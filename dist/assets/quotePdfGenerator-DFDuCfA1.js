import{E as D}from"./jspdf.es.min-CM__zGBL.js";import"./index-Qpkz6-Kp.js";import"./react-vendor-xNK3thrU.js";import"./supabase-vendor-CSCOup90.js";function y(e){const t=new D,n=t.internal.pageSize.getWidth(),S=t.internal.pageSize.getHeight(),o=20;let s=o;const c=7,_=[59,130,246],a=[31,41,55],d=[107,114,128];t.setFillColor(..._),t.rect(0,0,n,40,"F"),t.setTextColor(255,255,255),t.setFontSize(28),t.setFont("helvetica","bold"),t.text("DEVIS",o,25),t.setFontSize(12),t.setFont("helvetica","normal"),t.text(`N° ${e.quote_number}`,n-o,25,{align:"right"}),s=50,t.setTextColor(...a),t.setFontSize(10),t.setFont("helvetica","bold"),t.text("ARTISAN",o,s),t.setFont("helvetica","normal"),s+=c,t.setFontSize(11),t.text(e.artisan_name,o,s),s+=c,e.artisan_phone&&(t.setFontSize(10),t.text(`Tél: ${e.artisan_phone}`,o,s),s+=c),e.artisan_email&&(t.text(`Email: ${e.artisan_email}`,o,s),s+=c);const v=new Date(e.created_at).toLocaleDateString("fr-FR",{day:"2-digit",month:"long",year:"numeric"});t.setFont("helvetica","bold"),t.text("DATE",n-o,50,{align:"right"}),t.setFont("helvetica","normal"),t.text(v,n-o,57,{align:"right"}),e.validity_hours&&t.text(`Validité: ${e.validity_hours} heures`,n-o,64,{align:"right"}),s=80,t.setFillColor(239,246,255),t.setDrawColor(..._),t.rect(o-5,s-10,n-2*o+10,20,"FD"),t.setFontSize(14),t.setFont("helvetica","bold"),t.setTextColor(30,64,175),t.text(e.project_title,o,s),e.client_name&&(t.setFontSize(10),t.setFont("helvetica","normal"),t.setTextColor(...d),t.text(`Client: ${e.client_name}`,o,s+8)),s+=25,t.setTextColor(...a);const f=e.amount||0,m=e.labor_cost||0,h=e.materials_cost||0,g=m+h,C=e.urgent_surcharge||(e.urgent_surcharge_percent&&g?g*(e.urgent_surcharge_percent/100):0),x=s,F=o,T=n-o-60;t.setFillColor(243,244,246),t.rect(F-5,x-8,n-2*o+10,8,"F"),t.setFontSize(9),t.setFont("helvetica","bold"),t.setTextColor(...d),t.text("DESCRIPTION",F,x-2),t.text("MONTANT",T,x-2,{align:"right"}),s=x+5,t.setFont("helvetica","normal"),t.setFontSize(10),t.setTextColor(...a);const r=[];if(m>0&&r.push({desc:"Main d'œuvre",amount:m}),h>0&&r.push({desc:"Matériaux",amount:h}),g>0&&m===0&&h===0&&r.push({desc:"Prestation",amount:g}),C>0&&r.push({desc:`Majoration urgence (${e.urgent_surcharge_percent||0}%)`,amount:C}),r.push({desc:"TOTAL",amount:f,isTotal:!0}),r.forEach((i,l)=>{i.isTotal?(t.setFillColor(239,246,255),t.rect(F-5,s-6,n-2*o+10,10,"F"),t.setFont("helvetica","bold"),t.setFontSize(12),t.setTextColor(30,64,175)):(t.setFont("helvetica","normal"),t.setFontSize(10),t.setTextColor(...a)),t.text(i.desc,F,s),t.text(`${i.amount.toLocaleString("fr-FR")} FCFA`,T+60,s,{align:"right"}),s+=i.isTotal?12:8,!i.isTotal&&l<r.length-1&&(t.setDrawColor(229,231,235),t.line(F,s-2,n-o,s-2),s+=3)}),s+=10,e.message){t.setFillColor(249,250,251),t.rect(o-5,s-5,n-2*o+10,30,"F"),t.setFontSize(9),t.setFont("helvetica","bold"),t.setTextColor(..._),t.text("DESCRIPTION",o,s),s+=8,t.setFont("helvetica","normal"),t.setFontSize(10),t.setTextColor(...a);const i=t.splitTextToSize(e.message,n-2*o);t.text(i,o,s),s+=i.length*c+10}if(e.estimated_duration||e.proposed_date){const i=s,l=(n-2*o)/2-5;if(e.estimated_duration&&(t.setFillColor(249,250,251),t.rect(o-5,i-5,l,15,"F"),t.setFontSize(8),t.setFont("helvetica","bold"),t.setTextColor(...d),t.text("DURÉE ESTIMÉE",o,i),t.setFont("helvetica","normal"),t.setFontSize(10),t.setTextColor(...a),t.text(e.estimated_duration,o,i+8)),e.proposed_date){const z=new Date(e.proposed_date).toLocaleDateString("fr-FR"),b=e.proposed_time_start&&e.proposed_time_end?` de ${e.proposed_time_start} à ${e.proposed_time_end}`:"";t.setFillColor(249,250,251),t.rect(o+l+5,i-5,l,15,"F"),t.setFontSize(8),t.setFont("helvetica","bold"),t.setTextColor(...d),t.text("DATE PROPOSÉE",o+l+5,i),t.setFont("helvetica","normal"),t.setFontSize(10),t.setTextColor(...a),t.text(z+b,o+l+5,i+8)}s=i+20}const p=S-30;t.setDrawColor(229,231,235),t.line(o,p,n-o,p),t.setFontSize(9),t.setFont("helvetica","normal"),t.setTextColor(...d),t.text(`Ce devis est valable ${e.validity_hours||48} heures à compter de sa date d'émission.`,n/2,p+8,{align:"center"}),t.text("Document généré par Mbourake - Plateforme de mise en relation artisans/clients",n/2,p+15,{align:"center"}),t.save(`Devis-${e.quote_number}.pdf`)}export{y as downloadQuotePDF};
