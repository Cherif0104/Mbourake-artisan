const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["./quotePdfGenerator-DFDuCfA1.js","./jspdf.es.min-CM__zGBL.js","./react-vendor-xNK3thrU.js","./supabase-vendor-CSCOup90.js","./invoicePdfGenerator-CKKVeecw.js"])))=>i.map(i=>d[i]);
import{r as Ah,a as qh,b as c,u as pn,N as hd,c as ht,d as _l,e as Ya,R as $i,L as Mh,O as Dh,f as Rh,g as it,B as Th}from"./react-vendor-xNK3thrU.js";import{c as Lh}from"./supabase-vendor-CSCOup90.js";(function(){const u=document.createElement("link").relList;if(u&&u.supports&&u.supports("modulepreload"))return;for(const x of document.querySelectorAll('link[rel="modulepreload"]'))o(x);new MutationObserver(x=>{for(const y of x)if(y.type==="childList")for(const N of y.addedNodes)N.tagName==="LINK"&&N.rel==="modulepreload"&&o(N)}).observe(document,{childList:!0,subtree:!0});function f(x){const y={};return x.integrity&&(y.integrity=x.integrity),x.referrerPolicy&&(y.referrerPolicy=x.referrerPolicy),x.crossOrigin==="use-credentials"?y.credentials="include":x.crossOrigin==="anonymous"?y.credentials="omit":y.credentials="same-origin",y}function o(x){if(x.ep)return;x.ep=!0;const y=f(x);fetch(x.href,y)}})();var id={exports:{}},nn={};/**
 * @license React
 * react-jsx-runtime.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var y0;function Uh(){if(y0)return nn;y0=1;var i=Symbol.for("react.transitional.element"),u=Symbol.for("react.fragment");function f(o,x,y){var N=null;if(y!==void 0&&(N=""+y),x.key!==void 0&&(N=""+x.key),"key"in x){y={};for(var h in x)h!=="key"&&(y[h]=x[h])}else y=x;return x=y.ref,{$$typeof:i,type:o,key:N,ref:x!==void 0?x:null,props:y}}return nn.Fragment=u,nn.jsx=f,nn.jsxs=f,nn}var j0;function Oh(){return j0||(j0=1,id.exports=Uh()),id.exports}var e=Oh(),od={exports:{}},on={},cd={exports:{}},dd={};/**
 * @license React
 * scheduler.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var v0;function Vh(){return v0||(v0=1,(function(i){function u(z,S){var V=z.length;z.push(S);e:for(;0<V;){var le=V-1>>>1,he=z[le];if(0<x(he,S))z[le]=S,z[V]=he,V=le;else break e}}function f(z){return z.length===0?null:z[0]}function o(z){if(z.length===0)return null;var S=z[0],V=z.pop();if(V!==S){z[0]=V;e:for(var le=0,he=z.length,Ne=he>>>1;le<Ne;){var fe=2*(le+1)-1,ye=z[fe],Y=fe+1,$=z[Y];if(0>x(ye,V))Y<he&&0>x($,ye)?(z[le]=$,z[Y]=V,le=Y):(z[le]=ye,z[fe]=V,le=fe);else if(Y<he&&0>x($,V))z[le]=$,z[Y]=V,le=Y;else break e}}return S}function x(z,S){var V=z.sortIndex-S.sortIndex;return V!==0?V:z.id-S.id}if(i.unstable_now=void 0,typeof performance=="object"&&typeof performance.now=="function"){var y=performance;i.unstable_now=function(){return y.now()}}else{var N=Date,h=N.now();i.unstable_now=function(){return N.now()-h}}var g=[],E=[],d=1,v=null,b=3,w=!1,_=!1,L=!1,M=!1,D=typeof setTimeout=="function"?setTimeout:null,U=typeof clearTimeout=="function"?clearTimeout:null,J=typeof setImmediate<"u"?setImmediate:null;function F(z){for(var S=f(E);S!==null;){if(S.callback===null)o(E);else if(S.startTime<=z)o(E),S.sortIndex=S.expirationTime,u(g,S);else break;S=f(E)}}function G(z){if(L=!1,F(z),!_)if(f(g)!==null)_=!0,Z||(Z=!0,q());else{var S=f(E);S!==null&&B(G,S.startTime-z)}}var Z=!1,X=-1,R=5,ae=-1;function ge(){return M?!0:!(i.unstable_now()-ae<R)}function k(){if(M=!1,Z){var z=i.unstable_now();ae=z;var S=!0;try{e:{_=!1,L&&(L=!1,U(X),X=-1),w=!0;var V=b;try{t:{for(F(z),v=f(g);v!==null&&!(v.expirationTime>z&&ge());){var le=v.callback;if(typeof le=="function"){v.callback=null,b=v.priorityLevel;var he=le(v.expirationTime<=z);if(z=i.unstable_now(),typeof he=="function"){v.callback=he,F(z),S=!0;break t}v===f(g)&&o(g),F(z)}else o(g);v=f(g)}if(v!==null)S=!0;else{var Ne=f(E);Ne!==null&&B(G,Ne.startTime-z),S=!1}}break e}finally{v=null,b=V,w=!1}S=void 0}}finally{S?q():Z=!1}}}var q;if(typeof J=="function")q=function(){J(k)};else if(typeof MessageChannel<"u"){var T=new MessageChannel,C=T.port2;T.port1.onmessage=k,q=function(){C.postMessage(null)}}else q=function(){D(k,0)};function B(z,S){X=D(function(){z(i.unstable_now())},S)}i.unstable_IdlePriority=5,i.unstable_ImmediatePriority=1,i.unstable_LowPriority=4,i.unstable_NormalPriority=3,i.unstable_Profiling=null,i.unstable_UserBlockingPriority=2,i.unstable_cancelCallback=function(z){z.callback=null},i.unstable_forceFrameRate=function(z){0>z||125<z?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):R=0<z?Math.floor(1e3/z):5},i.unstable_getCurrentPriorityLevel=function(){return b},i.unstable_next=function(z){switch(b){case 1:case 2:case 3:var S=3;break;default:S=b}var V=b;b=S;try{return z()}finally{b=V}},i.unstable_requestPaint=function(){M=!0},i.unstable_runWithPriority=function(z,S){switch(z){case 1:case 2:case 3:case 4:case 5:break;default:z=3}var V=b;b=z;try{return S()}finally{b=V}},i.unstable_scheduleCallback=function(z,S,V){var le=i.unstable_now();switch(typeof V=="object"&&V!==null?(V=V.delay,V=typeof V=="number"&&0<V?le+V:le):V=le,z){case 1:var he=-1;break;case 2:he=250;break;case 5:he=1073741823;break;case 4:he=1e4;break;default:he=5e3}return he=V+he,z={id:d++,callback:S,priorityLevel:z,startTime:V,expirationTime:he,sortIndex:-1},V>le?(z.sortIndex=V,u(E,z),f(g)===null&&z===f(E)&&(L?(U(X),X=-1):L=!0,B(G,V-le))):(z.sortIndex=he,u(g,z),_||w||(_=!0,Z||(Z=!0,q()))),z},i.unstable_shouldYield=ge,i.unstable_wrapCallback=function(z){var S=b;return function(){var V=b;b=S;try{return z.apply(this,arguments)}finally{b=V}}}})(dd)),dd}var N0;function Fh(){return N0||(N0=1,cd.exports=Vh()),cd.exports}/**
 * @license React
 * react-dom-client.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var w0;function Bh(){if(w0)return on;w0=1;var i=Fh(),u=Ah(),f=qh();function o(t){var a="https://react.dev/errors/"+t;if(1<arguments.length){a+="?args[]="+encodeURIComponent(arguments[1]);for(var s=2;s<arguments.length;s++)a+="&args[]="+encodeURIComponent(arguments[s])}return"Minified React error #"+t+"; visit "+a+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function x(t){return!(!t||t.nodeType!==1&&t.nodeType!==9&&t.nodeType!==11)}function y(t){var a=t,s=t;if(t.alternate)for(;a.return;)a=a.return;else{t=a;do a=t,(a.flags&4098)!==0&&(s=a.return),t=a.return;while(t)}return a.tag===3?s:null}function N(t){if(t.tag===13){var a=t.memoizedState;if(a===null&&(t=t.alternate,t!==null&&(a=t.memoizedState)),a!==null)return a.dehydrated}return null}function h(t){if(t.tag===31){var a=t.memoizedState;if(a===null&&(t=t.alternate,t!==null&&(a=t.memoizedState)),a!==null)return a.dehydrated}return null}function g(t){if(y(t)!==t)throw Error(o(188))}function E(t){var a=t.alternate;if(!a){if(a=y(t),a===null)throw Error(o(188));return a!==t?null:t}for(var s=t,l=a;;){var r=s.return;if(r===null)break;var n=r.alternate;if(n===null){if(l=r.return,l!==null){s=l;continue}break}if(r.child===n.child){for(n=r.child;n;){if(n===s)return g(r),t;if(n===l)return g(r),a;n=n.sibling}throw Error(o(188))}if(s.return!==l.return)s=r,l=n;else{for(var m=!1,p=r.child;p;){if(p===s){m=!0,s=r,l=n;break}if(p===l){m=!0,l=r,s=n;break}p=p.sibling}if(!m){for(p=n.child;p;){if(p===s){m=!0,s=n,l=r;break}if(p===l){m=!0,l=n,s=r;break}p=p.sibling}if(!m)throw Error(o(189))}}if(s.alternate!==l)throw Error(o(190))}if(s.tag!==3)throw Error(o(188));return s.stateNode.current===s?t:a}function d(t){var a=t.tag;if(a===5||a===26||a===27||a===6)return t;for(t=t.child;t!==null;){if(a=d(t),a!==null)return a;t=t.sibling}return null}var v=Object.assign,b=Symbol.for("react.element"),w=Symbol.for("react.transitional.element"),_=Symbol.for("react.portal"),L=Symbol.for("react.fragment"),M=Symbol.for("react.strict_mode"),D=Symbol.for("react.profiler"),U=Symbol.for("react.consumer"),J=Symbol.for("react.context"),F=Symbol.for("react.forward_ref"),G=Symbol.for("react.suspense"),Z=Symbol.for("react.suspense_list"),X=Symbol.for("react.memo"),R=Symbol.for("react.lazy"),ae=Symbol.for("react.activity"),ge=Symbol.for("react.memo_cache_sentinel"),k=Symbol.iterator;function q(t){return t===null||typeof t!="object"?null:(t=k&&t[k]||t["@@iterator"],typeof t=="function"?t:null)}var T=Symbol.for("react.client.reference");function C(t){if(t==null)return null;if(typeof t=="function")return t.$$typeof===T?null:t.displayName||t.name||null;if(typeof t=="string")return t;switch(t){case L:return"Fragment";case D:return"Profiler";case M:return"StrictMode";case G:return"Suspense";case Z:return"SuspenseList";case ae:return"Activity"}if(typeof t=="object")switch(t.$$typeof){case _:return"Portal";case J:return t.displayName||"Context";case U:return(t._context.displayName||"Context")+".Consumer";case F:var a=t.render;return t=t.displayName,t||(t=a.displayName||a.name||"",t=t!==""?"ForwardRef("+t+")":"ForwardRef"),t;case X:return a=t.displayName||null,a!==null?a:C(t.type)||"Memo";case R:a=t._payload,t=t._init;try{return C(t(a))}catch{}}return null}var B=Array.isArray,z=u.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,S=f.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,V={pending:!1,data:null,method:null,action:null},le=[],he=-1;function Ne(t){return{current:t}}function fe(t){0>he||(t.current=le[he],le[he]=null,he--)}function ye(t,a){he++,le[he]=t.current,t.current=a}var Y=Ne(null),$=Ne(null),ce=Ne(null),we=Ne(null);function We(t,a){switch(ye(ce,a),ye($,t),ye(Y,null),a.nodeType){case 9:case 11:t=(t=a.documentElement)&&(t=t.namespaceURI)?Hx(t):0;break;default:if(t=a.tagName,a=a.namespaceURI)a=Hx(a),t=Gx(a,t);else switch(t){case"svg":t=1;break;case"math":t=2;break;default:t=0}}fe(Y),ye(Y,t)}function pe(){fe(Y),fe($),fe(ce)}function Ye(t){t.memoizedState!==null&&ye(we,t);var a=Y.current,s=Gx(a,t.type);a!==s&&(ye($,t),ye(Y,s))}function st(t){$.current===t&&(fe(Y),fe($)),we.current===t&&(fe(we),an._currentValue=V)}var Ke,ft;function _e(t){if(Ke===void 0)try{throw Error()}catch(s){var a=s.stack.trim().match(/\n( *(at )?)/);Ke=a&&a[1]||"",ft=-1<s.stack.indexOf(`
    at`)?" (<anonymous>)":-1<s.stack.indexOf("@")?"@unknown:0:0":""}return`
`+Ke+t+ft}var je=!1;function Le(t,a){if(!t||je)return"";je=!0;var s=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{var l={DetermineComponentFrameRoot:function(){try{if(a){var ie=function(){throw Error()};if(Object.defineProperty(ie.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(ie,[])}catch(I){var W=I}Reflect.construct(t,[],ie)}else{try{ie.call()}catch(I){W=I}t.call(ie.prototype)}}else{try{throw Error()}catch(I){W=I}(ie=t())&&typeof ie.catch=="function"&&ie.catch(function(){})}}catch(I){if(I&&W&&typeof I.stack=="string")return[I.stack,W.stack]}return[null,null]}};l.DetermineComponentFrameRoot.displayName="DetermineComponentFrameRoot";var r=Object.getOwnPropertyDescriptor(l.DetermineComponentFrameRoot,"name");r&&r.configurable&&Object.defineProperty(l.DetermineComponentFrameRoot,"name",{value:"DetermineComponentFrameRoot"});var n=l.DetermineComponentFrameRoot(),m=n[0],p=n[1];if(m&&p){var A=m.split(`
`),K=p.split(`
`);for(r=l=0;l<A.length&&!A[l].includes("DetermineComponentFrameRoot");)l++;for(;r<K.length&&!K[r].includes("DetermineComponentFrameRoot");)r++;if(l===A.length||r===K.length)for(l=A.length-1,r=K.length-1;1<=l&&0<=r&&A[l]!==K[r];)r--;for(;1<=l&&0<=r;l--,r--)if(A[l]!==K[r]){if(l!==1||r!==1)do if(l--,r--,0>r||A[l]!==K[r]){var re=`
`+A[l].replace(" at new "," at ");return t.displayName&&re.includes("<anonymous>")&&(re=re.replace("<anonymous>",t.displayName)),re}while(1<=l&&0<=r);break}}}finally{je=!1,Error.prepareStackTrace=s}return(s=t?t.displayName||t.name:"")?_e(s):""}function ue(t,a){switch(t.tag){case 26:case 27:case 5:return _e(t.type);case 16:return _e("Lazy");case 13:return t.child!==a&&a!==null?_e("Suspense Fallback"):_e("Suspense");case 19:return _e("SuspenseList");case 0:case 15:return Le(t.type,!1);case 11:return Le(t.type.render,!1);case 1:return Le(t.type,!0);case 31:return _e("Activity");default:return""}}function Ae(t){try{var a="",s=null;do a+=ue(t,s),s=t,t=t.return;while(t);return a}catch(l){return`
Error generating stack: `+l.message+`
`+l.stack}}var ze=Object.prototype.hasOwnProperty,Ge=i.unstable_scheduleCallback,xe=i.unstable_cancelCallback,Se=i.unstable_shouldYield,Pe=i.unstable_requestPaint,Xe=i.unstable_now,gt=i.unstable_getCurrentPriorityLevel,Lt=i.unstable_ImmediatePriority,qt=i.unstable_UserBlockingPriority,kt=i.unstable_NormalPriority,Rt=i.unstable_LowPriority,Ce=i.unstable_IdlePriority,Me=i.log,tt=i.unstable_setDisableYieldValue,Q=null,be=null;function Ee(t){if(typeof Me=="function"&&tt(t),be&&typeof be.setStrictMode=="function")try{be.setStrictMode(Q,t)}catch{}}var Oe=Math.clz32?Math.clz32:se,ct=Math.log,at=Math.LN2;function se(t){return t>>>=0,t===0?32:31-(ct(t)/at|0)|0}var oe=256,ve=262144,Te=4194304;function ee(t){var a=t&42;if(a!==0)return a;switch(t&-t){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:return 64;case 128:return 128;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:return t&261888;case 262144:case 524288:case 1048576:case 2097152:return t&3932160;case 4194304:case 8388608:case 16777216:case 33554432:return t&62914560;case 67108864:return 67108864;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 0;default:return t}}function Fe(t,a,s){var l=t.pendingLanes;if(l===0)return 0;var r=0,n=t.suspendedLanes,m=t.pingedLanes;t=t.warmLanes;var p=l&134217727;return p!==0?(l=p&~n,l!==0?r=ee(l):(m&=p,m!==0?r=ee(m):s||(s=p&~t,s!==0&&(r=ee(s))))):(p=l&~n,p!==0?r=ee(p):m!==0?r=ee(m):s||(s=l&~t,s!==0&&(r=ee(s)))),r===0?0:a!==0&&a!==r&&(a&n)===0&&(n=r&-r,s=a&-a,n>=s||n===32&&(s&4194048)!==0)?a:r}function He(t,a){return(t.pendingLanes&~(t.suspendedLanes&~t.pingedLanes)&a)===0}function te(t,a){switch(t){case 1:case 2:case 4:case 8:case 64:return a+250;case 16:case 32:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return a+5e3;case 4194304:case 8388608:case 16777216:case 33554432:return-1;case 67108864:case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function de(){var t=Te;return Te<<=1,(Te&62914560)===0&&(Te=4194304),t}function De(t){for(var a=[],s=0;31>s;s++)a.push(t);return a}function qe(t,a){t.pendingLanes|=a,a!==268435456&&(t.suspendedLanes=0,t.pingedLanes=0,t.warmLanes=0)}function xt(t,a,s,l,r,n){var m=t.pendingLanes;t.pendingLanes=s,t.suspendedLanes=0,t.pingedLanes=0,t.warmLanes=0,t.expiredLanes&=s,t.entangledLanes&=s,t.errorRecoveryDisabledLanes&=s,t.shellSuspendCounter=0;var p=t.entanglements,A=t.expirationTimes,K=t.hiddenUpdates;for(s=m&~s;0<s;){var re=31-Oe(s),ie=1<<re;p[re]=0,A[re]=-1;var W=K[re];if(W!==null)for(K[re]=null,re=0;re<W.length;re++){var I=W[re];I!==null&&(I.lane&=-536870913)}s&=~ie}l!==0&&jt(t,l,0),n!==0&&r===0&&t.tag!==0&&(t.suspendedLanes|=n&~(m&~a))}function jt(t,a,s){t.pendingLanes|=a,t.suspendedLanes&=~a;var l=31-Oe(a);t.entangledLanes|=a,t.entanglements[l]=t.entanglements[l]|1073741824|s&261930}function Mt(t,a){var s=t.entangledLanes|=a;for(t=t.entanglements;s;){var l=31-Oe(s),r=1<<l;r&a|t[l]&a&&(t[l]|=a),s&=~r}}function pt(t,a){var s=a&-a;return s=(s&42)!==0?1:Xa(s),(s&(t.suspendedLanes|a))!==0?0:s}function Xa(t){switch(t){case 2:t=1;break;case 8:t=4;break;case 32:t=16;break;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:t=128;break;case 268435456:t=134217728;break;default:t=0}return t}function wa(t){return t&=-t,2<t?8<t?(t&134217727)!==0?32:268435456:8:2}function Za(){var t=S.p;return t!==0?t:(t=window.event,t===void 0?32:m0(t.type))}function Ve(t,a){var s=S.p;try{return S.p=t,a()}finally{S.p=s}}var lt=Math.random().toString(36).slice(2),ke="__reactFiber$"+lt,Tt="__reactProps$"+lt,ua="__reactContainer$"+lt,Pa="__reactEvents$"+lt,ts="__reactListeners$"+lt,jn="__reactHandles$"+lt,Ed="__reactResources$"+lt,pr="__reactMarker$"+lt;function Wi(t){delete t[ke],delete t[Tt],delete t[Pa],delete t[ts],delete t[jn]}function zl(t){var a=t[ke];if(a)return a;for(var s=t.parentNode;s;){if(a=s[ua]||s[ke]){if(s=a.alternate,a.child!==null||s!==null&&s.child!==null)for(t=Kx(t);t!==null;){if(s=t[ke])return s;t=Kx(t)}return a}t=s,s=t.parentNode}return null}function kl(t){if(t=t[ke]||t[ua]){var a=t.tag;if(a===5||a===6||a===13||a===31||a===26||a===27||a===3)return t}return null}function br(t){var a=t.tag;if(a===5||a===26||a===27||a===6)return t.stateNode;throw Error(o(33))}function Cl(t){var a=t[Ed];return a||(a=t[Ed]={hoistableStyles:new Map,hoistableScripts:new Map}),a}function la(t){t[pr]=!0}var Ad=new Set,qd={};function sl(t,a){El(t,a),El(t+"Capture",a)}function El(t,a){for(qd[t]=a,t=0;t<a.length;t++)Ad.add(a[t])}var vf=RegExp("^[:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD][:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD\\-.0-9\\u00B7\\u0300-\\u036F\\u203F-\\u2040]*$"),Md={},Dd={};function Nf(t){return ze.call(Dd,t)?!0:ze.call(Md,t)?!1:vf.test(t)?Dd[t]=!0:(Md[t]=!0,!1)}function vn(t,a,s){if(Nf(a))if(s===null)t.removeAttribute(a);else{switch(typeof s){case"undefined":case"function":case"symbol":t.removeAttribute(a);return;case"boolean":var l=a.toLowerCase().slice(0,5);if(l!=="data-"&&l!=="aria-"){t.removeAttribute(a);return}}t.setAttribute(a,""+s)}}function Nn(t,a,s){if(s===null)t.removeAttribute(a);else{switch(typeof s){case"undefined":case"function":case"symbol":case"boolean":t.removeAttribute(a);return}t.setAttribute(a,""+s)}}function is(t,a,s,l){if(l===null)t.removeAttribute(s);else{switch(typeof l){case"undefined":case"function":case"symbol":case"boolean":t.removeAttribute(s);return}t.setAttributeNS(a,s,""+l)}}function Ta(t){switch(typeof t){case"bigint":case"boolean":case"number":case"string":case"undefined":return t;case"object":return t;default:return""}}function Rd(t){var a=t.type;return(t=t.nodeName)&&t.toLowerCase()==="input"&&(a==="checkbox"||a==="radio")}function wf(t,a,s){var l=Object.getOwnPropertyDescriptor(t.constructor.prototype,a);if(!t.hasOwnProperty(a)&&typeof l<"u"&&typeof l.get=="function"&&typeof l.set=="function"){var r=l.get,n=l.set;return Object.defineProperty(t,a,{configurable:!0,get:function(){return r.call(this)},set:function(m){s=""+m,n.call(this,m)}}),Object.defineProperty(t,a,{enumerable:l.enumerable}),{getValue:function(){return s},setValue:function(m){s=""+m},stopTracking:function(){t._valueTracker=null,delete t[a]}}}}function Ii(t){if(!t._valueTracker){var a=Rd(t)?"checked":"value";t._valueTracker=wf(t,a,""+t[a])}}function Td(t){if(!t)return!1;var a=t._valueTracker;if(!a)return!0;var s=a.getValue(),l="";return t&&(l=Rd(t)?t.checked?"true":"false":t.value),t=l,t!==s?(a.setValue(t),!0):!1}function wn(t){if(t=t||(typeof document<"u"?document:void 0),typeof t>"u")return null;try{return t.activeElement||t.body}catch{return t.body}}var _f=/[\n"\\]/g;function La(t){return t.replace(_f,function(a){return"\\"+a.charCodeAt(0).toString(16)+" "})}function eo(t,a,s,l,r,n,m,p){t.name="",m!=null&&typeof m!="function"&&typeof m!="symbol"&&typeof m!="boolean"?t.type=m:t.removeAttribute("type"),a!=null?m==="number"?(a===0&&t.value===""||t.value!=a)&&(t.value=""+Ta(a)):t.value!==""+Ta(a)&&(t.value=""+Ta(a)):m!=="submit"&&m!=="reset"||t.removeAttribute("value"),a!=null?to(t,m,Ta(a)):s!=null?to(t,m,Ta(s)):l!=null&&t.removeAttribute("value"),r==null&&n!=null&&(t.defaultChecked=!!n),r!=null&&(t.checked=r&&typeof r!="function"&&typeof r!="symbol"),p!=null&&typeof p!="function"&&typeof p!="symbol"&&typeof p!="boolean"?t.name=""+Ta(p):t.removeAttribute("name")}function Ld(t,a,s,l,r,n,m,p){if(n!=null&&typeof n!="function"&&typeof n!="symbol"&&typeof n!="boolean"&&(t.type=n),a!=null||s!=null){if(!(n!=="submit"&&n!=="reset"||a!=null)){Ii(t);return}s=s!=null?""+Ta(s):"",a=a!=null?""+Ta(a):s,p||a===t.value||(t.value=a),t.defaultValue=a}l=l??r,l=typeof l!="function"&&typeof l!="symbol"&&!!l,t.checked=p?t.checked:!!l,t.defaultChecked=!!l,m!=null&&typeof m!="function"&&typeof m!="symbol"&&typeof m!="boolean"&&(t.name=m),Ii(t)}function to(t,a,s){a==="number"&&wn(t.ownerDocument)===t||t.defaultValue===""+s||(t.defaultValue=""+s)}function Al(t,a,s,l){if(t=t.options,a){a={};for(var r=0;r<s.length;r++)a["$"+s[r]]=!0;for(s=0;s<t.length;s++)r=a.hasOwnProperty("$"+t[s].value),t[s].selected!==r&&(t[s].selected=r),r&&l&&(t[s].defaultSelected=!0)}else{for(s=""+Ta(s),a=null,r=0;r<t.length;r++){if(t[r].value===s){t[r].selected=!0,l&&(t[r].defaultSelected=!0);return}a!==null||t[r].disabled||(a=t[r])}a!==null&&(a.selected=!0)}}function Ud(t,a,s){if(a!=null&&(a=""+Ta(a),a!==t.value&&(t.value=a),s==null)){t.defaultValue!==a&&(t.defaultValue=a);return}t.defaultValue=s!=null?""+Ta(s):""}function Od(t,a,s,l){if(a==null){if(l!=null){if(s!=null)throw Error(o(92));if(B(l)){if(1<l.length)throw Error(o(93));l=l[0]}s=l}s==null&&(s=""),a=s}s=Ta(a),t.defaultValue=s,l=t.textContent,l===s&&l!==""&&l!==null&&(t.value=l),Ii(t)}function ql(t,a){if(a){var s=t.firstChild;if(s&&s===t.lastChild&&s.nodeType===3){s.nodeValue=a;return}}t.textContent=a}var Sf=new Set("animationIterationCount aspectRatio borderImageOutset borderImageSlice borderImageWidth boxFlex boxFlexGroup boxOrdinalGroup columnCount columns flex flexGrow flexPositive flexShrink flexNegative flexOrder gridArea gridRow gridRowEnd gridRowSpan gridRowStart gridColumn gridColumnEnd gridColumnSpan gridColumnStart fontWeight lineClamp lineHeight opacity order orphans scale tabSize widows zIndex zoom fillOpacity floodOpacity stopOpacity strokeDasharray strokeDashoffset strokeMiterlimit strokeOpacity strokeWidth MozAnimationIterationCount MozBoxFlex MozBoxFlexGroup MozLineClamp msAnimationIterationCount msFlex msZoom msFlexGrow msFlexNegative msFlexOrder msFlexPositive msFlexShrink msGridColumn msGridColumnSpan msGridRow msGridRowSpan WebkitAnimationIterationCount WebkitBoxFlex WebKitBoxFlexGroup WebkitBoxOrdinalGroup WebkitColumnCount WebkitColumns WebkitFlex WebkitFlexGrow WebkitFlexPositive WebkitFlexShrink WebkitLineClamp".split(" "));function Vd(t,a,s){var l=a.indexOf("--")===0;s==null||typeof s=="boolean"||s===""?l?t.setProperty(a,""):a==="float"?t.cssFloat="":t[a]="":l?t.setProperty(a,s):typeof s!="number"||s===0||Sf.has(a)?a==="float"?t.cssFloat=s:t[a]=(""+s).trim():t[a]=s+"px"}function Fd(t,a,s){if(a!=null&&typeof a!="object")throw Error(o(62));if(t=t.style,s!=null){for(var l in s)!s.hasOwnProperty(l)||a!=null&&a.hasOwnProperty(l)||(l.indexOf("--")===0?t.setProperty(l,""):l==="float"?t.cssFloat="":t[l]="");for(var r in a)l=a[r],a.hasOwnProperty(r)&&s[r]!==l&&Vd(t,r,l)}else for(var n in a)a.hasOwnProperty(n)&&Vd(t,n,a[n])}function ao(t){if(t.indexOf("-")===-1)return!1;switch(t){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var zf=new Map([["acceptCharset","accept-charset"],["htmlFor","for"],["httpEquiv","http-equiv"],["crossOrigin","crossorigin"],["accentHeight","accent-height"],["alignmentBaseline","alignment-baseline"],["arabicForm","arabic-form"],["baselineShift","baseline-shift"],["capHeight","cap-height"],["clipPath","clip-path"],["clipRule","clip-rule"],["colorInterpolation","color-interpolation"],["colorInterpolationFilters","color-interpolation-filters"],["colorProfile","color-profile"],["colorRendering","color-rendering"],["dominantBaseline","dominant-baseline"],["enableBackground","enable-background"],["fillOpacity","fill-opacity"],["fillRule","fill-rule"],["floodColor","flood-color"],["floodOpacity","flood-opacity"],["fontFamily","font-family"],["fontSize","font-size"],["fontSizeAdjust","font-size-adjust"],["fontStretch","font-stretch"],["fontStyle","font-style"],["fontVariant","font-variant"],["fontWeight","font-weight"],["glyphName","glyph-name"],["glyphOrientationHorizontal","glyph-orientation-horizontal"],["glyphOrientationVertical","glyph-orientation-vertical"],["horizAdvX","horiz-adv-x"],["horizOriginX","horiz-origin-x"],["imageRendering","image-rendering"],["letterSpacing","letter-spacing"],["lightingColor","lighting-color"],["markerEnd","marker-end"],["markerMid","marker-mid"],["markerStart","marker-start"],["overlinePosition","overline-position"],["overlineThickness","overline-thickness"],["paintOrder","paint-order"],["panose-1","panose-1"],["pointerEvents","pointer-events"],["renderingIntent","rendering-intent"],["shapeRendering","shape-rendering"],["stopColor","stop-color"],["stopOpacity","stop-opacity"],["strikethroughPosition","strikethrough-position"],["strikethroughThickness","strikethrough-thickness"],["strokeDasharray","stroke-dasharray"],["strokeDashoffset","stroke-dashoffset"],["strokeLinecap","stroke-linecap"],["strokeLinejoin","stroke-linejoin"],["strokeMiterlimit","stroke-miterlimit"],["strokeOpacity","stroke-opacity"],["strokeWidth","stroke-width"],["textAnchor","text-anchor"],["textDecoration","text-decoration"],["textRendering","text-rendering"],["transformOrigin","transform-origin"],["underlinePosition","underline-position"],["underlineThickness","underline-thickness"],["unicodeBidi","unicode-bidi"],["unicodeRange","unicode-range"],["unitsPerEm","units-per-em"],["vAlphabetic","v-alphabetic"],["vHanging","v-hanging"],["vIdeographic","v-ideographic"],["vMathematical","v-mathematical"],["vectorEffect","vector-effect"],["vertAdvY","vert-adv-y"],["vertOriginX","vert-origin-x"],["vertOriginY","vert-origin-y"],["wordSpacing","word-spacing"],["writingMode","writing-mode"],["xmlnsXlink","xmlns:xlink"],["xHeight","x-height"]]),kf=/^[\u0000-\u001F ]*j[\r\n\t]*a[\r\n\t]*v[\r\n\t]*a[\r\n\t]*s[\r\n\t]*c[\r\n\t]*r[\r\n\t]*i[\r\n\t]*p[\r\n\t]*t[\r\n\t]*:/i;function _n(t){return kf.test(""+t)?"javascript:throw new Error('React has blocked a javascript: URL as a security precaution.')":t}function os(){}var so=null;function lo(t){return t=t.target||t.srcElement||window,t.correspondingUseElement&&(t=t.correspondingUseElement),t.nodeType===3?t.parentNode:t}var Ml=null,Dl=null;function Bd(t){var a=kl(t);if(a&&(t=a.stateNode)){var s=t[Tt]||null;e:switch(t=a.stateNode,a.type){case"input":if(eo(t,s.value,s.defaultValue,s.defaultValue,s.checked,s.defaultChecked,s.type,s.name),a=s.name,s.type==="radio"&&a!=null){for(s=t;s.parentNode;)s=s.parentNode;for(s=s.querySelectorAll('input[name="'+La(""+a)+'"][type="radio"]'),a=0;a<s.length;a++){var l=s[a];if(l!==t&&l.form===t.form){var r=l[Tt]||null;if(!r)throw Error(o(90));eo(l,r.value,r.defaultValue,r.defaultValue,r.checked,r.defaultChecked,r.type,r.name)}}for(a=0;a<s.length;a++)l=s[a],l.form===t.form&&Td(l)}break e;case"textarea":Ud(t,s.value,s.defaultValue);break e;case"select":a=s.value,a!=null&&Al(t,!!s.multiple,a,!1)}}}var ro=!1;function Hd(t,a,s){if(ro)return t(a,s);ro=!0;try{var l=t(a);return l}finally{if(ro=!1,(Ml!==null||Dl!==null)&&(ui(),Ml&&(a=Ml,t=Dl,Dl=Ml=null,Bd(a),t)))for(a=0;a<t.length;a++)Bd(t[a])}}function yr(t,a){var s=t.stateNode;if(s===null)return null;var l=s[Tt]||null;if(l===null)return null;s=l[a];e:switch(a){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(l=!l.disabled)||(t=t.type,l=!(t==="button"||t==="input"||t==="select"||t==="textarea")),t=!l;break e;default:t=!1}if(t)return null;if(s&&typeof s!="function")throw Error(o(231,a,typeof s));return s}var cs=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),no=!1;if(cs)try{var jr={};Object.defineProperty(jr,"passive",{get:function(){no=!0}}),window.addEventListener("test",jr,jr),window.removeEventListener("test",jr,jr)}catch{no=!1}var ks=null,io=null,Sn=null;function Gd(){if(Sn)return Sn;var t,a=io,s=a.length,l,r="value"in ks?ks.value:ks.textContent,n=r.length;for(t=0;t<s&&a[t]===r[t];t++);var m=s-t;for(l=1;l<=m&&a[s-l]===r[n-l];l++);return Sn=r.slice(t,1<l?1-l:void 0)}function zn(t){var a=t.keyCode;return"charCode"in t?(t=t.charCode,t===0&&a===13&&(t=13)):t=a,t===10&&(t=13),32<=t||t===13?t:0}function kn(){return!0}function $d(){return!1}function ha(t){function a(s,l,r,n,m){this._reactName=s,this._targetInst=r,this.type=l,this.nativeEvent=n,this.target=m,this.currentTarget=null;for(var p in t)t.hasOwnProperty(p)&&(s=t[p],this[p]=s?s(n):n[p]);return this.isDefaultPrevented=(n.defaultPrevented!=null?n.defaultPrevented:n.returnValue===!1)?kn:$d,this.isPropagationStopped=$d,this}return v(a.prototype,{preventDefault:function(){this.defaultPrevented=!0;var s=this.nativeEvent;s&&(s.preventDefault?s.preventDefault():typeof s.returnValue!="unknown"&&(s.returnValue=!1),this.isDefaultPrevented=kn)},stopPropagation:function(){var s=this.nativeEvent;s&&(s.stopPropagation?s.stopPropagation():typeof s.cancelBubble!="unknown"&&(s.cancelBubble=!0),this.isPropagationStopped=kn)},persist:function(){},isPersistent:kn}),a}var ll={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(t){return t.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},Cn=ha(ll),vr=v({},ll,{view:0,detail:0}),Cf=ha(vr),oo,co,Nr,En=v({},vr,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:mo,button:0,buttons:0,relatedTarget:function(t){return t.relatedTarget===void 0?t.fromElement===t.srcElement?t.toElement:t.fromElement:t.relatedTarget},movementX:function(t){return"movementX"in t?t.movementX:(t!==Nr&&(Nr&&t.type==="mousemove"?(oo=t.screenX-Nr.screenX,co=t.screenY-Nr.screenY):co=oo=0,Nr=t),oo)},movementY:function(t){return"movementY"in t?t.movementY:co}}),Qd=ha(En),Ef=v({},En,{dataTransfer:0}),Af=ha(Ef),qf=v({},vr,{relatedTarget:0}),uo=ha(qf),Mf=v({},ll,{animationName:0,elapsedTime:0,pseudoElement:0}),Df=ha(Mf),Rf=v({},ll,{clipboardData:function(t){return"clipboardData"in t?t.clipboardData:window.clipboardData}}),Tf=ha(Rf),Lf=v({},ll,{data:0}),Yd=ha(Lf),Uf={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},Of={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},Vf={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function Ff(t){var a=this.nativeEvent;return a.getModifierState?a.getModifierState(t):(t=Vf[t])?!!a[t]:!1}function mo(){return Ff}var Bf=v({},vr,{key:function(t){if(t.key){var a=Uf[t.key]||t.key;if(a!=="Unidentified")return a}return t.type==="keypress"?(t=zn(t),t===13?"Enter":String.fromCharCode(t)):t.type==="keydown"||t.type==="keyup"?Of[t.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:mo,charCode:function(t){return t.type==="keypress"?zn(t):0},keyCode:function(t){return t.type==="keydown"||t.type==="keyup"?t.keyCode:0},which:function(t){return t.type==="keypress"?zn(t):t.type==="keydown"||t.type==="keyup"?t.keyCode:0}}),Hf=ha(Bf),Gf=v({},En,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),Xd=ha(Gf),$f=v({},vr,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:mo}),Qf=ha($f),Yf=v({},ll,{propertyName:0,elapsedTime:0,pseudoElement:0}),Xf=ha(Yf),Zf=v({},En,{deltaX:function(t){return"deltaX"in t?t.deltaX:"wheelDeltaX"in t?-t.wheelDeltaX:0},deltaY:function(t){return"deltaY"in t?t.deltaY:"wheelDeltaY"in t?-t.wheelDeltaY:"wheelDelta"in t?-t.wheelDelta:0},deltaZ:0,deltaMode:0}),Pf=ha(Zf),Kf=v({},ll,{newState:0,oldState:0}),Jf=ha(Kf),Wf=[9,13,27,32],xo=cs&&"CompositionEvent"in window,wr=null;cs&&"documentMode"in document&&(wr=document.documentMode);var If=cs&&"TextEvent"in window&&!wr,Zd=cs&&(!xo||wr&&8<wr&&11>=wr),Pd=" ",Kd=!1;function Jd(t,a){switch(t){case"keyup":return Wf.indexOf(a.keyCode)!==-1;case"keydown":return a.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function Wd(t){return t=t.detail,typeof t=="object"&&"data"in t?t.data:null}var Rl=!1;function eg(t,a){switch(t){case"compositionend":return Wd(a);case"keypress":return a.which!==32?null:(Kd=!0,Pd);case"textInput":return t=a.data,t===Pd&&Kd?null:t;default:return null}}function tg(t,a){if(Rl)return t==="compositionend"||!xo&&Jd(t,a)?(t=Gd(),Sn=io=ks=null,Rl=!1,t):null;switch(t){case"paste":return null;case"keypress":if(!(a.ctrlKey||a.altKey||a.metaKey)||a.ctrlKey&&a.altKey){if(a.char&&1<a.char.length)return a.char;if(a.which)return String.fromCharCode(a.which)}return null;case"compositionend":return Zd&&a.locale!=="ko"?null:a.data;default:return null}}var ag={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function Id(t){var a=t&&t.nodeName&&t.nodeName.toLowerCase();return a==="input"?!!ag[t.type]:a==="textarea"}function eu(t,a,s,l){Ml?Dl?Dl.push(l):Dl=[l]:Ml=l,a=bi(a,"onChange"),0<a.length&&(s=new Cn("onChange","change",null,s,l),t.push({event:s,listeners:a}))}var _r=null,Sr=null;function sg(t){Lx(t,0)}function An(t){var a=br(t);if(Td(a))return t}function tu(t,a){if(t==="change")return a}var au=!1;if(cs){var fo;if(cs){var go="oninput"in document;if(!go){var su=document.createElement("div");su.setAttribute("oninput","return;"),go=typeof su.oninput=="function"}fo=go}else fo=!1;au=fo&&(!document.documentMode||9<document.documentMode)}function lu(){_r&&(_r.detachEvent("onpropertychange",ru),Sr=_r=null)}function ru(t){if(t.propertyName==="value"&&An(Sr)){var a=[];eu(a,Sr,t,lo(t)),Hd(sg,a)}}function lg(t,a,s){t==="focusin"?(lu(),_r=a,Sr=s,_r.attachEvent("onpropertychange",ru)):t==="focusout"&&lu()}function rg(t){if(t==="selectionchange"||t==="keyup"||t==="keydown")return An(Sr)}function ng(t,a){if(t==="click")return An(a)}function ig(t,a){if(t==="input"||t==="change")return An(a)}function og(t,a){return t===a&&(t!==0||1/t===1/a)||t!==t&&a!==a}var _a=typeof Object.is=="function"?Object.is:og;function zr(t,a){if(_a(t,a))return!0;if(typeof t!="object"||t===null||typeof a!="object"||a===null)return!1;var s=Object.keys(t),l=Object.keys(a);if(s.length!==l.length)return!1;for(l=0;l<s.length;l++){var r=s[l];if(!ze.call(a,r)||!_a(t[r],a[r]))return!1}return!0}function nu(t){for(;t&&t.firstChild;)t=t.firstChild;return t}function iu(t,a){var s=nu(t);t=0;for(var l;s;){if(s.nodeType===3){if(l=t+s.textContent.length,t<=a&&l>=a)return{node:s,offset:a-t};t=l}e:{for(;s;){if(s.nextSibling){s=s.nextSibling;break e}s=s.parentNode}s=void 0}s=nu(s)}}function ou(t,a){return t&&a?t===a?!0:t&&t.nodeType===3?!1:a&&a.nodeType===3?ou(t,a.parentNode):"contains"in t?t.contains(a):t.compareDocumentPosition?!!(t.compareDocumentPosition(a)&16):!1:!1}function cu(t){t=t!=null&&t.ownerDocument!=null&&t.ownerDocument.defaultView!=null?t.ownerDocument.defaultView:window;for(var a=wn(t.document);a instanceof t.HTMLIFrameElement;){try{var s=typeof a.contentWindow.location.href=="string"}catch{s=!1}if(s)t=a.contentWindow;else break;a=wn(t.document)}return a}function ho(t){var a=t&&t.nodeName&&t.nodeName.toLowerCase();return a&&(a==="input"&&(t.type==="text"||t.type==="search"||t.type==="tel"||t.type==="url"||t.type==="password")||a==="textarea"||t.contentEditable==="true")}var cg=cs&&"documentMode"in document&&11>=document.documentMode,Tl=null,po=null,kr=null,bo=!1;function du(t,a,s){var l=s.window===s?s.document:s.nodeType===9?s:s.ownerDocument;bo||Tl==null||Tl!==wn(l)||(l=Tl,"selectionStart"in l&&ho(l)?l={start:l.selectionStart,end:l.selectionEnd}:(l=(l.ownerDocument&&l.ownerDocument.defaultView||window).getSelection(),l={anchorNode:l.anchorNode,anchorOffset:l.anchorOffset,focusNode:l.focusNode,focusOffset:l.focusOffset}),kr&&zr(kr,l)||(kr=l,l=bi(po,"onSelect"),0<l.length&&(a=new Cn("onSelect","select",null,a,s),t.push({event:a,listeners:l}),a.target=Tl)))}function rl(t,a){var s={};return s[t.toLowerCase()]=a.toLowerCase(),s["Webkit"+t]="webkit"+a,s["Moz"+t]="moz"+a,s}var Ll={animationend:rl("Animation","AnimationEnd"),animationiteration:rl("Animation","AnimationIteration"),animationstart:rl("Animation","AnimationStart"),transitionrun:rl("Transition","TransitionRun"),transitionstart:rl("Transition","TransitionStart"),transitioncancel:rl("Transition","TransitionCancel"),transitionend:rl("Transition","TransitionEnd")},yo={},uu={};cs&&(uu=document.createElement("div").style,"AnimationEvent"in window||(delete Ll.animationend.animation,delete Ll.animationiteration.animation,delete Ll.animationstart.animation),"TransitionEvent"in window||delete Ll.transitionend.transition);function nl(t){if(yo[t])return yo[t];if(!Ll[t])return t;var a=Ll[t],s;for(s in a)if(a.hasOwnProperty(s)&&s in uu)return yo[t]=a[s];return t}var mu=nl("animationend"),xu=nl("animationiteration"),fu=nl("animationstart"),dg=nl("transitionrun"),ug=nl("transitionstart"),mg=nl("transitioncancel"),gu=nl("transitionend"),hu=new Map,jo="abort auxClick beforeToggle cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");jo.push("scrollEnd");function Ka(t,a){hu.set(t,a),sl(a,[t])}var qn=typeof reportError=="function"?reportError:function(t){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var a=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof t=="object"&&t!==null&&typeof t.message=="string"?String(t.message):String(t),error:t});if(!window.dispatchEvent(a))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",t);return}console.error(t)},Ua=[],Ul=0,vo=0;function Mn(){for(var t=Ul,a=vo=Ul=0;a<t;){var s=Ua[a];Ua[a++]=null;var l=Ua[a];Ua[a++]=null;var r=Ua[a];Ua[a++]=null;var n=Ua[a];if(Ua[a++]=null,l!==null&&r!==null){var m=l.pending;m===null?r.next=r:(r.next=m.next,m.next=r),l.pending=r}n!==0&&pu(s,r,n)}}function Dn(t,a,s,l){Ua[Ul++]=t,Ua[Ul++]=a,Ua[Ul++]=s,Ua[Ul++]=l,vo|=l,t.lanes|=l,t=t.alternate,t!==null&&(t.lanes|=l)}function No(t,a,s,l){return Dn(t,a,s,l),Rn(t)}function il(t,a){return Dn(t,null,null,a),Rn(t)}function pu(t,a,s){t.lanes|=s;var l=t.alternate;l!==null&&(l.lanes|=s);for(var r=!1,n=t.return;n!==null;)n.childLanes|=s,l=n.alternate,l!==null&&(l.childLanes|=s),n.tag===22&&(t=n.stateNode,t===null||t._visibility&1||(r=!0)),t=n,n=n.return;return t.tag===3?(n=t.stateNode,r&&a!==null&&(r=31-Oe(s),t=n.hiddenUpdates,l=t[r],l===null?t[r]=[a]:l.push(a),a.lane=s|536870912),n):null}function Rn(t){if(50<Pr)throw Pr=0,qc=null,Error(o(185));for(var a=t.return;a!==null;)t=a,a=t.return;return t.tag===3?t.stateNode:null}var Ol={};function xg(t,a,s,l){this.tag=t,this.key=s,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.refCleanup=this.ref=null,this.pendingProps=a,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=l,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function Sa(t,a,s,l){return new xg(t,a,s,l)}function wo(t){return t=t.prototype,!(!t||!t.isReactComponent)}function ds(t,a){var s=t.alternate;return s===null?(s=Sa(t.tag,a,t.key,t.mode),s.elementType=t.elementType,s.type=t.type,s.stateNode=t.stateNode,s.alternate=t,t.alternate=s):(s.pendingProps=a,s.type=t.type,s.flags=0,s.subtreeFlags=0,s.deletions=null),s.flags=t.flags&65011712,s.childLanes=t.childLanes,s.lanes=t.lanes,s.child=t.child,s.memoizedProps=t.memoizedProps,s.memoizedState=t.memoizedState,s.updateQueue=t.updateQueue,a=t.dependencies,s.dependencies=a===null?null:{lanes:a.lanes,firstContext:a.firstContext},s.sibling=t.sibling,s.index=t.index,s.ref=t.ref,s.refCleanup=t.refCleanup,s}function bu(t,a){t.flags&=65011714;var s=t.alternate;return s===null?(t.childLanes=0,t.lanes=a,t.child=null,t.subtreeFlags=0,t.memoizedProps=null,t.memoizedState=null,t.updateQueue=null,t.dependencies=null,t.stateNode=null):(t.childLanes=s.childLanes,t.lanes=s.lanes,t.child=s.child,t.subtreeFlags=0,t.deletions=null,t.memoizedProps=s.memoizedProps,t.memoizedState=s.memoizedState,t.updateQueue=s.updateQueue,t.type=s.type,a=s.dependencies,t.dependencies=a===null?null:{lanes:a.lanes,firstContext:a.firstContext}),t}function Tn(t,a,s,l,r,n){var m=0;if(l=t,typeof t=="function")wo(t)&&(m=1);else if(typeof t=="string")m=bh(t,s,Y.current)?26:t==="html"||t==="head"||t==="body"?27:5;else e:switch(t){case ae:return t=Sa(31,s,a,r),t.elementType=ae,t.lanes=n,t;case L:return ol(s.children,r,n,a);case M:m=8,r|=24;break;case D:return t=Sa(12,s,a,r|2),t.elementType=D,t.lanes=n,t;case G:return t=Sa(13,s,a,r),t.elementType=G,t.lanes=n,t;case Z:return t=Sa(19,s,a,r),t.elementType=Z,t.lanes=n,t;default:if(typeof t=="object"&&t!==null)switch(t.$$typeof){case J:m=10;break e;case U:m=9;break e;case F:m=11;break e;case X:m=14;break e;case R:m=16,l=null;break e}m=29,s=Error(o(130,t===null?"null":typeof t,"")),l=null}return a=Sa(m,s,a,r),a.elementType=t,a.type=l,a.lanes=n,a}function ol(t,a,s,l){return t=Sa(7,t,l,a),t.lanes=s,t}function _o(t,a,s){return t=Sa(6,t,null,a),t.lanes=s,t}function yu(t){var a=Sa(18,null,null,0);return a.stateNode=t,a}function So(t,a,s){return a=Sa(4,t.children!==null?t.children:[],t.key,a),a.lanes=s,a.stateNode={containerInfo:t.containerInfo,pendingChildren:null,implementation:t.implementation},a}var ju=new WeakMap;function Oa(t,a){if(typeof t=="object"&&t!==null){var s=ju.get(t);return s!==void 0?s:(a={value:t,source:a,stack:Ae(a)},ju.set(t,a),a)}return{value:t,source:a,stack:Ae(a)}}var Vl=[],Fl=0,Ln=null,Cr=0,Va=[],Fa=0,Cs=null,as=1,ss="";function us(t,a){Vl[Fl++]=Cr,Vl[Fl++]=Ln,Ln=t,Cr=a}function vu(t,a,s){Va[Fa++]=as,Va[Fa++]=ss,Va[Fa++]=Cs,Cs=t;var l=as;t=ss;var r=32-Oe(l)-1;l&=~(1<<r),s+=1;var n=32-Oe(a)+r;if(30<n){var m=r-r%5;n=(l&(1<<m)-1).toString(32),l>>=m,r-=m,as=1<<32-Oe(a)+r|s<<r|l,ss=n+t}else as=1<<n|s<<r|l,ss=t}function zo(t){t.return!==null&&(us(t,1),vu(t,1,0))}function ko(t){for(;t===Ln;)Ln=Vl[--Fl],Vl[Fl]=null,Cr=Vl[--Fl],Vl[Fl]=null;for(;t===Cs;)Cs=Va[--Fa],Va[Fa]=null,ss=Va[--Fa],Va[Fa]=null,as=Va[--Fa],Va[Fa]=null}function Nu(t,a){Va[Fa++]=as,Va[Fa++]=ss,Va[Fa++]=Cs,as=a.id,ss=a.overflow,Cs=t}var na=null,Ut=null,mt=!1,Es=null,Ba=!1,Co=Error(o(519));function As(t){var a=Error(o(418,1<arguments.length&&arguments[1]!==void 0&&arguments[1]?"text":"HTML",""));throw Er(Oa(a,t)),Co}function wu(t){var a=t.stateNode,s=t.type,l=t.memoizedProps;switch(a[ke]=t,a[Tt]=l,s){case"dialog":nt("cancel",a),nt("close",a);break;case"iframe":case"object":case"embed":nt("load",a);break;case"video":case"audio":for(s=0;s<Jr.length;s++)nt(Jr[s],a);break;case"source":nt("error",a);break;case"img":case"image":case"link":nt("error",a),nt("load",a);break;case"details":nt("toggle",a);break;case"input":nt("invalid",a),Ld(a,l.value,l.defaultValue,l.checked,l.defaultChecked,l.type,l.name,!0);break;case"select":nt("invalid",a);break;case"textarea":nt("invalid",a),Od(a,l.value,l.defaultValue,l.children)}s=l.children,typeof s!="string"&&typeof s!="number"&&typeof s!="bigint"||a.textContent===""+s||l.suppressHydrationWarning===!0||Fx(a.textContent,s)?(l.popover!=null&&(nt("beforetoggle",a),nt("toggle",a)),l.onScroll!=null&&nt("scroll",a),l.onScrollEnd!=null&&nt("scrollend",a),l.onClick!=null&&(a.onclick=os),a=!0):a=!1,a||As(t,!0)}function _u(t){for(na=t.return;na;)switch(na.tag){case 5:case 31:case 13:Ba=!1;return;case 27:case 3:Ba=!0;return;default:na=na.return}}function Bl(t){if(t!==na)return!1;if(!mt)return _u(t),mt=!0,!1;var a=t.tag,s;if((s=a!==3&&a!==27)&&((s=a===5)&&(s=t.type,s=!(s!=="form"&&s!=="button")||Yc(t.type,t.memoizedProps)),s=!s),s&&Ut&&As(t),_u(t),a===13){if(t=t.memoizedState,t=t!==null?t.dehydrated:null,!t)throw Error(o(317));Ut=Px(t)}else if(a===31){if(t=t.memoizedState,t=t!==null?t.dehydrated:null,!t)throw Error(o(317));Ut=Px(t)}else a===27?(a=Ut,$s(t.type)?(t=Jc,Jc=null,Ut=t):Ut=a):Ut=na?Ga(t.stateNode.nextSibling):null;return!0}function cl(){Ut=na=null,mt=!1}function Eo(){var t=Es;return t!==null&&(ja===null?ja=t:ja.push.apply(ja,t),Es=null),t}function Er(t){Es===null?Es=[t]:Es.push(t)}var Ao=Ne(null),dl=null,ms=null;function qs(t,a,s){ye(Ao,a._currentValue),a._currentValue=s}function xs(t){t._currentValue=Ao.current,fe(Ao)}function qo(t,a,s){for(;t!==null;){var l=t.alternate;if((t.childLanes&a)!==a?(t.childLanes|=a,l!==null&&(l.childLanes|=a)):l!==null&&(l.childLanes&a)!==a&&(l.childLanes|=a),t===s)break;t=t.return}}function Mo(t,a,s,l){var r=t.child;for(r!==null&&(r.return=t);r!==null;){var n=r.dependencies;if(n!==null){var m=r.child;n=n.firstContext;e:for(;n!==null;){var p=n;n=r;for(var A=0;A<a.length;A++)if(p.context===a[A]){n.lanes|=s,p=n.alternate,p!==null&&(p.lanes|=s),qo(n.return,s,t),l||(m=null);break e}n=p.next}}else if(r.tag===18){if(m=r.return,m===null)throw Error(o(341));m.lanes|=s,n=m.alternate,n!==null&&(n.lanes|=s),qo(m,s,t),m=null}else m=r.child;if(m!==null)m.return=r;else for(m=r;m!==null;){if(m===t){m=null;break}if(r=m.sibling,r!==null){r.return=m.return,m=r;break}m=m.return}r=m}}function Hl(t,a,s,l){t=null;for(var r=a,n=!1;r!==null;){if(!n){if((r.flags&524288)!==0)n=!0;else if((r.flags&262144)!==0)break}if(r.tag===10){var m=r.alternate;if(m===null)throw Error(o(387));if(m=m.memoizedProps,m!==null){var p=r.type;_a(r.pendingProps.value,m.value)||(t!==null?t.push(p):t=[p])}}else if(r===we.current){if(m=r.alternate,m===null)throw Error(o(387));m.memoizedState.memoizedState!==r.memoizedState.memoizedState&&(t!==null?t.push(an):t=[an])}r=r.return}t!==null&&Mo(a,t,s,l),a.flags|=262144}function Un(t){for(t=t.firstContext;t!==null;){if(!_a(t.context._currentValue,t.memoizedValue))return!0;t=t.next}return!1}function ul(t){dl=t,ms=null,t=t.dependencies,t!==null&&(t.firstContext=null)}function ia(t){return Su(dl,t)}function On(t,a){return dl===null&&ul(t),Su(t,a)}function Su(t,a){var s=a._currentValue;if(a={context:a,memoizedValue:s,next:null},ms===null){if(t===null)throw Error(o(308));ms=a,t.dependencies={lanes:0,firstContext:a},t.flags|=524288}else ms=ms.next=a;return s}var fg=typeof AbortController<"u"?AbortController:function(){var t=[],a=this.signal={aborted:!1,addEventListener:function(s,l){t.push(l)}};this.abort=function(){a.aborted=!0,t.forEach(function(s){return s()})}},gg=i.unstable_scheduleCallback,hg=i.unstable_NormalPriority,Xt={$$typeof:J,Consumer:null,Provider:null,_currentValue:null,_currentValue2:null,_threadCount:0};function Do(){return{controller:new fg,data:new Map,refCount:0}}function Ar(t){t.refCount--,t.refCount===0&&gg(hg,function(){t.controller.abort()})}var qr=null,Ro=0,Gl=0,$l=null;function pg(t,a){if(qr===null){var s=qr=[];Ro=0,Gl=Uc(),$l={status:"pending",value:void 0,then:function(l){s.push(l)}}}return Ro++,a.then(zu,zu),a}function zu(){if(--Ro===0&&qr!==null){$l!==null&&($l.status="fulfilled");var t=qr;qr=null,Gl=0,$l=null;for(var a=0;a<t.length;a++)(0,t[a])()}}function bg(t,a){var s=[],l={status:"pending",value:null,reason:null,then:function(r){s.push(r)}};return t.then(function(){l.status="fulfilled",l.value=a;for(var r=0;r<s.length;r++)(0,s[r])(a)},function(r){for(l.status="rejected",l.reason=r,r=0;r<s.length;r++)(0,s[r])(void 0)}),l}var ku=z.S;z.S=function(t,a){dx=Xe(),typeof a=="object"&&a!==null&&typeof a.then=="function"&&pg(t,a),ku!==null&&ku(t,a)};var ml=Ne(null);function To(){var t=ml.current;return t!==null?t:Dt.pooledCache}function Vn(t,a){a===null?ye(ml,ml.current):ye(ml,a.pool)}function Cu(){var t=To();return t===null?null:{parent:Xt._currentValue,pool:t}}var Ql=Error(o(460)),Lo=Error(o(474)),Fn=Error(o(542)),Bn={then:function(){}};function Eu(t){return t=t.status,t==="fulfilled"||t==="rejected"}function Au(t,a,s){switch(s=t[s],s===void 0?t.push(a):s!==a&&(a.then(os,os),a=s),a.status){case"fulfilled":return a.value;case"rejected":throw t=a.reason,Mu(t),t;default:if(typeof a.status=="string")a.then(os,os);else{if(t=Dt,t!==null&&100<t.shellSuspendCounter)throw Error(o(482));t=a,t.status="pending",t.then(function(l){if(a.status==="pending"){var r=a;r.status="fulfilled",r.value=l}},function(l){if(a.status==="pending"){var r=a;r.status="rejected",r.reason=l}})}switch(a.status){case"fulfilled":return a.value;case"rejected":throw t=a.reason,Mu(t),t}throw fl=a,Ql}}function xl(t){try{var a=t._init;return a(t._payload)}catch(s){throw s!==null&&typeof s=="object"&&typeof s.then=="function"?(fl=s,Ql):s}}var fl=null;function qu(){if(fl===null)throw Error(o(459));var t=fl;return fl=null,t}function Mu(t){if(t===Ql||t===Fn)throw Error(o(483))}var Yl=null,Mr=0;function Hn(t){var a=Mr;return Mr+=1,Yl===null&&(Yl=[]),Au(Yl,t,a)}function Dr(t,a){a=a.props.ref,t.ref=a!==void 0?a:null}function Gn(t,a){throw a.$$typeof===b?Error(o(525)):(t=Object.prototype.toString.call(a),Error(o(31,t==="[object Object]"?"object with keys {"+Object.keys(a).join(", ")+"}":t)))}function Du(t){function a(H,O){if(t){var P=H.deletions;P===null?(H.deletions=[O],H.flags|=16):P.push(O)}}function s(H,O){if(!t)return null;for(;O!==null;)a(H,O),O=O.sibling;return null}function l(H){for(var O=new Map;H!==null;)H.key!==null?O.set(H.key,H):O.set(H.index,H),H=H.sibling;return O}function r(H,O){return H=ds(H,O),H.index=0,H.sibling=null,H}function n(H,O,P){return H.index=P,t?(P=H.alternate,P!==null?(P=P.index,P<O?(H.flags|=67108866,O):P):(H.flags|=67108866,O)):(H.flags|=1048576,O)}function m(H){return t&&H.alternate===null&&(H.flags|=67108866),H}function p(H,O,P,ne){return O===null||O.tag!==6?(O=_o(P,H.mode,ne),O.return=H,O):(O=r(O,P),O.return=H,O)}function A(H,O,P,ne){var Be=P.type;return Be===L?re(H,O,P.props.children,ne,P.key):O!==null&&(O.elementType===Be||typeof Be=="object"&&Be!==null&&Be.$$typeof===R&&xl(Be)===O.type)?(O=r(O,P.props),Dr(O,P),O.return=H,O):(O=Tn(P.type,P.key,P.props,null,H.mode,ne),Dr(O,P),O.return=H,O)}function K(H,O,P,ne){return O===null||O.tag!==4||O.stateNode.containerInfo!==P.containerInfo||O.stateNode.implementation!==P.implementation?(O=So(P,H.mode,ne),O.return=H,O):(O=r(O,P.children||[]),O.return=H,O)}function re(H,O,P,ne,Be){return O===null||O.tag!==7?(O=ol(P,H.mode,ne,Be),O.return=H,O):(O=r(O,P),O.return=H,O)}function ie(H,O,P){if(typeof O=="string"&&O!==""||typeof O=="number"||typeof O=="bigint")return O=_o(""+O,H.mode,P),O.return=H,O;if(typeof O=="object"&&O!==null){switch(O.$$typeof){case w:return P=Tn(O.type,O.key,O.props,null,H.mode,P),Dr(P,O),P.return=H,P;case _:return O=So(O,H.mode,P),O.return=H,O;case R:return O=xl(O),ie(H,O,P)}if(B(O)||q(O))return O=ol(O,H.mode,P,null),O.return=H,O;if(typeof O.then=="function")return ie(H,Hn(O),P);if(O.$$typeof===J)return ie(H,On(H,O),P);Gn(H,O)}return null}function W(H,O,P,ne){var Be=O!==null?O.key:null;if(typeof P=="string"&&P!==""||typeof P=="number"||typeof P=="bigint")return Be!==null?null:p(H,O,""+P,ne);if(typeof P=="object"&&P!==null){switch(P.$$typeof){case w:return P.key===Be?A(H,O,P,ne):null;case _:return P.key===Be?K(H,O,P,ne):null;case R:return P=xl(P),W(H,O,P,ne)}if(B(P)||q(P))return Be!==null?null:re(H,O,P,ne,null);if(typeof P.then=="function")return W(H,O,Hn(P),ne);if(P.$$typeof===J)return W(H,O,On(H,P),ne);Gn(H,P)}return null}function I(H,O,P,ne,Be){if(typeof ne=="string"&&ne!==""||typeof ne=="number"||typeof ne=="bigint")return H=H.get(P)||null,p(O,H,""+ne,Be);if(typeof ne=="object"&&ne!==null){switch(ne.$$typeof){case w:return H=H.get(ne.key===null?P:ne.key)||null,A(O,H,ne,Be);case _:return H=H.get(ne.key===null?P:ne.key)||null,K(O,H,ne,Be);case R:return ne=xl(ne),I(H,O,P,ne,Be)}if(B(ne)||q(ne))return H=H.get(P)||null,re(O,H,ne,Be,null);if(typeof ne.then=="function")return I(H,O,P,Hn(ne),Be);if(ne.$$typeof===J)return I(H,O,P,On(O,ne),Be);Gn(O,ne)}return null}function Re(H,O,P,ne){for(var Be=null,bt=null,Ue=O,Ie=O=0,ut=null;Ue!==null&&Ie<P.length;Ie++){Ue.index>Ie?(ut=Ue,Ue=null):ut=Ue.sibling;var yt=W(H,Ue,P[Ie],ne);if(yt===null){Ue===null&&(Ue=ut);break}t&&Ue&&yt.alternate===null&&a(H,Ue),O=n(yt,O,Ie),bt===null?Be=yt:bt.sibling=yt,bt=yt,Ue=ut}if(Ie===P.length)return s(H,Ue),mt&&us(H,Ie),Be;if(Ue===null){for(;Ie<P.length;Ie++)Ue=ie(H,P[Ie],ne),Ue!==null&&(O=n(Ue,O,Ie),bt===null?Be=Ue:bt.sibling=Ue,bt=Ue);return mt&&us(H,Ie),Be}for(Ue=l(Ue);Ie<P.length;Ie++)ut=I(Ue,H,Ie,P[Ie],ne),ut!==null&&(t&&ut.alternate!==null&&Ue.delete(ut.key===null?Ie:ut.key),O=n(ut,O,Ie),bt===null?Be=ut:bt.sibling=ut,bt=ut);return t&&Ue.forEach(function(Ps){return a(H,Ps)}),mt&&us(H,Ie),Be}function $e(H,O,P,ne){if(P==null)throw Error(o(151));for(var Be=null,bt=null,Ue=O,Ie=O=0,ut=null,yt=P.next();Ue!==null&&!yt.done;Ie++,yt=P.next()){Ue.index>Ie?(ut=Ue,Ue=null):ut=Ue.sibling;var Ps=W(H,Ue,yt.value,ne);if(Ps===null){Ue===null&&(Ue=ut);break}t&&Ue&&Ps.alternate===null&&a(H,Ue),O=n(Ps,O,Ie),bt===null?Be=Ps:bt.sibling=Ps,bt=Ps,Ue=ut}if(yt.done)return s(H,Ue),mt&&us(H,Ie),Be;if(Ue===null){for(;!yt.done;Ie++,yt=P.next())yt=ie(H,yt.value,ne),yt!==null&&(O=n(yt,O,Ie),bt===null?Be=yt:bt.sibling=yt,bt=yt);return mt&&us(H,Ie),Be}for(Ue=l(Ue);!yt.done;Ie++,yt=P.next())yt=I(Ue,H,Ie,yt.value,ne),yt!==null&&(t&&yt.alternate!==null&&Ue.delete(yt.key===null?Ie:yt.key),O=n(yt,O,Ie),bt===null?Be=yt:bt.sibling=yt,bt=yt);return t&&Ue.forEach(function(Eh){return a(H,Eh)}),mt&&us(H,Ie),Be}function At(H,O,P,ne){if(typeof P=="object"&&P!==null&&P.type===L&&P.key===null&&(P=P.props.children),typeof P=="object"&&P!==null){switch(P.$$typeof){case w:e:{for(var Be=P.key;O!==null;){if(O.key===Be){if(Be=P.type,Be===L){if(O.tag===7){s(H,O.sibling),ne=r(O,P.props.children),ne.return=H,H=ne;break e}}else if(O.elementType===Be||typeof Be=="object"&&Be!==null&&Be.$$typeof===R&&xl(Be)===O.type){s(H,O.sibling),ne=r(O,P.props),Dr(ne,P),ne.return=H,H=ne;break e}s(H,O);break}else a(H,O);O=O.sibling}P.type===L?(ne=ol(P.props.children,H.mode,ne,P.key),ne.return=H,H=ne):(ne=Tn(P.type,P.key,P.props,null,H.mode,ne),Dr(ne,P),ne.return=H,H=ne)}return m(H);case _:e:{for(Be=P.key;O!==null;){if(O.key===Be)if(O.tag===4&&O.stateNode.containerInfo===P.containerInfo&&O.stateNode.implementation===P.implementation){s(H,O.sibling),ne=r(O,P.children||[]),ne.return=H,H=ne;break e}else{s(H,O);break}else a(H,O);O=O.sibling}ne=So(P,H.mode,ne),ne.return=H,H=ne}return m(H);case R:return P=xl(P),At(H,O,P,ne)}if(B(P))return Re(H,O,P,ne);if(q(P)){if(Be=q(P),typeof Be!="function")throw Error(o(150));return P=Be.call(P),$e(H,O,P,ne)}if(typeof P.then=="function")return At(H,O,Hn(P),ne);if(P.$$typeof===J)return At(H,O,On(H,P),ne);Gn(H,P)}return typeof P=="string"&&P!==""||typeof P=="number"||typeof P=="bigint"?(P=""+P,O!==null&&O.tag===6?(s(H,O.sibling),ne=r(O,P),ne.return=H,H=ne):(s(H,O),ne=_o(P,H.mode,ne),ne.return=H,H=ne),m(H)):s(H,O)}return function(H,O,P,ne){try{Mr=0;var Be=At(H,O,P,ne);return Yl=null,Be}catch(Ue){if(Ue===Ql||Ue===Fn)throw Ue;var bt=Sa(29,Ue,null,H.mode);return bt.lanes=ne,bt.return=H,bt}finally{}}}var gl=Du(!0),Ru=Du(!1),Ms=!1;function Uo(t){t.updateQueue={baseState:t.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,lanes:0,hiddenCallbacks:null},callbacks:null}}function Oo(t,a){t=t.updateQueue,a.updateQueue===t&&(a.updateQueue={baseState:t.baseState,firstBaseUpdate:t.firstBaseUpdate,lastBaseUpdate:t.lastBaseUpdate,shared:t.shared,callbacks:null})}function Ds(t){return{lane:t,tag:0,payload:null,callback:null,next:null}}function Rs(t,a,s){var l=t.updateQueue;if(l===null)return null;if(l=l.shared,(vt&2)!==0){var r=l.pending;return r===null?a.next=a:(a.next=r.next,r.next=a),l.pending=a,a=Rn(t),pu(t,null,s),a}return Dn(t,l,a,s),Rn(t)}function Rr(t,a,s){if(a=a.updateQueue,a!==null&&(a=a.shared,(s&4194048)!==0)){var l=a.lanes;l&=t.pendingLanes,s|=l,a.lanes=s,Mt(t,s)}}function Vo(t,a){var s=t.updateQueue,l=t.alternate;if(l!==null&&(l=l.updateQueue,s===l)){var r=null,n=null;if(s=s.firstBaseUpdate,s!==null){do{var m={lane:s.lane,tag:s.tag,payload:s.payload,callback:null,next:null};n===null?r=n=m:n=n.next=m,s=s.next}while(s!==null);n===null?r=n=a:n=n.next=a}else r=n=a;s={baseState:l.baseState,firstBaseUpdate:r,lastBaseUpdate:n,shared:l.shared,callbacks:l.callbacks},t.updateQueue=s;return}t=s.lastBaseUpdate,t===null?s.firstBaseUpdate=a:t.next=a,s.lastBaseUpdate=a}var Fo=!1;function Tr(){if(Fo){var t=$l;if(t!==null)throw t}}function Lr(t,a,s,l){Fo=!1;var r=t.updateQueue;Ms=!1;var n=r.firstBaseUpdate,m=r.lastBaseUpdate,p=r.shared.pending;if(p!==null){r.shared.pending=null;var A=p,K=A.next;A.next=null,m===null?n=K:m.next=K,m=A;var re=t.alternate;re!==null&&(re=re.updateQueue,p=re.lastBaseUpdate,p!==m&&(p===null?re.firstBaseUpdate=K:p.next=K,re.lastBaseUpdate=A))}if(n!==null){var ie=r.baseState;m=0,re=K=A=null,p=n;do{var W=p.lane&-536870913,I=W!==p.lane;if(I?(dt&W)===W:(l&W)===W){W!==0&&W===Gl&&(Fo=!0),re!==null&&(re=re.next={lane:0,tag:p.tag,payload:p.payload,callback:null,next:null});e:{var Re=t,$e=p;W=a;var At=s;switch($e.tag){case 1:if(Re=$e.payload,typeof Re=="function"){ie=Re.call(At,ie,W);break e}ie=Re;break e;case 3:Re.flags=Re.flags&-65537|128;case 0:if(Re=$e.payload,W=typeof Re=="function"?Re.call(At,ie,W):Re,W==null)break e;ie=v({},ie,W);break e;case 2:Ms=!0}}W=p.callback,W!==null&&(t.flags|=64,I&&(t.flags|=8192),I=r.callbacks,I===null?r.callbacks=[W]:I.push(W))}else I={lane:W,tag:p.tag,payload:p.payload,callback:p.callback,next:null},re===null?(K=re=I,A=ie):re=re.next=I,m|=W;if(p=p.next,p===null){if(p=r.shared.pending,p===null)break;I=p,p=I.next,I.next=null,r.lastBaseUpdate=I,r.shared.pending=null}}while(!0);re===null&&(A=ie),r.baseState=A,r.firstBaseUpdate=K,r.lastBaseUpdate=re,n===null&&(r.shared.lanes=0),Vs|=m,t.lanes=m,t.memoizedState=ie}}function Tu(t,a){if(typeof t!="function")throw Error(o(191,t));t.call(a)}function Lu(t,a){var s=t.callbacks;if(s!==null)for(t.callbacks=null,t=0;t<s.length;t++)Tu(s[t],a)}var Xl=Ne(null),$n=Ne(0);function Uu(t,a){t=Ns,ye($n,t),ye(Xl,a),Ns=t|a.baseLanes}function Bo(){ye($n,Ns),ye(Xl,Xl.current)}function Ho(){Ns=$n.current,fe(Xl),fe($n)}var za=Ne(null),Ha=null;function Ts(t){var a=t.alternate;ye($t,$t.current&1),ye(za,t),Ha===null&&(a===null||Xl.current!==null||a.memoizedState!==null)&&(Ha=t)}function Go(t){ye($t,$t.current),ye(za,t),Ha===null&&(Ha=t)}function Ou(t){t.tag===22?(ye($t,$t.current),ye(za,t),Ha===null&&(Ha=t)):Ls()}function Ls(){ye($t,$t.current),ye(za,za.current)}function ka(t){fe(za),Ha===t&&(Ha=null),fe($t)}var $t=Ne(0);function Qn(t){for(var a=t;a!==null;){if(a.tag===13){var s=a.memoizedState;if(s!==null&&(s=s.dehydrated,s===null||Pc(s)||Kc(s)))return a}else if(a.tag===19&&(a.memoizedProps.revealOrder==="forwards"||a.memoizedProps.revealOrder==="backwards"||a.memoizedProps.revealOrder==="unstable_legacy-backwards"||a.memoizedProps.revealOrder==="together")){if((a.flags&128)!==0)return a}else if(a.child!==null){a.child.return=a,a=a.child;continue}if(a===t)break;for(;a.sibling===null;){if(a.return===null||a.return===t)return null;a=a.return}a.sibling.return=a.return,a=a.sibling}return null}var fs=0,Je=null,Ct=null,Zt=null,Yn=!1,Zl=!1,hl=!1,Xn=0,Ur=0,Pl=null,yg=0;function Ft(){throw Error(o(321))}function $o(t,a){if(a===null)return!1;for(var s=0;s<a.length&&s<t.length;s++)if(!_a(t[s],a[s]))return!1;return!0}function Qo(t,a,s,l,r,n){return fs=n,Je=a,a.memoizedState=null,a.updateQueue=null,a.lanes=0,z.H=t===null||t.memoizedState===null?vm:nc,hl=!1,n=s(l,r),hl=!1,Zl&&(n=Fu(a,s,l,r)),Vu(t),n}function Vu(t){z.H=Fr;var a=Ct!==null&&Ct.next!==null;if(fs=0,Zt=Ct=Je=null,Yn=!1,Ur=0,Pl=null,a)throw Error(o(300));t===null||Pt||(t=t.dependencies,t!==null&&Un(t)&&(Pt=!0))}function Fu(t,a,s,l){Je=t;var r=0;do{if(Zl&&(Pl=null),Ur=0,Zl=!1,25<=r)throw Error(o(301));if(r+=1,Zt=Ct=null,t.updateQueue!=null){var n=t.updateQueue;n.lastEffect=null,n.events=null,n.stores=null,n.memoCache!=null&&(n.memoCache.index=0)}z.H=Nm,n=a(s,l)}while(Zl);return n}function jg(){var t=z.H,a=t.useState()[0];return a=typeof a.then=="function"?Or(a):a,t=t.useState()[0],(Ct!==null?Ct.memoizedState:null)!==t&&(Je.flags|=1024),a}function Yo(){var t=Xn!==0;return Xn=0,t}function Xo(t,a,s){a.updateQueue=t.updateQueue,a.flags&=-2053,t.lanes&=~s}function Zo(t){if(Yn){for(t=t.memoizedState;t!==null;){var a=t.queue;a!==null&&(a.pending=null),t=t.next}Yn=!1}fs=0,Zt=Ct=Je=null,Zl=!1,Ur=Xn=0,Pl=null}function fa(){var t={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return Zt===null?Je.memoizedState=Zt=t:Zt=Zt.next=t,Zt}function Qt(){if(Ct===null){var t=Je.alternate;t=t!==null?t.memoizedState:null}else t=Ct.next;var a=Zt===null?Je.memoizedState:Zt.next;if(a!==null)Zt=a,Ct=t;else{if(t===null)throw Je.alternate===null?Error(o(467)):Error(o(310));Ct=t,t={memoizedState:Ct.memoizedState,baseState:Ct.baseState,baseQueue:Ct.baseQueue,queue:Ct.queue,next:null},Zt===null?Je.memoizedState=Zt=t:Zt=Zt.next=t}return Zt}function Zn(){return{lastEffect:null,events:null,stores:null,memoCache:null}}function Or(t){var a=Ur;return Ur+=1,Pl===null&&(Pl=[]),t=Au(Pl,t,a),a=Je,(Zt===null?a.memoizedState:Zt.next)===null&&(a=a.alternate,z.H=a===null||a.memoizedState===null?vm:nc),t}function Pn(t){if(t!==null&&typeof t=="object"){if(typeof t.then=="function")return Or(t);if(t.$$typeof===J)return ia(t)}throw Error(o(438,String(t)))}function Po(t){var a=null,s=Je.updateQueue;if(s!==null&&(a=s.memoCache),a==null){var l=Je.alternate;l!==null&&(l=l.updateQueue,l!==null&&(l=l.memoCache,l!=null&&(a={data:l.data.map(function(r){return r.slice()}),index:0})))}if(a==null&&(a={data:[],index:0}),s===null&&(s=Zn(),Je.updateQueue=s),s.memoCache=a,s=a.data[a.index],s===void 0)for(s=a.data[a.index]=Array(t),l=0;l<t;l++)s[l]=ge;return a.index++,s}function gs(t,a){return typeof a=="function"?a(t):a}function Kn(t){var a=Qt();return Ko(a,Ct,t)}function Ko(t,a,s){var l=t.queue;if(l===null)throw Error(o(311));l.lastRenderedReducer=s;var r=t.baseQueue,n=l.pending;if(n!==null){if(r!==null){var m=r.next;r.next=n.next,n.next=m}a.baseQueue=r=n,l.pending=null}if(n=t.baseState,r===null)t.memoizedState=n;else{a=r.next;var p=m=null,A=null,K=a,re=!1;do{var ie=K.lane&-536870913;if(ie!==K.lane?(dt&ie)===ie:(fs&ie)===ie){var W=K.revertLane;if(W===0)A!==null&&(A=A.next={lane:0,revertLane:0,gesture:null,action:K.action,hasEagerState:K.hasEagerState,eagerState:K.eagerState,next:null}),ie===Gl&&(re=!0);else if((fs&W)===W){K=K.next,W===Gl&&(re=!0);continue}else ie={lane:0,revertLane:K.revertLane,gesture:null,action:K.action,hasEagerState:K.hasEagerState,eagerState:K.eagerState,next:null},A===null?(p=A=ie,m=n):A=A.next=ie,Je.lanes|=W,Vs|=W;ie=K.action,hl&&s(n,ie),n=K.hasEagerState?K.eagerState:s(n,ie)}else W={lane:ie,revertLane:K.revertLane,gesture:K.gesture,action:K.action,hasEagerState:K.hasEagerState,eagerState:K.eagerState,next:null},A===null?(p=A=W,m=n):A=A.next=W,Je.lanes|=ie,Vs|=ie;K=K.next}while(K!==null&&K!==a);if(A===null?m=n:A.next=p,!_a(n,t.memoizedState)&&(Pt=!0,re&&(s=$l,s!==null)))throw s;t.memoizedState=n,t.baseState=m,t.baseQueue=A,l.lastRenderedState=n}return r===null&&(l.lanes=0),[t.memoizedState,l.dispatch]}function Jo(t){var a=Qt(),s=a.queue;if(s===null)throw Error(o(311));s.lastRenderedReducer=t;var l=s.dispatch,r=s.pending,n=a.memoizedState;if(r!==null){s.pending=null;var m=r=r.next;do n=t(n,m.action),m=m.next;while(m!==r);_a(n,a.memoizedState)||(Pt=!0),a.memoizedState=n,a.baseQueue===null&&(a.baseState=n),s.lastRenderedState=n}return[n,l]}function Bu(t,a,s){var l=Je,r=Qt(),n=mt;if(n){if(s===void 0)throw Error(o(407));s=s()}else s=a();var m=!_a((Ct||r).memoizedState,s);if(m&&(r.memoizedState=s,Pt=!0),r=r.queue,ec($u.bind(null,l,r,t),[t]),r.getSnapshot!==a||m||Zt!==null&&Zt.memoizedState.tag&1){if(l.flags|=2048,Kl(9,{destroy:void 0},Gu.bind(null,l,r,s,a),null),Dt===null)throw Error(o(349));n||(fs&127)!==0||Hu(l,a,s)}return s}function Hu(t,a,s){t.flags|=16384,t={getSnapshot:a,value:s},a=Je.updateQueue,a===null?(a=Zn(),Je.updateQueue=a,a.stores=[t]):(s=a.stores,s===null?a.stores=[t]:s.push(t))}function Gu(t,a,s,l){a.value=s,a.getSnapshot=l,Qu(a)&&Yu(t)}function $u(t,a,s){return s(function(){Qu(a)&&Yu(t)})}function Qu(t){var a=t.getSnapshot;t=t.value;try{var s=a();return!_a(t,s)}catch{return!0}}function Yu(t){var a=il(t,2);a!==null&&va(a,t,2)}function Wo(t){var a=fa();if(typeof t=="function"){var s=t;if(t=s(),hl){Ee(!0);try{s()}finally{Ee(!1)}}}return a.memoizedState=a.baseState=t,a.queue={pending:null,lanes:0,dispatch:null,lastRenderedReducer:gs,lastRenderedState:t},a}function Xu(t,a,s,l){return t.baseState=s,Ko(t,Ct,typeof l=="function"?l:gs)}function vg(t,a,s,l,r){if(In(t))throw Error(o(485));if(t=a.action,t!==null){var n={payload:r,action:t,next:null,isTransition:!0,status:"pending",value:null,reason:null,listeners:[],then:function(m){n.listeners.push(m)}};z.T!==null?s(!0):n.isTransition=!1,l(n),s=a.pending,s===null?(n.next=a.pending=n,Zu(a,n)):(n.next=s.next,a.pending=s.next=n)}}function Zu(t,a){var s=a.action,l=a.payload,r=t.state;if(a.isTransition){var n=z.T,m={};z.T=m;try{var p=s(r,l),A=z.S;A!==null&&A(m,p),Pu(t,a,p)}catch(K){Io(t,a,K)}finally{n!==null&&m.types!==null&&(n.types=m.types),z.T=n}}else try{n=s(r,l),Pu(t,a,n)}catch(K){Io(t,a,K)}}function Pu(t,a,s){s!==null&&typeof s=="object"&&typeof s.then=="function"?s.then(function(l){Ku(t,a,l)},function(l){return Io(t,a,l)}):Ku(t,a,s)}function Ku(t,a,s){a.status="fulfilled",a.value=s,Ju(a),t.state=s,a=t.pending,a!==null&&(s=a.next,s===a?t.pending=null:(s=s.next,a.next=s,Zu(t,s)))}function Io(t,a,s){var l=t.pending;if(t.pending=null,l!==null){l=l.next;do a.status="rejected",a.reason=s,Ju(a),a=a.next;while(a!==l)}t.action=null}function Ju(t){t=t.listeners;for(var a=0;a<t.length;a++)(0,t[a])()}function Wu(t,a){return a}function Iu(t,a){if(mt){var s=Dt.formState;if(s!==null){e:{var l=Je;if(mt){if(Ut){t:{for(var r=Ut,n=Ba;r.nodeType!==8;){if(!n){r=null;break t}if(r=Ga(r.nextSibling),r===null){r=null;break t}}n=r.data,r=n==="F!"||n==="F"?r:null}if(r){Ut=Ga(r.nextSibling),l=r.data==="F!";break e}}As(l)}l=!1}l&&(a=s[0])}}return s=fa(),s.memoizedState=s.baseState=a,l={pending:null,lanes:0,dispatch:null,lastRenderedReducer:Wu,lastRenderedState:a},s.queue=l,s=bm.bind(null,Je,l),l.dispatch=s,l=Wo(!1),n=rc.bind(null,Je,!1,l.queue),l=fa(),r={state:a,dispatch:null,action:t,pending:null},l.queue=r,s=vg.bind(null,Je,r,n,s),r.dispatch=s,l.memoizedState=t,[a,s,!1]}function em(t){var a=Qt();return tm(a,Ct,t)}function tm(t,a,s){if(a=Ko(t,a,Wu)[0],t=Kn(gs)[0],typeof a=="object"&&a!==null&&typeof a.then=="function")try{var l=Or(a)}catch(m){throw m===Ql?Fn:m}else l=a;a=Qt();var r=a.queue,n=r.dispatch;return s!==a.memoizedState&&(Je.flags|=2048,Kl(9,{destroy:void 0},Ng.bind(null,r,s),null)),[l,n,t]}function Ng(t,a){t.action=a}function am(t){var a=Qt(),s=Ct;if(s!==null)return tm(a,s,t);Qt(),a=a.memoizedState,s=Qt();var l=s.queue.dispatch;return s.memoizedState=t,[a,l,!1]}function Kl(t,a,s,l){return t={tag:t,create:s,deps:l,inst:a,next:null},a=Je.updateQueue,a===null&&(a=Zn(),Je.updateQueue=a),s=a.lastEffect,s===null?a.lastEffect=t.next=t:(l=s.next,s.next=t,t.next=l,a.lastEffect=t),t}function sm(){return Qt().memoizedState}function Jn(t,a,s,l){var r=fa();Je.flags|=t,r.memoizedState=Kl(1|a,{destroy:void 0},s,l===void 0?null:l)}function Wn(t,a,s,l){var r=Qt();l=l===void 0?null:l;var n=r.memoizedState.inst;Ct!==null&&l!==null&&$o(l,Ct.memoizedState.deps)?r.memoizedState=Kl(a,n,s,l):(Je.flags|=t,r.memoizedState=Kl(1|a,n,s,l))}function lm(t,a){Jn(8390656,8,t,a)}function ec(t,a){Wn(2048,8,t,a)}function wg(t){Je.flags|=4;var a=Je.updateQueue;if(a===null)a=Zn(),Je.updateQueue=a,a.events=[t];else{var s=a.events;s===null?a.events=[t]:s.push(t)}}function rm(t){var a=Qt().memoizedState;return wg({ref:a,nextImpl:t}),function(){if((vt&2)!==0)throw Error(o(440));return a.impl.apply(void 0,arguments)}}function nm(t,a){return Wn(4,2,t,a)}function im(t,a){return Wn(4,4,t,a)}function om(t,a){if(typeof a=="function"){t=t();var s=a(t);return function(){typeof s=="function"?s():a(null)}}if(a!=null)return t=t(),a.current=t,function(){a.current=null}}function cm(t,a,s){s=s!=null?s.concat([t]):null,Wn(4,4,om.bind(null,a,t),s)}function tc(){}function dm(t,a){var s=Qt();a=a===void 0?null:a;var l=s.memoizedState;return a!==null&&$o(a,l[1])?l[0]:(s.memoizedState=[t,a],t)}function um(t,a){var s=Qt();a=a===void 0?null:a;var l=s.memoizedState;if(a!==null&&$o(a,l[1]))return l[0];if(l=t(),hl){Ee(!0);try{t()}finally{Ee(!1)}}return s.memoizedState=[l,a],l}function ac(t,a,s){return s===void 0||(fs&1073741824)!==0&&(dt&261930)===0?t.memoizedState=a:(t.memoizedState=s,t=mx(),Je.lanes|=t,Vs|=t,s)}function mm(t,a,s,l){return _a(s,a)?s:Xl.current!==null?(t=ac(t,s,l),_a(t,a)||(Pt=!0),t):(fs&42)===0||(fs&1073741824)!==0&&(dt&261930)===0?(Pt=!0,t.memoizedState=s):(t=mx(),Je.lanes|=t,Vs|=t,a)}function xm(t,a,s,l,r){var n=S.p;S.p=n!==0&&8>n?n:8;var m=z.T,p={};z.T=p,rc(t,!1,a,s);try{var A=r(),K=z.S;if(K!==null&&K(p,A),A!==null&&typeof A=="object"&&typeof A.then=="function"){var re=bg(A,l);Vr(t,a,re,Aa(t))}else Vr(t,a,l,Aa(t))}catch(ie){Vr(t,a,{then:function(){},status:"rejected",reason:ie},Aa())}finally{S.p=n,m!==null&&p.types!==null&&(m.types=p.types),z.T=m}}function _g(){}function sc(t,a,s,l){if(t.tag!==5)throw Error(o(476));var r=fm(t).queue;xm(t,r,a,V,s===null?_g:function(){return gm(t),s(l)})}function fm(t){var a=t.memoizedState;if(a!==null)return a;a={memoizedState:V,baseState:V,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:gs,lastRenderedState:V},next:null};var s={};return a.next={memoizedState:s,baseState:s,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:gs,lastRenderedState:s},next:null},t.memoizedState=a,t=t.alternate,t!==null&&(t.memoizedState=a),a}function gm(t){var a=fm(t);a.next===null&&(a=t.alternate.memoizedState),Vr(t,a.next.queue,{},Aa())}function lc(){return ia(an)}function hm(){return Qt().memoizedState}function pm(){return Qt().memoizedState}function Sg(t){for(var a=t.return;a!==null;){switch(a.tag){case 24:case 3:var s=Aa();t=Ds(s);var l=Rs(a,t,s);l!==null&&(va(l,a,s),Rr(l,a,s)),a={cache:Do()},t.payload=a;return}a=a.return}}function zg(t,a,s){var l=Aa();s={lane:l,revertLane:0,gesture:null,action:s,hasEagerState:!1,eagerState:null,next:null},In(t)?ym(a,s):(s=No(t,a,s,l),s!==null&&(va(s,t,l),jm(s,a,l)))}function bm(t,a,s){var l=Aa();Vr(t,a,s,l)}function Vr(t,a,s,l){var r={lane:l,revertLane:0,gesture:null,action:s,hasEagerState:!1,eagerState:null,next:null};if(In(t))ym(a,r);else{var n=t.alternate;if(t.lanes===0&&(n===null||n.lanes===0)&&(n=a.lastRenderedReducer,n!==null))try{var m=a.lastRenderedState,p=n(m,s);if(r.hasEagerState=!0,r.eagerState=p,_a(p,m))return Dn(t,a,r,0),Dt===null&&Mn(),!1}catch{}finally{}if(s=No(t,a,r,l),s!==null)return va(s,t,l),jm(s,a,l),!0}return!1}function rc(t,a,s,l){if(l={lane:2,revertLane:Uc(),gesture:null,action:l,hasEagerState:!1,eagerState:null,next:null},In(t)){if(a)throw Error(o(479))}else a=No(t,s,l,2),a!==null&&va(a,t,2)}function In(t){var a=t.alternate;return t===Je||a!==null&&a===Je}function ym(t,a){Zl=Yn=!0;var s=t.pending;s===null?a.next=a:(a.next=s.next,s.next=a),t.pending=a}function jm(t,a,s){if((s&4194048)!==0){var l=a.lanes;l&=t.pendingLanes,s|=l,a.lanes=s,Mt(t,s)}}var Fr={readContext:ia,use:Pn,useCallback:Ft,useContext:Ft,useEffect:Ft,useImperativeHandle:Ft,useLayoutEffect:Ft,useInsertionEffect:Ft,useMemo:Ft,useReducer:Ft,useRef:Ft,useState:Ft,useDebugValue:Ft,useDeferredValue:Ft,useTransition:Ft,useSyncExternalStore:Ft,useId:Ft,useHostTransitionStatus:Ft,useFormState:Ft,useActionState:Ft,useOptimistic:Ft,useMemoCache:Ft,useCacheRefresh:Ft};Fr.useEffectEvent=Ft;var vm={readContext:ia,use:Pn,useCallback:function(t,a){return fa().memoizedState=[t,a===void 0?null:a],t},useContext:ia,useEffect:lm,useImperativeHandle:function(t,a,s){s=s!=null?s.concat([t]):null,Jn(4194308,4,om.bind(null,a,t),s)},useLayoutEffect:function(t,a){return Jn(4194308,4,t,a)},useInsertionEffect:function(t,a){Jn(4,2,t,a)},useMemo:function(t,a){var s=fa();a=a===void 0?null:a;var l=t();if(hl){Ee(!0);try{t()}finally{Ee(!1)}}return s.memoizedState=[l,a],l},useReducer:function(t,a,s){var l=fa();if(s!==void 0){var r=s(a);if(hl){Ee(!0);try{s(a)}finally{Ee(!1)}}}else r=a;return l.memoizedState=l.baseState=r,t={pending:null,lanes:0,dispatch:null,lastRenderedReducer:t,lastRenderedState:r},l.queue=t,t=t.dispatch=zg.bind(null,Je,t),[l.memoizedState,t]},useRef:function(t){var a=fa();return t={current:t},a.memoizedState=t},useState:function(t){t=Wo(t);var a=t.queue,s=bm.bind(null,Je,a);return a.dispatch=s,[t.memoizedState,s]},useDebugValue:tc,useDeferredValue:function(t,a){var s=fa();return ac(s,t,a)},useTransition:function(){var t=Wo(!1);return t=xm.bind(null,Je,t.queue,!0,!1),fa().memoizedState=t,[!1,t]},useSyncExternalStore:function(t,a,s){var l=Je,r=fa();if(mt){if(s===void 0)throw Error(o(407));s=s()}else{if(s=a(),Dt===null)throw Error(o(349));(dt&127)!==0||Hu(l,a,s)}r.memoizedState=s;var n={value:s,getSnapshot:a};return r.queue=n,lm($u.bind(null,l,n,t),[t]),l.flags|=2048,Kl(9,{destroy:void 0},Gu.bind(null,l,n,s,a),null),s},useId:function(){var t=fa(),a=Dt.identifierPrefix;if(mt){var s=ss,l=as;s=(l&~(1<<32-Oe(l)-1)).toString(32)+s,a="_"+a+"R_"+s,s=Xn++,0<s&&(a+="H"+s.toString(32)),a+="_"}else s=yg++,a="_"+a+"r_"+s.toString(32)+"_";return t.memoizedState=a},useHostTransitionStatus:lc,useFormState:Iu,useActionState:Iu,useOptimistic:function(t){var a=fa();a.memoizedState=a.baseState=t;var s={pending:null,lanes:0,dispatch:null,lastRenderedReducer:null,lastRenderedState:null};return a.queue=s,a=rc.bind(null,Je,!0,s),s.dispatch=a,[t,a]},useMemoCache:Po,useCacheRefresh:function(){return fa().memoizedState=Sg.bind(null,Je)},useEffectEvent:function(t){var a=fa(),s={impl:t};return a.memoizedState=s,function(){if((vt&2)!==0)throw Error(o(440));return s.impl.apply(void 0,arguments)}}},nc={readContext:ia,use:Pn,useCallback:dm,useContext:ia,useEffect:ec,useImperativeHandle:cm,useInsertionEffect:nm,useLayoutEffect:im,useMemo:um,useReducer:Kn,useRef:sm,useState:function(){return Kn(gs)},useDebugValue:tc,useDeferredValue:function(t,a){var s=Qt();return mm(s,Ct.memoizedState,t,a)},useTransition:function(){var t=Kn(gs)[0],a=Qt().memoizedState;return[typeof t=="boolean"?t:Or(t),a]},useSyncExternalStore:Bu,useId:hm,useHostTransitionStatus:lc,useFormState:em,useActionState:em,useOptimistic:function(t,a){var s=Qt();return Xu(s,Ct,t,a)},useMemoCache:Po,useCacheRefresh:pm};nc.useEffectEvent=rm;var Nm={readContext:ia,use:Pn,useCallback:dm,useContext:ia,useEffect:ec,useImperativeHandle:cm,useInsertionEffect:nm,useLayoutEffect:im,useMemo:um,useReducer:Jo,useRef:sm,useState:function(){return Jo(gs)},useDebugValue:tc,useDeferredValue:function(t,a){var s=Qt();return Ct===null?ac(s,t,a):mm(s,Ct.memoizedState,t,a)},useTransition:function(){var t=Jo(gs)[0],a=Qt().memoizedState;return[typeof t=="boolean"?t:Or(t),a]},useSyncExternalStore:Bu,useId:hm,useHostTransitionStatus:lc,useFormState:am,useActionState:am,useOptimistic:function(t,a){var s=Qt();return Ct!==null?Xu(s,Ct,t,a):(s.baseState=t,[t,s.queue.dispatch])},useMemoCache:Po,useCacheRefresh:pm};Nm.useEffectEvent=rm;function ic(t,a,s,l){a=t.memoizedState,s=s(l,a),s=s==null?a:v({},a,s),t.memoizedState=s,t.lanes===0&&(t.updateQueue.baseState=s)}var oc={enqueueSetState:function(t,a,s){t=t._reactInternals;var l=Aa(),r=Ds(l);r.payload=a,s!=null&&(r.callback=s),a=Rs(t,r,l),a!==null&&(va(a,t,l),Rr(a,t,l))},enqueueReplaceState:function(t,a,s){t=t._reactInternals;var l=Aa(),r=Ds(l);r.tag=1,r.payload=a,s!=null&&(r.callback=s),a=Rs(t,r,l),a!==null&&(va(a,t,l),Rr(a,t,l))},enqueueForceUpdate:function(t,a){t=t._reactInternals;var s=Aa(),l=Ds(s);l.tag=2,a!=null&&(l.callback=a),a=Rs(t,l,s),a!==null&&(va(a,t,s),Rr(a,t,s))}};function wm(t,a,s,l,r,n,m){return t=t.stateNode,typeof t.shouldComponentUpdate=="function"?t.shouldComponentUpdate(l,n,m):a.prototype&&a.prototype.isPureReactComponent?!zr(s,l)||!zr(r,n):!0}function _m(t,a,s,l){t=a.state,typeof a.componentWillReceiveProps=="function"&&a.componentWillReceiveProps(s,l),typeof a.UNSAFE_componentWillReceiveProps=="function"&&a.UNSAFE_componentWillReceiveProps(s,l),a.state!==t&&oc.enqueueReplaceState(a,a.state,null)}function pl(t,a){var s=a;if("ref"in a){s={};for(var l in a)l!=="ref"&&(s[l]=a[l])}if(t=t.defaultProps){s===a&&(s=v({},s));for(var r in t)s[r]===void 0&&(s[r]=t[r])}return s}function Sm(t){qn(t)}function zm(t){console.error(t)}function km(t){qn(t)}function ei(t,a){try{var s=t.onUncaughtError;s(a.value,{componentStack:a.stack})}catch(l){setTimeout(function(){throw l})}}function Cm(t,a,s){try{var l=t.onCaughtError;l(s.value,{componentStack:s.stack,errorBoundary:a.tag===1?a.stateNode:null})}catch(r){setTimeout(function(){throw r})}}function cc(t,a,s){return s=Ds(s),s.tag=3,s.payload={element:null},s.callback=function(){ei(t,a)},s}function Em(t){return t=Ds(t),t.tag=3,t}function Am(t,a,s,l){var r=s.type.getDerivedStateFromError;if(typeof r=="function"){var n=l.value;t.payload=function(){return r(n)},t.callback=function(){Cm(a,s,l)}}var m=s.stateNode;m!==null&&typeof m.componentDidCatch=="function"&&(t.callback=function(){Cm(a,s,l),typeof r!="function"&&(Fs===null?Fs=new Set([this]):Fs.add(this));var p=l.stack;this.componentDidCatch(l.value,{componentStack:p!==null?p:""})})}function kg(t,a,s,l,r){if(s.flags|=32768,l!==null&&typeof l=="object"&&typeof l.then=="function"){if(a=s.alternate,a!==null&&Hl(a,s,r,!0),s=za.current,s!==null){switch(s.tag){case 31:case 13:return Ha===null?mi():s.alternate===null&&Bt===0&&(Bt=3),s.flags&=-257,s.flags|=65536,s.lanes=r,l===Bn?s.flags|=16384:(a=s.updateQueue,a===null?s.updateQueue=new Set([l]):a.add(l),Rc(t,l,r)),!1;case 22:return s.flags|=65536,l===Bn?s.flags|=16384:(a=s.updateQueue,a===null?(a={transitions:null,markerInstances:null,retryQueue:new Set([l])},s.updateQueue=a):(s=a.retryQueue,s===null?a.retryQueue=new Set([l]):s.add(l)),Rc(t,l,r)),!1}throw Error(o(435,s.tag))}return Rc(t,l,r),mi(),!1}if(mt)return a=za.current,a!==null?((a.flags&65536)===0&&(a.flags|=256),a.flags|=65536,a.lanes=r,l!==Co&&(t=Error(o(422),{cause:l}),Er(Oa(t,s)))):(l!==Co&&(a=Error(o(423),{cause:l}),Er(Oa(a,s))),t=t.current.alternate,t.flags|=65536,r&=-r,t.lanes|=r,l=Oa(l,s),r=cc(t.stateNode,l,r),Vo(t,r),Bt!==4&&(Bt=2)),!1;var n=Error(o(520),{cause:l});if(n=Oa(n,s),Zr===null?Zr=[n]:Zr.push(n),Bt!==4&&(Bt=2),a===null)return!0;l=Oa(l,s),s=a;do{switch(s.tag){case 3:return s.flags|=65536,t=r&-r,s.lanes|=t,t=cc(s.stateNode,l,t),Vo(s,t),!1;case 1:if(a=s.type,n=s.stateNode,(s.flags&128)===0&&(typeof a.getDerivedStateFromError=="function"||n!==null&&typeof n.componentDidCatch=="function"&&(Fs===null||!Fs.has(n))))return s.flags|=65536,r&=-r,s.lanes|=r,r=Em(r),Am(r,t,s,l),Vo(s,r),!1}s=s.return}while(s!==null);return!1}var dc=Error(o(461)),Pt=!1;function oa(t,a,s,l){a.child=t===null?Ru(a,null,s,l):gl(a,t.child,s,l)}function qm(t,a,s,l,r){s=s.render;var n=a.ref;if("ref"in l){var m={};for(var p in l)p!=="ref"&&(m[p]=l[p])}else m=l;return ul(a),l=Qo(t,a,s,m,n,r),p=Yo(),t!==null&&!Pt?(Xo(t,a,r),hs(t,a,r)):(mt&&p&&zo(a),a.flags|=1,oa(t,a,l,r),a.child)}function Mm(t,a,s,l,r){if(t===null){var n=s.type;return typeof n=="function"&&!wo(n)&&n.defaultProps===void 0&&s.compare===null?(a.tag=15,a.type=n,Dm(t,a,n,l,r)):(t=Tn(s.type,null,l,a,a.mode,r),t.ref=a.ref,t.return=a,a.child=t)}if(n=t.child,!bc(t,r)){var m=n.memoizedProps;if(s=s.compare,s=s!==null?s:zr,s(m,l)&&t.ref===a.ref)return hs(t,a,r)}return a.flags|=1,t=ds(n,l),t.ref=a.ref,t.return=a,a.child=t}function Dm(t,a,s,l,r){if(t!==null){var n=t.memoizedProps;if(zr(n,l)&&t.ref===a.ref)if(Pt=!1,a.pendingProps=l=n,bc(t,r))(t.flags&131072)!==0&&(Pt=!0);else return a.lanes=t.lanes,hs(t,a,r)}return uc(t,a,s,l,r)}function Rm(t,a,s,l){var r=l.children,n=t!==null?t.memoizedState:null;if(t===null&&a.stateNode===null&&(a.stateNode={_visibility:1,_pendingMarkers:null,_retryCache:null,_transitions:null}),l.mode==="hidden"){if((a.flags&128)!==0){if(n=n!==null?n.baseLanes|s:s,t!==null){for(l=a.child=t.child,r=0;l!==null;)r=r|l.lanes|l.childLanes,l=l.sibling;l=r&~n}else l=0,a.child=null;return Tm(t,a,n,s,l)}if((s&536870912)!==0)a.memoizedState={baseLanes:0,cachePool:null},t!==null&&Vn(a,n!==null?n.cachePool:null),n!==null?Uu(a,n):Bo(),Ou(a);else return l=a.lanes=536870912,Tm(t,a,n!==null?n.baseLanes|s:s,s,l)}else n!==null?(Vn(a,n.cachePool),Uu(a,n),Ls(),a.memoizedState=null):(t!==null&&Vn(a,null),Bo(),Ls());return oa(t,a,r,s),a.child}function Br(t,a){return t!==null&&t.tag===22||a.stateNode!==null||(a.stateNode={_visibility:1,_pendingMarkers:null,_retryCache:null,_transitions:null}),a.sibling}function Tm(t,a,s,l,r){var n=To();return n=n===null?null:{parent:Xt._currentValue,pool:n},a.memoizedState={baseLanes:s,cachePool:n},t!==null&&Vn(a,null),Bo(),Ou(a),t!==null&&Hl(t,a,l,!0),a.childLanes=r,null}function ti(t,a){return a=si({mode:a.mode,children:a.children},t.mode),a.ref=t.ref,t.child=a,a.return=t,a}function Lm(t,a,s){return gl(a,t.child,null,s),t=ti(a,a.pendingProps),t.flags|=2,ka(a),a.memoizedState=null,t}function Cg(t,a,s){var l=a.pendingProps,r=(a.flags&128)!==0;if(a.flags&=-129,t===null){if(mt){if(l.mode==="hidden")return t=ti(a,l),a.lanes=536870912,Br(null,t);if(Go(a),(t=Ut)?(t=Zx(t,Ba),t=t!==null&&t.data==="&"?t:null,t!==null&&(a.memoizedState={dehydrated:t,treeContext:Cs!==null?{id:as,overflow:ss}:null,retryLane:536870912,hydrationErrors:null},s=yu(t),s.return=a,a.child=s,na=a,Ut=null)):t=null,t===null)throw As(a);return a.lanes=536870912,null}return ti(a,l)}var n=t.memoizedState;if(n!==null){var m=n.dehydrated;if(Go(a),r)if(a.flags&256)a.flags&=-257,a=Lm(t,a,s);else if(a.memoizedState!==null)a.child=t.child,a.flags|=128,a=null;else throw Error(o(558));else if(Pt||Hl(t,a,s,!1),r=(s&t.childLanes)!==0,Pt||r){if(l=Dt,l!==null&&(m=pt(l,s),m!==0&&m!==n.retryLane))throw n.retryLane=m,il(t,m),va(l,t,m),dc;mi(),a=Lm(t,a,s)}else t=n.treeContext,Ut=Ga(m.nextSibling),na=a,mt=!0,Es=null,Ba=!1,t!==null&&Nu(a,t),a=ti(a,l),a.flags|=4096;return a}return t=ds(t.child,{mode:l.mode,children:l.children}),t.ref=a.ref,a.child=t,t.return=a,t}function ai(t,a){var s=a.ref;if(s===null)t!==null&&t.ref!==null&&(a.flags|=4194816);else{if(typeof s!="function"&&typeof s!="object")throw Error(o(284));(t===null||t.ref!==s)&&(a.flags|=4194816)}}function uc(t,a,s,l,r){return ul(a),s=Qo(t,a,s,l,void 0,r),l=Yo(),t!==null&&!Pt?(Xo(t,a,r),hs(t,a,r)):(mt&&l&&zo(a),a.flags|=1,oa(t,a,s,r),a.child)}function Um(t,a,s,l,r,n){return ul(a),a.updateQueue=null,s=Fu(a,l,s,r),Vu(t),l=Yo(),t!==null&&!Pt?(Xo(t,a,n),hs(t,a,n)):(mt&&l&&zo(a),a.flags|=1,oa(t,a,s,n),a.child)}function Om(t,a,s,l,r){if(ul(a),a.stateNode===null){var n=Ol,m=s.contextType;typeof m=="object"&&m!==null&&(n=ia(m)),n=new s(l,n),a.memoizedState=n.state!==null&&n.state!==void 0?n.state:null,n.updater=oc,a.stateNode=n,n._reactInternals=a,n=a.stateNode,n.props=l,n.state=a.memoizedState,n.refs={},Uo(a),m=s.contextType,n.context=typeof m=="object"&&m!==null?ia(m):Ol,n.state=a.memoizedState,m=s.getDerivedStateFromProps,typeof m=="function"&&(ic(a,s,m,l),n.state=a.memoizedState),typeof s.getDerivedStateFromProps=="function"||typeof n.getSnapshotBeforeUpdate=="function"||typeof n.UNSAFE_componentWillMount!="function"&&typeof n.componentWillMount!="function"||(m=n.state,typeof n.componentWillMount=="function"&&n.componentWillMount(),typeof n.UNSAFE_componentWillMount=="function"&&n.UNSAFE_componentWillMount(),m!==n.state&&oc.enqueueReplaceState(n,n.state,null),Lr(a,l,n,r),Tr(),n.state=a.memoizedState),typeof n.componentDidMount=="function"&&(a.flags|=4194308),l=!0}else if(t===null){n=a.stateNode;var p=a.memoizedProps,A=pl(s,p);n.props=A;var K=n.context,re=s.contextType;m=Ol,typeof re=="object"&&re!==null&&(m=ia(re));var ie=s.getDerivedStateFromProps;re=typeof ie=="function"||typeof n.getSnapshotBeforeUpdate=="function",p=a.pendingProps!==p,re||typeof n.UNSAFE_componentWillReceiveProps!="function"&&typeof n.componentWillReceiveProps!="function"||(p||K!==m)&&_m(a,n,l,m),Ms=!1;var W=a.memoizedState;n.state=W,Lr(a,l,n,r),Tr(),K=a.memoizedState,p||W!==K||Ms?(typeof ie=="function"&&(ic(a,s,ie,l),K=a.memoizedState),(A=Ms||wm(a,s,A,l,W,K,m))?(re||typeof n.UNSAFE_componentWillMount!="function"&&typeof n.componentWillMount!="function"||(typeof n.componentWillMount=="function"&&n.componentWillMount(),typeof n.UNSAFE_componentWillMount=="function"&&n.UNSAFE_componentWillMount()),typeof n.componentDidMount=="function"&&(a.flags|=4194308)):(typeof n.componentDidMount=="function"&&(a.flags|=4194308),a.memoizedProps=l,a.memoizedState=K),n.props=l,n.state=K,n.context=m,l=A):(typeof n.componentDidMount=="function"&&(a.flags|=4194308),l=!1)}else{n=a.stateNode,Oo(t,a),m=a.memoizedProps,re=pl(s,m),n.props=re,ie=a.pendingProps,W=n.context,K=s.contextType,A=Ol,typeof K=="object"&&K!==null&&(A=ia(K)),p=s.getDerivedStateFromProps,(K=typeof p=="function"||typeof n.getSnapshotBeforeUpdate=="function")||typeof n.UNSAFE_componentWillReceiveProps!="function"&&typeof n.componentWillReceiveProps!="function"||(m!==ie||W!==A)&&_m(a,n,l,A),Ms=!1,W=a.memoizedState,n.state=W,Lr(a,l,n,r),Tr();var I=a.memoizedState;m!==ie||W!==I||Ms||t!==null&&t.dependencies!==null&&Un(t.dependencies)?(typeof p=="function"&&(ic(a,s,p,l),I=a.memoizedState),(re=Ms||wm(a,s,re,l,W,I,A)||t!==null&&t.dependencies!==null&&Un(t.dependencies))?(K||typeof n.UNSAFE_componentWillUpdate!="function"&&typeof n.componentWillUpdate!="function"||(typeof n.componentWillUpdate=="function"&&n.componentWillUpdate(l,I,A),typeof n.UNSAFE_componentWillUpdate=="function"&&n.UNSAFE_componentWillUpdate(l,I,A)),typeof n.componentDidUpdate=="function"&&(a.flags|=4),typeof n.getSnapshotBeforeUpdate=="function"&&(a.flags|=1024)):(typeof n.componentDidUpdate!="function"||m===t.memoizedProps&&W===t.memoizedState||(a.flags|=4),typeof n.getSnapshotBeforeUpdate!="function"||m===t.memoizedProps&&W===t.memoizedState||(a.flags|=1024),a.memoizedProps=l,a.memoizedState=I),n.props=l,n.state=I,n.context=A,l=re):(typeof n.componentDidUpdate!="function"||m===t.memoizedProps&&W===t.memoizedState||(a.flags|=4),typeof n.getSnapshotBeforeUpdate!="function"||m===t.memoizedProps&&W===t.memoizedState||(a.flags|=1024),l=!1)}return n=l,ai(t,a),l=(a.flags&128)!==0,n||l?(n=a.stateNode,s=l&&typeof s.getDerivedStateFromError!="function"?null:n.render(),a.flags|=1,t!==null&&l?(a.child=gl(a,t.child,null,r),a.child=gl(a,null,s,r)):oa(t,a,s,r),a.memoizedState=n.state,t=a.child):t=hs(t,a,r),t}function Vm(t,a,s,l){return cl(),a.flags|=256,oa(t,a,s,l),a.child}var mc={dehydrated:null,treeContext:null,retryLane:0,hydrationErrors:null};function xc(t){return{baseLanes:t,cachePool:Cu()}}function fc(t,a,s){return t=t!==null?t.childLanes&~s:0,a&&(t|=Ea),t}function Fm(t,a,s){var l=a.pendingProps,r=!1,n=(a.flags&128)!==0,m;if((m=n)||(m=t!==null&&t.memoizedState===null?!1:($t.current&2)!==0),m&&(r=!0,a.flags&=-129),m=(a.flags&32)!==0,a.flags&=-33,t===null){if(mt){if(r?Ts(a):Ls(),(t=Ut)?(t=Zx(t,Ba),t=t!==null&&t.data!=="&"?t:null,t!==null&&(a.memoizedState={dehydrated:t,treeContext:Cs!==null?{id:as,overflow:ss}:null,retryLane:536870912,hydrationErrors:null},s=yu(t),s.return=a,a.child=s,na=a,Ut=null)):t=null,t===null)throw As(a);return Kc(t)?a.lanes=32:a.lanes=536870912,null}var p=l.children;return l=l.fallback,r?(Ls(),r=a.mode,p=si({mode:"hidden",children:p},r),l=ol(l,r,s,null),p.return=a,l.return=a,p.sibling=l,a.child=p,l=a.child,l.memoizedState=xc(s),l.childLanes=fc(t,m,s),a.memoizedState=mc,Br(null,l)):(Ts(a),gc(a,p))}var A=t.memoizedState;if(A!==null&&(p=A.dehydrated,p!==null)){if(n)a.flags&256?(Ts(a),a.flags&=-257,a=hc(t,a,s)):a.memoizedState!==null?(Ls(),a.child=t.child,a.flags|=128,a=null):(Ls(),p=l.fallback,r=a.mode,l=si({mode:"visible",children:l.children},r),p=ol(p,r,s,null),p.flags|=2,l.return=a,p.return=a,l.sibling=p,a.child=l,gl(a,t.child,null,s),l=a.child,l.memoizedState=xc(s),l.childLanes=fc(t,m,s),a.memoizedState=mc,a=Br(null,l));else if(Ts(a),Kc(p)){if(m=p.nextSibling&&p.nextSibling.dataset,m)var K=m.dgst;m=K,l=Error(o(419)),l.stack="",l.digest=m,Er({value:l,source:null,stack:null}),a=hc(t,a,s)}else if(Pt||Hl(t,a,s,!1),m=(s&t.childLanes)!==0,Pt||m){if(m=Dt,m!==null&&(l=pt(m,s),l!==0&&l!==A.retryLane))throw A.retryLane=l,il(t,l),va(m,t,l),dc;Pc(p)||mi(),a=hc(t,a,s)}else Pc(p)?(a.flags|=192,a.child=t.child,a=null):(t=A.treeContext,Ut=Ga(p.nextSibling),na=a,mt=!0,Es=null,Ba=!1,t!==null&&Nu(a,t),a=gc(a,l.children),a.flags|=4096);return a}return r?(Ls(),p=l.fallback,r=a.mode,A=t.child,K=A.sibling,l=ds(A,{mode:"hidden",children:l.children}),l.subtreeFlags=A.subtreeFlags&65011712,K!==null?p=ds(K,p):(p=ol(p,r,s,null),p.flags|=2),p.return=a,l.return=a,l.sibling=p,a.child=l,Br(null,l),l=a.child,p=t.child.memoizedState,p===null?p=xc(s):(r=p.cachePool,r!==null?(A=Xt._currentValue,r=r.parent!==A?{parent:A,pool:A}:r):r=Cu(),p={baseLanes:p.baseLanes|s,cachePool:r}),l.memoizedState=p,l.childLanes=fc(t,m,s),a.memoizedState=mc,Br(t.child,l)):(Ts(a),s=t.child,t=s.sibling,s=ds(s,{mode:"visible",children:l.children}),s.return=a,s.sibling=null,t!==null&&(m=a.deletions,m===null?(a.deletions=[t],a.flags|=16):m.push(t)),a.child=s,a.memoizedState=null,s)}function gc(t,a){return a=si({mode:"visible",children:a},t.mode),a.return=t,t.child=a}function si(t,a){return t=Sa(22,t,null,a),t.lanes=0,t}function hc(t,a,s){return gl(a,t.child,null,s),t=gc(a,a.pendingProps.children),t.flags|=2,a.memoizedState=null,t}function Bm(t,a,s){t.lanes|=a;var l=t.alternate;l!==null&&(l.lanes|=a),qo(t.return,a,s)}function pc(t,a,s,l,r,n){var m=t.memoizedState;m===null?t.memoizedState={isBackwards:a,rendering:null,renderingStartTime:0,last:l,tail:s,tailMode:r,treeForkCount:n}:(m.isBackwards=a,m.rendering=null,m.renderingStartTime=0,m.last=l,m.tail=s,m.tailMode=r,m.treeForkCount=n)}function Hm(t,a,s){var l=a.pendingProps,r=l.revealOrder,n=l.tail;l=l.children;var m=$t.current,p=(m&2)!==0;if(p?(m=m&1|2,a.flags|=128):m&=1,ye($t,m),oa(t,a,l,s),l=mt?Cr:0,!p&&t!==null&&(t.flags&128)!==0)e:for(t=a.child;t!==null;){if(t.tag===13)t.memoizedState!==null&&Bm(t,s,a);else if(t.tag===19)Bm(t,s,a);else if(t.child!==null){t.child.return=t,t=t.child;continue}if(t===a)break e;for(;t.sibling===null;){if(t.return===null||t.return===a)break e;t=t.return}t.sibling.return=t.return,t=t.sibling}switch(r){case"forwards":for(s=a.child,r=null;s!==null;)t=s.alternate,t!==null&&Qn(t)===null&&(r=s),s=s.sibling;s=r,s===null?(r=a.child,a.child=null):(r=s.sibling,s.sibling=null),pc(a,!1,r,s,n,l);break;case"backwards":case"unstable_legacy-backwards":for(s=null,r=a.child,a.child=null;r!==null;){if(t=r.alternate,t!==null&&Qn(t)===null){a.child=r;break}t=r.sibling,r.sibling=s,s=r,r=t}pc(a,!0,s,null,n,l);break;case"together":pc(a,!1,null,null,void 0,l);break;default:a.memoizedState=null}return a.child}function hs(t,a,s){if(t!==null&&(a.dependencies=t.dependencies),Vs|=a.lanes,(s&a.childLanes)===0)if(t!==null){if(Hl(t,a,s,!1),(s&a.childLanes)===0)return null}else return null;if(t!==null&&a.child!==t.child)throw Error(o(153));if(a.child!==null){for(t=a.child,s=ds(t,t.pendingProps),a.child=s,s.return=a;t.sibling!==null;)t=t.sibling,s=s.sibling=ds(t,t.pendingProps),s.return=a;s.sibling=null}return a.child}function bc(t,a){return(t.lanes&a)!==0?!0:(t=t.dependencies,!!(t!==null&&Un(t)))}function Eg(t,a,s){switch(a.tag){case 3:We(a,a.stateNode.containerInfo),qs(a,Xt,t.memoizedState.cache),cl();break;case 27:case 5:Ye(a);break;case 4:We(a,a.stateNode.containerInfo);break;case 10:qs(a,a.type,a.memoizedProps.value);break;case 31:if(a.memoizedState!==null)return a.flags|=128,Go(a),null;break;case 13:var l=a.memoizedState;if(l!==null)return l.dehydrated!==null?(Ts(a),a.flags|=128,null):(s&a.child.childLanes)!==0?Fm(t,a,s):(Ts(a),t=hs(t,a,s),t!==null?t.sibling:null);Ts(a);break;case 19:var r=(t.flags&128)!==0;if(l=(s&a.childLanes)!==0,l||(Hl(t,a,s,!1),l=(s&a.childLanes)!==0),r){if(l)return Hm(t,a,s);a.flags|=128}if(r=a.memoizedState,r!==null&&(r.rendering=null,r.tail=null,r.lastEffect=null),ye($t,$t.current),l)break;return null;case 22:return a.lanes=0,Rm(t,a,s,a.pendingProps);case 24:qs(a,Xt,t.memoizedState.cache)}return hs(t,a,s)}function Gm(t,a,s){if(t!==null)if(t.memoizedProps!==a.pendingProps)Pt=!0;else{if(!bc(t,s)&&(a.flags&128)===0)return Pt=!1,Eg(t,a,s);Pt=(t.flags&131072)!==0}else Pt=!1,mt&&(a.flags&1048576)!==0&&vu(a,Cr,a.index);switch(a.lanes=0,a.tag){case 16:e:{var l=a.pendingProps;if(t=xl(a.elementType),a.type=t,typeof t=="function")wo(t)?(l=pl(t,l),a.tag=1,a=Om(null,a,t,l,s)):(a.tag=0,a=uc(null,a,t,l,s));else{if(t!=null){var r=t.$$typeof;if(r===F){a.tag=11,a=qm(null,a,t,l,s);break e}else if(r===X){a.tag=14,a=Mm(null,a,t,l,s);break e}}throw a=C(t)||t,Error(o(306,a,""))}}return a;case 0:return uc(t,a,a.type,a.pendingProps,s);case 1:return l=a.type,r=pl(l,a.pendingProps),Om(t,a,l,r,s);case 3:e:{if(We(a,a.stateNode.containerInfo),t===null)throw Error(o(387));l=a.pendingProps;var n=a.memoizedState;r=n.element,Oo(t,a),Lr(a,l,null,s);var m=a.memoizedState;if(l=m.cache,qs(a,Xt,l),l!==n.cache&&Mo(a,[Xt],s,!0),Tr(),l=m.element,n.isDehydrated)if(n={element:l,isDehydrated:!1,cache:m.cache},a.updateQueue.baseState=n,a.memoizedState=n,a.flags&256){a=Vm(t,a,l,s);break e}else if(l!==r){r=Oa(Error(o(424)),a),Er(r),a=Vm(t,a,l,s);break e}else{switch(t=a.stateNode.containerInfo,t.nodeType){case 9:t=t.body;break;default:t=t.nodeName==="HTML"?t.ownerDocument.body:t}for(Ut=Ga(t.firstChild),na=a,mt=!0,Es=null,Ba=!0,s=Ru(a,null,l,s),a.child=s;s;)s.flags=s.flags&-3|4096,s=s.sibling}else{if(cl(),l===r){a=hs(t,a,s);break e}oa(t,a,l,s)}a=a.child}return a;case 26:return ai(t,a),t===null?(s=e0(a.type,null,a.pendingProps,null))?a.memoizedState=s:mt||(s=a.type,t=a.pendingProps,l=yi(ce.current).createElement(s),l[ke]=a,l[Tt]=t,ca(l,s,t),la(l),a.stateNode=l):a.memoizedState=e0(a.type,t.memoizedProps,a.pendingProps,t.memoizedState),null;case 27:return Ye(a),t===null&&mt&&(l=a.stateNode=Jx(a.type,a.pendingProps,ce.current),na=a,Ba=!0,r=Ut,$s(a.type)?(Jc=r,Ut=Ga(l.firstChild)):Ut=r),oa(t,a,a.pendingProps.children,s),ai(t,a),t===null&&(a.flags|=4194304),a.child;case 5:return t===null&&mt&&((r=l=Ut)&&(l=rh(l,a.type,a.pendingProps,Ba),l!==null?(a.stateNode=l,na=a,Ut=Ga(l.firstChild),Ba=!1,r=!0):r=!1),r||As(a)),Ye(a),r=a.type,n=a.pendingProps,m=t!==null?t.memoizedProps:null,l=n.children,Yc(r,n)?l=null:m!==null&&Yc(r,m)&&(a.flags|=32),a.memoizedState!==null&&(r=Qo(t,a,jg,null,null,s),an._currentValue=r),ai(t,a),oa(t,a,l,s),a.child;case 6:return t===null&&mt&&((t=s=Ut)&&(s=nh(s,a.pendingProps,Ba),s!==null?(a.stateNode=s,na=a,Ut=null,t=!0):t=!1),t||As(a)),null;case 13:return Fm(t,a,s);case 4:return We(a,a.stateNode.containerInfo),l=a.pendingProps,t===null?a.child=gl(a,null,l,s):oa(t,a,l,s),a.child;case 11:return qm(t,a,a.type,a.pendingProps,s);case 7:return oa(t,a,a.pendingProps,s),a.child;case 8:return oa(t,a,a.pendingProps.children,s),a.child;case 12:return oa(t,a,a.pendingProps.children,s),a.child;case 10:return l=a.pendingProps,qs(a,a.type,l.value),oa(t,a,l.children,s),a.child;case 9:return r=a.type._context,l=a.pendingProps.children,ul(a),r=ia(r),l=l(r),a.flags|=1,oa(t,a,l,s),a.child;case 14:return Mm(t,a,a.type,a.pendingProps,s);case 15:return Dm(t,a,a.type,a.pendingProps,s);case 19:return Hm(t,a,s);case 31:return Cg(t,a,s);case 22:return Rm(t,a,s,a.pendingProps);case 24:return ul(a),l=ia(Xt),t===null?(r=To(),r===null&&(r=Dt,n=Do(),r.pooledCache=n,n.refCount++,n!==null&&(r.pooledCacheLanes|=s),r=n),a.memoizedState={parent:l,cache:r},Uo(a),qs(a,Xt,r)):((t.lanes&s)!==0&&(Oo(t,a),Lr(a,null,null,s),Tr()),r=t.memoizedState,n=a.memoizedState,r.parent!==l?(r={parent:l,cache:l},a.memoizedState=r,a.lanes===0&&(a.memoizedState=a.updateQueue.baseState=r),qs(a,Xt,l)):(l=n.cache,qs(a,Xt,l),l!==r.cache&&Mo(a,[Xt],s,!0))),oa(t,a,a.pendingProps.children,s),a.child;case 29:throw a.pendingProps}throw Error(o(156,a.tag))}function ps(t){t.flags|=4}function yc(t,a,s,l,r){if((a=(t.mode&32)!==0)&&(a=!1),a){if(t.flags|=16777216,(r&335544128)===r)if(t.stateNode.complete)t.flags|=8192;else if(hx())t.flags|=8192;else throw fl=Bn,Lo}else t.flags&=-16777217}function $m(t,a){if(a.type!=="stylesheet"||(a.state.loading&4)!==0)t.flags&=-16777217;else if(t.flags|=16777216,!r0(a))if(hx())t.flags|=8192;else throw fl=Bn,Lo}function li(t,a){a!==null&&(t.flags|=4),t.flags&16384&&(a=t.tag!==22?de():536870912,t.lanes|=a,er|=a)}function Hr(t,a){if(!mt)switch(t.tailMode){case"hidden":a=t.tail;for(var s=null;a!==null;)a.alternate!==null&&(s=a),a=a.sibling;s===null?t.tail=null:s.sibling=null;break;case"collapsed":s=t.tail;for(var l=null;s!==null;)s.alternate!==null&&(l=s),s=s.sibling;l===null?a||t.tail===null?t.tail=null:t.tail.sibling=null:l.sibling=null}}function Ot(t){var a=t.alternate!==null&&t.alternate.child===t.child,s=0,l=0;if(a)for(var r=t.child;r!==null;)s|=r.lanes|r.childLanes,l|=r.subtreeFlags&65011712,l|=r.flags&65011712,r.return=t,r=r.sibling;else for(r=t.child;r!==null;)s|=r.lanes|r.childLanes,l|=r.subtreeFlags,l|=r.flags,r.return=t,r=r.sibling;return t.subtreeFlags|=l,t.childLanes=s,a}function Ag(t,a,s){var l=a.pendingProps;switch(ko(a),a.tag){case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return Ot(a),null;case 1:return Ot(a),null;case 3:return s=a.stateNode,l=null,t!==null&&(l=t.memoizedState.cache),a.memoizedState.cache!==l&&(a.flags|=2048),xs(Xt),pe(),s.pendingContext&&(s.context=s.pendingContext,s.pendingContext=null),(t===null||t.child===null)&&(Bl(a)?ps(a):t===null||t.memoizedState.isDehydrated&&(a.flags&256)===0||(a.flags|=1024,Eo())),Ot(a),null;case 26:var r=a.type,n=a.memoizedState;return t===null?(ps(a),n!==null?(Ot(a),$m(a,n)):(Ot(a),yc(a,r,null,l,s))):n?n!==t.memoizedState?(ps(a),Ot(a),$m(a,n)):(Ot(a),a.flags&=-16777217):(t=t.memoizedProps,t!==l&&ps(a),Ot(a),yc(a,r,t,l,s)),null;case 27:if(st(a),s=ce.current,r=a.type,t!==null&&a.stateNode!=null)t.memoizedProps!==l&&ps(a);else{if(!l){if(a.stateNode===null)throw Error(o(166));return Ot(a),null}t=Y.current,Bl(a)?wu(a):(t=Jx(r,l,s),a.stateNode=t,ps(a))}return Ot(a),null;case 5:if(st(a),r=a.type,t!==null&&a.stateNode!=null)t.memoizedProps!==l&&ps(a);else{if(!l){if(a.stateNode===null)throw Error(o(166));return Ot(a),null}if(n=Y.current,Bl(a))wu(a);else{var m=yi(ce.current);switch(n){case 1:n=m.createElementNS("http://www.w3.org/2000/svg",r);break;case 2:n=m.createElementNS("http://www.w3.org/1998/Math/MathML",r);break;default:switch(r){case"svg":n=m.createElementNS("http://www.w3.org/2000/svg",r);break;case"math":n=m.createElementNS("http://www.w3.org/1998/Math/MathML",r);break;case"script":n=m.createElement("div"),n.innerHTML="<script><\/script>",n=n.removeChild(n.firstChild);break;case"select":n=typeof l.is=="string"?m.createElement("select",{is:l.is}):m.createElement("select"),l.multiple?n.multiple=!0:l.size&&(n.size=l.size);break;default:n=typeof l.is=="string"?m.createElement(r,{is:l.is}):m.createElement(r)}}n[ke]=a,n[Tt]=l;e:for(m=a.child;m!==null;){if(m.tag===5||m.tag===6)n.appendChild(m.stateNode);else if(m.tag!==4&&m.tag!==27&&m.child!==null){m.child.return=m,m=m.child;continue}if(m===a)break e;for(;m.sibling===null;){if(m.return===null||m.return===a)break e;m=m.return}m.sibling.return=m.return,m=m.sibling}a.stateNode=n;e:switch(ca(n,r,l),r){case"button":case"input":case"select":case"textarea":l=!!l.autoFocus;break e;case"img":l=!0;break e;default:l=!1}l&&ps(a)}}return Ot(a),yc(a,a.type,t===null?null:t.memoizedProps,a.pendingProps,s),null;case 6:if(t&&a.stateNode!=null)t.memoizedProps!==l&&ps(a);else{if(typeof l!="string"&&a.stateNode===null)throw Error(o(166));if(t=ce.current,Bl(a)){if(t=a.stateNode,s=a.memoizedProps,l=null,r=na,r!==null)switch(r.tag){case 27:case 5:l=r.memoizedProps}t[ke]=a,t=!!(t.nodeValue===s||l!==null&&l.suppressHydrationWarning===!0||Fx(t.nodeValue,s)),t||As(a,!0)}else t=yi(t).createTextNode(l),t[ke]=a,a.stateNode=t}return Ot(a),null;case 31:if(s=a.memoizedState,t===null||t.memoizedState!==null){if(l=Bl(a),s!==null){if(t===null){if(!l)throw Error(o(318));if(t=a.memoizedState,t=t!==null?t.dehydrated:null,!t)throw Error(o(557));t[ke]=a}else cl(),(a.flags&128)===0&&(a.memoizedState=null),a.flags|=4;Ot(a),t=!1}else s=Eo(),t!==null&&t.memoizedState!==null&&(t.memoizedState.hydrationErrors=s),t=!0;if(!t)return a.flags&256?(ka(a),a):(ka(a),null);if((a.flags&128)!==0)throw Error(o(558))}return Ot(a),null;case 13:if(l=a.memoizedState,t===null||t.memoizedState!==null&&t.memoizedState.dehydrated!==null){if(r=Bl(a),l!==null&&l.dehydrated!==null){if(t===null){if(!r)throw Error(o(318));if(r=a.memoizedState,r=r!==null?r.dehydrated:null,!r)throw Error(o(317));r[ke]=a}else cl(),(a.flags&128)===0&&(a.memoizedState=null),a.flags|=4;Ot(a),r=!1}else r=Eo(),t!==null&&t.memoizedState!==null&&(t.memoizedState.hydrationErrors=r),r=!0;if(!r)return a.flags&256?(ka(a),a):(ka(a),null)}return ka(a),(a.flags&128)!==0?(a.lanes=s,a):(s=l!==null,t=t!==null&&t.memoizedState!==null,s&&(l=a.child,r=null,l.alternate!==null&&l.alternate.memoizedState!==null&&l.alternate.memoizedState.cachePool!==null&&(r=l.alternate.memoizedState.cachePool.pool),n=null,l.memoizedState!==null&&l.memoizedState.cachePool!==null&&(n=l.memoizedState.cachePool.pool),n!==r&&(l.flags|=2048)),s!==t&&s&&(a.child.flags|=8192),li(a,a.updateQueue),Ot(a),null);case 4:return pe(),t===null&&Bc(a.stateNode.containerInfo),Ot(a),null;case 10:return xs(a.type),Ot(a),null;case 19:if(fe($t),l=a.memoizedState,l===null)return Ot(a),null;if(r=(a.flags&128)!==0,n=l.rendering,n===null)if(r)Hr(l,!1);else{if(Bt!==0||t!==null&&(t.flags&128)!==0)for(t=a.child;t!==null;){if(n=Qn(t),n!==null){for(a.flags|=128,Hr(l,!1),t=n.updateQueue,a.updateQueue=t,li(a,t),a.subtreeFlags=0,t=s,s=a.child;s!==null;)bu(s,t),s=s.sibling;return ye($t,$t.current&1|2),mt&&us(a,l.treeForkCount),a.child}t=t.sibling}l.tail!==null&&Xe()>ci&&(a.flags|=128,r=!0,Hr(l,!1),a.lanes=4194304)}else{if(!r)if(t=Qn(n),t!==null){if(a.flags|=128,r=!0,t=t.updateQueue,a.updateQueue=t,li(a,t),Hr(l,!0),l.tail===null&&l.tailMode==="hidden"&&!n.alternate&&!mt)return Ot(a),null}else 2*Xe()-l.renderingStartTime>ci&&s!==536870912&&(a.flags|=128,r=!0,Hr(l,!1),a.lanes=4194304);l.isBackwards?(n.sibling=a.child,a.child=n):(t=l.last,t!==null?t.sibling=n:a.child=n,l.last=n)}return l.tail!==null?(t=l.tail,l.rendering=t,l.tail=t.sibling,l.renderingStartTime=Xe(),t.sibling=null,s=$t.current,ye($t,r?s&1|2:s&1),mt&&us(a,l.treeForkCount),t):(Ot(a),null);case 22:case 23:return ka(a),Ho(),l=a.memoizedState!==null,t!==null?t.memoizedState!==null!==l&&(a.flags|=8192):l&&(a.flags|=8192),l?(s&536870912)!==0&&(a.flags&128)===0&&(Ot(a),a.subtreeFlags&6&&(a.flags|=8192)):Ot(a),s=a.updateQueue,s!==null&&li(a,s.retryQueue),s=null,t!==null&&t.memoizedState!==null&&t.memoizedState.cachePool!==null&&(s=t.memoizedState.cachePool.pool),l=null,a.memoizedState!==null&&a.memoizedState.cachePool!==null&&(l=a.memoizedState.cachePool.pool),l!==s&&(a.flags|=2048),t!==null&&fe(ml),null;case 24:return s=null,t!==null&&(s=t.memoizedState.cache),a.memoizedState.cache!==s&&(a.flags|=2048),xs(Xt),Ot(a),null;case 25:return null;case 30:return null}throw Error(o(156,a.tag))}function qg(t,a){switch(ko(a),a.tag){case 1:return t=a.flags,t&65536?(a.flags=t&-65537|128,a):null;case 3:return xs(Xt),pe(),t=a.flags,(t&65536)!==0&&(t&128)===0?(a.flags=t&-65537|128,a):null;case 26:case 27:case 5:return st(a),null;case 31:if(a.memoizedState!==null){if(ka(a),a.alternate===null)throw Error(o(340));cl()}return t=a.flags,t&65536?(a.flags=t&-65537|128,a):null;case 13:if(ka(a),t=a.memoizedState,t!==null&&t.dehydrated!==null){if(a.alternate===null)throw Error(o(340));cl()}return t=a.flags,t&65536?(a.flags=t&-65537|128,a):null;case 19:return fe($t),null;case 4:return pe(),null;case 10:return xs(a.type),null;case 22:case 23:return ka(a),Ho(),t!==null&&fe(ml),t=a.flags,t&65536?(a.flags=t&-65537|128,a):null;case 24:return xs(Xt),null;case 25:return null;default:return null}}function Qm(t,a){switch(ko(a),a.tag){case 3:xs(Xt),pe();break;case 26:case 27:case 5:st(a);break;case 4:pe();break;case 31:a.memoizedState!==null&&ka(a);break;case 13:ka(a);break;case 19:fe($t);break;case 10:xs(a.type);break;case 22:case 23:ka(a),Ho(),t!==null&&fe(ml);break;case 24:xs(Xt)}}function Gr(t,a){try{var s=a.updateQueue,l=s!==null?s.lastEffect:null;if(l!==null){var r=l.next;s=r;do{if((s.tag&t)===t){l=void 0;var n=s.create,m=s.inst;l=n(),m.destroy=l}s=s.next}while(s!==r)}}catch(p){_t(a,a.return,p)}}function Us(t,a,s){try{var l=a.updateQueue,r=l!==null?l.lastEffect:null;if(r!==null){var n=r.next;l=n;do{if((l.tag&t)===t){var m=l.inst,p=m.destroy;if(p!==void 0){m.destroy=void 0,r=a;var A=s,K=p;try{K()}catch(re){_t(r,A,re)}}}l=l.next}while(l!==n)}}catch(re){_t(a,a.return,re)}}function Ym(t){var a=t.updateQueue;if(a!==null){var s=t.stateNode;try{Lu(a,s)}catch(l){_t(t,t.return,l)}}}function Xm(t,a,s){s.props=pl(t.type,t.memoizedProps),s.state=t.memoizedState;try{s.componentWillUnmount()}catch(l){_t(t,a,l)}}function $r(t,a){try{var s=t.ref;if(s!==null){switch(t.tag){case 26:case 27:case 5:var l=t.stateNode;break;case 30:l=t.stateNode;break;default:l=t.stateNode}typeof s=="function"?t.refCleanup=s(l):s.current=l}}catch(r){_t(t,a,r)}}function ls(t,a){var s=t.ref,l=t.refCleanup;if(s!==null)if(typeof l=="function")try{l()}catch(r){_t(t,a,r)}finally{t.refCleanup=null,t=t.alternate,t!=null&&(t.refCleanup=null)}else if(typeof s=="function")try{s(null)}catch(r){_t(t,a,r)}else s.current=null}function Zm(t){var a=t.type,s=t.memoizedProps,l=t.stateNode;try{e:switch(a){case"button":case"input":case"select":case"textarea":s.autoFocus&&l.focus();break e;case"img":s.src?l.src=s.src:s.srcSet&&(l.srcset=s.srcSet)}}catch(r){_t(t,t.return,r)}}function jc(t,a,s){try{var l=t.stateNode;Ig(l,t.type,s,a),l[Tt]=a}catch(r){_t(t,t.return,r)}}function Pm(t){return t.tag===5||t.tag===3||t.tag===26||t.tag===27&&$s(t.type)||t.tag===4}function vc(t){e:for(;;){for(;t.sibling===null;){if(t.return===null||Pm(t.return))return null;t=t.return}for(t.sibling.return=t.return,t=t.sibling;t.tag!==5&&t.tag!==6&&t.tag!==18;){if(t.tag===27&&$s(t.type)||t.flags&2||t.child===null||t.tag===4)continue e;t.child.return=t,t=t.child}if(!(t.flags&2))return t.stateNode}}function Nc(t,a,s){var l=t.tag;if(l===5||l===6)t=t.stateNode,a?(s.nodeType===9?s.body:s.nodeName==="HTML"?s.ownerDocument.body:s).insertBefore(t,a):(a=s.nodeType===9?s.body:s.nodeName==="HTML"?s.ownerDocument.body:s,a.appendChild(t),s=s._reactRootContainer,s!=null||a.onclick!==null||(a.onclick=os));else if(l!==4&&(l===27&&$s(t.type)&&(s=t.stateNode,a=null),t=t.child,t!==null))for(Nc(t,a,s),t=t.sibling;t!==null;)Nc(t,a,s),t=t.sibling}function ri(t,a,s){var l=t.tag;if(l===5||l===6)t=t.stateNode,a?s.insertBefore(t,a):s.appendChild(t);else if(l!==4&&(l===27&&$s(t.type)&&(s=t.stateNode),t=t.child,t!==null))for(ri(t,a,s),t=t.sibling;t!==null;)ri(t,a,s),t=t.sibling}function Km(t){var a=t.stateNode,s=t.memoizedProps;try{for(var l=t.type,r=a.attributes;r.length;)a.removeAttributeNode(r[0]);ca(a,l,s),a[ke]=t,a[Tt]=s}catch(n){_t(t,t.return,n)}}var bs=!1,Kt=!1,wc=!1,Jm=typeof WeakSet=="function"?WeakSet:Set,ra=null;function Mg(t,a){if(t=t.containerInfo,$c=zi,t=cu(t),ho(t)){if("selectionStart"in t)var s={start:t.selectionStart,end:t.selectionEnd};else e:{s=(s=t.ownerDocument)&&s.defaultView||window;var l=s.getSelection&&s.getSelection();if(l&&l.rangeCount!==0){s=l.anchorNode;var r=l.anchorOffset,n=l.focusNode;l=l.focusOffset;try{s.nodeType,n.nodeType}catch{s=null;break e}var m=0,p=-1,A=-1,K=0,re=0,ie=t,W=null;t:for(;;){for(var I;ie!==s||r!==0&&ie.nodeType!==3||(p=m+r),ie!==n||l!==0&&ie.nodeType!==3||(A=m+l),ie.nodeType===3&&(m+=ie.nodeValue.length),(I=ie.firstChild)!==null;)W=ie,ie=I;for(;;){if(ie===t)break t;if(W===s&&++K===r&&(p=m),W===n&&++re===l&&(A=m),(I=ie.nextSibling)!==null)break;ie=W,W=ie.parentNode}ie=I}s=p===-1||A===-1?null:{start:p,end:A}}else s=null}s=s||{start:0,end:0}}else s=null;for(Qc={focusedElem:t,selectionRange:s},zi=!1,ra=a;ra!==null;)if(a=ra,t=a.child,(a.subtreeFlags&1028)!==0&&t!==null)t.return=a,ra=t;else for(;ra!==null;){switch(a=ra,n=a.alternate,t=a.flags,a.tag){case 0:if((t&4)!==0&&(t=a.updateQueue,t=t!==null?t.events:null,t!==null))for(s=0;s<t.length;s++)r=t[s],r.ref.impl=r.nextImpl;break;case 11:case 15:break;case 1:if((t&1024)!==0&&n!==null){t=void 0,s=a,r=n.memoizedProps,n=n.memoizedState,l=s.stateNode;try{var Re=pl(s.type,r);t=l.getSnapshotBeforeUpdate(Re,n),l.__reactInternalSnapshotBeforeUpdate=t}catch($e){_t(s,s.return,$e)}}break;case 3:if((t&1024)!==0){if(t=a.stateNode.containerInfo,s=t.nodeType,s===9)Zc(t);else if(s===1)switch(t.nodeName){case"HEAD":case"HTML":case"BODY":Zc(t);break;default:t.textContent=""}}break;case 5:case 26:case 27:case 6:case 4:case 17:break;default:if((t&1024)!==0)throw Error(o(163))}if(t=a.sibling,t!==null){t.return=a.return,ra=t;break}ra=a.return}}function Wm(t,a,s){var l=s.flags;switch(s.tag){case 0:case 11:case 15:js(t,s),l&4&&Gr(5,s);break;case 1:if(js(t,s),l&4)if(t=s.stateNode,a===null)try{t.componentDidMount()}catch(m){_t(s,s.return,m)}else{var r=pl(s.type,a.memoizedProps);a=a.memoizedState;try{t.componentDidUpdate(r,a,t.__reactInternalSnapshotBeforeUpdate)}catch(m){_t(s,s.return,m)}}l&64&&Ym(s),l&512&&$r(s,s.return);break;case 3:if(js(t,s),l&64&&(t=s.updateQueue,t!==null)){if(a=null,s.child!==null)switch(s.child.tag){case 27:case 5:a=s.child.stateNode;break;case 1:a=s.child.stateNode}try{Lu(t,a)}catch(m){_t(s,s.return,m)}}break;case 27:a===null&&l&4&&Km(s);case 26:case 5:js(t,s),a===null&&l&4&&Zm(s),l&512&&$r(s,s.return);break;case 12:js(t,s);break;case 31:js(t,s),l&4&&tx(t,s);break;case 13:js(t,s),l&4&&ax(t,s),l&64&&(t=s.memoizedState,t!==null&&(t=t.dehydrated,t!==null&&(s=Bg.bind(null,s),ih(t,s))));break;case 22:if(l=s.memoizedState!==null||bs,!l){a=a!==null&&a.memoizedState!==null||Kt,r=bs;var n=Kt;bs=l,(Kt=a)&&!n?vs(t,s,(s.subtreeFlags&8772)!==0):js(t,s),bs=r,Kt=n}break;case 30:break;default:js(t,s)}}function Im(t){var a=t.alternate;a!==null&&(t.alternate=null,Im(a)),t.child=null,t.deletions=null,t.sibling=null,t.tag===5&&(a=t.stateNode,a!==null&&Wi(a)),t.stateNode=null,t.return=null,t.dependencies=null,t.memoizedProps=null,t.memoizedState=null,t.pendingProps=null,t.stateNode=null,t.updateQueue=null}var Vt=null,pa=!1;function ys(t,a,s){for(s=s.child;s!==null;)ex(t,a,s),s=s.sibling}function ex(t,a,s){if(be&&typeof be.onCommitFiberUnmount=="function")try{be.onCommitFiberUnmount(Q,s)}catch{}switch(s.tag){case 26:Kt||ls(s,a),ys(t,a,s),s.memoizedState?s.memoizedState.count--:s.stateNode&&(s=s.stateNode,s.parentNode.removeChild(s));break;case 27:Kt||ls(s,a);var l=Vt,r=pa;$s(s.type)&&(Vt=s.stateNode,pa=!1),ys(t,a,s),Ir(s.stateNode),Vt=l,pa=r;break;case 5:Kt||ls(s,a);case 6:if(l=Vt,r=pa,Vt=null,ys(t,a,s),Vt=l,pa=r,Vt!==null)if(pa)try{(Vt.nodeType===9?Vt.body:Vt.nodeName==="HTML"?Vt.ownerDocument.body:Vt).removeChild(s.stateNode)}catch(n){_t(s,a,n)}else try{Vt.removeChild(s.stateNode)}catch(n){_t(s,a,n)}break;case 18:Vt!==null&&(pa?(t=Vt,Yx(t.nodeType===9?t.body:t.nodeName==="HTML"?t.ownerDocument.body:t,s.stateNode),or(t)):Yx(Vt,s.stateNode));break;case 4:l=Vt,r=pa,Vt=s.stateNode.containerInfo,pa=!0,ys(t,a,s),Vt=l,pa=r;break;case 0:case 11:case 14:case 15:Us(2,s,a),Kt||Us(4,s,a),ys(t,a,s);break;case 1:Kt||(ls(s,a),l=s.stateNode,typeof l.componentWillUnmount=="function"&&Xm(s,a,l)),ys(t,a,s);break;case 21:ys(t,a,s);break;case 22:Kt=(l=Kt)||s.memoizedState!==null,ys(t,a,s),Kt=l;break;default:ys(t,a,s)}}function tx(t,a){if(a.memoizedState===null&&(t=a.alternate,t!==null&&(t=t.memoizedState,t!==null))){t=t.dehydrated;try{or(t)}catch(s){_t(a,a.return,s)}}}function ax(t,a){if(a.memoizedState===null&&(t=a.alternate,t!==null&&(t=t.memoizedState,t!==null&&(t=t.dehydrated,t!==null))))try{or(t)}catch(s){_t(a,a.return,s)}}function Dg(t){switch(t.tag){case 31:case 13:case 19:var a=t.stateNode;return a===null&&(a=t.stateNode=new Jm),a;case 22:return t=t.stateNode,a=t._retryCache,a===null&&(a=t._retryCache=new Jm),a;default:throw Error(o(435,t.tag))}}function ni(t,a){var s=Dg(t);a.forEach(function(l){if(!s.has(l)){s.add(l);var r=Hg.bind(null,t,l);l.then(r,r)}})}function ba(t,a){var s=a.deletions;if(s!==null)for(var l=0;l<s.length;l++){var r=s[l],n=t,m=a,p=m;e:for(;p!==null;){switch(p.tag){case 27:if($s(p.type)){Vt=p.stateNode,pa=!1;break e}break;case 5:Vt=p.stateNode,pa=!1;break e;case 3:case 4:Vt=p.stateNode.containerInfo,pa=!0;break e}p=p.return}if(Vt===null)throw Error(o(160));ex(n,m,r),Vt=null,pa=!1,n=r.alternate,n!==null&&(n.return=null),r.return=null}if(a.subtreeFlags&13886)for(a=a.child;a!==null;)sx(a,t),a=a.sibling}var Ja=null;function sx(t,a){var s=t.alternate,l=t.flags;switch(t.tag){case 0:case 11:case 14:case 15:ba(a,t),ya(t),l&4&&(Us(3,t,t.return),Gr(3,t),Us(5,t,t.return));break;case 1:ba(a,t),ya(t),l&512&&(Kt||s===null||ls(s,s.return)),l&64&&bs&&(t=t.updateQueue,t!==null&&(l=t.callbacks,l!==null&&(s=t.shared.hiddenCallbacks,t.shared.hiddenCallbacks=s===null?l:s.concat(l))));break;case 26:var r=Ja;if(ba(a,t),ya(t),l&512&&(Kt||s===null||ls(s,s.return)),l&4){var n=s!==null?s.memoizedState:null;if(l=t.memoizedState,s===null)if(l===null)if(t.stateNode===null){e:{l=t.type,s=t.memoizedProps,r=r.ownerDocument||r;t:switch(l){case"title":n=r.getElementsByTagName("title")[0],(!n||n[pr]||n[ke]||n.namespaceURI==="http://www.w3.org/2000/svg"||n.hasAttribute("itemprop"))&&(n=r.createElement(l),r.head.insertBefore(n,r.querySelector("head > title"))),ca(n,l,s),n[ke]=t,la(n),l=n;break e;case"link":var m=s0("link","href",r).get(l+(s.href||""));if(m){for(var p=0;p<m.length;p++)if(n=m[p],n.getAttribute("href")===(s.href==null||s.href===""?null:s.href)&&n.getAttribute("rel")===(s.rel==null?null:s.rel)&&n.getAttribute("title")===(s.title==null?null:s.title)&&n.getAttribute("crossorigin")===(s.crossOrigin==null?null:s.crossOrigin)){m.splice(p,1);break t}}n=r.createElement(l),ca(n,l,s),r.head.appendChild(n);break;case"meta":if(m=s0("meta","content",r).get(l+(s.content||""))){for(p=0;p<m.length;p++)if(n=m[p],n.getAttribute("content")===(s.content==null?null:""+s.content)&&n.getAttribute("name")===(s.name==null?null:s.name)&&n.getAttribute("property")===(s.property==null?null:s.property)&&n.getAttribute("http-equiv")===(s.httpEquiv==null?null:s.httpEquiv)&&n.getAttribute("charset")===(s.charSet==null?null:s.charSet)){m.splice(p,1);break t}}n=r.createElement(l),ca(n,l,s),r.head.appendChild(n);break;default:throw Error(o(468,l))}n[ke]=t,la(n),l=n}t.stateNode=l}else l0(r,t.type,t.stateNode);else t.stateNode=a0(r,l,t.memoizedProps);else n!==l?(n===null?s.stateNode!==null&&(s=s.stateNode,s.parentNode.removeChild(s)):n.count--,l===null?l0(r,t.type,t.stateNode):a0(r,l,t.memoizedProps)):l===null&&t.stateNode!==null&&jc(t,t.memoizedProps,s.memoizedProps)}break;case 27:ba(a,t),ya(t),l&512&&(Kt||s===null||ls(s,s.return)),s!==null&&l&4&&jc(t,t.memoizedProps,s.memoizedProps);break;case 5:if(ba(a,t),ya(t),l&512&&(Kt||s===null||ls(s,s.return)),t.flags&32){r=t.stateNode;try{ql(r,"")}catch(Re){_t(t,t.return,Re)}}l&4&&t.stateNode!=null&&(r=t.memoizedProps,jc(t,r,s!==null?s.memoizedProps:r)),l&1024&&(wc=!0);break;case 6:if(ba(a,t),ya(t),l&4){if(t.stateNode===null)throw Error(o(162));l=t.memoizedProps,s=t.stateNode;try{s.nodeValue=l}catch(Re){_t(t,t.return,Re)}}break;case 3:if(Ni=null,r=Ja,Ja=ji(a.containerInfo),ba(a,t),Ja=r,ya(t),l&4&&s!==null&&s.memoizedState.isDehydrated)try{or(a.containerInfo)}catch(Re){_t(t,t.return,Re)}wc&&(wc=!1,lx(t));break;case 4:l=Ja,Ja=ji(t.stateNode.containerInfo),ba(a,t),ya(t),Ja=l;break;case 12:ba(a,t),ya(t);break;case 31:ba(a,t),ya(t),l&4&&(l=t.updateQueue,l!==null&&(t.updateQueue=null,ni(t,l)));break;case 13:ba(a,t),ya(t),t.child.flags&8192&&t.memoizedState!==null!=(s!==null&&s.memoizedState!==null)&&(oi=Xe()),l&4&&(l=t.updateQueue,l!==null&&(t.updateQueue=null,ni(t,l)));break;case 22:r=t.memoizedState!==null;var A=s!==null&&s.memoizedState!==null,K=bs,re=Kt;if(bs=K||r,Kt=re||A,ba(a,t),Kt=re,bs=K,ya(t),l&8192)e:for(a=t.stateNode,a._visibility=r?a._visibility&-2:a._visibility|1,r&&(s===null||A||bs||Kt||bl(t)),s=null,a=t;;){if(a.tag===5||a.tag===26){if(s===null){A=s=a;try{if(n=A.stateNode,r)m=n.style,typeof m.setProperty=="function"?m.setProperty("display","none","important"):m.display="none";else{p=A.stateNode;var ie=A.memoizedProps.style,W=ie!=null&&ie.hasOwnProperty("display")?ie.display:null;p.style.display=W==null||typeof W=="boolean"?"":(""+W).trim()}}catch(Re){_t(A,A.return,Re)}}}else if(a.tag===6){if(s===null){A=a;try{A.stateNode.nodeValue=r?"":A.memoizedProps}catch(Re){_t(A,A.return,Re)}}}else if(a.tag===18){if(s===null){A=a;try{var I=A.stateNode;r?Xx(I,!0):Xx(A.stateNode,!1)}catch(Re){_t(A,A.return,Re)}}}else if((a.tag!==22&&a.tag!==23||a.memoizedState===null||a===t)&&a.child!==null){a.child.return=a,a=a.child;continue}if(a===t)break e;for(;a.sibling===null;){if(a.return===null||a.return===t)break e;s===a&&(s=null),a=a.return}s===a&&(s=null),a.sibling.return=a.return,a=a.sibling}l&4&&(l=t.updateQueue,l!==null&&(s=l.retryQueue,s!==null&&(l.retryQueue=null,ni(t,s))));break;case 19:ba(a,t),ya(t),l&4&&(l=t.updateQueue,l!==null&&(t.updateQueue=null,ni(t,l)));break;case 30:break;case 21:break;default:ba(a,t),ya(t)}}function ya(t){var a=t.flags;if(a&2){try{for(var s,l=t.return;l!==null;){if(Pm(l)){s=l;break}l=l.return}if(s==null)throw Error(o(160));switch(s.tag){case 27:var r=s.stateNode,n=vc(t);ri(t,n,r);break;case 5:var m=s.stateNode;s.flags&32&&(ql(m,""),s.flags&=-33);var p=vc(t);ri(t,p,m);break;case 3:case 4:var A=s.stateNode.containerInfo,K=vc(t);Nc(t,K,A);break;default:throw Error(o(161))}}catch(re){_t(t,t.return,re)}t.flags&=-3}a&4096&&(t.flags&=-4097)}function lx(t){if(t.subtreeFlags&1024)for(t=t.child;t!==null;){var a=t;lx(a),a.tag===5&&a.flags&1024&&a.stateNode.reset(),t=t.sibling}}function js(t,a){if(a.subtreeFlags&8772)for(a=a.child;a!==null;)Wm(t,a.alternate,a),a=a.sibling}function bl(t){for(t=t.child;t!==null;){var a=t;switch(a.tag){case 0:case 11:case 14:case 15:Us(4,a,a.return),bl(a);break;case 1:ls(a,a.return);var s=a.stateNode;typeof s.componentWillUnmount=="function"&&Xm(a,a.return,s),bl(a);break;case 27:Ir(a.stateNode);case 26:case 5:ls(a,a.return),bl(a);break;case 22:a.memoizedState===null&&bl(a);break;case 30:bl(a);break;default:bl(a)}t=t.sibling}}function vs(t,a,s){for(s=s&&(a.subtreeFlags&8772)!==0,a=a.child;a!==null;){var l=a.alternate,r=t,n=a,m=n.flags;switch(n.tag){case 0:case 11:case 15:vs(r,n,s),Gr(4,n);break;case 1:if(vs(r,n,s),l=n,r=l.stateNode,typeof r.componentDidMount=="function")try{r.componentDidMount()}catch(K){_t(l,l.return,K)}if(l=n,r=l.updateQueue,r!==null){var p=l.stateNode;try{var A=r.shared.hiddenCallbacks;if(A!==null)for(r.shared.hiddenCallbacks=null,r=0;r<A.length;r++)Tu(A[r],p)}catch(K){_t(l,l.return,K)}}s&&m&64&&Ym(n),$r(n,n.return);break;case 27:Km(n);case 26:case 5:vs(r,n,s),s&&l===null&&m&4&&Zm(n),$r(n,n.return);break;case 12:vs(r,n,s);break;case 31:vs(r,n,s),s&&m&4&&tx(r,n);break;case 13:vs(r,n,s),s&&m&4&&ax(r,n);break;case 22:n.memoizedState===null&&vs(r,n,s),$r(n,n.return);break;case 30:break;default:vs(r,n,s)}a=a.sibling}}function _c(t,a){var s=null;t!==null&&t.memoizedState!==null&&t.memoizedState.cachePool!==null&&(s=t.memoizedState.cachePool.pool),t=null,a.memoizedState!==null&&a.memoizedState.cachePool!==null&&(t=a.memoizedState.cachePool.pool),t!==s&&(t!=null&&t.refCount++,s!=null&&Ar(s))}function Sc(t,a){t=null,a.alternate!==null&&(t=a.alternate.memoizedState.cache),a=a.memoizedState.cache,a!==t&&(a.refCount++,t!=null&&Ar(t))}function Wa(t,a,s,l){if(a.subtreeFlags&10256)for(a=a.child;a!==null;)rx(t,a,s,l),a=a.sibling}function rx(t,a,s,l){var r=a.flags;switch(a.tag){case 0:case 11:case 15:Wa(t,a,s,l),r&2048&&Gr(9,a);break;case 1:Wa(t,a,s,l);break;case 3:Wa(t,a,s,l),r&2048&&(t=null,a.alternate!==null&&(t=a.alternate.memoizedState.cache),a=a.memoizedState.cache,a!==t&&(a.refCount++,t!=null&&Ar(t)));break;case 12:if(r&2048){Wa(t,a,s,l),t=a.stateNode;try{var n=a.memoizedProps,m=n.id,p=n.onPostCommit;typeof p=="function"&&p(m,a.alternate===null?"mount":"update",t.passiveEffectDuration,-0)}catch(A){_t(a,a.return,A)}}else Wa(t,a,s,l);break;case 31:Wa(t,a,s,l);break;case 13:Wa(t,a,s,l);break;case 23:break;case 22:n=a.stateNode,m=a.alternate,a.memoizedState!==null?n._visibility&2?Wa(t,a,s,l):Qr(t,a):n._visibility&2?Wa(t,a,s,l):(n._visibility|=2,Jl(t,a,s,l,(a.subtreeFlags&10256)!==0||!1)),r&2048&&_c(m,a);break;case 24:Wa(t,a,s,l),r&2048&&Sc(a.alternate,a);break;default:Wa(t,a,s,l)}}function Jl(t,a,s,l,r){for(r=r&&((a.subtreeFlags&10256)!==0||!1),a=a.child;a!==null;){var n=t,m=a,p=s,A=l,K=m.flags;switch(m.tag){case 0:case 11:case 15:Jl(n,m,p,A,r),Gr(8,m);break;case 23:break;case 22:var re=m.stateNode;m.memoizedState!==null?re._visibility&2?Jl(n,m,p,A,r):Qr(n,m):(re._visibility|=2,Jl(n,m,p,A,r)),r&&K&2048&&_c(m.alternate,m);break;case 24:Jl(n,m,p,A,r),r&&K&2048&&Sc(m.alternate,m);break;default:Jl(n,m,p,A,r)}a=a.sibling}}function Qr(t,a){if(a.subtreeFlags&10256)for(a=a.child;a!==null;){var s=t,l=a,r=l.flags;switch(l.tag){case 22:Qr(s,l),r&2048&&_c(l.alternate,l);break;case 24:Qr(s,l),r&2048&&Sc(l.alternate,l);break;default:Qr(s,l)}a=a.sibling}}var Yr=8192;function Wl(t,a,s){if(t.subtreeFlags&Yr)for(t=t.child;t!==null;)nx(t,a,s),t=t.sibling}function nx(t,a,s){switch(t.tag){case 26:Wl(t,a,s),t.flags&Yr&&t.memoizedState!==null&&yh(s,Ja,t.memoizedState,t.memoizedProps);break;case 5:Wl(t,a,s);break;case 3:case 4:var l=Ja;Ja=ji(t.stateNode.containerInfo),Wl(t,a,s),Ja=l;break;case 22:t.memoizedState===null&&(l=t.alternate,l!==null&&l.memoizedState!==null?(l=Yr,Yr=16777216,Wl(t,a,s),Yr=l):Wl(t,a,s));break;default:Wl(t,a,s)}}function ix(t){var a=t.alternate;if(a!==null&&(t=a.child,t!==null)){a.child=null;do a=t.sibling,t.sibling=null,t=a;while(t!==null)}}function Xr(t){var a=t.deletions;if((t.flags&16)!==0){if(a!==null)for(var s=0;s<a.length;s++){var l=a[s];ra=l,cx(l,t)}ix(t)}if(t.subtreeFlags&10256)for(t=t.child;t!==null;)ox(t),t=t.sibling}function ox(t){switch(t.tag){case 0:case 11:case 15:Xr(t),t.flags&2048&&Us(9,t,t.return);break;case 3:Xr(t);break;case 12:Xr(t);break;case 22:var a=t.stateNode;t.memoizedState!==null&&a._visibility&2&&(t.return===null||t.return.tag!==13)?(a._visibility&=-3,ii(t)):Xr(t);break;default:Xr(t)}}function ii(t){var a=t.deletions;if((t.flags&16)!==0){if(a!==null)for(var s=0;s<a.length;s++){var l=a[s];ra=l,cx(l,t)}ix(t)}for(t=t.child;t!==null;){switch(a=t,a.tag){case 0:case 11:case 15:Us(8,a,a.return),ii(a);break;case 22:s=a.stateNode,s._visibility&2&&(s._visibility&=-3,ii(a));break;default:ii(a)}t=t.sibling}}function cx(t,a){for(;ra!==null;){var s=ra;switch(s.tag){case 0:case 11:case 15:Us(8,s,a);break;case 23:case 22:if(s.memoizedState!==null&&s.memoizedState.cachePool!==null){var l=s.memoizedState.cachePool.pool;l!=null&&l.refCount++}break;case 24:Ar(s.memoizedState.cache)}if(l=s.child,l!==null)l.return=s,ra=l;else e:for(s=t;ra!==null;){l=ra;var r=l.sibling,n=l.return;if(Im(l),l===s){ra=null;break e}if(r!==null){r.return=n,ra=r;break e}ra=n}}}var Rg={getCacheForType:function(t){var a=ia(Xt),s=a.data.get(t);return s===void 0&&(s=t(),a.data.set(t,s)),s},cacheSignal:function(){return ia(Xt).controller.signal}},Tg=typeof WeakMap=="function"?WeakMap:Map,vt=0,Dt=null,rt=null,dt=0,wt=0,Ca=null,Os=!1,Il=!1,zc=!1,Ns=0,Bt=0,Vs=0,yl=0,kc=0,Ea=0,er=0,Zr=null,ja=null,Cc=!1,oi=0,dx=0,ci=1/0,di=null,Fs=null,ea=0,Bs=null,tr=null,ws=0,Ec=0,Ac=null,ux=null,Pr=0,qc=null;function Aa(){return(vt&2)!==0&&dt!==0?dt&-dt:z.T!==null?Uc():Za()}function mx(){if(Ea===0)if((dt&536870912)===0||mt){var t=ve;ve<<=1,(ve&3932160)===0&&(ve=262144),Ea=t}else Ea=536870912;return t=za.current,t!==null&&(t.flags|=32),Ea}function va(t,a,s){(t===Dt&&(wt===2||wt===9)||t.cancelPendingCommit!==null)&&(ar(t,0),Hs(t,dt,Ea,!1)),qe(t,s),((vt&2)===0||t!==Dt)&&(t===Dt&&((vt&2)===0&&(yl|=s),Bt===4&&Hs(t,dt,Ea,!1)),rs(t))}function xx(t,a,s){if((vt&6)!==0)throw Error(o(327));var l=!s&&(a&127)===0&&(a&t.expiredLanes)===0||He(t,a),r=l?Og(t,a):Dc(t,a,!0),n=l;do{if(r===0){Il&&!l&&Hs(t,a,0,!1);break}else{if(s=t.current.alternate,n&&!Lg(s)){r=Dc(t,a,!1),n=!1;continue}if(r===2){if(n=a,t.errorRecoveryDisabledLanes&n)var m=0;else m=t.pendingLanes&-536870913,m=m!==0?m:m&536870912?536870912:0;if(m!==0){a=m;e:{var p=t;r=Zr;var A=p.current.memoizedState.isDehydrated;if(A&&(ar(p,m).flags|=256),m=Dc(p,m,!1),m!==2){if(zc&&!A){p.errorRecoveryDisabledLanes|=n,yl|=n,r=4;break e}n=ja,ja=r,n!==null&&(ja===null?ja=n:ja.push.apply(ja,n))}r=m}if(n=!1,r!==2)continue}}if(r===1){ar(t,0),Hs(t,a,0,!0);break}e:{switch(l=t,n=r,n){case 0:case 1:throw Error(o(345));case 4:if((a&4194048)!==a)break;case 6:Hs(l,a,Ea,!Os);break e;case 2:ja=null;break;case 3:case 5:break;default:throw Error(o(329))}if((a&62914560)===a&&(r=oi+300-Xe(),10<r)){if(Hs(l,a,Ea,!Os),Fe(l,0,!0)!==0)break e;ws=a,l.timeoutHandle=$x(fx.bind(null,l,s,ja,di,Cc,a,Ea,yl,er,Os,n,"Throttled",-0,0),r);break e}fx(l,s,ja,di,Cc,a,Ea,yl,er,Os,n,null,-0,0)}}break}while(!0);rs(t)}function fx(t,a,s,l,r,n,m,p,A,K,re,ie,W,I){if(t.timeoutHandle=-1,ie=a.subtreeFlags,ie&8192||(ie&16785408)===16785408){ie={stylesheets:null,count:0,imgCount:0,imgBytes:0,suspenseyImages:[],waitingForImages:!0,waitingForViewTransition:!1,unsuspend:os},nx(a,n,ie);var Re=(n&62914560)===n?oi-Xe():(n&4194048)===n?dx-Xe():0;if(Re=jh(ie,Re),Re!==null){ws=n,t.cancelPendingCommit=Re(Nx.bind(null,t,a,n,s,l,r,m,p,A,re,ie,null,W,I)),Hs(t,n,m,!K);return}}Nx(t,a,n,s,l,r,m,p,A)}function Lg(t){for(var a=t;;){var s=a.tag;if((s===0||s===11||s===15)&&a.flags&16384&&(s=a.updateQueue,s!==null&&(s=s.stores,s!==null)))for(var l=0;l<s.length;l++){var r=s[l],n=r.getSnapshot;r=r.value;try{if(!_a(n(),r))return!1}catch{return!1}}if(s=a.child,a.subtreeFlags&16384&&s!==null)s.return=a,a=s;else{if(a===t)break;for(;a.sibling===null;){if(a.return===null||a.return===t)return!0;a=a.return}a.sibling.return=a.return,a=a.sibling}}return!0}function Hs(t,a,s,l){a&=~kc,a&=~yl,t.suspendedLanes|=a,t.pingedLanes&=~a,l&&(t.warmLanes|=a),l=t.expirationTimes;for(var r=a;0<r;){var n=31-Oe(r),m=1<<n;l[n]=-1,r&=~m}s!==0&&jt(t,s,a)}function ui(){return(vt&6)===0?(Kr(0),!1):!0}function Mc(){if(rt!==null){if(wt===0)var t=rt.return;else t=rt,ms=dl=null,Zo(t),Yl=null,Mr=0,t=rt;for(;t!==null;)Qm(t.alternate,t),t=t.return;rt=null}}function ar(t,a){var s=t.timeoutHandle;s!==-1&&(t.timeoutHandle=-1,ah(s)),s=t.cancelPendingCommit,s!==null&&(t.cancelPendingCommit=null,s()),ws=0,Mc(),Dt=t,rt=s=ds(t.current,null),dt=a,wt=0,Ca=null,Os=!1,Il=He(t,a),zc=!1,er=Ea=kc=yl=Vs=Bt=0,ja=Zr=null,Cc=!1,(a&8)!==0&&(a|=a&32);var l=t.entangledLanes;if(l!==0)for(t=t.entanglements,l&=a;0<l;){var r=31-Oe(l),n=1<<r;a|=t[r],l&=~n}return Ns=a,Mn(),s}function gx(t,a){Je=null,z.H=Fr,a===Ql||a===Fn?(a=qu(),wt=3):a===Lo?(a=qu(),wt=4):wt=a===dc?8:a!==null&&typeof a=="object"&&typeof a.then=="function"?6:1,Ca=a,rt===null&&(Bt=1,ei(t,Oa(a,t.current)))}function hx(){var t=za.current;return t===null?!0:(dt&4194048)===dt?Ha===null:(dt&62914560)===dt||(dt&536870912)!==0?t===Ha:!1}function px(){var t=z.H;return z.H=Fr,t===null?Fr:t}function bx(){var t=z.A;return z.A=Rg,t}function mi(){Bt=4,Os||(dt&4194048)!==dt&&za.current!==null||(Il=!0),(Vs&134217727)===0&&(yl&134217727)===0||Dt===null||Hs(Dt,dt,Ea,!1)}function Dc(t,a,s){var l=vt;vt|=2;var r=px(),n=bx();(Dt!==t||dt!==a)&&(di=null,ar(t,a)),a=!1;var m=Bt;e:do try{if(wt!==0&&rt!==null){var p=rt,A=Ca;switch(wt){case 8:Mc(),m=6;break e;case 3:case 2:case 9:case 6:za.current===null&&(a=!0);var K=wt;if(wt=0,Ca=null,sr(t,p,A,K),s&&Il){m=0;break e}break;default:K=wt,wt=0,Ca=null,sr(t,p,A,K)}}Ug(),m=Bt;break}catch(re){gx(t,re)}while(!0);return a&&t.shellSuspendCounter++,ms=dl=null,vt=l,z.H=r,z.A=n,rt===null&&(Dt=null,dt=0,Mn()),m}function Ug(){for(;rt!==null;)yx(rt)}function Og(t,a){var s=vt;vt|=2;var l=px(),r=bx();Dt!==t||dt!==a?(di=null,ci=Xe()+500,ar(t,a)):Il=He(t,a);e:do try{if(wt!==0&&rt!==null){a=rt;var n=Ca;t:switch(wt){case 1:wt=0,Ca=null,sr(t,a,n,1);break;case 2:case 9:if(Eu(n)){wt=0,Ca=null,jx(a);break}a=function(){wt!==2&&wt!==9||Dt!==t||(wt=7),rs(t)},n.then(a,a);break e;case 3:wt=7;break e;case 4:wt=5;break e;case 7:Eu(n)?(wt=0,Ca=null,jx(a)):(wt=0,Ca=null,sr(t,a,n,7));break;case 5:var m=null;switch(rt.tag){case 26:m=rt.memoizedState;case 5:case 27:var p=rt;if(m?r0(m):p.stateNode.complete){wt=0,Ca=null;var A=p.sibling;if(A!==null)rt=A;else{var K=p.return;K!==null?(rt=K,xi(K)):rt=null}break t}}wt=0,Ca=null,sr(t,a,n,5);break;case 6:wt=0,Ca=null,sr(t,a,n,6);break;case 8:Mc(),Bt=6;break e;default:throw Error(o(462))}}Vg();break}catch(re){gx(t,re)}while(!0);return ms=dl=null,z.H=l,z.A=r,vt=s,rt!==null?0:(Dt=null,dt=0,Mn(),Bt)}function Vg(){for(;rt!==null&&!Se();)yx(rt)}function yx(t){var a=Gm(t.alternate,t,Ns);t.memoizedProps=t.pendingProps,a===null?xi(t):rt=a}function jx(t){var a=t,s=a.alternate;switch(a.tag){case 15:case 0:a=Um(s,a,a.pendingProps,a.type,void 0,dt);break;case 11:a=Um(s,a,a.pendingProps,a.type.render,a.ref,dt);break;case 5:Zo(a);default:Qm(s,a),a=rt=bu(a,Ns),a=Gm(s,a,Ns)}t.memoizedProps=t.pendingProps,a===null?xi(t):rt=a}function sr(t,a,s,l){ms=dl=null,Zo(a),Yl=null,Mr=0;var r=a.return;try{if(kg(t,r,a,s,dt)){Bt=1,ei(t,Oa(s,t.current)),rt=null;return}}catch(n){if(r!==null)throw rt=r,n;Bt=1,ei(t,Oa(s,t.current)),rt=null;return}a.flags&32768?(mt||l===1?t=!0:Il||(dt&536870912)!==0?t=!1:(Os=t=!0,(l===2||l===9||l===3||l===6)&&(l=za.current,l!==null&&l.tag===13&&(l.flags|=16384))),vx(a,t)):xi(a)}function xi(t){var a=t;do{if((a.flags&32768)!==0){vx(a,Os);return}t=a.return;var s=Ag(a.alternate,a,Ns);if(s!==null){rt=s;return}if(a=a.sibling,a!==null){rt=a;return}rt=a=t}while(a!==null);Bt===0&&(Bt=5)}function vx(t,a){do{var s=qg(t.alternate,t);if(s!==null){s.flags&=32767,rt=s;return}if(s=t.return,s!==null&&(s.flags|=32768,s.subtreeFlags=0,s.deletions=null),!a&&(t=t.sibling,t!==null)){rt=t;return}rt=t=s}while(t!==null);Bt=6,rt=null}function Nx(t,a,s,l,r,n,m,p,A){t.cancelPendingCommit=null;do fi();while(ea!==0);if((vt&6)!==0)throw Error(o(327));if(a!==null){if(a===t.current)throw Error(o(177));if(n=a.lanes|a.childLanes,n|=vo,xt(t,s,n,m,p,A),t===Dt&&(rt=Dt=null,dt=0),tr=a,Bs=t,ws=s,Ec=n,Ac=r,ux=l,(a.subtreeFlags&10256)!==0||(a.flags&10256)!==0?(t.callbackNode=null,t.callbackPriority=0,Gg(kt,function(){return kx(),null})):(t.callbackNode=null,t.callbackPriority=0),l=(a.flags&13878)!==0,(a.subtreeFlags&13878)!==0||l){l=z.T,z.T=null,r=S.p,S.p=2,m=vt,vt|=4;try{Mg(t,a,s)}finally{vt=m,S.p=r,z.T=l}}ea=1,wx(),_x(),Sx()}}function wx(){if(ea===1){ea=0;var t=Bs,a=tr,s=(a.flags&13878)!==0;if((a.subtreeFlags&13878)!==0||s){s=z.T,z.T=null;var l=S.p;S.p=2;var r=vt;vt|=4;try{sx(a,t);var n=Qc,m=cu(t.containerInfo),p=n.focusedElem,A=n.selectionRange;if(m!==p&&p&&p.ownerDocument&&ou(p.ownerDocument.documentElement,p)){if(A!==null&&ho(p)){var K=A.start,re=A.end;if(re===void 0&&(re=K),"selectionStart"in p)p.selectionStart=K,p.selectionEnd=Math.min(re,p.value.length);else{var ie=p.ownerDocument||document,W=ie&&ie.defaultView||window;if(W.getSelection){var I=W.getSelection(),Re=p.textContent.length,$e=Math.min(A.start,Re),At=A.end===void 0?$e:Math.min(A.end,Re);!I.extend&&$e>At&&(m=At,At=$e,$e=m);var H=iu(p,$e),O=iu(p,At);if(H&&O&&(I.rangeCount!==1||I.anchorNode!==H.node||I.anchorOffset!==H.offset||I.focusNode!==O.node||I.focusOffset!==O.offset)){var P=ie.createRange();P.setStart(H.node,H.offset),I.removeAllRanges(),$e>At?(I.addRange(P),I.extend(O.node,O.offset)):(P.setEnd(O.node,O.offset),I.addRange(P))}}}}for(ie=[],I=p;I=I.parentNode;)I.nodeType===1&&ie.push({element:I,left:I.scrollLeft,top:I.scrollTop});for(typeof p.focus=="function"&&p.focus(),p=0;p<ie.length;p++){var ne=ie[p];ne.element.scrollLeft=ne.left,ne.element.scrollTop=ne.top}}zi=!!$c,Qc=$c=null}finally{vt=r,S.p=l,z.T=s}}t.current=a,ea=2}}function _x(){if(ea===2){ea=0;var t=Bs,a=tr,s=(a.flags&8772)!==0;if((a.subtreeFlags&8772)!==0||s){s=z.T,z.T=null;var l=S.p;S.p=2;var r=vt;vt|=4;try{Wm(t,a.alternate,a)}finally{vt=r,S.p=l,z.T=s}}ea=3}}function Sx(){if(ea===4||ea===3){ea=0,Pe();var t=Bs,a=tr,s=ws,l=ux;(a.subtreeFlags&10256)!==0||(a.flags&10256)!==0?ea=5:(ea=0,tr=Bs=null,zx(t,t.pendingLanes));var r=t.pendingLanes;if(r===0&&(Fs=null),wa(s),a=a.stateNode,be&&typeof be.onCommitFiberRoot=="function")try{be.onCommitFiberRoot(Q,a,void 0,(a.current.flags&128)===128)}catch{}if(l!==null){a=z.T,r=S.p,S.p=2,z.T=null;try{for(var n=t.onRecoverableError,m=0;m<l.length;m++){var p=l[m];n(p.value,{componentStack:p.stack})}}finally{z.T=a,S.p=r}}(ws&3)!==0&&fi(),rs(t),r=t.pendingLanes,(s&261930)!==0&&(r&42)!==0?t===qc?Pr++:(Pr=0,qc=t):Pr=0,Kr(0)}}function zx(t,a){(t.pooledCacheLanes&=a)===0&&(a=t.pooledCache,a!=null&&(t.pooledCache=null,Ar(a)))}function fi(){return wx(),_x(),Sx(),kx()}function kx(){if(ea!==5)return!1;var t=Bs,a=Ec;Ec=0;var s=wa(ws),l=z.T,r=S.p;try{S.p=32>s?32:s,z.T=null,s=Ac,Ac=null;var n=Bs,m=ws;if(ea=0,tr=Bs=null,ws=0,(vt&6)!==0)throw Error(o(331));var p=vt;if(vt|=4,ox(n.current),rx(n,n.current,m,s),vt=p,Kr(0,!1),be&&typeof be.onPostCommitFiberRoot=="function")try{be.onPostCommitFiberRoot(Q,n)}catch{}return!0}finally{S.p=r,z.T=l,zx(t,a)}}function Cx(t,a,s){a=Oa(s,a),a=cc(t.stateNode,a,2),t=Rs(t,a,2),t!==null&&(qe(t,2),rs(t))}function _t(t,a,s){if(t.tag===3)Cx(t,t,s);else for(;a!==null;){if(a.tag===3){Cx(a,t,s);break}else if(a.tag===1){var l=a.stateNode;if(typeof a.type.getDerivedStateFromError=="function"||typeof l.componentDidCatch=="function"&&(Fs===null||!Fs.has(l))){t=Oa(s,t),s=Em(2),l=Rs(a,s,2),l!==null&&(Am(s,l,a,t),qe(l,2),rs(l));break}}a=a.return}}function Rc(t,a,s){var l=t.pingCache;if(l===null){l=t.pingCache=new Tg;var r=new Set;l.set(a,r)}else r=l.get(a),r===void 0&&(r=new Set,l.set(a,r));r.has(s)||(zc=!0,r.add(s),t=Fg.bind(null,t,a,s),a.then(t,t))}function Fg(t,a,s){var l=t.pingCache;l!==null&&l.delete(a),t.pingedLanes|=t.suspendedLanes&s,t.warmLanes&=~s,Dt===t&&(dt&s)===s&&(Bt===4||Bt===3&&(dt&62914560)===dt&&300>Xe()-oi?(vt&2)===0&&ar(t,0):kc|=s,er===dt&&(er=0)),rs(t)}function Ex(t,a){a===0&&(a=de()),t=il(t,a),t!==null&&(qe(t,a),rs(t))}function Bg(t){var a=t.memoizedState,s=0;a!==null&&(s=a.retryLane),Ex(t,s)}function Hg(t,a){var s=0;switch(t.tag){case 31:case 13:var l=t.stateNode,r=t.memoizedState;r!==null&&(s=r.retryLane);break;case 19:l=t.stateNode;break;case 22:l=t.stateNode._retryCache;break;default:throw Error(o(314))}l!==null&&l.delete(a),Ex(t,s)}function Gg(t,a){return Ge(t,a)}var gi=null,lr=null,Tc=!1,hi=!1,Lc=!1,Gs=0;function rs(t){t!==lr&&t.next===null&&(lr===null?gi=lr=t:lr=lr.next=t),hi=!0,Tc||(Tc=!0,Qg())}function Kr(t,a){if(!Lc&&hi){Lc=!0;do for(var s=!1,l=gi;l!==null;){if(t!==0){var r=l.pendingLanes;if(r===0)var n=0;else{var m=l.suspendedLanes,p=l.pingedLanes;n=(1<<31-Oe(42|t)+1)-1,n&=r&~(m&~p),n=n&201326741?n&201326741|1:n?n|2:0}n!==0&&(s=!0,Dx(l,n))}else n=dt,n=Fe(l,l===Dt?n:0,l.cancelPendingCommit!==null||l.timeoutHandle!==-1),(n&3)===0||He(l,n)||(s=!0,Dx(l,n));l=l.next}while(s);Lc=!1}}function $g(){Ax()}function Ax(){hi=Tc=!1;var t=0;Gs!==0&&th()&&(t=Gs);for(var a=Xe(),s=null,l=gi;l!==null;){var r=l.next,n=qx(l,a);n===0?(l.next=null,s===null?gi=r:s.next=r,r===null&&(lr=s)):(s=l,(t!==0||(n&3)!==0)&&(hi=!0)),l=r}ea!==0&&ea!==5||Kr(t),Gs!==0&&(Gs=0)}function qx(t,a){for(var s=t.suspendedLanes,l=t.pingedLanes,r=t.expirationTimes,n=t.pendingLanes&-62914561;0<n;){var m=31-Oe(n),p=1<<m,A=r[m];A===-1?((p&s)===0||(p&l)!==0)&&(r[m]=te(p,a)):A<=a&&(t.expiredLanes|=p),n&=~p}if(a=Dt,s=dt,s=Fe(t,t===a?s:0,t.cancelPendingCommit!==null||t.timeoutHandle!==-1),l=t.callbackNode,s===0||t===a&&(wt===2||wt===9)||t.cancelPendingCommit!==null)return l!==null&&l!==null&&xe(l),t.callbackNode=null,t.callbackPriority=0;if((s&3)===0||He(t,s)){if(a=s&-s,a===t.callbackPriority)return a;switch(l!==null&&xe(l),wa(s)){case 2:case 8:s=qt;break;case 32:s=kt;break;case 268435456:s=Ce;break;default:s=kt}return l=Mx.bind(null,t),s=Ge(s,l),t.callbackPriority=a,t.callbackNode=s,a}return l!==null&&l!==null&&xe(l),t.callbackPriority=2,t.callbackNode=null,2}function Mx(t,a){if(ea!==0&&ea!==5)return t.callbackNode=null,t.callbackPriority=0,null;var s=t.callbackNode;if(fi()&&t.callbackNode!==s)return null;var l=dt;return l=Fe(t,t===Dt?l:0,t.cancelPendingCommit!==null||t.timeoutHandle!==-1),l===0?null:(xx(t,l,a),qx(t,Xe()),t.callbackNode!=null&&t.callbackNode===s?Mx.bind(null,t):null)}function Dx(t,a){if(fi())return null;xx(t,a,!0)}function Qg(){sh(function(){(vt&6)!==0?Ge(Lt,$g):Ax()})}function Uc(){if(Gs===0){var t=Gl;t===0&&(t=oe,oe<<=1,(oe&261888)===0&&(oe=256)),Gs=t}return Gs}function Rx(t){return t==null||typeof t=="symbol"||typeof t=="boolean"?null:typeof t=="function"?t:_n(""+t)}function Tx(t,a){var s=a.ownerDocument.createElement("input");return s.name=a.name,s.value=a.value,t.id&&s.setAttribute("form",t.id),a.parentNode.insertBefore(s,a),t=new FormData(t),s.parentNode.removeChild(s),t}function Yg(t,a,s,l,r){if(a==="submit"&&s&&s.stateNode===r){var n=Rx((r[Tt]||null).action),m=l.submitter;m&&(a=(a=m[Tt]||null)?Rx(a.formAction):m.getAttribute("formAction"),a!==null&&(n=a,m=null));var p=new Cn("action","action",null,l,r);t.push({event:p,listeners:[{instance:null,listener:function(){if(l.defaultPrevented){if(Gs!==0){var A=m?Tx(r,m):new FormData(r);sc(s,{pending:!0,data:A,method:r.method,action:n},null,A)}}else typeof n=="function"&&(p.preventDefault(),A=m?Tx(r,m):new FormData(r),sc(s,{pending:!0,data:A,method:r.method,action:n},n,A))},currentTarget:r}]})}}for(var Oc=0;Oc<jo.length;Oc++){var Vc=jo[Oc],Xg=Vc.toLowerCase(),Zg=Vc[0].toUpperCase()+Vc.slice(1);Ka(Xg,"on"+Zg)}Ka(mu,"onAnimationEnd"),Ka(xu,"onAnimationIteration"),Ka(fu,"onAnimationStart"),Ka("dblclick","onDoubleClick"),Ka("focusin","onFocus"),Ka("focusout","onBlur"),Ka(dg,"onTransitionRun"),Ka(ug,"onTransitionStart"),Ka(mg,"onTransitionCancel"),Ka(gu,"onTransitionEnd"),El("onMouseEnter",["mouseout","mouseover"]),El("onMouseLeave",["mouseout","mouseover"]),El("onPointerEnter",["pointerout","pointerover"]),El("onPointerLeave",["pointerout","pointerover"]),sl("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),sl("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),sl("onBeforeInput",["compositionend","keypress","textInput","paste"]),sl("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),sl("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),sl("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var Jr="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),Pg=new Set("beforetoggle cancel close invalid load scroll scrollend toggle".split(" ").concat(Jr));function Lx(t,a){a=(a&4)!==0;for(var s=0;s<t.length;s++){var l=t[s],r=l.event;l=l.listeners;e:{var n=void 0;if(a)for(var m=l.length-1;0<=m;m--){var p=l[m],A=p.instance,K=p.currentTarget;if(p=p.listener,A!==n&&r.isPropagationStopped())break e;n=p,r.currentTarget=K;try{n(r)}catch(re){qn(re)}r.currentTarget=null,n=A}else for(m=0;m<l.length;m++){if(p=l[m],A=p.instance,K=p.currentTarget,p=p.listener,A!==n&&r.isPropagationStopped())break e;n=p,r.currentTarget=K;try{n(r)}catch(re){qn(re)}r.currentTarget=null,n=A}}}}function nt(t,a){var s=a[Pa];s===void 0&&(s=a[Pa]=new Set);var l=t+"__bubble";s.has(l)||(Ux(a,t,2,!1),s.add(l))}function Fc(t,a,s){var l=0;a&&(l|=4),Ux(s,t,l,a)}var pi="_reactListening"+Math.random().toString(36).slice(2);function Bc(t){if(!t[pi]){t[pi]=!0,Ad.forEach(function(s){s!=="selectionchange"&&(Pg.has(s)||Fc(s,!1,t),Fc(s,!0,t))});var a=t.nodeType===9?t:t.ownerDocument;a===null||a[pi]||(a[pi]=!0,Fc("selectionchange",!1,a))}}function Ux(t,a,s,l){switch(m0(a)){case 2:var r=wh;break;case 8:r=_h;break;default:r=ad}s=r.bind(null,a,s,t),r=void 0,!no||a!=="touchstart"&&a!=="touchmove"&&a!=="wheel"||(r=!0),l?r!==void 0?t.addEventListener(a,s,{capture:!0,passive:r}):t.addEventListener(a,s,!0):r!==void 0?t.addEventListener(a,s,{passive:r}):t.addEventListener(a,s,!1)}function Hc(t,a,s,l,r){var n=l;if((a&1)===0&&(a&2)===0&&l!==null)e:for(;;){if(l===null)return;var m=l.tag;if(m===3||m===4){var p=l.stateNode.containerInfo;if(p===r)break;if(m===4)for(m=l.return;m!==null;){var A=m.tag;if((A===3||A===4)&&m.stateNode.containerInfo===r)return;m=m.return}for(;p!==null;){if(m=zl(p),m===null)return;if(A=m.tag,A===5||A===6||A===26||A===27){l=n=m;continue e}p=p.parentNode}}l=l.return}Hd(function(){var K=n,re=lo(s),ie=[];e:{var W=hu.get(t);if(W!==void 0){var I=Cn,Re=t;switch(t){case"keypress":if(zn(s)===0)break e;case"keydown":case"keyup":I=Hf;break;case"focusin":Re="focus",I=uo;break;case"focusout":Re="blur",I=uo;break;case"beforeblur":case"afterblur":I=uo;break;case"click":if(s.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":I=Qd;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":I=Af;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":I=Qf;break;case mu:case xu:case fu:I=Df;break;case gu:I=Xf;break;case"scroll":case"scrollend":I=Cf;break;case"wheel":I=Pf;break;case"copy":case"cut":case"paste":I=Tf;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":I=Xd;break;case"toggle":case"beforetoggle":I=Jf}var $e=(a&4)!==0,At=!$e&&(t==="scroll"||t==="scrollend"),H=$e?W!==null?W+"Capture":null:W;$e=[];for(var O=K,P;O!==null;){var ne=O;if(P=ne.stateNode,ne=ne.tag,ne!==5&&ne!==26&&ne!==27||P===null||H===null||(ne=yr(O,H),ne!=null&&$e.push(Wr(O,ne,P))),At)break;O=O.return}0<$e.length&&(W=new I(W,Re,null,s,re),ie.push({event:W,listeners:$e}))}}if((a&7)===0){e:{if(W=t==="mouseover"||t==="pointerover",I=t==="mouseout"||t==="pointerout",W&&s!==so&&(Re=s.relatedTarget||s.fromElement)&&(zl(Re)||Re[ua]))break e;if((I||W)&&(W=re.window===re?re:(W=re.ownerDocument)?W.defaultView||W.parentWindow:window,I?(Re=s.relatedTarget||s.toElement,I=K,Re=Re?zl(Re):null,Re!==null&&(At=y(Re),$e=Re.tag,Re!==At||$e!==5&&$e!==27&&$e!==6)&&(Re=null)):(I=null,Re=K),I!==Re)){if($e=Qd,ne="onMouseLeave",H="onMouseEnter",O="mouse",(t==="pointerout"||t==="pointerover")&&($e=Xd,ne="onPointerLeave",H="onPointerEnter",O="pointer"),At=I==null?W:br(I),P=Re==null?W:br(Re),W=new $e(ne,O+"leave",I,s,re),W.target=At,W.relatedTarget=P,ne=null,zl(re)===K&&($e=new $e(H,O+"enter",Re,s,re),$e.target=P,$e.relatedTarget=At,ne=$e),At=ne,I&&Re)t:{for($e=Kg,H=I,O=Re,P=0,ne=H;ne;ne=$e(ne))P++;ne=0;for(var Be=O;Be;Be=$e(Be))ne++;for(;0<P-ne;)H=$e(H),P--;for(;0<ne-P;)O=$e(O),ne--;for(;P--;){if(H===O||O!==null&&H===O.alternate){$e=H;break t}H=$e(H),O=$e(O)}$e=null}else $e=null;I!==null&&Ox(ie,W,I,$e,!1),Re!==null&&At!==null&&Ox(ie,At,Re,$e,!0)}}e:{if(W=K?br(K):window,I=W.nodeName&&W.nodeName.toLowerCase(),I==="select"||I==="input"&&W.type==="file")var bt=tu;else if(Id(W))if(au)bt=ig;else{bt=rg;var Ue=lg}else I=W.nodeName,!I||I.toLowerCase()!=="input"||W.type!=="checkbox"&&W.type!=="radio"?K&&ao(K.elementType)&&(bt=tu):bt=ng;if(bt&&(bt=bt(t,K))){eu(ie,bt,s,re);break e}Ue&&Ue(t,W,K),t==="focusout"&&K&&W.type==="number"&&K.memoizedProps.value!=null&&to(W,"number",W.value)}switch(Ue=K?br(K):window,t){case"focusin":(Id(Ue)||Ue.contentEditable==="true")&&(Tl=Ue,po=K,kr=null);break;case"focusout":kr=po=Tl=null;break;case"mousedown":bo=!0;break;case"contextmenu":case"mouseup":case"dragend":bo=!1,du(ie,s,re);break;case"selectionchange":if(cg)break;case"keydown":case"keyup":du(ie,s,re)}var Ie;if(xo)e:{switch(t){case"compositionstart":var ut="onCompositionStart";break e;case"compositionend":ut="onCompositionEnd";break e;case"compositionupdate":ut="onCompositionUpdate";break e}ut=void 0}else Rl?Jd(t,s)&&(ut="onCompositionEnd"):t==="keydown"&&s.keyCode===229&&(ut="onCompositionStart");ut&&(Zd&&s.locale!=="ko"&&(Rl||ut!=="onCompositionStart"?ut==="onCompositionEnd"&&Rl&&(Ie=Gd()):(ks=re,io="value"in ks?ks.value:ks.textContent,Rl=!0)),Ue=bi(K,ut),0<Ue.length&&(ut=new Yd(ut,t,null,s,re),ie.push({event:ut,listeners:Ue}),Ie?ut.data=Ie:(Ie=Wd(s),Ie!==null&&(ut.data=Ie)))),(Ie=If?eg(t,s):tg(t,s))&&(ut=bi(K,"onBeforeInput"),0<ut.length&&(Ue=new Yd("onBeforeInput","beforeinput",null,s,re),ie.push({event:Ue,listeners:ut}),Ue.data=Ie)),Yg(ie,t,K,s,re)}Lx(ie,a)})}function Wr(t,a,s){return{instance:t,listener:a,currentTarget:s}}function bi(t,a){for(var s=a+"Capture",l=[];t!==null;){var r=t,n=r.stateNode;if(r=r.tag,r!==5&&r!==26&&r!==27||n===null||(r=yr(t,s),r!=null&&l.unshift(Wr(t,r,n)),r=yr(t,a),r!=null&&l.push(Wr(t,r,n))),t.tag===3)return l;t=t.return}return[]}function Kg(t){if(t===null)return null;do t=t.return;while(t&&t.tag!==5&&t.tag!==27);return t||null}function Ox(t,a,s,l,r){for(var n=a._reactName,m=[];s!==null&&s!==l;){var p=s,A=p.alternate,K=p.stateNode;if(p=p.tag,A!==null&&A===l)break;p!==5&&p!==26&&p!==27||K===null||(A=K,r?(K=yr(s,n),K!=null&&m.unshift(Wr(s,K,A))):r||(K=yr(s,n),K!=null&&m.push(Wr(s,K,A)))),s=s.return}m.length!==0&&t.push({event:a,listeners:m})}var Jg=/\r\n?/g,Wg=/\u0000|\uFFFD/g;function Vx(t){return(typeof t=="string"?t:""+t).replace(Jg,`
`).replace(Wg,"")}function Fx(t,a){return a=Vx(a),Vx(t)===a}function Et(t,a,s,l,r,n){switch(s){case"children":typeof l=="string"?a==="body"||a==="textarea"&&l===""||ql(t,l):(typeof l=="number"||typeof l=="bigint")&&a!=="body"&&ql(t,""+l);break;case"className":Nn(t,"class",l);break;case"tabIndex":Nn(t,"tabindex",l);break;case"dir":case"role":case"viewBox":case"width":case"height":Nn(t,s,l);break;case"style":Fd(t,l,n);break;case"data":if(a!=="object"){Nn(t,"data",l);break}case"src":case"href":if(l===""&&(a!=="a"||s!=="href")){t.removeAttribute(s);break}if(l==null||typeof l=="function"||typeof l=="symbol"||typeof l=="boolean"){t.removeAttribute(s);break}l=_n(""+l),t.setAttribute(s,l);break;case"action":case"formAction":if(typeof l=="function"){t.setAttribute(s,"javascript:throw new Error('A React form was unexpectedly submitted. If you called form.submit() manually, consider using form.requestSubmit() instead. If you\\'re trying to use event.stopPropagation() in a submit event handler, consider also calling event.preventDefault().')");break}else typeof n=="function"&&(s==="formAction"?(a!=="input"&&Et(t,a,"name",r.name,r,null),Et(t,a,"formEncType",r.formEncType,r,null),Et(t,a,"formMethod",r.formMethod,r,null),Et(t,a,"formTarget",r.formTarget,r,null)):(Et(t,a,"encType",r.encType,r,null),Et(t,a,"method",r.method,r,null),Et(t,a,"target",r.target,r,null)));if(l==null||typeof l=="symbol"||typeof l=="boolean"){t.removeAttribute(s);break}l=_n(""+l),t.setAttribute(s,l);break;case"onClick":l!=null&&(t.onclick=os);break;case"onScroll":l!=null&&nt("scroll",t);break;case"onScrollEnd":l!=null&&nt("scrollend",t);break;case"dangerouslySetInnerHTML":if(l!=null){if(typeof l!="object"||!("__html"in l))throw Error(o(61));if(s=l.__html,s!=null){if(r.children!=null)throw Error(o(60));t.innerHTML=s}}break;case"multiple":t.multiple=l&&typeof l!="function"&&typeof l!="symbol";break;case"muted":t.muted=l&&typeof l!="function"&&typeof l!="symbol";break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"defaultValue":case"defaultChecked":case"innerHTML":case"ref":break;case"autoFocus":break;case"xlinkHref":if(l==null||typeof l=="function"||typeof l=="boolean"||typeof l=="symbol"){t.removeAttribute("xlink:href");break}s=_n(""+l),t.setAttributeNS("http://www.w3.org/1999/xlink","xlink:href",s);break;case"contentEditable":case"spellCheck":case"draggable":case"value":case"autoReverse":case"externalResourcesRequired":case"focusable":case"preserveAlpha":l!=null&&typeof l!="function"&&typeof l!="symbol"?t.setAttribute(s,""+l):t.removeAttribute(s);break;case"inert":case"allowFullScreen":case"async":case"autoPlay":case"controls":case"default":case"defer":case"disabled":case"disablePictureInPicture":case"disableRemotePlayback":case"formNoValidate":case"hidden":case"loop":case"noModule":case"noValidate":case"open":case"playsInline":case"readOnly":case"required":case"reversed":case"scoped":case"seamless":case"itemScope":l&&typeof l!="function"&&typeof l!="symbol"?t.setAttribute(s,""):t.removeAttribute(s);break;case"capture":case"download":l===!0?t.setAttribute(s,""):l!==!1&&l!=null&&typeof l!="function"&&typeof l!="symbol"?t.setAttribute(s,l):t.removeAttribute(s);break;case"cols":case"rows":case"size":case"span":l!=null&&typeof l!="function"&&typeof l!="symbol"&&!isNaN(l)&&1<=l?t.setAttribute(s,l):t.removeAttribute(s);break;case"rowSpan":case"start":l==null||typeof l=="function"||typeof l=="symbol"||isNaN(l)?t.removeAttribute(s):t.setAttribute(s,l);break;case"popover":nt("beforetoggle",t),nt("toggle",t),vn(t,"popover",l);break;case"xlinkActuate":is(t,"http://www.w3.org/1999/xlink","xlink:actuate",l);break;case"xlinkArcrole":is(t,"http://www.w3.org/1999/xlink","xlink:arcrole",l);break;case"xlinkRole":is(t,"http://www.w3.org/1999/xlink","xlink:role",l);break;case"xlinkShow":is(t,"http://www.w3.org/1999/xlink","xlink:show",l);break;case"xlinkTitle":is(t,"http://www.w3.org/1999/xlink","xlink:title",l);break;case"xlinkType":is(t,"http://www.w3.org/1999/xlink","xlink:type",l);break;case"xmlBase":is(t,"http://www.w3.org/XML/1998/namespace","xml:base",l);break;case"xmlLang":is(t,"http://www.w3.org/XML/1998/namespace","xml:lang",l);break;case"xmlSpace":is(t,"http://www.w3.org/XML/1998/namespace","xml:space",l);break;case"is":vn(t,"is",l);break;case"innerText":case"textContent":break;default:(!(2<s.length)||s[0]!=="o"&&s[0]!=="O"||s[1]!=="n"&&s[1]!=="N")&&(s=zf.get(s)||s,vn(t,s,l))}}function Gc(t,a,s,l,r,n){switch(s){case"style":Fd(t,l,n);break;case"dangerouslySetInnerHTML":if(l!=null){if(typeof l!="object"||!("__html"in l))throw Error(o(61));if(s=l.__html,s!=null){if(r.children!=null)throw Error(o(60));t.innerHTML=s}}break;case"children":typeof l=="string"?ql(t,l):(typeof l=="number"||typeof l=="bigint")&&ql(t,""+l);break;case"onScroll":l!=null&&nt("scroll",t);break;case"onScrollEnd":l!=null&&nt("scrollend",t);break;case"onClick":l!=null&&(t.onclick=os);break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"innerHTML":case"ref":break;case"innerText":case"textContent":break;default:if(!qd.hasOwnProperty(s))e:{if(s[0]==="o"&&s[1]==="n"&&(r=s.endsWith("Capture"),a=s.slice(2,r?s.length-7:void 0),n=t[Tt]||null,n=n!=null?n[s]:null,typeof n=="function"&&t.removeEventListener(a,n,r),typeof l=="function")){typeof n!="function"&&n!==null&&(s in t?t[s]=null:t.hasAttribute(s)&&t.removeAttribute(s)),t.addEventListener(a,l,r);break e}s in t?t[s]=l:l===!0?t.setAttribute(s,""):vn(t,s,l)}}}function ca(t,a,s){switch(a){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"img":nt("error",t),nt("load",t);var l=!1,r=!1,n;for(n in s)if(s.hasOwnProperty(n)){var m=s[n];if(m!=null)switch(n){case"src":l=!0;break;case"srcSet":r=!0;break;case"children":case"dangerouslySetInnerHTML":throw Error(o(137,a));default:Et(t,a,n,m,s,null)}}r&&Et(t,a,"srcSet",s.srcSet,s,null),l&&Et(t,a,"src",s.src,s,null);return;case"input":nt("invalid",t);var p=n=m=r=null,A=null,K=null;for(l in s)if(s.hasOwnProperty(l)){var re=s[l];if(re!=null)switch(l){case"name":r=re;break;case"type":m=re;break;case"checked":A=re;break;case"defaultChecked":K=re;break;case"value":n=re;break;case"defaultValue":p=re;break;case"children":case"dangerouslySetInnerHTML":if(re!=null)throw Error(o(137,a));break;default:Et(t,a,l,re,s,null)}}Ld(t,n,p,A,K,m,r,!1);return;case"select":nt("invalid",t),l=m=n=null;for(r in s)if(s.hasOwnProperty(r)&&(p=s[r],p!=null))switch(r){case"value":n=p;break;case"defaultValue":m=p;break;case"multiple":l=p;default:Et(t,a,r,p,s,null)}a=n,s=m,t.multiple=!!l,a!=null?Al(t,!!l,a,!1):s!=null&&Al(t,!!l,s,!0);return;case"textarea":nt("invalid",t),n=r=l=null;for(m in s)if(s.hasOwnProperty(m)&&(p=s[m],p!=null))switch(m){case"value":l=p;break;case"defaultValue":r=p;break;case"children":n=p;break;case"dangerouslySetInnerHTML":if(p!=null)throw Error(o(91));break;default:Et(t,a,m,p,s,null)}Od(t,l,r,n);return;case"option":for(A in s)if(s.hasOwnProperty(A)&&(l=s[A],l!=null))switch(A){case"selected":t.selected=l&&typeof l!="function"&&typeof l!="symbol";break;default:Et(t,a,A,l,s,null)}return;case"dialog":nt("beforetoggle",t),nt("toggle",t),nt("cancel",t),nt("close",t);break;case"iframe":case"object":nt("load",t);break;case"video":case"audio":for(l=0;l<Jr.length;l++)nt(Jr[l],t);break;case"image":nt("error",t),nt("load",t);break;case"details":nt("toggle",t);break;case"embed":case"source":case"link":nt("error",t),nt("load",t);case"area":case"base":case"br":case"col":case"hr":case"keygen":case"meta":case"param":case"track":case"wbr":case"menuitem":for(K in s)if(s.hasOwnProperty(K)&&(l=s[K],l!=null))switch(K){case"children":case"dangerouslySetInnerHTML":throw Error(o(137,a));default:Et(t,a,K,l,s,null)}return;default:if(ao(a)){for(re in s)s.hasOwnProperty(re)&&(l=s[re],l!==void 0&&Gc(t,a,re,l,s,void 0));return}}for(p in s)s.hasOwnProperty(p)&&(l=s[p],l!=null&&Et(t,a,p,l,s,null))}function Ig(t,a,s,l){switch(a){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"input":var r=null,n=null,m=null,p=null,A=null,K=null,re=null;for(I in s){var ie=s[I];if(s.hasOwnProperty(I)&&ie!=null)switch(I){case"checked":break;case"value":break;case"defaultValue":A=ie;default:l.hasOwnProperty(I)||Et(t,a,I,null,l,ie)}}for(var W in l){var I=l[W];if(ie=s[W],l.hasOwnProperty(W)&&(I!=null||ie!=null))switch(W){case"type":n=I;break;case"name":r=I;break;case"checked":K=I;break;case"defaultChecked":re=I;break;case"value":m=I;break;case"defaultValue":p=I;break;case"children":case"dangerouslySetInnerHTML":if(I!=null)throw Error(o(137,a));break;default:I!==ie&&Et(t,a,W,I,l,ie)}}eo(t,m,p,A,K,re,n,r);return;case"select":I=m=p=W=null;for(n in s)if(A=s[n],s.hasOwnProperty(n)&&A!=null)switch(n){case"value":break;case"multiple":I=A;default:l.hasOwnProperty(n)||Et(t,a,n,null,l,A)}for(r in l)if(n=l[r],A=s[r],l.hasOwnProperty(r)&&(n!=null||A!=null))switch(r){case"value":W=n;break;case"defaultValue":p=n;break;case"multiple":m=n;default:n!==A&&Et(t,a,r,n,l,A)}a=p,s=m,l=I,W!=null?Al(t,!!s,W,!1):!!l!=!!s&&(a!=null?Al(t,!!s,a,!0):Al(t,!!s,s?[]:"",!1));return;case"textarea":I=W=null;for(p in s)if(r=s[p],s.hasOwnProperty(p)&&r!=null&&!l.hasOwnProperty(p))switch(p){case"value":break;case"children":break;default:Et(t,a,p,null,l,r)}for(m in l)if(r=l[m],n=s[m],l.hasOwnProperty(m)&&(r!=null||n!=null))switch(m){case"value":W=r;break;case"defaultValue":I=r;break;case"children":break;case"dangerouslySetInnerHTML":if(r!=null)throw Error(o(91));break;default:r!==n&&Et(t,a,m,r,l,n)}Ud(t,W,I);return;case"option":for(var Re in s)if(W=s[Re],s.hasOwnProperty(Re)&&W!=null&&!l.hasOwnProperty(Re))switch(Re){case"selected":t.selected=!1;break;default:Et(t,a,Re,null,l,W)}for(A in l)if(W=l[A],I=s[A],l.hasOwnProperty(A)&&W!==I&&(W!=null||I!=null))switch(A){case"selected":t.selected=W&&typeof W!="function"&&typeof W!="symbol";break;default:Et(t,a,A,W,l,I)}return;case"img":case"link":case"area":case"base":case"br":case"col":case"embed":case"hr":case"keygen":case"meta":case"param":case"source":case"track":case"wbr":case"menuitem":for(var $e in s)W=s[$e],s.hasOwnProperty($e)&&W!=null&&!l.hasOwnProperty($e)&&Et(t,a,$e,null,l,W);for(K in l)if(W=l[K],I=s[K],l.hasOwnProperty(K)&&W!==I&&(W!=null||I!=null))switch(K){case"children":case"dangerouslySetInnerHTML":if(W!=null)throw Error(o(137,a));break;default:Et(t,a,K,W,l,I)}return;default:if(ao(a)){for(var At in s)W=s[At],s.hasOwnProperty(At)&&W!==void 0&&!l.hasOwnProperty(At)&&Gc(t,a,At,void 0,l,W);for(re in l)W=l[re],I=s[re],!l.hasOwnProperty(re)||W===I||W===void 0&&I===void 0||Gc(t,a,re,W,l,I);return}}for(var H in s)W=s[H],s.hasOwnProperty(H)&&W!=null&&!l.hasOwnProperty(H)&&Et(t,a,H,null,l,W);for(ie in l)W=l[ie],I=s[ie],!l.hasOwnProperty(ie)||W===I||W==null&&I==null||Et(t,a,ie,W,l,I)}function Bx(t){switch(t){case"css":case"script":case"font":case"img":case"image":case"input":case"link":return!0;default:return!1}}function eh(){if(typeof performance.getEntriesByType=="function"){for(var t=0,a=0,s=performance.getEntriesByType("resource"),l=0;l<s.length;l++){var r=s[l],n=r.transferSize,m=r.initiatorType,p=r.duration;if(n&&p&&Bx(m)){for(m=0,p=r.responseEnd,l+=1;l<s.length;l++){var A=s[l],K=A.startTime;if(K>p)break;var re=A.transferSize,ie=A.initiatorType;re&&Bx(ie)&&(A=A.responseEnd,m+=re*(A<p?1:(p-K)/(A-K)))}if(--l,a+=8*(n+m)/(r.duration/1e3),t++,10<t)break}}if(0<t)return a/t/1e6}return navigator.connection&&(t=navigator.connection.downlink,typeof t=="number")?t:5}var $c=null,Qc=null;function yi(t){return t.nodeType===9?t:t.ownerDocument}function Hx(t){switch(t){case"http://www.w3.org/2000/svg":return 1;case"http://www.w3.org/1998/Math/MathML":return 2;default:return 0}}function Gx(t,a){if(t===0)switch(a){case"svg":return 1;case"math":return 2;default:return 0}return t===1&&a==="foreignObject"?0:t}function Yc(t,a){return t==="textarea"||t==="noscript"||typeof a.children=="string"||typeof a.children=="number"||typeof a.children=="bigint"||typeof a.dangerouslySetInnerHTML=="object"&&a.dangerouslySetInnerHTML!==null&&a.dangerouslySetInnerHTML.__html!=null}var Xc=null;function th(){var t=window.event;return t&&t.type==="popstate"?t===Xc?!1:(Xc=t,!0):(Xc=null,!1)}var $x=typeof setTimeout=="function"?setTimeout:void 0,ah=typeof clearTimeout=="function"?clearTimeout:void 0,Qx=typeof Promise=="function"?Promise:void 0,sh=typeof queueMicrotask=="function"?queueMicrotask:typeof Qx<"u"?function(t){return Qx.resolve(null).then(t).catch(lh)}:$x;function lh(t){setTimeout(function(){throw t})}function $s(t){return t==="head"}function Yx(t,a){var s=a,l=0;do{var r=s.nextSibling;if(t.removeChild(s),r&&r.nodeType===8)if(s=r.data,s==="/$"||s==="/&"){if(l===0){t.removeChild(r),or(a);return}l--}else if(s==="$"||s==="$?"||s==="$~"||s==="$!"||s==="&")l++;else if(s==="html")Ir(t.ownerDocument.documentElement);else if(s==="head"){s=t.ownerDocument.head,Ir(s);for(var n=s.firstChild;n;){var m=n.nextSibling,p=n.nodeName;n[pr]||p==="SCRIPT"||p==="STYLE"||p==="LINK"&&n.rel.toLowerCase()==="stylesheet"||s.removeChild(n),n=m}}else s==="body"&&Ir(t.ownerDocument.body);s=r}while(s);or(a)}function Xx(t,a){var s=t;t=0;do{var l=s.nextSibling;if(s.nodeType===1?a?(s._stashedDisplay=s.style.display,s.style.display="none"):(s.style.display=s._stashedDisplay||"",s.getAttribute("style")===""&&s.removeAttribute("style")):s.nodeType===3&&(a?(s._stashedText=s.nodeValue,s.nodeValue=""):s.nodeValue=s._stashedText||""),l&&l.nodeType===8)if(s=l.data,s==="/$"){if(t===0)break;t--}else s!=="$"&&s!=="$?"&&s!=="$~"&&s!=="$!"||t++;s=l}while(s)}function Zc(t){var a=t.firstChild;for(a&&a.nodeType===10&&(a=a.nextSibling);a;){var s=a;switch(a=a.nextSibling,s.nodeName){case"HTML":case"HEAD":case"BODY":Zc(s),Wi(s);continue;case"SCRIPT":case"STYLE":continue;case"LINK":if(s.rel.toLowerCase()==="stylesheet")continue}t.removeChild(s)}}function rh(t,a,s,l){for(;t.nodeType===1;){var r=s;if(t.nodeName.toLowerCase()!==a.toLowerCase()){if(!l&&(t.nodeName!=="INPUT"||t.type!=="hidden"))break}else if(l){if(!t[pr])switch(a){case"meta":if(!t.hasAttribute("itemprop"))break;return t;case"link":if(n=t.getAttribute("rel"),n==="stylesheet"&&t.hasAttribute("data-precedence"))break;if(n!==r.rel||t.getAttribute("href")!==(r.href==null||r.href===""?null:r.href)||t.getAttribute("crossorigin")!==(r.crossOrigin==null?null:r.crossOrigin)||t.getAttribute("title")!==(r.title==null?null:r.title))break;return t;case"style":if(t.hasAttribute("data-precedence"))break;return t;case"script":if(n=t.getAttribute("src"),(n!==(r.src==null?null:r.src)||t.getAttribute("type")!==(r.type==null?null:r.type)||t.getAttribute("crossorigin")!==(r.crossOrigin==null?null:r.crossOrigin))&&n&&t.hasAttribute("async")&&!t.hasAttribute("itemprop"))break;return t;default:return t}}else if(a==="input"&&t.type==="hidden"){var n=r.name==null?null:""+r.name;if(r.type==="hidden"&&t.getAttribute("name")===n)return t}else return t;if(t=Ga(t.nextSibling),t===null)break}return null}function nh(t,a,s){if(a==="")return null;for(;t.nodeType!==3;)if((t.nodeType!==1||t.nodeName!=="INPUT"||t.type!=="hidden")&&!s||(t=Ga(t.nextSibling),t===null))return null;return t}function Zx(t,a){for(;t.nodeType!==8;)if((t.nodeType!==1||t.nodeName!=="INPUT"||t.type!=="hidden")&&!a||(t=Ga(t.nextSibling),t===null))return null;return t}function Pc(t){return t.data==="$?"||t.data==="$~"}function Kc(t){return t.data==="$!"||t.data==="$?"&&t.ownerDocument.readyState!=="loading"}function ih(t,a){var s=t.ownerDocument;if(t.data==="$~")t._reactRetry=a;else if(t.data!=="$?"||s.readyState!=="loading")a();else{var l=function(){a(),s.removeEventListener("DOMContentLoaded",l)};s.addEventListener("DOMContentLoaded",l),t._reactRetry=l}}function Ga(t){for(;t!=null;t=t.nextSibling){var a=t.nodeType;if(a===1||a===3)break;if(a===8){if(a=t.data,a==="$"||a==="$!"||a==="$?"||a==="$~"||a==="&"||a==="F!"||a==="F")break;if(a==="/$"||a==="/&")return null}}return t}var Jc=null;function Px(t){t=t.nextSibling;for(var a=0;t;){if(t.nodeType===8){var s=t.data;if(s==="/$"||s==="/&"){if(a===0)return Ga(t.nextSibling);a--}else s!=="$"&&s!=="$!"&&s!=="$?"&&s!=="$~"&&s!=="&"||a++}t=t.nextSibling}return null}function Kx(t){t=t.previousSibling;for(var a=0;t;){if(t.nodeType===8){var s=t.data;if(s==="$"||s==="$!"||s==="$?"||s==="$~"||s==="&"){if(a===0)return t;a--}else s!=="/$"&&s!=="/&"||a++}t=t.previousSibling}return null}function Jx(t,a,s){switch(a=yi(s),t){case"html":if(t=a.documentElement,!t)throw Error(o(452));return t;case"head":if(t=a.head,!t)throw Error(o(453));return t;case"body":if(t=a.body,!t)throw Error(o(454));return t;default:throw Error(o(451))}}function Ir(t){for(var a=t.attributes;a.length;)t.removeAttributeNode(a[0]);Wi(t)}var $a=new Map,Wx=new Set;function ji(t){return typeof t.getRootNode=="function"?t.getRootNode():t.nodeType===9?t:t.ownerDocument}var _s=S.d;S.d={f:oh,r:ch,D:dh,C:uh,L:mh,m:xh,X:gh,S:fh,M:hh};function oh(){var t=_s.f(),a=ui();return t||a}function ch(t){var a=kl(t);a!==null&&a.tag===5&&a.type==="form"?gm(a):_s.r(t)}var rr=typeof document>"u"?null:document;function Ix(t,a,s){var l=rr;if(l&&typeof a=="string"&&a){var r=La(a);r='link[rel="'+t+'"][href="'+r+'"]',typeof s=="string"&&(r+='[crossorigin="'+s+'"]'),Wx.has(r)||(Wx.add(r),t={rel:t,crossOrigin:s,href:a},l.querySelector(r)===null&&(a=l.createElement("link"),ca(a,"link",t),la(a),l.head.appendChild(a)))}}function dh(t){_s.D(t),Ix("dns-prefetch",t,null)}function uh(t,a){_s.C(t,a),Ix("preconnect",t,a)}function mh(t,a,s){_s.L(t,a,s);var l=rr;if(l&&t&&a){var r='link[rel="preload"][as="'+La(a)+'"]';a==="image"&&s&&s.imageSrcSet?(r+='[imagesrcset="'+La(s.imageSrcSet)+'"]',typeof s.imageSizes=="string"&&(r+='[imagesizes="'+La(s.imageSizes)+'"]')):r+='[href="'+La(t)+'"]';var n=r;switch(a){case"style":n=nr(t);break;case"script":n=ir(t)}$a.has(n)||(t=v({rel:"preload",href:a==="image"&&s&&s.imageSrcSet?void 0:t,as:a},s),$a.set(n,t),l.querySelector(r)!==null||a==="style"&&l.querySelector(en(n))||a==="script"&&l.querySelector(tn(n))||(a=l.createElement("link"),ca(a,"link",t),la(a),l.head.appendChild(a)))}}function xh(t,a){_s.m(t,a);var s=rr;if(s&&t){var l=a&&typeof a.as=="string"?a.as:"script",r='link[rel="modulepreload"][as="'+La(l)+'"][href="'+La(t)+'"]',n=r;switch(l){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":n=ir(t)}if(!$a.has(n)&&(t=v({rel:"modulepreload",href:t},a),$a.set(n,t),s.querySelector(r)===null)){switch(l){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":if(s.querySelector(tn(n)))return}l=s.createElement("link"),ca(l,"link",t),la(l),s.head.appendChild(l)}}}function fh(t,a,s){_s.S(t,a,s);var l=rr;if(l&&t){var r=Cl(l).hoistableStyles,n=nr(t);a=a||"default";var m=r.get(n);if(!m){var p={loading:0,preload:null};if(m=l.querySelector(en(n)))p.loading=5;else{t=v({rel:"stylesheet",href:t,"data-precedence":a},s),(s=$a.get(n))&&Wc(t,s);var A=m=l.createElement("link");la(A),ca(A,"link",t),A._p=new Promise(function(K,re){A.onload=K,A.onerror=re}),A.addEventListener("load",function(){p.loading|=1}),A.addEventListener("error",function(){p.loading|=2}),p.loading|=4,vi(m,a,l)}m={type:"stylesheet",instance:m,count:1,state:p},r.set(n,m)}}}function gh(t,a){_s.X(t,a);var s=rr;if(s&&t){var l=Cl(s).hoistableScripts,r=ir(t),n=l.get(r);n||(n=s.querySelector(tn(r)),n||(t=v({src:t,async:!0},a),(a=$a.get(r))&&Ic(t,a),n=s.createElement("script"),la(n),ca(n,"link",t),s.head.appendChild(n)),n={type:"script",instance:n,count:1,state:null},l.set(r,n))}}function hh(t,a){_s.M(t,a);var s=rr;if(s&&t){var l=Cl(s).hoistableScripts,r=ir(t),n=l.get(r);n||(n=s.querySelector(tn(r)),n||(t=v({src:t,async:!0,type:"module"},a),(a=$a.get(r))&&Ic(t,a),n=s.createElement("script"),la(n),ca(n,"link",t),s.head.appendChild(n)),n={type:"script",instance:n,count:1,state:null},l.set(r,n))}}function e0(t,a,s,l){var r=(r=ce.current)?ji(r):null;if(!r)throw Error(o(446));switch(t){case"meta":case"title":return null;case"style":return typeof s.precedence=="string"&&typeof s.href=="string"?(a=nr(s.href),s=Cl(r).hoistableStyles,l=s.get(a),l||(l={type:"style",instance:null,count:0,state:null},s.set(a,l)),l):{type:"void",instance:null,count:0,state:null};case"link":if(s.rel==="stylesheet"&&typeof s.href=="string"&&typeof s.precedence=="string"){t=nr(s.href);var n=Cl(r).hoistableStyles,m=n.get(t);if(m||(r=r.ownerDocument||r,m={type:"stylesheet",instance:null,count:0,state:{loading:0,preload:null}},n.set(t,m),(n=r.querySelector(en(t)))&&!n._p&&(m.instance=n,m.state.loading=5),$a.has(t)||(s={rel:"preload",as:"style",href:s.href,crossOrigin:s.crossOrigin,integrity:s.integrity,media:s.media,hrefLang:s.hrefLang,referrerPolicy:s.referrerPolicy},$a.set(t,s),n||ph(r,t,s,m.state))),a&&l===null)throw Error(o(528,""));return m}if(a&&l!==null)throw Error(o(529,""));return null;case"script":return a=s.async,s=s.src,typeof s=="string"&&a&&typeof a!="function"&&typeof a!="symbol"?(a=ir(s),s=Cl(r).hoistableScripts,l=s.get(a),l||(l={type:"script",instance:null,count:0,state:null},s.set(a,l)),l):{type:"void",instance:null,count:0,state:null};default:throw Error(o(444,t))}}function nr(t){return'href="'+La(t)+'"'}function en(t){return'link[rel="stylesheet"]['+t+"]"}function t0(t){return v({},t,{"data-precedence":t.precedence,precedence:null})}function ph(t,a,s,l){t.querySelector('link[rel="preload"][as="style"]['+a+"]")?l.loading=1:(a=t.createElement("link"),l.preload=a,a.addEventListener("load",function(){return l.loading|=1}),a.addEventListener("error",function(){return l.loading|=2}),ca(a,"link",s),la(a),t.head.appendChild(a))}function ir(t){return'[src="'+La(t)+'"]'}function tn(t){return"script[async]"+t}function a0(t,a,s){if(a.count++,a.instance===null)switch(a.type){case"style":var l=t.querySelector('style[data-href~="'+La(s.href)+'"]');if(l)return a.instance=l,la(l),l;var r=v({},s,{"data-href":s.href,"data-precedence":s.precedence,href:null,precedence:null});return l=(t.ownerDocument||t).createElement("style"),la(l),ca(l,"style",r),vi(l,s.precedence,t),a.instance=l;case"stylesheet":r=nr(s.href);var n=t.querySelector(en(r));if(n)return a.state.loading|=4,a.instance=n,la(n),n;l=t0(s),(r=$a.get(r))&&Wc(l,r),n=(t.ownerDocument||t).createElement("link"),la(n);var m=n;return m._p=new Promise(function(p,A){m.onload=p,m.onerror=A}),ca(n,"link",l),a.state.loading|=4,vi(n,s.precedence,t),a.instance=n;case"script":return n=ir(s.src),(r=t.querySelector(tn(n)))?(a.instance=r,la(r),r):(l=s,(r=$a.get(n))&&(l=v({},s),Ic(l,r)),t=t.ownerDocument||t,r=t.createElement("script"),la(r),ca(r,"link",l),t.head.appendChild(r),a.instance=r);case"void":return null;default:throw Error(o(443,a.type))}else a.type==="stylesheet"&&(a.state.loading&4)===0&&(l=a.instance,a.state.loading|=4,vi(l,s.precedence,t));return a.instance}function vi(t,a,s){for(var l=s.querySelectorAll('link[rel="stylesheet"][data-precedence],style[data-precedence]'),r=l.length?l[l.length-1]:null,n=r,m=0;m<l.length;m++){var p=l[m];if(p.dataset.precedence===a)n=p;else if(n!==r)break}n?n.parentNode.insertBefore(t,n.nextSibling):(a=s.nodeType===9?s.head:s,a.insertBefore(t,a.firstChild))}function Wc(t,a){t.crossOrigin==null&&(t.crossOrigin=a.crossOrigin),t.referrerPolicy==null&&(t.referrerPolicy=a.referrerPolicy),t.title==null&&(t.title=a.title)}function Ic(t,a){t.crossOrigin==null&&(t.crossOrigin=a.crossOrigin),t.referrerPolicy==null&&(t.referrerPolicy=a.referrerPolicy),t.integrity==null&&(t.integrity=a.integrity)}var Ni=null;function s0(t,a,s){if(Ni===null){var l=new Map,r=Ni=new Map;r.set(s,l)}else r=Ni,l=r.get(s),l||(l=new Map,r.set(s,l));if(l.has(t))return l;for(l.set(t,null),s=s.getElementsByTagName(t),r=0;r<s.length;r++){var n=s[r];if(!(n[pr]||n[ke]||t==="link"&&n.getAttribute("rel")==="stylesheet")&&n.namespaceURI!=="http://www.w3.org/2000/svg"){var m=n.getAttribute(a)||"";m=t+m;var p=l.get(m);p?p.push(n):l.set(m,[n])}}return l}function l0(t,a,s){t=t.ownerDocument||t,t.head.insertBefore(s,a==="title"?t.querySelector("head > title"):null)}function bh(t,a,s){if(s===1||a.itemProp!=null)return!1;switch(t){case"meta":case"title":return!0;case"style":if(typeof a.precedence!="string"||typeof a.href!="string"||a.href==="")break;return!0;case"link":if(typeof a.rel!="string"||typeof a.href!="string"||a.href===""||a.onLoad||a.onError)break;switch(a.rel){case"stylesheet":return t=a.disabled,typeof a.precedence=="string"&&t==null;default:return!0}case"script":if(a.async&&typeof a.async!="function"&&typeof a.async!="symbol"&&!a.onLoad&&!a.onError&&a.src&&typeof a.src=="string")return!0}return!1}function r0(t){return!(t.type==="stylesheet"&&(t.state.loading&3)===0)}function yh(t,a,s,l){if(s.type==="stylesheet"&&(typeof l.media!="string"||matchMedia(l.media).matches!==!1)&&(s.state.loading&4)===0){if(s.instance===null){var r=nr(l.href),n=a.querySelector(en(r));if(n){a=n._p,a!==null&&typeof a=="object"&&typeof a.then=="function"&&(t.count++,t=wi.bind(t),a.then(t,t)),s.state.loading|=4,s.instance=n,la(n);return}n=a.ownerDocument||a,l=t0(l),(r=$a.get(r))&&Wc(l,r),n=n.createElement("link"),la(n);var m=n;m._p=new Promise(function(p,A){m.onload=p,m.onerror=A}),ca(n,"link",l),s.instance=n}t.stylesheets===null&&(t.stylesheets=new Map),t.stylesheets.set(s,a),(a=s.state.preload)&&(s.state.loading&3)===0&&(t.count++,s=wi.bind(t),a.addEventListener("load",s),a.addEventListener("error",s))}}var ed=0;function jh(t,a){return t.stylesheets&&t.count===0&&Si(t,t.stylesheets),0<t.count||0<t.imgCount?function(s){var l=setTimeout(function(){if(t.stylesheets&&Si(t,t.stylesheets),t.unsuspend){var n=t.unsuspend;t.unsuspend=null,n()}},6e4+a);0<t.imgBytes&&ed===0&&(ed=62500*eh());var r=setTimeout(function(){if(t.waitingForImages=!1,t.count===0&&(t.stylesheets&&Si(t,t.stylesheets),t.unsuspend)){var n=t.unsuspend;t.unsuspend=null,n()}},(t.imgBytes>ed?50:800)+a);return t.unsuspend=s,function(){t.unsuspend=null,clearTimeout(l),clearTimeout(r)}}:null}function wi(){if(this.count--,this.count===0&&(this.imgCount===0||!this.waitingForImages)){if(this.stylesheets)Si(this,this.stylesheets);else if(this.unsuspend){var t=this.unsuspend;this.unsuspend=null,t()}}}var _i=null;function Si(t,a){t.stylesheets=null,t.unsuspend!==null&&(t.count++,_i=new Map,a.forEach(vh,t),_i=null,wi.call(t))}function vh(t,a){if(!(a.state.loading&4)){var s=_i.get(t);if(s)var l=s.get(null);else{s=new Map,_i.set(t,s);for(var r=t.querySelectorAll("link[data-precedence],style[data-precedence]"),n=0;n<r.length;n++){var m=r[n];(m.nodeName==="LINK"||m.getAttribute("media")!=="not all")&&(s.set(m.dataset.precedence,m),l=m)}l&&s.set(null,l)}r=a.instance,m=r.getAttribute("data-precedence"),n=s.get(m)||l,n===l&&s.set(null,r),s.set(m,r),this.count++,l=wi.bind(this),r.addEventListener("load",l),r.addEventListener("error",l),n?n.parentNode.insertBefore(r,n.nextSibling):(t=t.nodeType===9?t.head:t,t.insertBefore(r,t.firstChild)),a.state.loading|=4}}var an={$$typeof:J,Provider:null,Consumer:null,_currentValue:V,_currentValue2:V,_threadCount:0};function Nh(t,a,s,l,r,n,m,p,A){this.tag=1,this.containerInfo=t,this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.next=this.pendingContext=this.context=this.cancelPendingCommit=null,this.callbackPriority=0,this.expirationTimes=De(-1),this.entangledLanes=this.shellSuspendCounter=this.errorRecoveryDisabledLanes=this.expiredLanes=this.warmLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=De(0),this.hiddenUpdates=De(null),this.identifierPrefix=l,this.onUncaughtError=r,this.onCaughtError=n,this.onRecoverableError=m,this.pooledCache=null,this.pooledCacheLanes=0,this.formState=A,this.incompleteTransitions=new Map}function n0(t,a,s,l,r,n,m,p,A,K,re,ie){return t=new Nh(t,a,s,m,A,K,re,ie,p),a=1,n===!0&&(a|=24),n=Sa(3,null,null,a),t.current=n,n.stateNode=t,a=Do(),a.refCount++,t.pooledCache=a,a.refCount++,n.memoizedState={element:l,isDehydrated:s,cache:a},Uo(n),t}function i0(t){return t?(t=Ol,t):Ol}function o0(t,a,s,l,r,n){r=i0(r),l.context===null?l.context=r:l.pendingContext=r,l=Ds(a),l.payload={element:s},n=n===void 0?null:n,n!==null&&(l.callback=n),s=Rs(t,l,a),s!==null&&(va(s,t,a),Rr(s,t,a))}function c0(t,a){if(t=t.memoizedState,t!==null&&t.dehydrated!==null){var s=t.retryLane;t.retryLane=s!==0&&s<a?s:a}}function td(t,a){c0(t,a),(t=t.alternate)&&c0(t,a)}function d0(t){if(t.tag===13||t.tag===31){var a=il(t,67108864);a!==null&&va(a,t,67108864),td(t,67108864)}}function u0(t){if(t.tag===13||t.tag===31){var a=Aa();a=Xa(a);var s=il(t,a);s!==null&&va(s,t,a),td(t,a)}}var zi=!0;function wh(t,a,s,l){var r=z.T;z.T=null;var n=S.p;try{S.p=2,ad(t,a,s,l)}finally{S.p=n,z.T=r}}function _h(t,a,s,l){var r=z.T;z.T=null;var n=S.p;try{S.p=8,ad(t,a,s,l)}finally{S.p=n,z.T=r}}function ad(t,a,s,l){if(zi){var r=sd(l);if(r===null)Hc(t,a,l,ki,s),x0(t,l);else if(zh(r,t,a,s,l))l.stopPropagation();else if(x0(t,l),a&4&&-1<Sh.indexOf(t)){for(;r!==null;){var n=kl(r);if(n!==null)switch(n.tag){case 3:if(n=n.stateNode,n.current.memoizedState.isDehydrated){var m=ee(n.pendingLanes);if(m!==0){var p=n;for(p.pendingLanes|=2,p.entangledLanes|=2;m;){var A=1<<31-Oe(m);p.entanglements[1]|=A,m&=~A}rs(n),(vt&6)===0&&(ci=Xe()+500,Kr(0))}}break;case 31:case 13:p=il(n,2),p!==null&&va(p,n,2),ui(),td(n,2)}if(n=sd(l),n===null&&Hc(t,a,l,ki,s),n===r)break;r=n}r!==null&&l.stopPropagation()}else Hc(t,a,l,null,s)}}function sd(t){return t=lo(t),ld(t)}var ki=null;function ld(t){if(ki=null,t=zl(t),t!==null){var a=y(t);if(a===null)t=null;else{var s=a.tag;if(s===13){if(t=N(a),t!==null)return t;t=null}else if(s===31){if(t=h(a),t!==null)return t;t=null}else if(s===3){if(a.stateNode.current.memoizedState.isDehydrated)return a.tag===3?a.stateNode.containerInfo:null;t=null}else a!==t&&(t=null)}}return ki=t,null}function m0(t){switch(t){case"beforetoggle":case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"toggle":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 2;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 8;case"message":switch(gt()){case Lt:return 2;case qt:return 8;case kt:case Rt:return 32;case Ce:return 268435456;default:return 32}default:return 32}}var rd=!1,Qs=null,Ys=null,Xs=null,sn=new Map,ln=new Map,Zs=[],Sh="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset".split(" ");function x0(t,a){switch(t){case"focusin":case"focusout":Qs=null;break;case"dragenter":case"dragleave":Ys=null;break;case"mouseover":case"mouseout":Xs=null;break;case"pointerover":case"pointerout":sn.delete(a.pointerId);break;case"gotpointercapture":case"lostpointercapture":ln.delete(a.pointerId)}}function rn(t,a,s,l,r,n){return t===null||t.nativeEvent!==n?(t={blockedOn:a,domEventName:s,eventSystemFlags:l,nativeEvent:n,targetContainers:[r]},a!==null&&(a=kl(a),a!==null&&d0(a)),t):(t.eventSystemFlags|=l,a=t.targetContainers,r!==null&&a.indexOf(r)===-1&&a.push(r),t)}function zh(t,a,s,l,r){switch(a){case"focusin":return Qs=rn(Qs,t,a,s,l,r),!0;case"dragenter":return Ys=rn(Ys,t,a,s,l,r),!0;case"mouseover":return Xs=rn(Xs,t,a,s,l,r),!0;case"pointerover":var n=r.pointerId;return sn.set(n,rn(sn.get(n)||null,t,a,s,l,r)),!0;case"gotpointercapture":return n=r.pointerId,ln.set(n,rn(ln.get(n)||null,t,a,s,l,r)),!0}return!1}function f0(t){var a=zl(t.target);if(a!==null){var s=y(a);if(s!==null){if(a=s.tag,a===13){if(a=N(s),a!==null){t.blockedOn=a,Ve(t.priority,function(){u0(s)});return}}else if(a===31){if(a=h(s),a!==null){t.blockedOn=a,Ve(t.priority,function(){u0(s)});return}}else if(a===3&&s.stateNode.current.memoizedState.isDehydrated){t.blockedOn=s.tag===3?s.stateNode.containerInfo:null;return}}}t.blockedOn=null}function Ci(t){if(t.blockedOn!==null)return!1;for(var a=t.targetContainers;0<a.length;){var s=sd(t.nativeEvent);if(s===null){s=t.nativeEvent;var l=new s.constructor(s.type,s);so=l,s.target.dispatchEvent(l),so=null}else return a=kl(s),a!==null&&d0(a),t.blockedOn=s,!1;a.shift()}return!0}function g0(t,a,s){Ci(t)&&s.delete(a)}function kh(){rd=!1,Qs!==null&&Ci(Qs)&&(Qs=null),Ys!==null&&Ci(Ys)&&(Ys=null),Xs!==null&&Ci(Xs)&&(Xs=null),sn.forEach(g0),ln.forEach(g0)}function Ei(t,a){t.blockedOn===a&&(t.blockedOn=null,rd||(rd=!0,i.unstable_scheduleCallback(i.unstable_NormalPriority,kh)))}var Ai=null;function h0(t){Ai!==t&&(Ai=t,i.unstable_scheduleCallback(i.unstable_NormalPriority,function(){Ai===t&&(Ai=null);for(var a=0;a<t.length;a+=3){var s=t[a],l=t[a+1],r=t[a+2];if(typeof l!="function"){if(ld(l||s)===null)continue;break}var n=kl(s);n!==null&&(t.splice(a,3),a-=3,sc(n,{pending:!0,data:r,method:s.method,action:l},l,r))}}))}function or(t){function a(A){return Ei(A,t)}Qs!==null&&Ei(Qs,t),Ys!==null&&Ei(Ys,t),Xs!==null&&Ei(Xs,t),sn.forEach(a),ln.forEach(a);for(var s=0;s<Zs.length;s++){var l=Zs[s];l.blockedOn===t&&(l.blockedOn=null)}for(;0<Zs.length&&(s=Zs[0],s.blockedOn===null);)f0(s),s.blockedOn===null&&Zs.shift();if(s=(t.ownerDocument||t).$$reactFormReplay,s!=null)for(l=0;l<s.length;l+=3){var r=s[l],n=s[l+1],m=r[Tt]||null;if(typeof n=="function")m||h0(s);else if(m){var p=null;if(n&&n.hasAttribute("formAction")){if(r=n,m=n[Tt]||null)p=m.formAction;else if(ld(r)!==null)continue}else p=m.action;typeof p=="function"?s[l+1]=p:(s.splice(l,3),l-=3),h0(s)}}}function p0(){function t(n){n.canIntercept&&n.info==="react-transition"&&n.intercept({handler:function(){return new Promise(function(m){return r=m})},focusReset:"manual",scroll:"manual"})}function a(){r!==null&&(r(),r=null),l||setTimeout(s,20)}function s(){if(!l&&!navigation.transition){var n=navigation.currentEntry;n&&n.url!=null&&navigation.navigate(n.url,{state:n.getState(),info:"react-transition",history:"replace"})}}if(typeof navigation=="object"){var l=!1,r=null;return navigation.addEventListener("navigate",t),navigation.addEventListener("navigatesuccess",a),navigation.addEventListener("navigateerror",a),setTimeout(s,100),function(){l=!0,navigation.removeEventListener("navigate",t),navigation.removeEventListener("navigatesuccess",a),navigation.removeEventListener("navigateerror",a),r!==null&&(r(),r=null)}}}function nd(t){this._internalRoot=t}qi.prototype.render=nd.prototype.render=function(t){var a=this._internalRoot;if(a===null)throw Error(o(409));var s=a.current,l=Aa();o0(s,l,t,a,null,null)},qi.prototype.unmount=nd.prototype.unmount=function(){var t=this._internalRoot;if(t!==null){this._internalRoot=null;var a=t.containerInfo;o0(t.current,2,null,t,null,null),ui(),a[ua]=null}};function qi(t){this._internalRoot=t}qi.prototype.unstable_scheduleHydration=function(t){if(t){var a=Za();t={blockedOn:null,target:t,priority:a};for(var s=0;s<Zs.length&&a!==0&&a<Zs[s].priority;s++);Zs.splice(s,0,t),s===0&&f0(t)}};var b0=u.version;if(b0!=="19.2.3")throw Error(o(527,b0,"19.2.3"));S.findDOMNode=function(t){var a=t._reactInternals;if(a===void 0)throw typeof t.render=="function"?Error(o(188)):(t=Object.keys(t).join(","),Error(o(268,t)));return t=E(a),t=t!==null?d(t):null,t=t===null?null:t.stateNode,t};var Ch={bundleType:0,version:"19.2.3",rendererPackageName:"react-dom",currentDispatcherRef:z,reconcilerVersion:"19.2.3"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var Mi=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!Mi.isDisabled&&Mi.supportsFiber)try{Q=Mi.inject(Ch),be=Mi}catch{}}return on.createRoot=function(t,a){if(!x(t))throw Error(o(299));var s=!1,l="",r=Sm,n=zm,m=km;return a!=null&&(a.unstable_strictMode===!0&&(s=!0),a.identifierPrefix!==void 0&&(l=a.identifierPrefix),a.onUncaughtError!==void 0&&(r=a.onUncaughtError),a.onCaughtError!==void 0&&(n=a.onCaughtError),a.onRecoverableError!==void 0&&(m=a.onRecoverableError)),a=n0(t,1,!1,null,null,s,l,null,r,n,m,p0),t[ua]=a.current,Bc(t),new nd(a)},on.hydrateRoot=function(t,a,s){if(!x(t))throw Error(o(299));var l=!1,r="",n=Sm,m=zm,p=km,A=null;return s!=null&&(s.unstable_strictMode===!0&&(l=!0),s.identifierPrefix!==void 0&&(r=s.identifierPrefix),s.onUncaughtError!==void 0&&(n=s.onUncaughtError),s.onCaughtError!==void 0&&(m=s.onCaughtError),s.onRecoverableError!==void 0&&(p=s.onRecoverableError),s.formState!==void 0&&(A=s.formState)),a=n0(t,1,!0,a,s??null,l,r,A,n,m,p,p0),a.context=i0(null),s=a.current,l=Aa(),l=Xa(l),r=Ds(l),r.callback=null,Rs(s,r,l),s=l,a.current.lanes=s,qe(a,s),rs(a),t[ua]=a.current,Bc(t),new qi(a)},on.version="19.2.3",on}var _0;function Hh(){if(_0)return od.exports;_0=1;function i(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(i)}catch(u){console.error(u)}}return i(),od.exports=Bh(),od.exports}var Gh=Hh();const $0=c.createContext(void 0);function $h({children:i}){const[u,f]=c.useState([]),o=c.useCallback((E,d="info",v)=>{const b=`toast-${Date.now()}-${Math.random()}`,w={id:b,message:E,type:d,duration:v};return f(_=>[..._,w]),b},[]),x=c.useCallback(E=>{f(d=>d.filter(v=>v.id!==E))},[]),y=c.useCallback((E,d)=>o(E,"success",d),[o]),N=c.useCallback((E,d)=>o(E,"error",d),[o]),h=c.useCallback((E,d)=>o(E,"warning",d),[o]),g=c.useCallback((E,d)=>o(E,"info",d),[o]);return e.jsx($0.Provider,{value:{showToast:o,success:y,error:N,warning:h,info:g,toasts:u,removeToast:x},children:i})}function sa(){const i=c.useContext($0);if(!i)throw new Error("useToastContext must be used within a ToastProvider");return i}/**
 * @license lucide-react v0.460.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Qh=i=>i.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase(),Q0=(...i)=>i.filter((u,f,o)=>!!u&&u.trim()!==""&&o.indexOf(u)===f).join(" ").trim();/**
 * @license lucide-react v0.460.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */var Yh={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};/**
 * @license lucide-react v0.460.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Xh=c.forwardRef(({color:i="currentColor",size:u=24,strokeWidth:f=2,absoluteStrokeWidth:o,className:x="",children:y,iconNode:N,...h},g)=>c.createElement("svg",{ref:g,...Yh,width:u,height:u,stroke:i,strokeWidth:o?Number(f)*24/Number(u):f,className:Q0("lucide",x),...h},[...N.map(([E,d])=>c.createElement(E,d)),...Array.isArray(y)?y:[y]]));/**
 * @license lucide-react v0.460.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const me=(i,u)=>{const f=c.forwardRef(({className:o,...x},y)=>c.createElement(Xh,{ref:y,iconNode:u,className:Q0(`lucide-${Qh(i)}`,o),...x}));return f.displayName=`${i}`,f};/**
 * @license lucide-react v0.460.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Wt=me("ArrowLeft",[["path",{d:"m12 19-7-7 7-7",key:"1l729n"}],["path",{d:"M19 12H5",key:"x3x0zl"}]]);/**
 * @license lucide-react v0.460.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const vl=me("ArrowRight",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"m12 5 7 7-7 7",key:"xquz4c"}]]);/**
 * @license lucide-react v0.460.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Y0=me("ArrowUpRight",[["path",{d:"M7 7h10v10",key:"1tivn9"}],["path",{d:"M7 17 17 7",key:"1vkiza"}]]);/**
 * @license lucide-react v0.460.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Sl=me("Award",[["path",{d:"m15.477 12.89 1.515 8.526a.5.5 0 0 1-.81.47l-3.58-2.687a1 1 0 0 0-1.197 0l-3.586 2.686a.5.5 0 0 1-.81-.469l1.514-8.526",key:"1yiouv"}],["circle",{cx:"12",cy:"8",r:"6",key:"1vp47v"}]]);/**
 * @license lucide-react v0.460.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Zh=me("BadgeCheck",[["path",{d:"M3.85 8.62a4 4 0 0 1 4.78-4.77 4 4 0 0 1 6.74 0 4 4 0 0 1 4.78 4.78 4 4 0 0 1 0 6.74 4 4 0 0 1-4.77 4.78 4 4 0 0 1-6.75 0 4 4 0 0 1-4.78-4.77 4 4 0 0 1 0-6.76Z",key:"3c2336"}],["path",{d:"m9 12 2 2 4-4",key:"dzmm74"}]]);/**
 * @license lucide-react v0.460.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ur=me("Bell",[["path",{d:"M6 8a6 6 0 0 1 12 0c0 7 3 9 3 9H3s3-2 3-9",key:"1qo2s2"}],["path",{d:"M10.3 21a1.94 1.94 0 0 0 3.4 0",key:"qgo35s"}]]);/**
 * @license lucide-react v0.460.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ph=me("Bike",[["circle",{cx:"18.5",cy:"17.5",r:"3.5",key:"15x4ox"}],["circle",{cx:"5.5",cy:"17.5",r:"3.5",key:"1noe27"}],["circle",{cx:"15",cy:"5",r:"1",key:"19l28e"}],["path",{d:"M12 17.5V14l-3-3 4-3 2 3h2",key:"1npguv"}]]);/**
 * @license lucide-react v0.460.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Kh=me("Brain",[["path",{d:"M12 5a3 3 0 1 0-5.997.125 4 4 0 0 0-2.526 5.77 4 4 0 0 0 .556 6.588A4 4 0 1 0 12 18Z",key:"l5xja"}],["path",{d:"M12 5a3 3 0 1 1 5.997.125 4 4 0 0 1 2.526 5.77 4 4 0 0 1-.556 6.588A4 4 0 1 1 12 18Z",key:"ep3f8r"}],["path",{d:"M15 13a4.5 4.5 0 0 1-3-4 4.5 4.5 0 0 1-3 4",key:"1p4c4q"}],["path",{d:"M17.599 6.5a3 3 0 0 0 .399-1.375",key:"tmeiqw"}],["path",{d:"M6.003 5.125A3 3 0 0 0 6.401 6.5",key:"105sqy"}],["path",{d:"M3.477 10.896a4 4 0 0 1 .585-.396",key:"ql3yin"}],["path",{d:"M19.938 10.5a4 4 0 0 1 .585.396",key:"1qfode"}],["path",{d:"M6 18a4 4 0 0 1-1.967-.516",key:"2e4loj"}],["path",{d:"M19.967 17.484A4 4 0 0 1 18 18",key:"159ez6"}]]);/**
 * @license lucide-react v0.460.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ht=me("Briefcase",[["path",{d:"M16 20V4a2 2 0 0 0-2-2h-4a2 2 0 0 0-2 2v16",key:"jecpp"}],["rect",{width:"20",height:"14",x:"2",y:"6",rx:"2",key:"i6l2r4"}]]);/**
 * @license lucide-react v0.460.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Qa=me("Building2",[["path",{d:"M6 22V4a2 2 0 0 1 2-2h8a2 2 0 0 1 2 2v18Z",key:"1b4qmf"}],["path",{d:"M6 12H4a2 2 0 0 0-2 2v6a2 2 0 0 0 2 2h2",key:"i71pzd"}],["path",{d:"M18 9h2a2 2 0 0 1 2 2v9a2 2 0 0 1-2 2h-2",key:"10jefs"}],["path",{d:"M10 6h4",key:"1itunk"}],["path",{d:"M10 10h4",key:"tcdvrf"}],["path",{d:"M10 14h4",key:"kelpxr"}],["path",{d:"M10 18h4",key:"1ulq68"}]]);/**
 * @license lucide-react v0.460.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const mr=me("Calendar",[["path",{d:"M8 2v4",key:"1cmpym"}],["path",{d:"M16 2v4",key:"4m81vk"}],["rect",{width:"18",height:"18",x:"3",y:"4",rx:"2",key:"1hopcy"}],["path",{d:"M3 10h18",key:"8toen8"}]]);/**
 * @license lucide-react v0.460.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const un=me("Camera",[["path",{d:"M14.5 4h-5L7 7H4a2 2 0 0 0-2 2v9a2 2 0 0 0 2 2h16a2 2 0 0 0 2-2V9a2 2 0 0 0-2-2h-3l-2.5-3z",key:"1tc9qg"}],["circle",{cx:"12",cy:"13",r:"3",key:"1vg3eu"}]]);/**
 * @license lucide-react v0.460.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Jh=me("Car",[["path",{d:"M19 17h2c.6 0 1-.4 1-1v-3c0-.9-.7-1.7-1.5-1.9C18.7 10.6 16 10 16 10s-1.3-1.4-2.2-2.3c-.5-.4-1.1-.7-1.8-.7H5c-.6 0-1.1.4-1.4.9l-1.4 2.9A3.7 3.7 0 0 0 2 12v4c0 .6.4 1 1 1h2",key:"5owen"}],["circle",{cx:"7",cy:"17",r:"2",key:"u2ysq9"}],["path",{d:"M9 17h6",key:"r8uit2"}],["circle",{cx:"17",cy:"17",r:"2",key:"axvx0g"}]]);/**
 * @license lucide-react v0.460.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Wh=me("ChartColumn",[["path",{d:"M3 3v16a2 2 0 0 0 2 2h16",key:"c24i48"}],["path",{d:"M18 17V9",key:"2bz60n"}],["path",{d:"M13 17V5",key:"1frdt8"}],["path",{d:"M8 17v-3",key:"17ska0"}]]);/**
 * @license lucide-react v0.460.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const bd=me("CheckCheck",[["path",{d:"M18 6 7 17l-5-5",key:"116fxf"}],["path",{d:"m22 10-7.5 7.5L13 16",key:"ke71qq"}]]);/**
 * @license lucide-react v0.460.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const aa=me("Check",[["path",{d:"M20 6 9 17l-5-5",key:"1gmf2c"}]]);/**
 * @license lucide-react v0.460.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ih=me("ChefHat",[["path",{d:"M17 21a1 1 0 0 0 1-1v-5.35c0-.457.316-.844.727-1.041a4 4 0 0 0-2.134-7.589 5 5 0 0 0-9.186 0 4 4 0 0 0-2.134 7.588c.411.198.727.585.727 1.041V20a1 1 0 0 0 1 1Z",key:"1qvrer"}],["path",{d:"M6 17h12",key:"1jwigz"}]]);/**
 * @license lucide-react v0.460.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const yd=me("ChevronDown",[["path",{d:"m6 9 6 6 6-6",key:"qrunsl"}]]);/**
 * @license lucide-react v0.460.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const X0=me("ChevronLeft",[["path",{d:"m15 18-6-6 6-6",key:"1wnfg3"}]]);/**
 * @license lucide-react v0.460.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const da=me("ChevronRight",[["path",{d:"m9 18 6-6-6-6",key:"mthhwq"}]]);/**
 * @license lucide-react v0.460.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const jd=me("ChevronUp",[["path",{d:"m18 15-6-6-6 6",key:"153udz"}]]);/**
 * @license lucide-react v0.460.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const qa=me("CircleAlert",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["line",{x1:"12",x2:"12",y1:"8",y2:"12",key:"1pkeuh"}],["line",{x1:"12",x2:"12.01",y1:"16",y2:"16",key:"4dfq90"}]]);/**
 * @license lucide-react v0.460.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Qe=me("CircleCheckBig",[["path",{d:"M21.801 10A10 10 0 1 1 17 3.335",key:"yps3ct"}],["path",{d:"m9 11 3 3L22 4",key:"1pflzl"}]]);/**
 * @license lucide-react v0.460.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Bi=me("CirclePlus",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M8 12h8",key:"1wcyev"}],["path",{d:"M12 8v8",key:"napkw2"}]]);/**
 * @license lucide-react v0.460.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const el=me("CircleX",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m15 9-6 6",key:"1uzhvr"}],["path",{d:"m9 9 6 6",key:"z0biqf"}]]);/**
 * @license lucide-react v0.460.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ep=me("Circle",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}]]);/**
 * @license lucide-react v0.460.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const St=me("Clock",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["polyline",{points:"12 6 12 12 16 14",key:"68esgv"}]]);/**
 * @license lucide-react v0.460.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const tp=me("CloudLightning",[["path",{d:"M6 16.326A7 7 0 1 1 15.71 8h1.79a4.5 4.5 0 0 1 .5 8.973",key:"1cez44"}],["path",{d:"m13 12-3 5h4l-3 5",key:"1t22er"}]]);/**
 * @license lucide-react v0.460.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ap=me("CloudUpload",[["path",{d:"M12 13v8",key:"1l5pq0"}],["path",{d:"M4 14.899A7 7 0 1 1 15.71 8h1.79a4.5 4.5 0 0 1 2.5 8.242",key:"1pljnt"}],["path",{d:"m8 17 4-4 4 4",key:"1quai1"}]]);/**
 * @license lucide-react v0.460.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ud=me("Code",[["polyline",{points:"16 18 22 12 16 6",key:"z7tu5w"}],["polyline",{points:"8 6 2 12 8 18",key:"1eg1df"}]]);/**
 * @license lucide-react v0.460.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const sp=me("Copy",[["rect",{width:"14",height:"14",x:"8",y:"8",rx:"2",ry:"2",key:"17jyea"}],["path",{d:"M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2",key:"zix9uf"}]]);/**
 * @license lucide-react v0.460.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Na=me("CreditCard",[["rect",{width:"20",height:"14",x:"2",y:"5",rx:"2",key:"ynyp8z"}],["line",{x1:"2",x2:"22",y1:"10",y2:"10",key:"1b3vmo"}]]);/**
 * @license lucide-react v0.460.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ss=me("DollarSign",[["line",{x1:"12",x2:"12",y1:"2",y2:"22",key:"7eqyqh"}],["path",{d:"M17 5H9.5a3.5 3.5 0 0 0 0 7h5a3.5 3.5 0 0 1 0 7H6",key:"1b0p4s"}]]);/**
 * @license lucide-react v0.460.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const mn=me("Download",[["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["polyline",{points:"7 10 12 15 17 10",key:"2ggqvy"}],["line",{x1:"12",x2:"12",y1:"15",y2:"3",key:"1vk2je"}]]);/**
 * @license lucide-react v0.460.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const lp=me("Droplets",[["path",{d:"M7 16.3c2.2 0 4-1.83 4-4.05 0-1.16-.57-2.26-1.71-3.19S7.29 6.75 7 5.3c-.29 1.45-1.14 2.84-2.29 3.76S3 11.1 3 12.25c0 2.22 1.8 4.05 4 4.05z",key:"1ptgy4"}],["path",{d:"M12.56 6.6A10.97 10.97 0 0 0 14 3.02c.5 2.5 2 4.9 4 6.5s3 3.5 3 5.5a6.98 6.98 0 0 1-11.91 4.97",key:"1sl1rz"}]]);/**
 * @license lucide-react v0.460.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Z0=me("EllipsisVertical",[["circle",{cx:"12",cy:"12",r:"1",key:"41hilf"}],["circle",{cx:"12",cy:"5",r:"1",key:"gxeob9"}],["circle",{cx:"12",cy:"19",r:"1",key:"lyex9k"}]]);/**
 * @license lucide-react v0.460.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Hi=me("ExternalLink",[["path",{d:"M15 3h6v6",key:"1q9fwt"}],["path",{d:"M10 14 21 3",key:"gplh6r"}],["path",{d:"M18 13v6a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h6",key:"a6xqqp"}]]);/**
 * @license lucide-react v0.460.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const rp=me("Eye",[["path",{d:"M2.062 12.348a1 1 0 0 1 0-.696 10.75 10.75 0 0 1 19.876 0 1 1 0 0 1 0 .696 10.75 10.75 0 0 1-19.876 0",key:"1nclc0"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]]);/**
 * @license lucide-react v0.460.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const et=me("FileText",[["path",{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z",key:"1rqfz7"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}],["path",{d:"M10 9H8",key:"b1mrlr"}],["path",{d:"M16 13H8",key:"t4e002"}],["path",{d:"M16 17H8",key:"z1uh3a"}]]);/**
 * @license lucide-react v0.460.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Di=me("Globe",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M12 2a14.5 14.5 0 0 0 0 20 14.5 14.5 0 0 0 0-20",key:"13o1zl"}],["path",{d:"M2 12h20",key:"9i4pu4"}]]);/**
 * @license lucide-react v0.460.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const S0=me("Hammer",[["path",{d:"m15 12-8.373 8.373a1 1 0 1 1-3-3L12 9",key:"eefl8a"}],["path",{d:"m18 15 4-4",key:"16gjal"}],["path",{d:"m21.5 11.5-1.914-1.914A2 2 0 0 1 19 8.172V7l-2.26-2.26a6 6 0 0 0-4.202-1.756L9 2.96l.92.82A6.18 6.18 0 0 1 12 8.4V10l2 2h1.172a2 2 0 0 1 1.414.586L18.5 14.5",key:"b7pghm"}]]);/**
 * @license lucide-react v0.460.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const z0=me("Handshake",[["path",{d:"m11 17 2 2a1 1 0 1 0 3-3",key:"efffak"}],["path",{d:"m14 14 2.5 2.5a1 1 0 1 0 3-3l-3.88-3.88a3 3 0 0 0-4.24 0l-.88.88a1 1 0 1 1-3-3l2.81-2.81a5.79 5.79 0 0 1 7.06-.87l.47.28a2 2 0 0 0 1.42.25L21 4",key:"9pr0kb"}],["path",{d:"m21 3 1 11h-2",key:"1tisrp"}],["path",{d:"M3 3 2 14l6.5 6.5a1 1 0 1 0 3-3",key:"1uvwmv"}],["path",{d:"M3 4h8",key:"1ep09j"}]]);/**
 * @license lucide-react v0.460.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const np=me("HardHat",[["path",{d:"M10 10V5a1 1 0 0 1 1-1h2a1 1 0 0 1 1 1v5",key:"1p9q5i"}],["path",{d:"M14 6a6 6 0 0 1 6 6v3",key:"1hnv84"}],["path",{d:"M4 15v-3a6 6 0 0 1 6-6",key:"9ciidu"}],["rect",{x:"2",y:"15",width:"20",height:"4",rx:"1",key:"g3x8cw"}]]);/**
 * @license lucide-react v0.460.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ip=me("Hash",[["line",{x1:"4",x2:"20",y1:"9",y2:"9",key:"4lhtct"}],["line",{x1:"4",x2:"20",y1:"15",y2:"15",key:"vyu0kd"}],["line",{x1:"10",x2:"8",y1:"3",y2:"21",key:"1ggp8o"}],["line",{x1:"16",x2:"14",y1:"3",y2:"21",key:"weycgp"}]]);/**
 * @license lucide-react v0.460.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const xn=me("Heart",[["path",{d:"M19 14c1.49-1.46 3-3.21 3-5.5A5.5 5.5 0 0 0 16.5 3c-1.76 0-3 .5-4.5 2-1.5-1.5-2.74-2-4.5-2A5.5 5.5 0 0 0 2 8.5c0 2.3 1.5 4.05 3 5.5l7 7Z",key:"c3ymky"}]]);/**
 * @license lucide-react v0.460.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const xr=me("House",[["path",{d:"M15 21v-8a1 1 0 0 0-1-1h-4a1 1 0 0 0-1 1v8",key:"5wwlr5"}],["path",{d:"M3 10a2 2 0 0 1 .709-1.528l7-5.999a2 2 0 0 1 2.582 0l7 5.999A2 2 0 0 1 21 10v9a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2z",key:"1d0kgt"}]]);/**
 * @license lucide-react v0.460.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const tl=me("Image",[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",ry:"2",key:"1m3agn"}],["circle",{cx:"9",cy:"9",r:"2",key:"af1f0g"}],["path",{d:"m21 15-3.086-3.086a2 2 0 0 0-2.828 0L6 21",key:"1xmnt7"}]]);/**
 * @license lucide-react v0.460.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const fn=me("Info",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M12 16v-4",key:"1dtifu"}],["path",{d:"M12 8h.01",key:"e9boi3"}]]);/**
 * @license lucide-react v0.460.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const op=me("LayoutDashboard",[["rect",{width:"7",height:"9",x:"3",y:"3",rx:"1",key:"10lvy0"}],["rect",{width:"7",height:"5",x:"14",y:"3",rx:"1",key:"16une8"}],["rect",{width:"7",height:"9",x:"14",y:"12",rx:"1",key:"1hutg5"}],["rect",{width:"7",height:"5",x:"3",y:"16",rx:"1",key:"ldoo1y"}]]);/**
 * @license lucide-react v0.460.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const P0=me("Lightbulb",[["path",{d:"M15 14c.2-1 .7-1.7 1.5-2.5 1-.9 1.5-2.2 1.5-3.5A6 6 0 0 0 6 8c0 1 .2 2.2 1.5 3.5.7.7 1.3 1.5 1.5 2.5",key:"1gvzjb"}],["path",{d:"M9 18h6",key:"x1upvd"}],["path",{d:"M10 22h4",key:"ceow96"}]]);/**
 * @license lucide-react v0.460.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ma=me("LoaderCircle",[["path",{d:"M21 12a9 9 0 1 1-6.219-8.56",key:"13zald"}]]);/**
 * @license lucide-react v0.460.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const cp=me("LockOpen",[["rect",{width:"18",height:"11",x:"3",y:"11",rx:"2",ry:"2",key:"1w4ew1"}],["path",{d:"M7 11V7a5 5 0 0 1 9.9-1",key:"1mm8w8"}]]);/**
 * @license lucide-react v0.460.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const dp=me("Lock",[["rect",{width:"18",height:"11",x:"3",y:"11",rx:"2",ry:"2",key:"1w4ew1"}],["path",{d:"M7 11V7a5 5 0 0 1 10 0v4",key:"fwvmzm"}]]);/**
 * @license lucide-react v0.460.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const K0=me("LogOut",[["path",{d:"M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4",key:"1uf3rs"}],["polyline",{points:"16 17 21 12 16 7",key:"1gabdz"}],["line",{x1:"21",x2:"9",y1:"12",y2:"12",key:"1uyos4"}]]);/**
 * @license lucide-react v0.460.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Zi=me("Mail",[["rect",{width:"20",height:"16",x:"2",y:"4",rx:"2",key:"18n3k1"}],["path",{d:"m22 7-8.97 5.7a1.94 1.94 0 0 1-2.06 0L2 7",key:"1ocrg3"}]]);/**
 * @license lucide-react v0.460.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ga=me("MapPin",[["path",{d:"M20 10c0 4.993-5.539 10.193-7.399 11.799a1 1 0 0 1-1.202 0C9.539 20.193 4 14.993 4 10a8 8 0 0 1 16 0",key:"1r0f0z"}],["circle",{cx:"12",cy:"10",r:"3",key:"ilqhr7"}]]);/**
 * @license lucide-react v0.460.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const es=me("MessageCircle",[["path",{d:"M7.9 20A9 9 0 1 0 4 16.1L2 22Z",key:"vv11sd"}]]);/**
 * @license lucide-react v0.460.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const fr=me("MessageSquare",[["path",{d:"M21 15a2 2 0 0 1-2 2H7l-4 4V5a2 2 0 0 1 2-2h14a2 2 0 0 1 2 2z",key:"1lielz"}]]);/**
 * @license lucide-react v0.460.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const gn=me("Mic",[["path",{d:"M12 2a3 3 0 0 0-3 3v7a3 3 0 0 0 6 0V5a3 3 0 0 0-3-3Z",key:"131961"}],["path",{d:"M19 10v2a7 7 0 0 1-14 0v-2",key:"1vc78b"}],["line",{x1:"12",x2:"12",y1:"19",y2:"22",key:"x3vr5v"}]]);/**
 * @license lucide-react v0.460.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const up=me("Network",[["rect",{x:"16",y:"16",width:"6",height:"6",rx:"1",key:"4q2zg0"}],["rect",{x:"2",y:"16",width:"6",height:"6",rx:"1",key:"8cvhb9"}],["rect",{x:"9",y:"2",width:"6",height:"6",rx:"1",key:"1egb70"}],["path",{d:"M5 16v-3a1 1 0 0 1 1-1h12a1 1 0 0 1 1 1v3",key:"1jsf9p"}],["path",{d:"M12 12V8",key:"2874zd"}]]);/**
 * @license lucide-react v0.460.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const mp=me("Package",[["path",{d:"M11 21.73a2 2 0 0 0 2 0l7-4A2 2 0 0 0 21 16V8a2 2 0 0 0-1-1.73l-7-4a2 2 0 0 0-2 0l-7 4A2 2 0 0 0 3 8v8a2 2 0 0 0 1 1.73z",key:"1a0edw"}],["path",{d:"M12 22V12",key:"d0xqtd"}],["path",{d:"m3.3 7 7.703 4.734a2 2 0 0 0 1.994 0L20.7 7",key:"yx3hmr"}],["path",{d:"m7.5 4.27 9 5.15",key:"1c824w"}]]);/**
 * @license lucide-react v0.460.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const xp=me("PaintBucket",[["path",{d:"m19 11-8-8-8.6 8.6a2 2 0 0 0 0 2.8l5.2 5.2c.8.8 2 .8 2.8 0L19 11Z",key:"irua1i"}],["path",{d:"m5 2 5 5",key:"1lls2c"}],["path",{d:"M2 13h15",key:"1hkzvu"}],["path",{d:"M22 20a2 2 0 1 1-4 0c0-1.6 1.7-2.4 2-4 .3 1.6 2 2.4 2 4Z",key:"xk76lq"}]]);/**
 * @license lucide-react v0.460.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const fp=me("Pause",[["rect",{x:"14",y:"4",width:"4",height:"16",rx:"1",key:"zuxfzm"}],["rect",{x:"6",y:"4",width:"4",height:"16",rx:"1",key:"1okwgv"}]]);/**
 * @license lucide-react v0.460.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const gp=me("Pencil",[["path",{d:"M21.174 6.812a1 1 0 0 0-3.986-3.987L3.842 16.174a2 2 0 0 0-.5.83l-1.321 4.352a.5.5 0 0 0 .623.622l4.353-1.32a2 2 0 0 0 .83-.497z",key:"1a8usu"}],["path",{d:"m15 5 4 4",key:"1mk7zo"}]]);/**
 * @license lucide-react v0.460.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ri=me("PhoneOff",[["path",{d:"M10.68 13.31a16 16 0 0 0 3.41 2.6l1.27-1.27a2 2 0 0 1 2.11-.45 12.84 12.84 0 0 0 2.81.7 2 2 0 0 1 1.72 2v3a2 2 0 0 1-2.18 2 19.79 19.79 0 0 1-8.63-3.07 19.42 19.42 0 0 1-3.33-2.67m-2.67-3.34a19.79 19.79 0 0 1-3.07-8.63A2 2 0 0 1 4.11 2h3a2 2 0 0 1 2 1.72 12.84 12.84 0 0 0 .7 2.81 2 2 0 0 1-.45 2.11L8.09 9.91",key:"z86iuo"}],["line",{x1:"22",x2:"2",y1:"2",y2:"22",key:"11kh81"}]]);/**
 * @license lucide-react v0.460.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const hn=me("Phone",[["path",{d:"M22 16.92v3a2 2 0 0 1-2.18 2 19.79 19.79 0 0 1-8.63-3.07 19.5 19.5 0 0 1-6-6 19.79 19.79 0 0 1-3.07-8.67A2 2 0 0 1 4.11 2h3a2 2 0 0 1 2 1.72 12.84 12.84 0 0 0 .7 2.81 2 2 0 0 1-.45 2.11L8.09 9.91a16 16 0 0 0 6 6l1.27-1.27a2 2 0 0 1 2.11-.45 12.84 12.84 0 0 0 2.81.7A2 2 0 0 1 22 16.92z",key:"foiqr5"}]]);/**
 * @license lucide-react v0.460.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Nl=me("Play",[["polygon",{points:"6 3 20 12 6 21 6 3",key:"1oa8hb"}]]);/**
 * @license lucide-react v0.460.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const hp=me("Plus",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]]);/**
 * @license lucide-react v0.460.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const pp=me("Printer",[["path",{d:"M6 18H4a2 2 0 0 1-2-2v-5a2 2 0 0 1 2-2h16a2 2 0 0 1 2 2v5a2 2 0 0 1-2 2h-2",key:"143wyd"}],["path",{d:"M6 9V3a1 1 0 0 1 1-1h10a1 1 0 0 1 1 1v6",key:"1itne7"}],["rect",{x:"6",y:"14",width:"12",height:"8",rx:"1",key:"1ue0tg"}]]);/**
 * @license lucide-react v0.460.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const bp=me("Quote",[["path",{d:"M16 3a2 2 0 0 0-2 2v6a2 2 0 0 0 2 2 1 1 0 0 1 1 1v1a2 2 0 0 1-2 2 1 1 0 0 0-1 1v2a1 1 0 0 0 1 1 6 6 0 0 0 6-6V5a2 2 0 0 0-2-2z",key:"rib7q0"}],["path",{d:"M5 3a2 2 0 0 0-2 2v6a2 2 0 0 0 2 2 1 1 0 0 1 1 1v1a2 2 0 0 1-2 2 1 1 0 0 0-1 1v2a1 1 0 0 0 1 1 6 6 0 0 0 6-6V5a2 2 0 0 0-2-2z",key:"1ymkrd"}]]);/**
 * @license lucide-react v0.460.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const J0=me("Receipt",[["path",{d:"M4 2v20l2-1 2 1 2-1 2 1 2-1 2 1 2-1 2 1V2l-2 1-2-1-2 1-2-1-2 1-2-1-2 1Z",key:"q3az6g"}],["path",{d:"M16 8h-6a2 2 0 1 0 0 4h4a2 2 0 1 1 0 4H8",key:"1h4pet"}],["path",{d:"M12 17.5v-11",key:"1jc1ny"}]]);/**
 * @license lucide-react v0.460.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const yp=me("Rocket",[["path",{d:"M4.5 16.5c-1.5 1.26-2 5-2 5s3.74-.5 5-2c.71-.84.7-2.13-.09-2.91a2.18 2.18 0 0 0-2.91-.09z",key:"m3kijz"}],["path",{d:"m12 15-3-3a22 22 0 0 1 2-3.95A12.88 12.88 0 0 1 22 2c0 2.72-.78 7.5-6 11a22.35 22.35 0 0 1-4 2z",key:"1fmvmk"}],["path",{d:"M9 12H4s.55-3.03 2-4c1.62-1.08 5 0 5 0",key:"1f8sc4"}],["path",{d:"M12 15v5s3.03-.55 4-2c1.08-1.62 0-5 0-5",key:"qeys4"}]]);/**
 * @license lucide-react v0.460.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const jp=me("Scissors",[["circle",{cx:"6",cy:"6",r:"3",key:"1lh9wr"}],["path",{d:"M8.12 8.12 12 12",key:"1alkpv"}],["path",{d:"M20 4 8.12 15.88",key:"xgtan2"}],["circle",{cx:"6",cy:"18",r:"3",key:"fqmcym"}],["path",{d:"M14.8 14.8 20 20",key:"ptml3r"}]]);/**
 * @license lucide-react v0.460.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const xa=me("Search",[["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}],["path",{d:"m21 21-4.3-4.3",key:"1qie3q"}]]);/**
 * @license lucide-react v0.460.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const al=me("Send",[["path",{d:"M14.536 21.686a.5.5 0 0 0 .937-.024l6.5-19a.496.496 0 0 0-.635-.635l-19 6.5a.5.5 0 0 0-.024.937l7.93 3.18a2 2 0 0 1 1.112 1.11z",key:"1ffxy3"}],["path",{d:"m21.854 2.147-10.94 10.939",key:"12cjpa"}]]);/**
 * @license lucide-react v0.460.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const vp=me("Server",[["rect",{width:"20",height:"8",x:"2",y:"2",rx:"2",ry:"2",key:"ngkwjq"}],["rect",{width:"20",height:"8",x:"2",y:"14",rx:"2",ry:"2",key:"iecqi9"}],["line",{x1:"6",x2:"6.01",y1:"6",y2:"6",key:"16zg32"}],["line",{x1:"6",x2:"6.01",y1:"18",y2:"18",key:"nzw8ys"}]]);/**
 * @license lucide-react v0.460.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const vd=me("Settings",[["path",{d:"M12.22 2h-.44a2 2 0 0 0-2 2v.18a2 2 0 0 1-1 1.73l-.43.25a2 2 0 0 1-2 0l-.15-.08a2 2 0 0 0-2.73.73l-.22.38a2 2 0 0 0 .73 2.73l.15.1a2 2 0 0 1 1 1.72v.51a2 2 0 0 1-1 1.74l-.15.09a2 2 0 0 0-.73 2.73l.22.38a2 2 0 0 0 2.73.73l.15-.08a2 2 0 0 1 2 0l.43.25a2 2 0 0 1 1 1.73V20a2 2 0 0 0 2 2h.44a2 2 0 0 0 2-2v-.18a2 2 0 0 1 1-1.73l.43-.25a2 2 0 0 1 2 0l.15.08a2 2 0 0 0 2.73-.73l.22-.39a2 2 0 0 0-.73-2.73l-.15-.08a2 2 0 0 1-1-1.74v-.5a2 2 0 0 1 1-1.74l.15-.09a2 2 0 0 0 .73-2.73l-.22-.38a2 2 0 0 0-2.73-.73l-.15.08a2 2 0 0 1-2 0l-.43-.25a2 2 0 0 1-1-1.73V4a2 2 0 0 0-2-2z",key:"1qme2f"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]]);/**
 * @license lucide-react v0.460.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const k0=me("Share2",[["circle",{cx:"18",cy:"5",r:"3",key:"gq8acd"}],["circle",{cx:"6",cy:"12",r:"3",key:"w7nqdw"}],["circle",{cx:"18",cy:"19",r:"3",key:"1xt0gg"}],["line",{x1:"8.59",x2:"15.42",y1:"13.51",y2:"17.49",key:"47mynk"}],["line",{x1:"15.41",x2:"8.59",y1:"6.51",y2:"10.49",key:"1n3mei"}]]);/**
 * @license lucide-react v0.460.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const dn=me("ShieldCheck",[["path",{d:"M20 13c0 5-3.5 7.5-7.66 8.95a1 1 0 0 1-.67-.01C7.5 20.5 4 18 4 13V6a1 1 0 0 1 1-1c2 0 4.5-1.2 6.24-2.72a1.17 1.17 0 0 1 1.52 0C14.51 3.81 17 5 19 5a1 1 0 0 1 1 1z",key:"oel41y"}],["path",{d:"m9 12 2 2 4-4",key:"dzmm74"}]]);/**
 * @license lucide-react v0.460.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Gt=me("Shield",[["path",{d:"M20 13c0 5-3.5 7.5-7.66 8.95a1 1 0 0 1-.67-.01C7.5 20.5 4 18 4 13V6a1 1 0 0 1 1-1c2 0 4.5-1.2 6.24-2.72a1.17 1.17 0 0 1 1.52 0C14.51 3.81 17 5 19 5a1 1 0 0 1 1 1z",key:"oel41y"}]]);/**
 * @license lucide-react v0.460.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const W0=me("SlidersHorizontal",[["line",{x1:"21",x2:"14",y1:"4",y2:"4",key:"obuewd"}],["line",{x1:"10",x2:"3",y1:"4",y2:"4",key:"1q6298"}],["line",{x1:"21",x2:"12",y1:"12",y2:"12",key:"1iu8h1"}],["line",{x1:"8",x2:"3",y1:"12",y2:"12",key:"ntss68"}],["line",{x1:"21",x2:"16",y1:"20",y2:"20",key:"14d8ph"}],["line",{x1:"12",x2:"3",y1:"20",y2:"20",key:"m0wm8r"}],["line",{x1:"14",x2:"14",y1:"2",y2:"6",key:"14e1ph"}],["line",{x1:"8",x2:"8",y1:"10",y2:"14",key:"1i6ji0"}],["line",{x1:"16",x2:"16",y1:"18",y2:"22",key:"1lctlv"}]]);/**
 * @license lucide-react v0.460.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Qi=me("Smartphone",[["rect",{width:"14",height:"20",x:"5",y:"2",rx:"2",ry:"2",key:"1yt0o3"}],["path",{d:"M12 18h.01",key:"mhygvu"}]]);/**
 * @license lucide-react v0.460.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const I0=me("Sparkles",[["path",{d:"M9.937 15.5A2 2 0 0 0 8.5 14.063l-6.135-1.582a.5.5 0 0 1 0-.962L8.5 9.936A2 2 0 0 0 9.937 8.5l1.582-6.135a.5.5 0 0 1 .963 0L14.063 8.5A2 2 0 0 0 15.5 9.937l6.135 1.581a.5.5 0 0 1 0 .964L15.5 14.063a2 2 0 0 0-1.437 1.437l-1.582 6.135a.5.5 0 0 1-.963 0z",key:"4pj2yx"}],["path",{d:"M20 3v4",key:"1olli1"}],["path",{d:"M22 5h-4",key:"1gvqau"}],["path",{d:"M4 17v2",key:"vumght"}],["path",{d:"M5 18H3",key:"zchphs"}]]);/**
 * @license lucide-react v0.460.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Np=me("Square",[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",key:"afitv7"}]]);/**
 * @license lucide-react v0.460.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ma=me("Star",[["path",{d:"M11.525 2.295a.53.53 0 0 1 .95 0l2.31 4.679a2.123 2.123 0 0 0 1.595 1.16l5.166.756a.53.53 0 0 1 .294.904l-3.736 3.638a2.123 2.123 0 0 0-.611 1.878l.882 5.14a.53.53 0 0 1-.771.56l-4.618-2.428a2.122 2.122 0 0 0-1.973 0L6.396 21.01a.53.53 0 0 1-.77-.56l.881-5.139a2.122 2.122 0 0 0-.611-1.879L2.16 9.795a.53.53 0 0 1 .294-.906l5.165-.755a2.122 2.122 0 0 0 1.597-1.16z",key:"r04s7s"}]]);/**
 * @license lucide-react v0.460.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const wp=me("Target",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["circle",{cx:"12",cy:"12",r:"6",key:"1vlfrh"}],["circle",{cx:"12",cy:"12",r:"2",key:"1c9p78"}]]);/**
 * @license lucide-react v0.460.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const _p=me("ToggleLeft",[["rect",{width:"20",height:"12",x:"2",y:"6",rx:"6",ry:"6",key:"f2vt7d"}],["circle",{cx:"8",cy:"12",r:"2",key:"1nvbw3"}]]);/**
 * @license lucide-react v0.460.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Sp=me("ToggleRight",[["rect",{width:"20",height:"12",x:"2",y:"6",rx:"6",ry:"6",key:"f2vt7d"}],["circle",{cx:"16",cy:"12",r:"2",key:"4ma0v8"}]]);/**
 * @license lucide-react v0.460.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const gr=me("Trash2",[["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6",key:"4alrt4"}],["path",{d:"M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2",key:"v07s0e"}],["line",{x1:"10",x2:"10",y1:"11",y2:"17",key:"1uufr5"}],["line",{x1:"14",x2:"14",y1:"11",y2:"17",key:"xtxkd"}]]);/**
 * @license lucide-react v0.460.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const dr=me("TrendingUp",[["polyline",{points:"22 7 13.5 15.5 8.5 10.5 2 17",key:"126l90"}],["polyline",{points:"16 7 22 7 22 13",key:"kwv8wd"}]]);/**
 * @license lucide-react v0.460.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const zt=me("TriangleAlert",[["path",{d:"m21.73 18-8-14a2 2 0 0 0-3.48 0l-8 14A2 2 0 0 0 4 21h16a2 2 0 0 0 1.73-3",key:"wmoenq"}],["path",{d:"M12 9v4",key:"juzpu7"}],["path",{d:"M12 17h.01",key:"p32p05"}]]);/**
 * @license lucide-react v0.460.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ef=me("Truck",[["path",{d:"M14 18V6a2 2 0 0 0-2-2H4a2 2 0 0 0-2 2v11a1 1 0 0 0 1 1h2",key:"wrbu53"}],["path",{d:"M15 18H9",key:"1lyqi6"}],["path",{d:"M19 18h2a1 1 0 0 0 1-1v-3.65a1 1 0 0 0-.22-.624l-3.48-4.35A1 1 0 0 0 17.52 8H14",key:"lysw3i"}],["circle",{cx:"17",cy:"18",r:"2",key:"332jqn"}],["circle",{cx:"7",cy:"18",r:"2",key:"19iecd"}]]);/**
 * @license lucide-react v0.460.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const hr=me("Upload",[["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["polyline",{points:"17 8 12 3 7 8",key:"t8dd8p"}],["line",{x1:"12",x2:"12",y1:"3",y2:"15",key:"widbto"}]]);/**
 * @license lucide-react v0.460.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const zp=me("UserCheck",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["polyline",{points:"16 11 18 13 22 9",key:"1pwet4"}]]);/**
 * @license lucide-react v0.460.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ot=me("User",[["path",{d:"M19 21v-2a4 4 0 0 0-4-4H9a4 4 0 0 0-4 4v2",key:"975kel"}],["circle",{cx:"12",cy:"7",r:"4",key:"17ys0d"}]]);/**
 * @license lucide-react v0.460.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Is=me("Users",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["path",{d:"M22 21v-2a4 4 0 0 0-3-3.87",key:"kshegd"}],["path",{d:"M16 3.13a4 4 0 0 1 0 7.75",key:"1da9ce"}]]);/**
 * @license lucide-react v0.460.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const zs=me("Video",[["path",{d:"m16 13 5.223 3.482a.5.5 0 0 0 .777-.416V7.87a.5.5 0 0 0-.752-.432L16 10.5",key:"ftymec"}],["rect",{x:"2",y:"6",width:"14",height:"12",rx:"2",key:"158x01"}]]);/**
 * @license lucide-react v0.460.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Nd=me("Wallet",[["path",{d:"M19 7V4a1 1 0 0 0-1-1H5a2 2 0 0 0 0 4h15a1 1 0 0 1 1 1v4h-3a2 2 0 0 0 0 4h3a1 1 0 0 0 1-1v-2a1 1 0 0 0-1-1",key:"18etb6"}],["path",{d:"M3 5v14a2 2 0 0 0 2 2h15a1 1 0 0 0 1-1v-4",key:"xoc0q4"}]]);/**
 * @license lucide-react v0.460.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const kp=me("WifiOff",[["path",{d:"M12 20h.01",key:"zekei9"}],["path",{d:"M8.5 16.429a5 5 0 0 1 7 0",key:"1bycff"}],["path",{d:"M5 12.859a10 10 0 0 1 5.17-2.69",key:"1dl1wf"}],["path",{d:"M19 12.859a10 10 0 0 0-2.007-1.523",key:"4k23kn"}],["path",{d:"M2 8.82a15 15 0 0 1 4.177-2.643",key:"1grhjp"}],["path",{d:"M22 8.82a15 15 0 0 0-11.288-3.764",key:"z3jwby"}],["path",{d:"m2 2 20 20",key:"1ooewy"}]]);/**
 * @license lucide-react v0.460.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Cp=me("Wifi",[["path",{d:"M12 20h.01",key:"zekei9"}],["path",{d:"M2 8.82a15 15 0 0 1 20 0",key:"dnpr2z"}],["path",{d:"M5 12.859a10 10 0 0 1 14 0",key:"1x1e6c"}],["path",{d:"M8.5 16.429a5 5 0 0 1 7 0",key:"1bycff"}]]);/**
 * @license lucide-react v0.460.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ep=me("Wind",[["path",{d:"M12.8 19.6A2 2 0 1 0 14 16H2",key:"148xed"}],["path",{d:"M17.5 8a2.5 2.5 0 1 1 2 4H2",key:"1u4tom"}],["path",{d:"M9.8 4.4A2 2 0 1 1 11 8H2",key:"75valh"}]]);/**
 * @license lucide-react v0.460.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ns=me("Wrench",[["path",{d:"M14.7 6.3a1 1 0 0 0 0 1.4l1.6 1.6a1 1 0 0 0 1.4 0l3.77-3.77a6 6 0 0 1-7.94 7.94l-6.91 6.91a2.12 2.12 0 0 1-3-3l6.91-6.91a6 6 0 0 1 7.94-7.94l-3.76 3.76z",key:"cbrjhi"}]]);/**
 * @license lucide-react v0.460.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ze=me("X",[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]]);/**
 * @license lucide-react v0.460.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const tf=me("Zap",[["path",{d:"M4 14a1 1 0 0 1-.78-1.63l9.9-10.2a.5.5 0 0 1 .86.46l-1.92 6.02A1 1 0 0 0 13 10h7a1 1 0 0 1 .78 1.63l-9.9 10.2a.5.5 0 0 1-.86-.46l1.92-6.02A1 1 0 0 0 11 14z",key:"1xq2db"}]]);function Ap({toast:i,onRemove:u}){const[f,o]=c.useState(!1),[x,y]=c.useState(!1);c.useEffect(()=>{setTimeout(()=>o(!0),10);const g=i.duration||5e3,E=setTimeout(()=>{y(!0),setTimeout(()=>u(i.id),300)},g);return()=>clearTimeout(E)},[i,u]);const N={success:e.jsx(Qe,{size:20,className:"text-green-500"}),error:e.jsx(el,{size:20,className:"text-red-500"}),warning:e.jsx(zt,{size:20,className:"text-yellow-500"}),info:e.jsx(fn,{size:20,className:"text-blue-500"})},h={success:"bg-green-50 border-green-200 text-green-800",error:"bg-red-50 border-red-200 text-red-800",warning:"bg-yellow-50 border-yellow-200 text-yellow-800",info:"bg-blue-50 border-blue-200 text-blue-800"};return e.jsxs("div",{className:`
        relative flex items-start gap-3 px-4 py-3 rounded-xl border shadow-lg
        transition-all duration-300 ease-out
        ${h[i.type]}
        ${f&&!x?"opacity-100 translate-x-0":"opacity-0 translate-x-full"}
        ${x?"opacity-0 scale-95":""}
        max-w-sm
      `,role:"alert","aria-live":"polite",children:[e.jsx("div",{className:"flex-shrink-0 mt-0.5",children:N[i.type]}),e.jsx("p",{className:"flex-1 text-sm font-medium leading-relaxed",children:i.message}),e.jsx("button",{onClick:()=>{y(!0),setTimeout(()=>u(i.id),300)},className:"flex-shrink-0 p-1 rounded-lg hover:bg-black/5 transition-colors","aria-label":"Fermer la notification",children:e.jsx(Ze,{size:16})})]})}function qp({toasts:i,onRemove:u}){return e.jsx("div",{className:"fixed top-4 right-4 z-50 flex flex-col gap-2 pointer-events-none","aria-live":"polite","aria-atomic":"true",children:i.map(f=>e.jsx("div",{className:"pointer-events-auto",children:e.jsx(Ap,{toast:f,onRemove:u})},f.id))})}function Mp(){const[i,u]=c.useState(navigator.onLine),[f,o]=c.useState(!1);return c.useEffect(()=>{const x=()=>{u(!0),o(!1)},y=()=>{u(!1),o(!0)};return window.addEventListener("online",x),window.addEventListener("offline",y),navigator.onLine||o(!0),()=>{window.removeEventListener("online",x),window.removeEventListener("offline",y)}},[]),i&&!f?null:i&&f?e.jsx("div",{className:"fixed top-0 left-0 right-0 z-50 bg-green-500 text-white px-4 py-3 shadow-lg animate-in slide-in-from-top duration-300",children:e.jsxs("div",{className:"max-w-7xl mx-auto flex items-center gap-3",children:[e.jsx(Cp,{size:20}),e.jsx("span",{className:"font-medium",children:"Connexion rtablie !"})]})}):e.jsx("div",{className:"fixed top-0 left-0 right-0 z-50 bg-red-500 text-white px-4 py-3 shadow-lg",children:e.jsxs("div",{className:"max-w-7xl mx-auto flex items-center gap-3",children:[e.jsx(kp,{size:20}),e.jsxs("div",{className:"flex-1",children:[e.jsx("span",{className:"font-medium",children:"Vous tes hors ligne"}),e.jsx("span",{className:"ml-2 text-sm opacity-90",children:"Vrifiez votre connexion internet et ressayez."})]}),e.jsx("button",{onClick:()=>window.location.reload(),className:"px-4 py-1 bg-white/20 hover:bg-white/30 rounded-lg text-sm font-medium transition-colors",children:"Ressayer"})]})})}function Dp(){const{pathname:i}=pn();return c.useEffect(()=>{window.scrollTo({top:0,left:0,behavior:"instant"}),document.documentElement.scrollTop=0,document.body.scrollTop=0,"scrollRestoration"in window.history&&(window.history.scrollRestoration="manual")},[i]),null}function Yt({className:i="",contentOnly:u}){return e.jsxs("div",{className:`flex items-center justify-center bg-white ${u?"absolute inset-0":"fixed inset-0 z-[9999]"} ${i}`,style:{pointerEvents:"auto"},"aria-hidden":"true","aria-busy":"true",children:[e.jsxs("div",{className:"absolute inset-0 overflow-hidden",children:[e.jsx("div",{className:"absolute top-20 left-10 w-32 h-32 bg-brand-100 rounded-full blur-3xl opacity-40 animate-float-slow",style:{animationDelay:"0s"}}),e.jsx("div",{className:"absolute top-40 right-20 w-24 h-24 bg-orange-100 rounded-full blur-2xl opacity-30 animate-float-medium",style:{animationDelay:"1s"}}),e.jsx("div",{className:"absolute bottom-32 left-1/4 w-40 h-40 bg-brand-50 rounded-full blur-3xl opacity-35 animate-float-slow",style:{animationDelay:"2s"}}),e.jsx("div",{className:"absolute bottom-20 right-1/3 w-28 h-28 bg-orange-50 rounded-full blur-2xl opacity-40 animate-float-medium",style:{animationDelay:"1.5s"}}),e.jsx("div",{className:"absolute top-1/4 left-1/3 w-16 h-16 border-4 border-brand-200 rounded-2xl rotate-45 opacity-20 animate-float-fast",style:{animationDelay:"0.5s"}}),e.jsx("div",{className:"absolute top-1/3 right-1/4 w-12 h-12 border-4 border-orange-200 rounded-lg rotate-12 opacity-25 animate-float-fast",style:{animationDelay:"2.5s"}}),e.jsx("div",{className:"absolute bottom-1/4 left-1/5 w-20 h-20 border-4 border-brand-300 rounded-3xl rotate-45 opacity-15 animate-float-medium",style:{animationDelay:"1s"}}),e.jsx("div",{className:"absolute top-1/2 left-1/6 w-3 h-3 bg-brand-400 rounded-full opacity-30 animate-float-fast",style:{animationDelay:"0s"}}),e.jsx("div",{className:"absolute top-1/3 right-1/6 w-2 h-2 bg-orange-400 rounded-full opacity-35 animate-float-medium",style:{animationDelay:"1.5s"}}),e.jsx("div",{className:"absolute bottom-1/3 right-1/5 w-4 h-4 bg-brand-300 rounded-full opacity-25 animate-float-slow",style:{animationDelay:"2s"}})]}),e.jsxs("div",{className:"relative flex flex-col items-center gap-6 px-4 z-10",children:[e.jsxs("div",{className:"relative",children:[e.jsx("div",{className:"absolute inset-0 rounded-full bg-brand-500/10 animate-ping"}),e.jsx("div",{className:"relative w-20 h-20 rounded-full bg-gradient-to-br from-brand-500 to-brand-600 flex items-center justify-center shadow-xl",children:e.jsx("svg",{viewBox:"0 0 100 100",className:"w-12 h-12 text-white",fill:"currentColor",children:e.jsx("path",{d:"M 20 30 L 20 70 L 30 70 L 30 45 L 50 65 L 70 45 L 70 70 L 80 70 L 80 30 L 70 30 L 50 50 L 30 30 Z",fill:"currentColor",className:"animate-pulse"})})})]}),e.jsxs("div",{className:"text-center max-w-xs",children:[e.jsx("p",{className:"text-base font-black text-gray-900 mb-2",children:"La premire plateforme"}),e.jsx("p",{className:"text-base font-black text-brand-600 mb-3",children:"faite pour les artisans au Sngal"}),e.jsxs("div",{className:"flex items-center justify-center gap-2",children:[e.jsxs("div",{className:"flex gap-1",children:[e.jsx("div",{className:"w-2 h-2 rounded-full bg-brand-500 animate-bounce",style:{animationDelay:"0ms"}}),e.jsx("div",{className:"w-2 h-2 rounded-full bg-brand-500 animate-bounce",style:{animationDelay:"150ms"}}),e.jsx("div",{className:"w-2 h-2 rounded-full bg-brand-500 animate-bounce",style:{animationDelay:"300ms"}})]}),e.jsx("span",{className:"text-sm font-bold text-gray-500 ml-2",children:"Chargement..."})]})]})]}),e.jsx("style",{children:`
        @keyframes float-fast {
          0%, 100% { transform: translateY(0px) translateX(0px) rotate(0deg); }
          33% { transform: translateY(-20px) translateX(10px) rotate(5deg); }
          66% { transform: translateY(-10px) translateX(-10px) rotate(-5deg); }
        }
        @keyframes float-medium {
          0%, 100% { transform: translateY(0px) translateX(0px) rotate(0deg); }
          50% { transform: translateY(-30px) translateX(15px) rotate(10deg); }
        }
        @keyframes float-slow {
          0%, 100% { transform: translateY(0px) translateX(0px) rotate(0deg); }
          50% { transform: translateY(-40px) translateX(20px) rotate(15deg); }
        }
        .animate-float-fast { animation: float-fast 4s ease-in-out infinite; }
        .animate-float-medium { animation: float-medium 6s ease-in-out infinite; }
        .animate-float-slow { animation: float-slow 8s ease-in-out infinite; }
      `})]})}const Rp=["/dashboard","/revisions","/projects/","/credits","/verification","/edit-profile","/conversations","/notifications"];function C0(i){return Rp.some(u=>u.endsWith("/")?i.startsWith(u):i===u)}function Tp(){const u=pn().pathname,f=c.useRef(u),[o,x]=c.useState(!1),[y,N]=c.useState(!1),h=c.useRef(null),g=c.useRef(null),E=f.current!==u,d=!C0(u)&&(y||E);return c.useLayoutEffect(()=>{if(!C0(u))return f.current=u,h.current&&clearTimeout(h.current),g.current&&clearTimeout(g.current),x(!0),N(!0),h.current=setTimeout(()=>{x(!1),g.current=setTimeout(()=>N(!1),300)},500),()=>{h.current&&clearTimeout(h.current),g.current&&clearTimeout(g.current)}},[u]),d?e.jsx("div",{className:`fixed inset-0 z-[9999] transition-opacity duration-300 ${o?"opacity-100":"opacity-0"}`,style:{pointerEvents:o?"auto":"none"},children:e.jsx(Yt,{contentOnly:!0})}):null}const af=c.createContext(null);function Lp({children:i}){const[u,f]=c.useState(null),[o,x]=c.useState(!1),[y,N]=c.useState(!1),[h,g]=c.useState(!1),E=!y&&(!!u||o),d=c.useCallback(()=>{u?u.prompt():o&&g(!0)},[u,o]),v={deferredPrompt:u,setDeferredPrompt:f,isIOS:o,setIsIOS:x,isStandalone:y,setIsStandalone:N,showBanner:h,setShowBanner:g,canInstall:E,promptInstall:d};return e.jsx(af.Provider,{value:v,children:i})}function Up(){return c.useContext(af)}function Op(){const i=Up(),[u,f]=c.useState(!1);c.useEffect(()=>{f(!0)},[]),c.useEffect(()=>{if(!i||!u)return;if(window.matchMedia("(display-mode: standalone)").matches){i.setIsStandalone(!0);return}const N=/iPad|iPhone|iPod/.test(navigator.userAgent)&&!window.MSStream;i.setIsIOS(N);const h=g=>{g.preventDefault(),i.setDeferredPrompt(g),localStorage.getItem("pwa-install-dismissed")||setTimeout(()=>i.setShowBanner(!0),3e3)};return window.addEventListener("beforeinstallprompt",h),N&&(localStorage.getItem("pwa-install-dismissed")||setTimeout(()=>i.setShowBanner(!0),5e3)),()=>{window.removeEventListener("beforeinstallprompt",h)}},[i,u]);const o=async()=>{if(!(i!=null&&i.deferredPrompt))return;i.deferredPrompt.prompt();const{outcome:N}=await i.deferredPrompt.userChoice;N==="accepted"&&(i.setShowBanner(!1),localStorage.setItem("pwa-install-dismissed","true")),i.setDeferredPrompt(null)},x=()=>{i==null||i.setShowBanner(!1)},y=()=>{localStorage.setItem("pwa-install-dismissed","true"),i==null||i.setShowBanner(!1)};return!i||i.isStandalone||!i.showBanner||!i.deferredPrompt&&!i.isIOS?null:e.jsx("div",{className:"fixed bottom-4 left-4 right-4 md:left-auto md:right-4 md:w-96 z-50 animate-in slide-in-from-bottom-4 duration-300",children:e.jsx("div",{className:"bg-white rounded-2xl shadow-2xl border-2 border-brand-200 p-4 md:p-6",children:e.jsxs("div",{className:"flex items-start gap-4",children:[e.jsx("div",{className:"w-12 h-12 rounded-xl bg-gradient-to-br from-brand-500 to-brand-600 flex items-center justify-center flex-shrink-0",children:e.jsx(Qi,{className:"w-6 h-6 text-white"})}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("h3",{className:"font-black text-gray-900 mb-1",children:"Installer Mbourake"}),i.isIOS?e.jsxs("div",{className:"text-sm text-gray-600 space-y-2",children:[e.jsx("p",{children:"Pour installer l'application :"}),e.jsxs("ol",{className:"list-decimal list-inside space-y-1 ml-2",children:[e.jsxs("li",{children:["Appuyez sur le bouton ",e.jsx("span",{className:"font-bold",children:"Partager"})," ",e.jsx("span",{className:"inline-block w-4 h-4 bg-gray-300 rounded"})]}),e.jsxs("li",{children:["Slectionnez ",e.jsx("span",{className:"font-bold",children:"Sur l'cran d'accueil"})]})]})]}):e.jsx("p",{className:"text-sm text-gray-600",children:"Installez Mbourake pour un accs rapide et une meilleure exprience."}),e.jsxs("div",{className:"flex gap-2 mt-4 flex-wrap items-center",children:[!i.isIOS&&i.deferredPrompt&&e.jsxs("button",{onClick:o,className:"flex-1 min-w-[120px] flex items-center justify-center gap-2 px-4 py-2.5 bg-brand-500 text-white rounded-xl font-bold hover:bg-brand-600 transition-colors",children:[e.jsx(mn,{size:18}),"Installer"]}),e.jsx("button",{onClick:x,className:"px-4 py-2.5 bg-gray-100 text-gray-700 rounded-xl font-bold hover:bg-gray-200 transition-colors","aria-label":"Fermer",children:e.jsx(Ze,{size:18})})]}),e.jsx("button",{type:"button",onClick:y,className:"mt-3 text-xs text-gray-500 hover:text-gray-700 underline",children:"Ne plus proposer"})]})]})})})}class sf extends c.Component{constructor(u){super(u),this.handleReset=()=>{this.setState({hasError:!1,error:null,errorInfo:null})},this.state={hasError:!1,error:null,errorInfo:null}}static getDerivedStateFromError(u){return{hasError:!0,error:u}}componentDidCatch(u,f){var x,y;if(((x=u==null?void 0:u.message)==null?void 0:x.includes("removeChild"))||(u==null?void 0:u.name)==="NotFoundError"||((y=f==null?void 0:f.componentStack)==null?void 0:y.includes("removeChild"))){console.warn("[ErrorBoundary] Erreur removeChild dtecte (cosmtique, ignore):",u),setTimeout(()=>{this.setState({hasError:!1,error:null,errorInfo:null})},100);return}console.error("[ErrorBoundary] Erreur capture:",u,f),this.setState({error:u,errorInfo:f}),this.props.onError&&this.props.onError(u,f)}render(){var u,f,o;return this.state.hasError&&this.state.error?((f=(u=this.state.error)==null?void 0:u.message)==null?void 0:f.includes("removeChild"))||((o=this.state.error)==null?void 0:o.name)==="NotFoundError"?this.props.children:this.props.fallback?this.props.fallback:e.jsx("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center p-6",children:e.jsxs("div",{className:"max-w-md w-full text-center",children:[e.jsx("div",{className:"w-20 h-20 bg-red-100 rounded-full flex items-center justify-center mx-auto mb-4",children:e.jsx(zt,{size:40,className:"text-red-600"})}),e.jsx("h1",{className:"text-2xl font-black text-gray-900 mb-2",children:"Une erreur s'est produite"}),e.jsx("p",{className:"text-gray-600 mb-6",children:"Dsol, quelque chose s'est mal pass. Veuillez ressayer."}),!1,e.jsx("button",{onClick:this.handleReset,className:"px-6 py-3 bg-brand-500 text-white rounded-xl font-bold hover:bg-brand-600 transition-colors",children:"Ressayer"})]})}):this.props.children}}const Vp="mbourake-auth";function Fp(i){return{persistSession:!0,autoRefreshToken:!0,detectSessionInUrl:!0,storageKey:Vp,storage:i}}const lf="https://snhoxuqaskgoownshvgr.supabase.co".trim()||"",rf="eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6InNuaG94dXFhc2tnb293bnNodmdyIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NjY4NDgzOTMsImV4cCI6MjA4MjQyNDM5M30.W1JqBhoIQfYMJ72KdcJnM2MFu7a2-iZThWKQ1xOVnPE".trim()||"";(!lf||!rf)&&console.warn("[Mbourake] VITE_SUPABASE_URL ou VITE_SUPABASE_ANON_KEY manquants. Crez un fichier .env  la racine (voir env.example). Connexion et donnes seront dsactives.");const j=Lh(lf||"https://placeholder.supabase.co",rf||"placeholder-anon-key",{auth:Fp(localStorage)});function Nt(){const[i,u]=c.useState({user:null,session:null,loading:!0}),f=c.useRef(!1);c.useEffect(()=>{let h=!0;j.auth.getSession().then(({data:E})=>{var d;h&&u({user:((d=E.session)==null?void 0:d.user)??null,session:E.session??null,loading:!1})}).catch(E=>{h&&(console.warn("Erreur lors du chargement de la session:",E),u({user:null,session:null,loading:!1}))});const{data:g}=j.auth.onAuthStateChange((E,d)=>{var v,b;if(E!=="INITIAL_SESSION"&&console.log("[useAuth] Auth state changed:",{event:E,hasUser:!!(d!=null&&d.user),userId:(v=d==null?void 0:d.user)==null?void 0:v.id,email:(b=d==null?void 0:d.user)==null?void 0:b.email}),E==="SIGNED_IN"&&typeof window<"u")try{const w=new URLSearchParams(window.location.search);let _=w.get("mode"),L=w.get("role");if(_||(_=localStorage.getItem("mbourake_pending_mode")||void 0),L||(L=localStorage.getItem("mbourake_pending_role")||void 0),_==="signup"){const U=new URLSearchParams;U.set("mode","onboarding");const J=L||localStorage.getItem("mbourake_pending_role")||void 0;J?(U.set("role",J),console.log("[useAuth] Rle dtermin pour redirection:",J)):console.warn("[useAuth] ATTENTION: Aucun rle trouv pour signup, redirection sans rle");const F=`/edit-profile?${U.toString()}`;console.log("[useAuth] SIGNED_IN (signup)  redirection directe vers",F),setTimeout(()=>{window.location.replace(F)},0);return}const M=new URLSearchParams;_&&M.set("mode",_),L&&M.set("role",L);const D=`/dashboard${M.toString()?`?${M.toString()}`:""}`;window.location.pathname!=="/dashboard"&&(console.log("[useAuth] SIGNED_IN (login)  redirection vers",D),setTimeout(()=>{window.location.replace(D)},0))}catch(w){console.warn("[useAuth] Erreur pendant la redirection SIGNED_IN:",w),f.current=!1}u(w=>{var U,J;const _=(d==null?void 0:d.user)??null,L=d??null,M=((U=w.user)==null?void 0:U.id)!==(_==null?void 0:_.id),D=((J=w.session)==null?void 0:J.access_token)!==(L==null?void 0:L.access_token);return!M&&!D&&w.loading===!1?w:{user:_,session:L,loading:!1}})});return()=>{h=!1,g.subscription.unsubscribe()}},[]);const o=c.useCallback(async(h="signup",g)=>{var b,w,_;console.log("[useAuth] signInWithGoogle appel avec mode:",h,"role:",g),console.log("[useAuth] URL actuelle:",window.location.href),console.log("[useAuth] Origin:",window.location.origin);const E=new URLSearchParams;E.set("mode",h),g&&E.set("role",g);const d=E.toString(),v=`${window.location.origin}/dashboard${d?`?${d}`:""}`;console.log("[useAuth] Google OAuth redirectTo configur:",v);try{console.log("[useAuth] Tentative de connexion Google OAuth avec redirectTo:",v);const{data:L,error:M}=await j.auth.signInWithOAuth({provider:"google",options:{redirectTo:v,queryParams:{access_type:"offline",prompt:"select_account"}}});if(M)throw console.error("[useAuth] Erreur Google OAuth:",M),console.error("[useAuth] Dtails erreur:",{message:M.message,status:M.status,name:M.name}),(b=M.message)!=null&&b.includes("redirect")||(w=M.message)!=null&&w.includes("URL")||(_=M.message)!=null&&_.includes("mismatch")?new Error("Erreur de configuration OAuth. Vrifiez que l'URL de redirection est configure dans Supabase Dashboard: Settings  Authentication  URL Configuration  Redirect URLs. Ajoutez: "+v+" Si le problme persiste, vrifiez aussi Google Cloud Console."):M;if(console.log("[useAuth] Google OAuth initi avec succs"),console.log("[useAuth] Data retourne:",L),console.log("[useAuth] URL de redirection Google:",L==null?void 0:L.url),L!=null&&L.url)console.log("[useAuth] Redirection automatique vers Google OAuth dans 100ms..."),setTimeout(()=>{window.location.href=L.url},100);else throw console.warn("[useAuth] Pas d'URL de redirection retourne par Supabase"),new Error("Aucune URL de redirection retourne par Supabase. Vrifiez la configuration OAuth.")}catch(L){throw console.error("[useAuth] Exception lors de l'initiation OAuth:",L),L}},[]),x=c.useCallback(async(h,g)=>{const{error:E}=await j.auth.signInWithPassword({email:h,password:g});if(E)throw E},[]),y=c.useCallback(async(h,g)=>{const{error:E}=await j.auth.signUp({email:h,password:g});if(E)throw E},[]),N=c.useCallback(async()=>{const{error:h}=await j.auth.signOut();if(h)throw h;window.location.href="/"},[]);return c.useMemo(()=>({user:i.user,session:i.session,loading:i.loading,signInWithGoogle:(h,g)=>o(h,g),signInWithPassword:x,signUpWithPassword:y,signOut:N}),[i.user,i.session,i.loading,o,x,y,N])}function Jt({children:i}){const u=Nt();if(u.loading)return e.jsx("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:e.jsxs("div",{className:"flex flex-col items-center gap-4",children:[e.jsx("div",{className:"w-12 h-12 border-4 border-brand-500 border-t-transparent rounded-full animate-spin"}),e.jsx("p",{className:"text-sm text-gray-600 font-medium",children:"Chargement..."})]})});if(!u.user){const f=window.location.pathname+window.location.search;return e.jsx(hd,{to:`/onboard?mode=login&redirect=${encodeURIComponent(f)}`,replace:!0})}return e.jsx(e.Fragment,{children:i})}function It(){const i=Nt(),[u,f]=c.useState({profile:null,loading:!0});c.useEffect(()=>{let x=!0;return(async()=>{var E,d,v,b,w;if(!i.user){if(!x)return;f({profile:null,loading:!1});return}if(!x)return;f(_=>({..._,loading:!0}));const{data:N,error:h}=await j.from("profiles").select(`
          *,
          artisans!artisans_id_fkey(category_id)
        `).eq("id",i.user.id).maybeSingle();if(!x)return;if(h){((E=h.message)==null?void 0:E.toLowerCase().includes("failed to fetch"))||((d=h.message)==null?void 0:d.toLowerCase().includes("network"))||((v=h.message)==null?void 0:v.toLowerCase().includes("connection"))||((b=h.message)==null?void 0:b.toLowerCase().includes("timeout"))||console.error("Erreur lors du chargement du profil:",h),f({profile:null,loading:!1});return}const g=N?{...N,category_id:((w=N.artisans)==null?void 0:w.category_id)??N.category_id??null}:null;f({profile:g,loading:!1})})(),()=>{x=!1}},[i.user]);const o=c.useCallback(async x=>{var w,_,L;const{data:y,error:N}=await j.auth.getSession();if(N)throw console.error("[useProfile] Erreur lors de la rcupration de la session:",N),new Error("Not authenticated");if(!(y!=null&&y.session))throw console.error("[useProfile] Aucune session trouve"),new Error("Not authenticated");if(!y.session.user)throw console.error("[useProfile] Session trouve mais pas d'utilisateur"),new Error("Not authenticated");const h=y.session.user,g=((w=h.user_metadata)==null?void 0:w.avatar_url)||((_=h.user_metadata)==null?void 0:_.picture)||null,{error:E}=await j.from("profiles").upsert({id:h.id,email:h.email??null,full_name:x.full_name,role:x.role,avatar_url:g,phone:x.phone??null,location:x.location??null,company_name:x.company_name??null,region:x.region??null,department:x.department??null,commune:x.commune??null,updated_at:new Date().toISOString()});if(E)throw E;if(x.role==="artisan"){const{error:M}=await j.from("artisans").upsert({id:h.id,user_id:h.id,category_id:x.category_id??null,bio:x.bio??null,specialty:x.specialty??null,portfolio_urls:x.portfolio_urls??[],updated_at:new Date().toISOString()});if(M)throw M;const{data:D}=await j.from("artisan_credit_wallets").select("id, balance").eq("artisan_id",h.id).maybeSingle();if(D){if(D.balance<500){const{error:U}=await j.from("artisan_credit_wallets").update({balance:500,updated_at:new Date().toISOString()}).eq("artisan_id",h.id);U?console.error("[useProfile] Erreur lors de l'attribution des crdits de bienvenue:",U):console.log("[useProfile] 500 crdits de bienvenue accords  l'artisan existant:",h.id)}}else{const{error:U}=await j.from("artisan_credit_wallets").insert({artisan_id:h.id,balance:500,updated_at:new Date().toISOString()});U?console.error("[useProfile] Erreur lors de la cration du wallet avec crdits de bienvenue:",U):console.log("[useProfile] 500 crdits de bienvenue accords au nouvel artisan:",h.id)}}const{data:d,error:v}=await j.from("profiles").select(`
          *,
          artisans!artisans_id_fkey(category_id)
        `).eq("id",h.id).single();if(v)throw v;const b=d?{...d,category_id:((L=d.artisans)==null?void 0:L.category_id)??d.category_id??null}:null;f({profile:b,loading:!1})},[]);return c.useMemo(()=>({profile:u.profile,loading:u.loading,upsertProfile:o}),[u.profile,u.loading,o])}function Ks({children:i}){const{user:u,loading:f}=Nt(),{profile:o,loading:x}=It();if(f||x)return e.jsx("div",{className:"min-h-screen flex items-center justify-center bg-gray-50",children:e.jsxs("div",{className:"flex flex-col items-center gap-4",children:[e.jsx("div",{className:"w-12 h-12 border-4 border-brand-500 border-t-transparent rounded-full animate-spin"}),e.jsx("p",{className:"text-sm text-gray-600 font-medium",children:"Vrification des permissions..."})]})});if(!u){const y=window.location.pathname+window.location.search;return e.jsx(hd,{to:`/login?redirect=${encodeURIComponent(y)}`,replace:!0})}return(o==null?void 0:o.role)!=="admin"?e.jsx(hd,{to:"/dashboard",replace:!0}):e.jsx(e.Fragment,{children:i})}const E0=[{id:1,name:"Maonnerie Gnrale",icon_name:"hard-hat",slug:"maconnerie-gen"},{id:2,name:"Maonnerie de Finition",icon_name:"hard-hat",slug:"maconnerie-fin"},{id:3,name:"Ferraillage",icon_name:"grid",slug:"ferraillage"},{id:4,name:"Coffrage Btiment",icon_name:"grid",slug:"coffrage"},{id:5,name:"Charpente Mtallique",icon_name:"wrench",slug:"charpente-met"},{id:6,name:"Charpente Bois",icon_name:"hammer",slug:"charpente-bois"},{id:7,name:"Plomberie Sanitaire",icon_name:"droplets",slug:"plomberie-san"},{id:8,name:"Plomberie Industrielle",icon_name:"droplets",slug:"plomberie-ind"},{id:9,name:"Installation Pompe  eau",icon_name:"droplets",slug:"pompe-eau"},{id:10,name:"lectricit Btiment",icon_name:"zap",slug:"elec-bat"},{id:11,name:"lectricit Industrielle",icon_name:"zap",slug:"elec-ind"},{id:12,name:"lectricit Solaire",icon_name:"sun",slug:"elec-sol"},{id:13,name:"Installation Paratonnerre",icon_name:"cloud-lightning",slug:"paratonnerre"},{id:14,name:"Peinture Intrieure",icon_name:"paint-bucket",slug:"peinture-int"},{id:15,name:"Peinture Extrieure",icon_name:"paint-bucket",slug:"peinture-ext"},{id:16,name:"Peinture Industrielle",icon_name:"paint-bucket",slug:"peinture-ind"},{id:17,name:"Carrelage & Dallage",icon_name:"layout-grid",slug:"carrelage"},{id:18,name:"Pose de Marbre",icon_name:"layout-grid",slug:"marbre"},{id:19,name:"tanchit Terrasse",icon_name:"umbrella",slug:"etancheite-ter"},{id:20,name:"tanchit Toiture",icon_name:"umbrella",slug:"etancheite-toit"},{id:21,name:"Menuiserie Bois Massif",icon_name:"hammer",slug:"menuiserie-bois-massif"},{id:22,name:"Menuiserie Aluminium",icon_name:"grid",slug:"menuiserie-alu"},{id:23,name:"Menuiserie PVC",icon_name:"grid",slug:"menuiserie-pvc"},{id:24,name:"Vranda & Pergola",icon_name:"home",slug:"veranda"},{id:25,name:"Pltrerie & Staff",icon_name:"layout",slug:"platrerie"},{id:26,name:"Vitrerie & Miroiterie",icon_name:"square",slug:"vitrerie"},{id:27,name:"Soudure  l'arc",icon_name:"wrench",slug:"soudure-arc"},{id:28,name:"Soudure Argon",icon_name:"wrench",slug:"soudure-argon"},{id:29,name:"Ferronnerie d'Art",icon_name:"anvil",slug:"ferronnerie"},{id:30,name:"Climatisation Rsidentielle",icon_name:"cloud-lightning",slug:"clim-res"},{id:31,name:"Climatisation Centralise",icon_name:"cloud-lightning",slug:"clim-cent"},{id:32,name:"Froid Commercial",icon_name:"thermometer-snowflake",slug:"froid-comm"},{id:33,name:"Ascenseur & Escalier Mca",icon_name:"arrow-up-down",slug:"ascenseur"},{id:34,name:"Domotique & Smart Home",icon_name:"home",slug:"domotique"},{id:35,name:"Piscine & Jacuzzi",icon_name:"droplets",slug:"piscine"},{id:36,name:"Installation Gaz Cuisine",icon_name:"flame",slug:"gaz-cuisine"},{id:37,name:"chafaudage Pro",icon_name:"layers",slug:"echafaudage"},{id:38,name:"Isolation Thermique",icon_name:"shield",slug:"isolation-therm"},{id:39,name:"Ponage Parquet",icon_name:"sparkles",slug:"poncage-parquet"},{id:40,name:"Ponage Marbre",icon_name:"sparkles",slug:"poncage-marbre"},{id:41,name:"Stores & Volets Roulants",icon_name:"panel-top",slug:"stores"},{id:42,name:"Signaltique Enseignes",icon_name:"info",slug:"signaletique"},{id:43,name:"Forage & Puits",icon_name:"droplets",slug:"forage"},{id:44,name:"Mcanique Essence",icon_name:"car",slug:"meca-essence"},{id:45,name:"Mcanique Diesel",icon_name:"car",slug:"meca-diesel"},{id:46,name:"lectricit Automobile",icon_name:"zap",slug:"elec-auto"},{id:47,name:"Tlerie & Carrosserie",icon_name:"car",slug:"tolerie"},{id:48,name:"Peinture Automobile",icon_name:"paint-bucket",slug:"peinture-auto"},{id:49,name:"Vulcanisation & Pneus",icon_name:"circle-dot",slug:"vulcanisation"},{id:50,name:"Mcanique Moto",icon_name:"bike",slug:"meca-moto"},{id:51,name:"Mcanique Poids Lourds",icon_name:"truck",slug:"meca-camion"},{id:52,name:"Mcanique Engins BTP",icon_name:"truck",slug:"meca-engins"},{id:53,name:"Diagnostic lectronique",icon_name:"cpu",slug:"diag-auto"},{id:54,name:"Lavage & Lustrage",icon_name:"waves",slug:"lavage-auto"},{id:55,name:"Tapisserie Automobile",icon_name:"armchair",slug:"tapisserie-auto"},{id:56,name:"Location Vhicule Priv",icon_name:"key",slug:"location-auto"},{id:57,name:"Chauffeur Priv",icon_name:"user",slug:"chauffeur-prive"},{id:58,name:"Livreur Urbain (Moto)",icon_name:"package",slug:"livreur-moto"},{id:59,name:"Livreur Urbain (Vlo)",icon_name:"bike",slug:"livreur-velo"},{id:60,name:"Dmnagement Camion",icon_name:"truck",slug:"demenagement-camion"},{id:61,name:"Transport de Marchandises",icon_name:"truck",slug:"transport-marchandises"},{id:62,name:"Coursier Express",icon_name:"package",slug:"coursier"},{id:63,name:"Rparation Vlo",icon_name:"bike",slug:"rep-velo"},{id:64,name:"Couture Homme Traditionnelle",icon_name:"scissors",slug:"couture-homme-trad"},{id:65,name:"Couture Femme Traditionnelle",icon_name:"scissors",slug:"couture-femme-trad"},{id:66,name:"Couture Prt--porter",icon_name:"scissors",slug:"couture-pap"},{id:67,name:"Stylisme & Modlisme",icon_name:"palette",slug:"stylisme"},{id:68,name:"Bijouterie Or & Argent",icon_name:"gem",slug:"bijouterie"},{id:69,name:"Maroquinerie Sacs",icon_name:"briefcase",slug:"maroquinerie-sacs"},{id:70,name:"Maroquinerie Chaussures",icon_name:"briefcase",slug:"maroquinerie-chaussures"},{id:71,name:"Cordonnerie & Rparation",icon_name:"footprints",slug:"cordonnerie"},{id:72,name:"Tissage de Perruques",icon_name:"sparkles",slug:"tissage"},{id:73,name:"Coiffure Homme (Barbier)",icon_name:"user",slug:"coiffure-homme"},{id:74,name:"Coiffure Femme (Tresses)",icon_name:"user-round",slug:"coiffure-femme-tresses"},{id:75,name:"Coiffure Femme (Chignons)",icon_name:"user-round",slug:"coiffure-femme-chignons"},{id:76,name:"Esthtique & Maquillage",icon_name:"flower2",slug:"esthetique"},{id:77,name:"Soins du Visage",icon_name:"flower2",slug:"soins-visage"},{id:78,name:"Teinture Textile (Thioup)",icon_name:"palette",slug:"teinture-thioup"},{id:79,name:"Batik & Artisanat",icon_name:"brush",slug:"batik"},{id:80,name:"Poterie & Cramique",icon_name:"flower",slug:"poterie"},{id:81,name:"Vannerie & Paniers",icon_name:"shopping-basket",slug:"vannerie"},{id:82,name:"Sculpture Bois Dcor",icon_name:"hammer",slug:"sculpture-bois"},{id:83,name:"Sculpture Pierre",icon_name:"hammer",slug:"sculpture-pierre"},{id:84,name:"Tapisserie Ameublement",icon_name:"armchair",slug:"tapisserie-ameublement"},{id:85,name:"Rideaux & Dco Textile",icon_name:"palette",slug:"rideaux"},{id:86,name:"Blanchisserie & Pressing",icon_name:"waves",slug:"blanchisserie"},{id:87,name:"Nettoyage  Sec",icon_name:"waves",slug:"nettoyage-sec"},{id:88,name:"Horlogerie & Montres",icon_name:"watch",slug:"horlogerie"},{id:89,name:"Tatouage & Henn",icon_name:"pen-tool",slug:"tatouage-henne"},{id:90,name:"Manucure & Pdicure",icon_name:"sparkles",slug:"manucure"},{id:91,name:"Boulangerie Traditionnelle",icon_name:"utensils-crossed",slug:"boulangerie-trad"},{id:92,name:"Boulangerie Moderne",icon_name:"utensils-crossed",slug:"boulangerie-mod"},{id:93,name:"Ptisserie Fine",icon_name:"cake-slice",slug:"patisserie-fine"},{id:94,name:"Traiteur vnementiel",icon_name:"chef-hat",slug:"traiteur-event"},{id:95,name:"Traiteur Entreprise",icon_name:"chef-hat",slug:"traiteur-pro"},{id:96,name:"Cuisine Locale (Dibiterie)",icon_name:"utensils",slug:"dibiterie"},{id:97,name:"Cuisine Locale (Thieb)",icon_name:"utensils",slug:"thieb"},{id:98,name:"Transformation Fruits",icon_name:"leaf",slug:"transfo-fruits"},{id:99,name:"Transformation Crales",icon_name:"wheat",slug:"transfo-cereales"},{id:100,name:"Transformation Halieutique",icon_name:"fish",slug:"transfo-poisson"},{id:101,name:"Torrfaction Caf",icon_name:"coffee",slug:"torrefaction-cafe"},{id:102,name:"Apiculture & Miel",icon_name:"beaker",slug:"apiculture"},{id:103,name:"Aviculture (Poulets)",icon_name:"bird",slug:"aviculture"},{id:104,name:"Marachage Urbain",icon_name:"leaf",slug:"maraichage"},{id:105,name:"Livraison Repas Domicile",icon_name:"bike",slug:"livraison-repas"},{id:106,name:"Jus Locaux & Boissons",icon_name:"cup-soda",slug:"jus-locaux"},{id:107,name:"Boucherie & Dcoupe",icon_name:"shrub",slug:"boucherie"},{id:108,name:"Glacier & Sorbet",icon_name:"ice-cream",slug:"glacier"},{id:109,name:"Rparation Smartphone",icon_name:"smartphone",slug:"rep-phone"},{id:110,name:"Rparation Tablette",icon_name:"tablet",slug:"rep-tablet"},{id:111,name:"Rparation Laptop",icon_name:"monitor",slug:"rep-laptop"},{id:112,name:"Rparation Console Jeux",icon_name:"gamepad-2",slug:"rep-console"},{id:113,name:"Installation Rseau Wifi",icon_name:"wifi",slug:"reseau-wifi"},{id:114,name:"Maintenance Imprimante",icon_name:"printer",slug:"maintenance-imprimante"},{id:115,name:"Installation CCTV/Vido",icon_name:"video",slug:"cctv"},{id:116,name:"Vente Matriel Info",icon_name:"hard-drive",slug:"vente-informatique"},{id:117,name:"Dveloppement Web",icon_name:"code",slug:"dev-web"},{id:118,name:"Dveloppement Mobile",icon_name:"code-2",slug:"dev-mobile"},{id:119,name:"Infographie & Design Logo",icon_name:"layout",slug:"infographie"},{id:120,name:"Community Management",icon_name:"message-square",slug:"community-manager"},{id:121,name:"Photographie Mariage",icon_name:"camera",slug:"photo-mariage"},{id:122,name:"Photographie Studio",icon_name:"camera",slug:"photo-studio"},{id:123,name:"Montage Vido Youtube",icon_name:"video",slug:"montage-video"},{id:124,name:"Sonorisation Mariage/Event",icon_name:"music",slug:"sonorisation"},{id:125,name:"Installation Antenne TV",icon_name:"tv",slug:"antenne-tv"},{id:126,name:"Maintenance olienne",icon_name:"fan",slug:"eolien"},{id:127,name:"nergie Biomasse",icon_name:"flame",slug:"biomasse"},{id:128,name:"Rparation lectromnager",icon_name:"tv",slug:"rep-electro"},{id:129,name:"Nettoyage Bureaux",icon_name:"sparkles",slug:"nettoyage-bureaux"},{id:130,name:"Nettoyage Domicile",icon_name:"sparkles",slug:"nettoyage-domicile"},{id:131,name:"Dsinfection Nuisibles",icon_name:"shield-alert",slug:"desinfection"},{id:132,name:"Jardinage Rsidentiel",icon_name:"wind",slug:"jardinage-res"},{id:133,name:"Paysagisme & Design Jardin",icon_name:"leaf",slug:"paysagisme"},{id:134,name:"Recyclage Plastique",icon_name:"recycle",slug:"recyclage-plastique"},{id:135,name:"Recyclage Mtaux",icon_name:"recycle",slug:"recyclage-metaux"},{id:136,name:"Recyclage lectronique",icon_name:"recycle",slug:"recyclage-electronique"},{id:137,name:"ducation & Rptition",icon_name:"graduation-cap",slug:"repetition"},{id:138,name:"Cours de Langues (Wolof)",icon_name:"languages",slug:"cours-wolof"},{id:139,name:"Formation Informatique",icon_name:"book-open",slug:"formation-info"},{id:140,name:"Assistance Administrative",icon_name:"file-text",slug:"assistanat"},{id:141,name:"Conseil en Marketing",icon_name:"bar-chart-3",slug:"conseil-mkt"},{id:142,name:"Traducteur Franais/Wolof",icon_name:"languages",slug:"traducteur-wo"},{id:143,name:"Agent de Scurit Priv",icon_name:"shield",slug:"securite-privee"},{id:144,name:"Gardiennage Rsidence",icon_name:"eye",slug:"gardiennage"},{id:145,name:"Conciergerie Luxe",icon_name:"bell",slug:"conciergerie"},{id:146,name:"Vente en Ligne (WhatsApp)",icon_name:"shopping-cart",slug:"ecommerce-wa"},{id:147,name:"Gestion de Stock",icon_name:"boxes",slug:"gestion-stock"},{id:148,name:"Organisation Voyage",icon_name:"plane",slug:"voyage"}];function Pi(){const[i,u]=c.useState([]),[f,o]=c.useState(!1);return c.useEffect(()=>{(async()=>{o(!0);try{const{data:N,error:h}=await j.from("categories").select("*").order("name");!h&&N&&N.length>0?u(N):(console.warn("Using fallback categories - API error:",h),u(E0))}catch(N){console.warn("Using fallback categories - Exception:",N),u(E0)}o(!1)})()},[]),{categories:i,loading:f,searchArtisans:async(y,N)=>{o(!0);let h=j.from("artisans").select("*, profiles(*)");N&&(h=h.eq("category_id",N)),y&&(h=h.or(`specialty.ilike.%${y}%,bio.ilike.%${y}%,profiles.full_name.ilike.%${y}%`));const{data:g,error:E}=await h;return o(!1),g||[]}}}const Bp="/download/mbourake.apk";function A0({variant:i="nav"}){const[u,f]=c.useState(!1),o=i==="nav"?"flex items-center gap-2 text-gray-600 hover:text-brand-500 font-semibold text-sm transition-all duration-200":"flex items-center gap-2 text-gray-600 hover:text-brand-500 font-bold text-sm transition-colors";return e.jsxs(e.Fragment,{children:[e.jsxs("button",{type:"button",onClick:()=>f(!0),className:o,children:[e.jsx(Qi,{size:i==="nav"?18:20,className:"shrink-0"}),e.jsx("span",{className:"hidden sm:inline",children:"Tlcharger l'app Android"}),e.jsx("span",{className:"sm:hidden",children:"App Android"})]}),u&&e.jsx("div",{className:"fixed inset-0 z-[100] flex items-center justify-center bg-black/50 p-4",onClick:x=>x.target===x.currentTarget&&f(!1),role:"presentation",children:e.jsxs("div",{className:"fixed left-1/2 top-1/2 w-[calc(100%-2rem)] max-w-md max-h-[85vh] -translate-x-1/2 -translate-y-1/2 flex flex-col rounded-2xl bg-white shadow-2xl overflow-hidden",style:{maxHeight:"85vh"},role:"dialog","aria-labelledby":"download-app-title","aria-modal":"true",onClick:x=>x.stopPropagation(),children:[e.jsxs("div",{className:"flex items-start justify-between gap-3 p-5 shrink-0 border-b border-gray-100",children:[e.jsxs("div",{className:"flex items-center gap-3 min-w-0",children:[e.jsx("div",{className:"w-11 h-11 rounded-xl bg-brand-100 flex items-center justify-center shrink-0",children:e.jsx(Qi,{size:24,className:"text-brand-600"})}),e.jsx("h2",{id:"download-app-title",className:"text-base md:text-lg font-black text-gray-900",children:"App Mbourake pour Android"})]}),e.jsx("button",{type:"button",onClick:()=>f(!1),className:"p-2 rounded-lg text-gray-400 hover:text-gray-600 hover:bg-gray-100 transition-colors shrink-0","aria-label":"Fermer",children:e.jsx(Ze,{size:20})})]}),e.jsxs("div",{className:"p-5 overflow-y-auto flex-1 min-h-0",children:[e.jsx("p",{className:"text-gray-600 text-sm leading-relaxed mb-4",children:"Tlchargez l'application et installez-la sur votre tlphone Android. Vous pourrez utiliser Mbourake comme une app, sans passer par le Play Store."}),e.jsx("p",{className:"text-gray-500 text-xs leading-relaxed mb-4",children:"Aprs le tlchargement, ouvrez le fichier et acceptez l'installation si votre appareil vous demande d'autoriser les  sources inconnues ."}),e.jsxs("div",{className:"flex flex-col gap-3",children:[e.jsxs(e.Fragment,{children:[e.jsxs("a",{href:Bp,target:"_blank",rel:"noopener noreferrer",download:"mbourake.apk",className:"flex items-center justify-center gap-2 w-full py-3.5 px-4 bg-brand-500 text-white rounded-xl font-bold text-sm shadow-md hover:bg-brand-600 transition-colors no-underline",onClick:()=>f(!1),children:[e.jsx(mn,{size:20}),"Tlcharger l'APK"]}),e.jsx("p",{className:"text-gray-400 text-xs text-center",children:"Si le lien ne fonctionne pas, l'APK n'est pas encore disponible. Ressayez plus tard."})]}),e.jsx("button",{type:"button",onClick:()=>f(!1),className:"py-2.5 text-gray-500 hover:text-gray-700 font-medium text-sm transition-colors",children:"Fermer"})]})]})]})})]})}function cr(i){return(i||"").toLowerCase().normalize("NFD").replace(new RegExp("\\p{Diacritic}","gu"),"")}const q0=10,Hp=6;function Gp(){const i=ht(),[u]=_l(),f=Nt(),{profile:o,loading:x}=It(),{categories:y,loading:N}=Pi(),[h,g]=c.useState(""),[E,d]=c.useState(!1),[v,b]=c.useState([]),w=c.useRef(null),[_,L]=c.useState(!1);c.useEffect(()=>{const k=window.setTimeout(()=>L(!0),3e3);return()=>window.clearTimeout(k)},[]);const M=(f.loading||x)&&!_,D=!f.loading&&!x&&!!f.user&&!!o,U={hammer:e.jsx(S0,{size:24}),wrench:e.jsx(ns,{size:24}),"paint-bucket":e.jsx(xp,{size:24}),droplets:e.jsx(lp,{size:24}),zap:e.jsx(tf,{size:24}),"hard-hat":e.jsx(np,{size:24}),"cloud-lightning":e.jsx(tp,{size:24}),wind:e.jsx(Ep,{size:24}),car:e.jsx(Jh,{size:24}),scissors:e.jsx(jp,{size:24}),"chef-hat":e.jsx(Ih,{size:24}),truck:e.jsx(ef,{size:24}),lightbulb:e.jsx(P0,{size:24}),sparkles:e.jsx(I0,{size:24}),bike:e.jsx(Ph,{size:24})},J=c.useMemo(()=>y.slice(0,12),[y]),F=c.useMemo(()=>h.trim()?y.filter(k=>k.name.toLowerCase().includes(h.toLowerCase())):J,[J,y,h]),G=c.useMemo(()=>{const k=cr(h.trim());return k?y.filter(q=>cr(q.name).includes(k)).slice(0,q0):y.slice(0,q0)},[h,y]),Z=c.useMemo(()=>{const k=cr(h.trim());return!k||k.length<2?[]:v.filter(q=>cr(q.name).includes(k)||cr(q.specialty).includes(k)||cr(q.category).includes(k)).slice(0,Hp)},[h,v]),X=G.length>0||Z.length>0;c.useEffect(()=>{(async()=>{const{data:q,error:T}=await j.from("artisans").select("id, specialty, categories(name)").limit(80);if(T||!(q!=null&&q.length)){b([]);return}const C=q.map(V=>V.id),{data:B}=await j.from("profiles").select("id, full_name, avatar_url").in("id",C),z={};B&&B.forEach(V=>{z[V.id]=V});const S=q.map(V=>{var fe,ye,Y,$;const le=z[V.id],he=((fe=le==null?void 0:le.full_name)==null?void 0:fe.trim())||"Artisan",Ne=((ye=le==null?void 0:le.avatar_url)==null?void 0:ye.trim())||`https://ui-avatars.com/api/?name=${encodeURIComponent(he)}&background=F97316&color=fff`;return{id:V.id,name:he,specialty:((Y=V.specialty)==null?void 0:Y.trim())||"Spcialiste",category:(($=V.categories)==null?void 0:$.name)||"Autre",img:Ne}});b(S)})()},[]),c.useEffect(()=>{const k=q=>{w.current&&!w.current.contains(q.target)&&d(!1)};return document.addEventListener("mousedown",k),()=>document.removeEventListener("mousedown",k)},[]);const R=k=>{d(!1),g(""),i(`/category/${k}`)},ae=k=>{d(!1),g(""),i(`/artisans/${k}`)},ge=k=>{k.preventDefault(),h.trim()?i(`/artisans?search=${encodeURIComponent(h)}`):i("/artisans")};return c.useEffect(()=>{if(f.loading||x||!f.user)return;if(!o){const B=localStorage.getItem("mbourake_pending_role"),z=new URLSearchParams({mode:"onboarding"});B&&z.set("role",B),i(`/edit-profile?${z.toString()}`,{replace:!0});return}if(u.get("recherche")==="1"||typeof window<"u"&&window.location.search.includes("recherche=1"))return;["role","full_name","location"].every(B=>o[B]&&o[B].toString().trim().length>0)&&(o.role!=="artisan"||o.category_id)&&i("/dashboard",{replace:!0})},[f.loading,x,f.user,o,i,u]),M?e.jsx("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",style:{backgroundColor:"#f9fafb",minHeight:"100vh"},children:e.jsxs("div",{className:"flex flex-col items-center gap-4",children:[e.jsx("div",{className:"w-12 h-12 border-4 border-brand-500 border-t-transparent rounded-full animate-spin"}),e.jsx("p",{className:"text-sm text-gray-600 font-medium",children:"Chargement..."})]})}):e.jsxs("div",{className:"min-h-screen bg-[#F8F9FA] overflow-x-hidden selection:bg-brand-100 font-sans",children:[e.jsxs("nav",{className:"bg-white/95 backdrop-blur-md px-4 md:px-8 lg:px-20 py-3 md:py-4 flex items-center justify-between border-b border-gray-100/50 shadow-sm sticky top-0 z-50",children:[e.jsxs("button",{onClick:()=>i("/"),className:"flex items-center gap-2.5 group transition-all",children:[e.jsxs("span",{className:"text-xl md:text-2xl font-black text-gray-900 tracking-tighter italic group-hover:text-brand-500 transition-colors",children:["Mboura",e.jsx("span",{className:"text-brand-500",children:"k"})]}),e.jsx("div",{className:"w-4 h-4 md:w-5 md:h-5 rounded-full border border-gray-200 group-hover:border-brand-300 flex items-center justify-center text-[9px] md:text-[10px] text-gray-400 group-hover:text-brand-500 font-bold transition-colors",children:"i"})]}),e.jsxs("div",{className:"flex items-center gap-2 md:gap-3 lg:gap-5",children:[e.jsxs("button",{onClick:()=>i("/about"),className:"hidden lg:block text-gray-600 hover:text-brand-500 font-semibold text-sm transition-all duration-200 relative group",children:[" propos",e.jsx("span",{className:"absolute bottom-0 left-0 w-0 h-0.5 bg-brand-500 group-hover:w-full transition-all duration-200"})]}),e.jsx("div",{className:"hidden lg:block",children:e.jsx(A0,{variant:"nav"})}),e.jsx("div",{className:"hidden md:block w-px h-6 bg-gray-200"}),e.jsx("div",{className:"flex items-center gap-2 md:gap-3",children:D?e.jsxs(e.Fragment,{children:[e.jsx("button",{onClick:()=>i("/dashboard"),className:"px-4 md:px-5 py-2 md:py-2.5 bg-white text-gray-700 border border-gray-200 rounded-xl font-bold text-[10px] md:text-xs uppercase tracking-wider hover:border-brand-400 hover:text-brand-600 hover:bg-brand-50 active:scale-[0.97] transition-all duration-200 shadow-sm hover:shadow-md",children:"Mon tableau de bord"}),e.jsx("button",{onClick:()=>i("/artisans"),className:"px-4 md:px-5 py-2 md:py-2.5 bg-brand-500 text-white rounded-xl font-black text-[10px] md:text-xs uppercase tracking-wider shadow-md shadow-brand-200/50 hover:bg-brand-600 hover:shadow-lg hover:shadow-brand-300/50 active:scale-[0.97] transition-all duration-200",children:"Explorer les artisans"})]}):e.jsxs(e.Fragment,{children:[e.jsx("button",{onClick:()=>i("/onboard?mode=signup"),className:"px-4 md:px-5 py-2 md:py-2.5 bg-white text-gray-700 border border-gray-200 rounded-xl font-bold text-[10px] md:text-xs uppercase tracking-wider hover:border-brand-400 hover:text-brand-600 hover:bg-brand-50 active:scale-[0.97] transition-all duration-200 shadow-sm hover:shadow-md",children:"S'inscrire"}),e.jsx("button",{onClick:()=>i("/onboard?mode=login"),className:"px-4 md:px-5 py-2 md:py-2.5 bg-brand-500 text-white rounded-xl font-black text-[10px] md:text-xs uppercase tracking-wider shadow-md shadow-brand-200/50 hover:bg-brand-600 hover:shadow-lg hover:shadow-brand-300/50 active:scale-[0.97] transition-all duration-200",children:"Connexion"})]})})]})]}),e.jsxs("section",{className:"relative h-[650px] flex flex-col items-center justify-center text-center px-6 overflow-hidden",style:{backgroundImage:'url("https://images.unsplash.com/photo-1547471080-7cc2caa01a7e?auto=format&fit=crop&q=80")',backgroundSize:"cover",backgroundPosition:"center"},children:[e.jsx("div",{className:"absolute inset-0 bg-black/55 backdrop-blur-[1px]"}),e.jsxs("div",{className:"relative z-10 w-full max-w-4xl animate-in fade-in zoom-in duration-700",children:[e.jsxs("h1",{className:"text-4xl md:text-7xl font-black text-white mb-10 tracking-tighter leading-[1.1]",children:["Trouvez les meilleurs ",e.jsx("br",{}),e.jsx("span",{className:"text-brand-500",children:"artisans"})," du Sngal."]}),e.jsxs("div",{ref:w,className:"w-full max-w-2xl mx-auto relative",children:[e.jsxs("form",{onSubmit:ge,className:"flex w-full bg-white rounded-2xl overflow-hidden shadow-2xl p-1.5 border-4 border-white/20 backdrop-blur-md transition-all focus-within:ring-4 ring-brand-500/30",children:[e.jsxs("div",{className:"flex-1 flex items-center px-4 gap-3 text-gray-400",children:[e.jsx(xa,{size:24,className:"text-brand-500 shrink-0"}),e.jsx("input",{type:"text",value:h,onChange:k=>{g(k.target.value),d(!0)},onFocus:()=>d(!0),placeholder:"Rechercher une catgorie ou un artisan (ex: Maon, Couture...)",className:"w-full py-4 outline-none text-gray-700 font-bold text-lg placeholder:font-medium min-w-0",autoComplete:"off"}),h&&e.jsx("button",{type:"button",onClick:()=>{g(""),d(!1)},className:"p-1 text-gray-400 hover:text-gray-600 shrink-0","aria-label":"Effacer",children:e.jsx(Ze,{size:20})})]}),e.jsx("button",{type:"submit",className:"bg-brand-500 text-white px-10 py-4 font-black rounded-xl hover:bg-brand-600 transition-all uppercase tracking-widest text-xs shadow-lg shadow-brand-100 active:scale-95",children:"Rechercher"})]}),E&&X&&e.jsxs("div",{className:"absolute top-full left-0 right-0 mt-2 bg-white rounded-2xl border border-gray-200 shadow-xl z-50 overflow-hidden max-h-[70vh] overflow-y-auto",children:[G.length>0&&e.jsxs("div",{className:"p-2",children:[e.jsx("p",{className:"text-[10px] font-black text-gray-400 uppercase tracking-widest px-3 py-2",children:"Catgories"}),G.map(k=>e.jsxs("button",{type:"button",onClick:()=>R(k.slug||String(k.id)),className:"w-full flex items-center justify-between gap-2 px-4 py-3 rounded-xl hover:bg-brand-50 text-left transition-colors",children:[e.jsx("span",{className:"font-bold text-gray-900 truncate",children:k.name}),e.jsx(da,{size:18,className:"text-gray-400 shrink-0"})]},k.id))]}),Z.length>0&&e.jsxs("div",{className:"p-2 border-t border-gray-100",children:[e.jsx("p",{className:"text-[10px] font-black text-gray-400 uppercase tracking-widest px-3 py-2",children:"Artisans"}),Z.map(k=>e.jsxs("button",{type:"button",onClick:()=>ae(k.id),className:"w-full flex items-center gap-3 px-4 py-3 rounded-xl hover:bg-brand-50 text-left transition-colors",children:[e.jsx("img",{src:k.img,alt:"",className:"w-10 h-10 rounded-full object-cover shrink-0"}),e.jsxs("div",{className:"min-w-0 flex-1",children:[e.jsx("p",{className:"font-bold text-gray-900 truncate",children:k.name}),e.jsxs("p",{className:"text-xs text-gray-500 truncate",children:[k.specialty,"  ",k.category]})]}),e.jsx(da,{size:18,className:"text-gray-400 shrink-0"})]},k.id))]})]})]}),e.jsx("div",{className:"mt-10 flex flex-wrap justify-center gap-3",children:["Maonnerie","Plomberie","Couture","Solaire","Mcanique"].map(k=>e.jsx("button",{onClick:()=>{g(k),d(!0)},className:"px-4 py-1.5 bg-white/10 backdrop-blur-md border border-white/20 rounded-full text-white text-[10px] font-black uppercase tracking-widest hover:bg-brand-500 transition-all",children:k},k))})]})]}),e.jsxs("section",{id:"categories-section",className:"py-24 px-6 md:px-20 bg-white scroll-mt-24",children:[e.jsxs("div",{className:"flex flex-col items-center mb-20 text-center",children:[e.jsx("h2",{className:"text-3xl md:text-5xl font-black text-gray-900 tracking-tight mb-4",children:"Corps de mtiers populaires"}),e.jsx("p",{className:"text-gray-500 max-w-xl mb-8 font-medium leading-relaxed italic",children:'"Le mlange parfait entre professionnels qualifis et clients exigeants, ancr dans la culture sngalaise."'}),e.jsx("div",{className:"h-1.5 w-24 bg-brand-500 rounded-full"})]}),N?e.jsx("div",{className:"flex justify-center p-20",children:e.jsx("div",{className:"w-12 h-12 border-4 border-brand-500 border-t-transparent rounded-full animate-spin"})}):e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"grid grid-cols-2 md:grid-cols-3 lg:grid-cols-4 gap-8 max-w-5xl mx-auto mb-12",children:F.length>0?F.map((k,q)=>e.jsxs("button",{onClick:()=>i(`/category/${k.slug||k.id}`),className:"flex flex-col items-center group animate-in fade-in slide-in-from-bottom-4 duration-500",style:{animationDelay:`${q*5}ms`},children:[e.jsx("div",{className:"w-20 h-20 bg-orange-50/50 rounded-[2rem] flex items-center justify-center text-brand-500 mb-5 transition-all duration-500 group-hover:bg-brand-500 group-hover:text-white shadow-sm border border-orange-100 group-hover:rotate-6 group-hover:scale-110",children:U[k.icon_name||"wrench"]||e.jsx(ns,{size:24})}),e.jsx("span",{className:"text-[9px] font-black text-gray-800 text-center uppercase tracking-[0.12em] leading-tight px-2 transition-colors group-hover:text-brand-600 h-10 flex items-center justify-center",children:k.name})]},k.id)):e.jsxs("div",{className:"col-span-full py-20 text-center",children:[e.jsxs("p",{className:"text-gray-400 font-bold uppercase tracking-widest text-sm",children:['Aucun mtier ne correspond  votre recherche "',h,'"']}),e.jsx("button",{onClick:()=>g(""),className:"mt-4 text-brand-500 font-black uppercase text-xs hover:underline underline-offset-4",children:"Voir tous les mtiers"})]})}),!h&&e.jsx("div",{className:"flex justify-center mt-8",children:e.jsxs("button",{onClick:()=>i("/artisans"),className:"px-8 py-4 bg-brand-500 text-white font-black rounded-2xl hover:bg-brand-600 active:scale-[0.98] transition-all uppercase tracking-widest text-xs shadow-lg shadow-brand-200 flex items-center gap-2",children:[e.jsx(Y0,{size:18}),"Voir toutes les catgories"]})})]})]}),e.jsxs("section",{className:"py-32 px-6 bg-orange-50/20 flex flex-col items-center text-center",children:[e.jsx("div",{className:"w-20 h-20 bg-brand-500 rounded-3xl flex items-center justify-center text-white mb-10 rotate-6 shadow-2xl shadow-brand-100/50",children:e.jsx(S0,{size:36,strokeWidth:2.5,className:"-rotate-6"})}),e.jsx("h2",{className:"text-4xl font-black text-gray-900 mb-6 tracking-tight",children:"Prt  commencer ?"}),e.jsx("p",{className:"text-gray-500 max-w-xl mb-12 leading-relaxed font-medium",children:"Rejoignez la plateforme et connectez-vous avec les meilleurs artisans du Sngal."}),e.jsxs("div",{className:"flex flex-col sm:flex-row gap-4",children:[e.jsx("button",{onClick:()=>i("/onboard?mode=signup"),className:"bg-gray-900 text-white px-16 py-5 rounded-2xl font-black text-xs uppercase tracking-[0.25em] shadow-2xl hover:bg-brand-500 transition-all active:scale-95",children:"S'inscrire"}),e.jsx("button",{onClick:()=>i("/onboard?mode=login"),className:"bg-white text-gray-700 border-2 border-gray-200 px-16 py-5 rounded-2xl font-black text-xs uppercase tracking-[0.25em] shadow-xl hover:border-brand-500 hover:text-brand-600 transition-all active:scale-95",children:"Se connecter"})]})]}),e.jsxs("footer",{className:"bg-white border-t py-20 px-6 text-center",children:[e.jsx("div",{className:"mb-10",children:e.jsxs("span",{className:"text-3xl font-black text-gray-900 tracking-tighter italic",children:["Mboura ",e.jsx("span",{className:"text-brand-500",children:"k"})]})}),e.jsxs("div",{className:"flex flex-wrap justify-center gap-6 mb-10",children:[e.jsx("button",{onClick:()=>i("/about"),className:"text-gray-600 hover:text-brand-500 font-bold text-sm transition-colors",children:" propos"}),e.jsx("button",{onClick:()=>i("/artisans"),className:"text-gray-600 hover:text-brand-500 font-bold text-sm transition-colors",children:"Artisans"}),e.jsx(A0,{variant:"footer"}),e.jsx("button",{onClick:()=>i("/onboard?mode=signup"),className:"text-gray-600 hover:text-brand-500 font-bold text-sm transition-colors",children:"S'inscrire"})]}),e.jsx("p",{className:"text-gray-400 text-[9px] font-black uppercase tracking-[0.4em] mb-10 opacity-60",children:" 2026 Mbourake - L'alliance de l'excellence artisanale."}),e.jsx("div",{className:"h-px w-20 bg-orange-100 mx-auto"})]})]})}const $p=()=>e.jsxs("svg",{viewBox:"0 0 24 24",width:"20",height:"20","aria-hidden":"true",children:[e.jsx("path",{fill:"#4285F4",d:"M22.56 12.25c0-.78-.07-1.53-.2-2.25H12v4.26h5.92c-.26 1.37-1.04 2.53-2.21 3.31v2.77h3.57c2.08-1.92 3.28-4.74 3.28-8.09z"}),e.jsx("path",{fill:"#34A853",d:"M12 23c2.97 0 5.46-.98 7.28-2.66l-3.57-2.77c-.98.66-2.23 1.06-3.71 1.06-2.86 0-5.29-1.93-6.16-4.53H2.18v2.84C3.99 20.53 7.7 23 12 23z"}),e.jsx("path",{fill:"#FBBC05",d:"M5.84 14.09c-.22-.66-.35-1.36-.35-2.09s.13-1.43.35-2.09V7.07H2.18C1.43 8.55 1 10.22 1 12s.43 3.45 1.18 4.93l2.85-2.22.81-.62z"}),e.jsx("path",{fill:"#EA4335",d:"M12 5.38c1.62 0 3.06.56 4.21 1.64l3.15-3.15C17.45 2.09 14.97 1 12 1 7.7 1 3.99 3.47 2.18 7.07l3.66 2.84c.87-2.6 3.3-4.53 6.16-4.53z"})]});function Qp(){const i=ht(),u=Nt(),[f]=_l(),o=f.get("mode"),x=o==="login"||o==="signup"?o:"signup",[y,N]=c.useState(x==="login"?"auth":"role"),[h,g]=c.useState(null),[E,d]=c.useState(!1),[v,b]=c.useState(null);c.useEffect(()=>{const M=f.get("role");x==="signup"&&(M==="client"||M==="artisan")&&(g(M),N("auth"))},[f,x]);const w=()=>{i("/",{replace:!0})},_=M=>{if(x==="login"){N("auth");return}g(M),N("auth");const D=new URLSearchParams;D.set("mode",x),D.set("role",M),i(`/onboard?${D.toString()}`,{replace:!0})},L=async()=>{if(x==="signup"&&!h){b("Merci de choisir d'abord Client ou Artisan.");return}b(null),d(!0);try{x==="signup"&&h&&(localStorage.setItem("mbourake_pending_role",h),localStorage.setItem("mbourake_pending_mode",x));const M=x==="signup"&&h||void 0;await u.signInWithGoogle(x,M)}catch(M){b((M==null?void 0:M.message)??"Impossible de dmarrer la connexion avec Google"),d(!1)}};return e.jsxs("div",{className:"min-h-screen bg-gradient-to-br from-[#FDFCFB] via-white to-orange-50/30 flex flex-col",children:[e.jsx("header",{className:"px-6 py-4 bg-white border-b border-gray-100",children:e.jsx("div",{className:"max-w-md mx-auto flex items-center justify-between",children:e.jsxs("button",{onClick:w,className:"flex items-center gap-2 text-gray-500 hover:text-brand-600 font-bold text-sm transition-colors",children:[e.jsx(Wt,{size:18}),"Retour"]})})}),e.jsx("main",{className:"flex-1 flex flex-col items-center justify-center px-6 py-8",children:e.jsxs("div",{className:"w-full max-w-md",children:[y==="role"&&x==="signup"&&e.jsxs("div",{className:"animate-in fade-in slide-in-from-right-4 duration-300",children:[e.jsxs("div",{className:"text-center mb  -8",children:[e.jsx("h1",{className:"text-3xl font-black text-gray-900 mb-2",children:"Vous tes..."}),e.jsx("p",{className:"text-gray-500",children:"Choisissez votre profil"})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsx("button",{onClick:()=>_("client"),className:"w-full rounded-3xl border-2 border-gray-100 p-6 text-left transition-all hover:scale-[1.02] active:scale-[0.98] hover:border-brand-200 hover:shadow-lg",children:e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("div",{className:"w-16 h-16 rounded-2xl flex items-center justify-center bg-brand-500 text-white",children:e.jsx(ot,{size:32})}),e.jsxs("div",{className:"flex-1",children:[e.jsx("div",{className:"font-black text-lg text-gray-900",children:"Je suis Client"}),e.jsx("div",{className:"text-sm text-gray-500",children:"Je cherche un artisan pour mon projet"})]})]})}),e.jsx("button",{onClick:()=>_("artisan"),className:"w-full rounded-3xl border-2 border-gray-100 p-6 text-left transition-all hover:scale-[1.02] active:scale-[0.98] hover:border-brand-200 hover:shadow-lg",children:e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("div",{className:"w-16 h-16 rounded-2xl flex items-center justify-center bg-brand-500 text-white",children:e.jsx(Ht,{size:32})}),e.jsxs("div",{className:"flex-1",children:[e.jsx("div",{className:"font-black text-lg text-gray-900",children:"Je suis Artisan"}),e.jsx("div",{className:"text-sm text-gray-500",children:"Je propose mes services et mon savoir-faire"})]})]})})]})]}),y==="auth"&&e.jsxs("div",{className:"animate-in fade-in slide-in-from-right-4 duration-300",children:[e.jsxs("div",{className:"text-center mb-8",children:[e.jsx("h1",{className:"text-3xl font-black text-gray-900 mb-2",children:x==="signup"?"Crer mon compte":"Se connecter"}),e.jsx("p",{className:"text-gray-500",children:x==="signup"?"Choisissez votre mthode d'authentification":"Connectez-vous  votre compte"})]}),e.jsxs("div",{className:"space-y-6",children:[e.jsxs("button",{onClick:L,disabled:E||x==="signup"&&!h,type:"button",className:"w-full flex items-center justify-center gap-3 bg-white border-2 border-gray-100 rounded-2xl py-4 font-bold text-gray-700 hover:border-gray-200 hover:shadow-md transition-all disabled:opacity-50 disabled:cursor-not-allowed",children:[e.jsx($p,{}),E?"Redirection vers Google...":x==="signup"?"S'inscrire avec Google":"Se connecter avec Google"]}),v&&e.jsx("div",{className:"bg-red-50 border border-red-200 rounded-xl p-3 text-sm text-red-600 font-medium",children:v})]})]}),y!=="role"&&y!=="auth"&&e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"w-12 h-12 border-4 border-brand-500 border-t-transparent rounded-full animate-spin mx-auto mb-4"}),e.jsx("p",{className:"text-gray-500",children:"Chargement..."})]})]})})]})}const wd=i=>i>=50?"Platine":i>=25?"Or":i>=10?"Argent":"Bronze",_d={Platine:"bg-gradient-to-r from-purple-500 to-pink-500 text-white",Or:"bg-gradient-to-r from-yellow-400 to-orange-400 text-white",Argent:"bg-gradient-to-r from-gray-400 to-gray-500 text-white",Bronze:"bg-gradient-to-r from-orange-300 to-orange-400 text-white"};function Ia(i){return(i||"").toLowerCase().normalize("NFD").replace(new RegExp("\\p{Diacritic}","gu"),"")}const Yp=6;function Xp(){const i=ht(),[u]=_l(),{categories:f}=Pi(),{user:o}=Nt(),{profile:x}=It(),y=c.useRef(null),[N,h]=c.useState([]),[g,E]=c.useState(!0),[d,v]=c.useState(u.get("search")||""),[b,w]=c.useState(!1),[_,L]=c.useState(u.get("category")||""),[M,D]=c.useState(u.get("region")||""),[U,J]=c.useState(null),[F,G]=c.useState(""),[Z,X]=c.useState(""),[R,ae]=c.useState(u.get("affiliation")||""),[ge,k]=c.useState(!1),q=!!o&&!!x;c.useEffect(()=>{(async()=>{E(!0);const{data:$,error:ce}=await j.from("artisans").select(`
          id, bio, specialty, verification_status, is_available, rating_avg,
          category_id, portfolio_urls,
          categories (name, slug)
        `).limit(200);if(ce){console.error("Error fetching artisans:",ce),h([]),E(!1);return}if(!$||$.length===0){h([]),E(!1);return}const we=$.map(ue=>ue.id),[We,pe,Ye,st]=await Promise.all([j.from("profiles").select("id, full_name, avatar_url, location").in("id",we),j.from("reviews").select("artisan_id").in("artisan_id",we),j.from("quotes").select("artisan_id").in("artisan_id",we).eq("status","accepted"),j.from("artisan_affiliations").select("artisan_id, affiliation_type").in("artisan_id",we).eq("status","verified")]),Ke={};We.data&&We.data.forEach(ue=>{Ke[ue.id]=ue});const ft={};pe.data&&pe.data.forEach(ue=>{ft[ue.artisan_id]=(ft[ue.artisan_id]||0)+1});const _e={};Ye.data&&Ye.data.forEach(ue=>{_e[ue.artisan_id]=(_e[ue.artisan_id]||0)+1});const je={};st.data&&st.data.forEach(ue=>{je[ue.artisan_id]||(je[ue.artisan_id]=[]),je[ue.artisan_id].includes(ue.affiliation_type)||je[ue.artisan_id].push(ue.affiliation_type)});const Le=$.map(ue=>{var Lt,qt,kt,Rt,Ce,Me,tt;const Ae=Ke[ue.id],ze=((Lt=Ae==null?void 0:Ae.full_name)==null?void 0:Lt.trim())||"Artisan",Ge=((qt=Ae==null?void 0:Ae.location)==null?void 0:qt.trim())||"Sngal",xe=((kt=Ae==null?void 0:Ae.avatar_url)==null?void 0:kt.trim())||null,Se=ft[ue.id]||0,Pe=_e[ue.id]||0,Xe=((Rt=ue.categories)==null?void 0:Rt.name)||"Autre",gt=((Ce=ue.categories)==null?void 0:Ce.slug)||"";return{id:ue.id,name:ze,specialty:((Me=ue.specialty)==null?void 0:Me.trim())||"Spcialiste",category:Xe,categorySlug:gt,rating:ue.rating_avg??0,reviews:Se,projects_completed:Pe,status:ue.is_available!==!1?"Disponible":"Occup",tier:wd(Pe),location:Ge,verified:ue.verification_status==="verified",img:xe||`https://ui-avatars.com/api/?name=${encodeURIComponent(ze)}&background=F97316&color=fff`,bio:((tt=ue.bio)==null?void 0:tt.trim())||"",is_available:ue.is_available!==!1,affiliationTypes:je[ue.id]||[]}});h(Le),E(!1)})()},[]);const T=c.useMemo(()=>{const Y=Ia(d.trim());return Y?f.filter($=>Ia($.name).includes(Y)).slice(0,10):f.slice(0,12)},[d,f]),C=c.useMemo(()=>{const Y=Ia(d.trim());return!Y||Y.length<2?[]:N.filter($=>Ia($.name).includes(Y)||Ia($.specialty).includes(Y)||Ia($.category).includes(Y)).slice(0,Yp)},[d,N]),B=T.length>0||C.length>0;c.useEffect(()=>{const Y=$=>{y.current&&!y.current.contains($.target)&&w(!1)};return document.addEventListener("mousedown",Y),()=>document.removeEventListener("mousedown",Y)},[]);const z=c.useMemo(()=>{const Y=Ia(d.trim());return N.filter($=>{if(Y){const ce=Ia($.name),we=Ia($.specialty),We=Ia($.category),pe=Ia($.bio);if(!(ce.includes(Y)||we.includes(Y)||We.includes(Y)||pe.includes(Y)))return!1}return!(_&&$.category!==_||M&&$.location!==M||U!=null&&$.rating<U||F&&$.tier!==F||Z&&$.status!==Z||R&&(!$.affiliationTypes||!$.affiliationTypes.includes(R)))})},[N,d,_,M,U,F,Z,R]),S=c.useMemo(()=>[...z].sort((Y,$)=>$.rating-Y.rating),[z]),V=c.useMemo(()=>{const Y=new Set;return N.forEach($=>{var ce;(ce=$.location)!=null&&ce.trim()&&Y.add($.location.trim())}),Array.from(Y).sort()},[N]),le=c.useMemo(()=>{const Y=new Set(N.map($=>$.category));return f.forEach($=>Y.add($.name)),Array.from(Y).sort()},[N,f]),he=()=>{v(""),L(""),D(""),J(null),G(""),X(""),ae(""),w(!1)},Ne=!!(d||_||M||U||F||Z||R),fe=Y=>{w(!1),v(""),i(`/category/${Y}`)},ye=Y=>{w(!1),v(""),i(`/artisans/${Y}`)};return g?e.jsx(Yt,{}):e.jsxs("div",{className:"min-h-screen bg-[#F8F9FA]",children:[e.jsx("header",{className:"bg-white border-b sticky top-0 z-40",children:e.jsxs("div",{className:"max-w-7xl mx-auto px-6 py-4 flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("button",{onClick:()=>i("/dashboard"),className:"p-2 hover:bg-gray-100 rounded-xl transition-colors","aria-label":"Retour au tableau de bord",children:e.jsx(Wt,{size:20,className:"text-gray-600"})}),e.jsxs("div",{children:[e.jsx("h1",{className:"text-xl font-black text-gray-900",children:"Explorer les artisans"}),e.jsxs("p",{className:"text-xs text-gray-400 font-bold",children:[S.length," professionnel",S.length>1?"s":""," trouv",S.length>1?"s":""]})]})]}),!q&&e.jsx("button",{onClick:()=>i("/"),className:"bg-brand-500 text-white px-6 py-2.5 rounded-xl font-black text-xs uppercase tracking-widest shadow-lg hover:bg-brand-600 transition-all",children:"Connexion"})]})}),e.jsx("div",{className:"bg-white border-b shadow-sm",children:e.jsxs("div",{className:"max-w-7xl mx-auto px-6 py-4",children:[e.jsxs("div",{className:"flex flex-col md:flex-row gap-4",children:[e.jsxs("div",{ref:y,className:"flex-1 relative",children:[e.jsxs("div",{className:"flex items-center gap-3 bg-gray-50 rounded-xl px-4 py-3 border border-gray-100 focus-within:border-brand-300 focus-within:ring-2 ring-brand-100 transition-all",children:[e.jsx(xa,{size:20,className:"text-gray-400 shrink-0"}),e.jsx("input",{type:"text",value:d,onChange:Y=>{v(Y.target.value),w(!0)},onFocus:()=>w(!0),placeholder:"Rechercher une catgorie (ex. Couture), un artisan...",className:"flex-1 bg-transparent outline-none text-gray-700 font-medium min-w-0",autoComplete:"off"}),d&&e.jsx("button",{type:"button",onClick:()=>{v(""),w(!1)},className:"text-gray-400 hover:text-gray-600 shrink-0",children:e.jsx(Ze,{size:18})})]}),b&&B&&e.jsxs("div",{className:"absolute top-full left-0 right-0 mt-1 bg-white rounded-xl border border-gray-200 shadow-lg z-50 overflow-hidden max-h-[70vh] overflow-y-auto",children:[T.length>0&&e.jsxs("div",{className:"p-2",children:[e.jsx("p",{className:"text-[10px] font-black text-gray-400 uppercase tracking-widest px-3 py-2",children:"Catgories"}),T.map(Y=>e.jsxs("button",{type:"button",onClick:()=>fe(Y.slug||String(Y.id)),className:"w-full flex items-center justify-between gap-2 px-4 py-3 rounded-lg hover:bg-brand-50 text-left transition-colors",children:[e.jsx("span",{className:"font-bold text-gray-900 truncate",children:Y.name}),e.jsx(da,{size:16,className:"text-gray-400 shrink-0"})]},Y.id))]}),C.length>0&&e.jsxs("div",{className:"p-2 border-t border-gray-100",children:[e.jsx("p",{className:"text-[10px] font-black text-gray-400 uppercase tracking-widest px-3 py-2",children:"Artisans"}),C.map(Y=>e.jsxs("button",{type:"button",onClick:()=>ye(Y.id),className:"w-full flex items-center gap-3 px-4 py-3 rounded-lg hover:bg-brand-50 text-left transition-colors",children:[e.jsx("img",{src:Y.img,alt:"",className:"w-10 h-10 rounded-full object-cover shrink-0"}),e.jsxs("div",{className:"min-w-0 flex-1",children:[e.jsx("p",{className:"font-bold text-gray-900 truncate",children:Y.name}),e.jsxs("p",{className:"text-xs text-gray-500 truncate",children:[Y.specialty,"  ",Y.category]})]}),e.jsx(da,{size:16,className:"text-gray-400 shrink-0"})]},Y.id))]})]})]}),e.jsxs("button",{type:"button",onClick:()=>k(!ge),className:`flex items-center gap-2 px-6 py-3 rounded-xl font-black text-xs uppercase tracking-widest transition-all shrink-0 ${ge||Ne?"bg-brand-500 text-white shadow-lg":"bg-gray-100 text-gray-600 hover:bg-gray-200"}`,children:[e.jsx(W0,{size:18}),"Filtres",Ne&&e.jsx("span",{className:"w-5 h-5 bg-white text-brand-500 rounded-full text-[10px] flex items-center justify-center",children:"!"})]})]}),ge&&e.jsxs("div",{className:"mt-6 pt-6 border-t border-gray-100 animate-in slide-in-from-top-4 duration-300",children:[e.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-3 lg:grid-cols-6 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-[10px] font-black text-gray-500 uppercase tracking-widest mb-2",children:"Catgorie"}),e.jsxs("select",{value:_,onChange:Y=>L(Y.target.value),className:"w-full px-4 py-3 bg-gray-50 border border-gray-100 rounded-xl font-bold text-sm text-gray-700 focus:outline-none focus:border-brand-300",children:[e.jsx("option",{value:"",children:"Toutes"}),le.map(Y=>e.jsx("option",{value:Y,children:Y},Y))]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-[10px] font-black text-gray-500 uppercase tracking-widest mb-2",children:"Rgion"}),e.jsxs("select",{value:M,onChange:Y=>D(Y.target.value),className:"w-full px-4 py-3 bg-gray-50 border border-gray-100 rounded-xl font-bold text-sm text-gray-700 focus:outline-none focus:border-brand-300",children:[e.jsx("option",{value:"",children:"Toutes"}),V.map(Y=>e.jsx("option",{value:Y,children:Y},Y))]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-[10px] font-black text-gray-500 uppercase tracking-widest mb-2",children:"Note minimum"}),e.jsxs("select",{value:U??"",onChange:Y=>J(Y.target.value?Number(Y.target.value):null),className:"w-full px-4 py-3 bg-gray-50 border border-gray-100 rounded-xl font-bold text-sm text-gray-700 focus:outline-none focus:border-brand-300",children:[e.jsx("option",{value:"",children:"Toutes"}),e.jsx("option",{value:"4.5",children:"4.5+ toiles"}),e.jsx("option",{value:"4",children:"4+ toiles"}),e.jsx("option",{value:"3.5",children:"3.5+ toiles"}),e.jsx("option",{value:"3",children:"3+ toiles"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-[10px] font-black text-gray-500 uppercase tracking-widest mb-2",children:"Niveau"}),e.jsxs("select",{value:F,onChange:Y=>G(Y.target.value),className:"w-full px-4 py-3 bg-gray-50 border border-gray-100 rounded-xl font-bold text-sm text-gray-700 focus:outline-none focus:border-brand-300",children:[e.jsx("option",{value:"",children:"Tous"}),e.jsx("option",{value:"Platine",children:"Platine"}),e.jsx("option",{value:"Or",children:"Or"}),e.jsx("option",{value:"Argent",children:"Argent"}),e.jsx("option",{value:"Bronze",children:"Bronze"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-[10px] font-black text-gray-500 uppercase tracking-widest mb-2",children:"Disponibilit"}),e.jsxs("select",{value:Z,onChange:Y=>X(Y.target.value),className:"w-full px-4 py-3 bg-gray-50 border border-gray-100 rounded-xl font-bold text-sm text-gray-700 focus:outline-none focus:border-brand-300",children:[e.jsx("option",{value:"",children:"Tous"}),e.jsx("option",{value:"Disponible",children:"Disponible"}),e.jsx("option",{value:"Occup",children:"Occup"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-[10px] font-black text-gray-500 uppercase tracking-widest mb-2",children:"Affiliation"}),e.jsxs("select",{value:R,onChange:Y=>ae(Y.target.value),className:"w-full px-4 py-3 bg-gray-50 border border-gray-100 rounded-xl font-bold text-sm text-gray-700 focus:outline-none focus:border-brand-300",children:[e.jsx("option",{value:"",children:"Toutes"}),e.jsx("option",{value:"chambre",children:"Chambre de mtier"}),e.jsx("option",{value:"sae",children:"SAE"}),e.jsx("option",{value:"incubateur",children:"Incubateur"}),e.jsx("option",{value:"autre",children:"Autre"})]})]})]}),Ne&&e.jsx("button",{type:"button",onClick:he,className:"mt-4 text-brand-500 font-black text-xs uppercase tracking-widest hover:underline underline-offset-4",children:"Effacer tous les filtres"})]})]})}),e.jsx("div",{className:"max-w-7xl mx-auto px-6 py-6",children:e.jsx("div",{className:"flex flex-wrap gap-2",children:["Platine","Or","Disponible","4.5+ toiles"].map(Y=>e.jsx("button",{type:"button",onClick:()=>{Y==="Platine"||Y==="Or"?G(F===Y?"":Y):Y==="Disponible"?X(Z===Y?"":Y):Y==="4.5+ toiles"&&J(U===4.5?null:4.5)},className:`px-4 py-2 rounded-full text-xs font-black uppercase tracking-widest transition-all ${Y===F||Y===Z||Y==="4.5+ toiles"&&U===4.5?"bg-brand-500 text-white shadow-lg":"bg-white text-gray-600 border border-gray-200 hover:border-brand-300"}`,children:Y},Y))})}),e.jsx("main",{className:"max-w-7xl mx-auto px-6 pb-20",children:S.length===0?e.jsxs("div",{className:"text-center py-20",children:[e.jsx("div",{className:"w-20 h-20 bg-gray-100 rounded-full flex items-center justify-center mx-auto mb-6",children:e.jsx(xa,{size:32,className:"text-gray-300"})}),e.jsx("h3",{className:"text-xl font-black text-gray-900 mb-2",children:"Aucun artisan trouv"}),e.jsx("p",{className:"text-gray-500 mb-6",children:"Essayez une catgorie dans la recherche (ex. Couture) ou modifiez les filtres."}),e.jsx("button",{type:"button",onClick:he,className:"px-6 py-3 bg-brand-500 text-white font-black text-xs uppercase tracking-widest rounded-xl hover:bg-brand-600 transition-all",children:"Rinitialiser les filtres"})]}):e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-8",children:S.map((Y,$)=>e.jsxs("div",{className:"bg-white rounded-[2rem] overflow-hidden shadow-lg border border-gray-100 hover:shadow-xl transition-all duration-500 group hover:-translate-y-1 animate-in fade-in slide-in-from-bottom-4",style:{animationDelay:`${$*50}ms`},children:[e.jsxs("div",{className:"relative h-52 overflow-hidden",children:[e.jsx("img",{src:Y.img,alt:Y.name,className:"w-full h-full object-cover transition-transform duration-700 group-hover:scale-110"}),e.jsx("div",{className:"absolute inset-0 bg-gradient-to-t from-black/60 via-transparent to-transparent"}),e.jsxs("div",{className:`absolute top-4 left-4 px-3 py-1.5 rounded-full text-[9px] font-black uppercase tracking-widest flex items-center gap-1.5 shadow-lg ${Y.status==="Disponible"?"bg-green-500 text-white":"bg-yellow-500 text-white"}`,children:[e.jsx("div",{className:`w-1.5 h-1.5 rounded-full bg-white ${Y.is_available?"animate-pulse":""}`}),Y.status]}),e.jsxs("div",{className:`absolute top-4 right-4 px-3 py-1.5 rounded-full text-[9px] font-black uppercase tracking-widest shadow-lg ${_d[Y.tier]}`,children:[e.jsx(Sl,{size:12,className:"inline mr-1"}),Y.tier]}),e.jsx("button",{type:"button",className:"absolute bottom-4 right-4 w-10 h-10 bg-white/20 backdrop-blur-md rounded-full flex items-center justify-center text-white cursor-pointer hover:bg-brand-500 transition-all shadow-lg","aria-label":"Ajouter aux favoris",children:e.jsx(xn,{size:18})}),e.jsxs("div",{className:"absolute bottom-4 left-4 flex items-center gap-1.5 text-white/90 text-xs font-bold",children:[e.jsx(ga,{size:14}),Y.location]})]}),e.jsxs("div",{className:"p-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-3",children:[e.jsx("span",{className:"text-[10px] font-black text-brand-600 uppercase tracking-[0.2em]",children:Y.category}),Y.verified&&e.jsxs("span",{className:"flex items-center gap-1 text-green-600 text-[10px] font-bold",children:[e.jsx(Zh,{size:14,fill:"currentColor",className:"fill-green-100"}),"Vrifi"]})]}),e.jsx("h3",{className:"text-lg font-black text-gray-900 mb-1",children:Y.name}),e.jsx("p",{className:"text-sm text-gray-500 font-medium mb-4",children:Y.specialty}),e.jsxs("div",{className:"flex items-center gap-3 mb-6",children:[e.jsx("div",{className:"flex items-center gap-1",children:[0,1,2,3,4].map(ce=>e.jsx(Ma,{size:14,className:ce<Math.floor(Y.rating)?"text-yellow-400 fill-yellow-400":"text-gray-200"},ce))}),e.jsx("span",{className:"text-gray-900 font-black text-sm",children:Y.rating}),e.jsxs("span",{className:"text-gray-400 text-xs font-bold",children:["(",Y.reviews," avis)"]})]}),e.jsx("p",{className:"text-xs text-gray-500 leading-relaxed mb-6 line-clamp-2",children:Y.bio}),e.jsx("button",{type:"button",onClick:()=>i(`/artisans/${Y.id}`),className:"w-full py-3.5 bg-gray-900 text-white font-black rounded-xl hover:bg-brand-500 active:scale-[0.98] transition-all uppercase tracking-widest text-[10px] shadow-lg",children:"Voir le profil complet"})]})]},Y.id))})})]})}function nf({className:i="","aria-label":u="Retour  la page prcdente"}){const f=ht(),o=()=>{f(-1)};return e.jsx("button",{type:"button",onClick:o,className:i||"w-10 h-10 rounded-full bg-gray-100 flex items-center justify-center text-gray-600 hover:bg-gray-200 transition-colors","aria-label":u,children:e.jsx(Wt,{size:20})})}function Zp(){const{slug:i}=Ya(),u=ht();_l();const{user:f}=Nt(),{profile:o}=It(),[x,y]=c.useState(null),[N,h]=c.useState([]),[g,E]=c.useState(!0),[d,v]=c.useState(""),[b,w]=c.useState(null),[_,L]=c.useState(""),[M,D]=c.useState(""),[U,J]=c.useState(!1),[F,G]=c.useState(!1),[Z,X]=c.useState("rating"),[R,ae]=c.useState(!1),ge=!!f&&!!o,k=(o==null?void 0:o.role)==="client";c.useEffect(()=>{(async()=>{if(!i)return;E(!0);const{data:V,error:le}=await j.from("categories").select("*").eq("slug",i).single();if(le||!V){const Y=parseInt(i);if(isNaN(Y)){E(!1);return}else{const{data:$}=await j.from("categories").select("*").eq("id",Y).single();$&&y($)}}else y(V);const he=(V==null?void 0:V.id)||parseInt(i),{data:Ne,error:fe}=await j.from("artisans").select(`
          id, bio, specialty, verification_status, is_available, rating_avg,
          category_id, portfolio_urls,
          categories (name, slug)
        `).eq("category_id",he);fe&&console.error("Error fetching artisans:",fe);let ye={};if(Ne&&Ne.length>0){const Y=Ne.map(we=>we.id),{data:$,error:ce}=await j.from("profiles").select("id, full_name, avatar_url, location").in("id",Y);ce?console.error("Error fetching profiles:",ce):$&&(ye=$.reduce((we,We)=>(we[We.id]=We,we),{}))}if(Ne&&Ne.length>0){const Y=await Promise.all(Ne.map(async $=>{var je,Le,ue,Ae,ze,Ge;const{count:ce}=await j.from("reviews").select("*",{count:"exact",head:!0}).eq("artisan_id",$.id),{count:we}=await j.from("quotes").select("*",{count:"exact",head:!0}).eq("artisan_id",$.id).eq("status","accepted"),We=Array.isArray($.portfolio_urls)?$.portfolio_urls.filter(xe=>xe&&xe.trim()!==""):[],pe=ye[$.id],Ye=((je=pe==null?void 0:pe.full_name)==null?void 0:je.trim())||null,st=((Le=$.specialty)==null?void 0:Le.trim())||null,Ke=((ue=pe==null?void 0:pe.location)==null?void 0:ue.trim())||null,ft=((Ae=pe==null?void 0:pe.avatar_url)==null?void 0:Ae.trim())||null,_e=((ze=$.bio)==null?void 0:ze.trim())||null;return console.log("Artisan data:",{id:$.id,fullName:Ye,specialty:st,location:Ke,avatarUrl:ft,portfolioUrls:We.length,bio:_e?_e.substring(0,50):null,profileData:pe}),{id:$.id,name:Ye||"Artisan",specialty:st||"Spcialiste",category:((Ge=$.categories)==null?void 0:Ge.name)||"Autre",category_id:$.category_id,rating:$.rating_avg||0,reviews:ce||0,projects_completed:we||0,is_available:$.is_available!==!1,tier:wd(we||0),location:Ke||"Localisation non renseigne",verified:$.verification_status==="verified",img:ft||(Ye?`https://ui-avatars.com/api/?name=${encodeURIComponent(Ye)}&background=F97316&color=fff`:"https://ui-avatars.com/api/?name=Artisan&background=F97316&color=fff"),bio:_e||"",portfolio_first_image:We.length>0?We[0]:null}}));h(Y)}else console.warn("No artisans data found for category:",he),h([]);E(!1)})()},[i]);const q=c.useMemo(()=>{const S=new Set;return N.forEach(V=>{V.location&&V.location.trim()&&S.add(V.location.trim())}),Array.from(S).sort()},[N]),T=c.useMemo(()=>N.filter(S=>!(d&&!S.name.toLowerCase().includes(d.toLowerCase())&&!S.specialty.toLowerCase().includes(d.toLowerCase())||b&&S.rating<b||_&&S.tier!==_||U&&!S.is_available||F&&!S.verified||M&&S.location!==M)),[N,d,b,_,U,F,M]),C=c.useMemo(()=>[...T].sort((S,V)=>{switch(Z){case"rating":return V.rating-S.rating;case"reviews":return V.reviews-S.reviews;case"projects":return V.projects_completed-S.projects_completed;case"tier":const le={Platine:4,Or:3,Argent:2,Bronze:1};return le[V.tier]-le[S.tier];default:return 0}}),[T,Z]),B=!!(d||b||_||M||U||F),z=()=>{v(""),w(null),L(""),D(""),J(!1),G(!1)};return g?e.jsx(Yt,{}):x?e.jsxs("div",{className:"min-h-screen bg-gray-50",children:[e.jsx("header",{className:"bg-white border-b sticky top-0 z-50 shadow-sm",children:e.jsxs("div",{className:"max-w-7xl mx-auto px-4 md:px-6 py-4 flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx(nf,{}),e.jsxs("div",{children:[e.jsx("h1",{className:"text-xl font-black text-gray-900",children:x.name}),e.jsxs("p",{className:"text-xs text-gray-400 font-bold",children:[C.length," artisan",C.length>1?"s":""," trouv",C.length>1?"s":""," ",q.length>0&&M&&` ${M}`]})]})]}),e.jsx("div",{className:"flex items-center gap-3",children:ge?e.jsxs(e.Fragment,{children:[k&&e.jsxs("button",{onClick:()=>u(`/create-project?category=${x.id}`),className:"hidden md:flex items-center gap-2 bg-brand-500 text-white px-5 py-2.5 rounded-xl font-black text-xs uppercase tracking-widest shadow-lg hover:bg-brand-600 transition-all",children:[e.jsx(Bi,{size:16}),"Publier un projet"]}),e.jsxs("button",{onClick:()=>u("/dashboard"),className:"flex items-center gap-2 bg-gray-100 text-gray-700 px-5 py-2.5 rounded-xl font-black text-xs uppercase tracking-widest hover:bg-gray-200 transition-all",children:[e.jsx(ot,{size:16}),"Tableau de bord"]})]}):e.jsx("button",{onClick:()=>u("/"),className:"bg-brand-500 text-white px-6 py-2.5 rounded-xl font-black text-xs uppercase tracking-widest shadow-lg hover:bg-brand-600 transition-all",children:"Connexion"})})]})}),e.jsx("div",{className:"bg-white border-b",children:e.jsxs("div",{className:"max-w-7xl mx-auto px-4 md:px-6 py-4",children:[e.jsxs("div",{className:"flex flex-col md:flex-row gap-4",children:[e.jsxs("div",{className:"flex-1 flex items-center gap-3 bg-gray-50 rounded-xl px-4 py-3 border border-gray-100 focus-within:border-brand-300 focus-within:ring-2 ring-brand-100 transition-all",children:[e.jsx(xa,{size:20,className:"text-gray-400"}),e.jsx("input",{type:"text",value:d,onChange:S=>v(S.target.value),placeholder:"Rechercher un artisan...",className:"flex-1 bg-transparent outline-none text-gray-700 font-medium"}),d&&e.jsx("button",{onClick:()=>v(""),className:"text-gray-400 hover:text-gray-600",children:e.jsx(Ze,{size:18})})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs("select",{value:Z,onChange:S=>X(S.target.value),className:"px-4 py-3 bg-gray-50 border border-gray-100 rounded-xl font-bold text-sm text-gray-700 focus:outline-none focus:border-brand-300",children:[e.jsx("option",{value:"rating",children:"Trier par note"}),e.jsx("option",{value:"reviews",children:"Trier par avis"}),e.jsx("option",{value:"projects",children:"Trier par projets"}),e.jsx("option",{value:"tier",children:"Trier par niveau"})]}),e.jsxs("button",{onClick:()=>ae(!R),className:`flex items-center gap-2 px-4 py-3 rounded-xl font-black text-xs uppercase tracking-widest transition-all ${R||B?"bg-brand-500 text-white shadow-lg":"bg-gray-100 text-gray-600 hover:bg-gray-200"}`,children:[e.jsx(W0,{size:16}),"Filtres"]})]})]}),R&&e.jsx("div",{className:"mt-4 pt-4 border-t border-gray-100 animate-in slide-in-from-top-2 duration-200",children:e.jsxs("div",{className:"flex flex-wrap gap-4",children:[e.jsxs("select",{value:b||"",onChange:S=>w(S.target.value?Number(S.target.value):null),className:"px-4 py-2.5 bg-gray-50 border border-gray-100 rounded-xl font-bold text-sm text-gray-700",children:[e.jsx("option",{value:"",children:"Note minimum"}),e.jsx("option",{value:"4.5",children:"4.5+ toiles"}),e.jsx("option",{value:"4",children:"4+ toiles"}),e.jsx("option",{value:"3",children:"3+ toiles"})]}),e.jsxs("select",{value:_,onChange:S=>L(S.target.value),className:"px-4 py-2.5 bg-gray-50 border border-gray-100 rounded-xl font-bold text-sm text-gray-700",children:[e.jsx("option",{value:"",children:"Tous les niveaux"}),e.jsx("option",{value:"Platine",children:"Platine"}),e.jsx("option",{value:"Or",children:"Or"}),e.jsx("option",{value:"Argent",children:"Argent"}),e.jsx("option",{value:"Bronze",children:"Bronze"})]}),e.jsx("button",{onClick:()=>J(!U),className:`px-4 py-2.5 rounded-xl font-bold text-sm transition-all ${U?"bg-green-500 text-white":"bg-gray-50 text-gray-600 border border-gray-100"}`,children:"Disponible uniquement"}),e.jsxs("button",{onClick:()=>G(!F),className:`px-4 py-2.5 rounded-xl font-bold text-sm flex items-center gap-2 transition-all ${F?"bg-blue-500 text-white":"bg-gray-50 text-gray-600 border border-gray-100"}`,children:[e.jsx(Gt,{size:14}),"Vrifis uniquement"]}),B&&e.jsx("button",{onClick:z,className:"px-4 py-2.5 text-brand-500 font-bold text-sm hover:underline",children:"Effacer les filtres"})]})})]})}),k&&e.jsx("div",{className:"md:hidden bg-brand-50 border-b border-brand-100 px-4 py-3",children:e.jsxs("button",{onClick:()=>u(`/create-project?category=${x.id}`),className:"w-full flex items-center justify-center gap-2 bg-brand-500 text-white px-5 py-3 rounded-xl font-black text-xs uppercase tracking-widest shadow-lg",children:[e.jsx(Bi,{size:18}),"Crer un projet dans cette catgorie"]})}),e.jsx("main",{className:"max-w-7xl mx-auto px-4 md:px-6 py-8",children:C.length===0?e.jsxs("div",{className:"text-center py-20",children:[e.jsx("div",{className:"w-20 h-20 bg-gray-100 rounded-full flex items-center justify-center mx-auto mb-6",children:e.jsx(Ht,{size:32,className:"text-gray-300"})}),e.jsx("h3",{className:"text-xl font-black text-gray-900 mb-2",children:"Aucun artisan dans cette catgorie"}),e.jsx("p",{className:"text-gray-500 mb-6",children:B?"Essayez de modifier vos filtres":"Les premiers artisans arrivent bientt !"}),B&&e.jsx("button",{onClick:z,className:"px-6 py-3 bg-brand-500 text-white font-bold rounded-xl",children:"Rinitialiser les filtres"})]}):e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:C.map((S,V)=>e.jsxs("div",{className:"bg-white rounded-2xl overflow-hidden shadow-sm border border-gray-100 hover:shadow-lg transition-all duration-300 group animate-in fade-in slide-in-from-bottom-2",style:{animationDelay:`${V*30}ms`},children:[e.jsxs("div",{className:"relative h-56 overflow-hidden bg-gray-100",children:[S.portfolio_first_image?e.jsx("img",{src:S.portfolio_first_image,alt:`Portfolio de ${S.name}`,className:"w-full h-full object-cover transition-transform duration-500 group-hover:scale-105",onError:le=>{const he=le.target;S.img&&he.src!==S.img&&(he.src=S.img)}}):S.img?e.jsx("img",{src:S.img,alt:S.name,className:"w-full h-full object-cover transition-transform duration-500 group-hover:scale-105"}):e.jsx("div",{className:"w-full h-full bg-gradient-to-br from-brand-100 to-orange-100 flex items-center justify-center",children:e.jsx(ot,{size:48,className:"text-gray-300"})}),e.jsx("div",{className:"absolute inset-0 bg-gradient-to-t from-black/70 via-black/20 to-transparent"}),S.img&&e.jsx("div",{className:"absolute top-3 left-3",children:e.jsx("div",{className:"w-12 h-12 rounded-xl border-2 border-white/90 shadow-lg overflow-hidden bg-white",children:e.jsx("img",{src:S.img,alt:S.name,className:"w-full h-full object-cover",onError:le=>{const he=le.target;he.style.display="none"}})})}),e.jsxs("div",{className:`absolute top-3 right-3 px-3 py-1.5 rounded-lg text-[10px] font-black uppercase tracking-wider flex items-center gap-1.5 shadow-lg ${S.is_available?"bg-green-500 text-white":"bg-gray-500 text-white"}`,children:[e.jsx("div",{className:`w-1.5 h-1.5 rounded-full bg-white ${S.is_available?"animate-pulse":""}`}),S.is_available?"Disponible":"Occup"]}),e.jsxs("div",{className:`absolute top-14 right-3 px-3 py-1.5 rounded-lg text-[10px] font-black uppercase tracking-wider flex items-center gap-1 shadow-lg ${_d[S.tier]}`,children:[e.jsx(Sl,{size:12}),S.tier]}),e.jsx("div",{className:"absolute bottom-3 left-3 right-3",children:e.jsxs("div",{className:"flex items-center gap-1.5 text-white text-xs font-bold bg-black/40 backdrop-blur-sm px-3 py-1.5 rounded-lg",children:[e.jsx(ga,{size:14}),e.jsx("span",{children:S.location})]})}),S.verified&&e.jsx("div",{className:"absolute top-14 left-3 w-8 h-8 bg-blue-500 rounded-lg flex items-center justify-center shadow-lg border-2 border-white",children:e.jsx(Gt,{size:14,className:"text-white"})})]}),e.jsxs("div",{className:"p-5",children:[S.category&&S.category!=="Autre"&&e.jsx("p",{className:"text-xs font-black text-brand-600 uppercase tracking-wider mb-1",children:S.category}),e.jsxs("h3",{className:"text-lg font-black text-gray-900 mb-1 flex items-center gap-2",children:[S.name,S.verified&&e.jsx(Qe,{size:16,className:"text-blue-500"})]}),S.specialty&&S.specialty!=="Spcialiste"&&e.jsx("p",{className:"text-sm text-gray-600 font-bold mb-3",children:S.specialty}),e.jsxs("div",{className:"flex items-center gap-4 mb-4 pb-4 border-b border-gray-100",children:[e.jsxs("div",{className:"flex items-center gap-1.5",children:[e.jsx(Ma,{size:16,className:"text-yellow-400 fill-yellow-400"}),e.jsx("span",{className:"font-black text-gray-900",children:S.rating.toFixed(1)}),e.jsxs("span",{className:"text-gray-400 text-xs",children:["(",S.reviews," avis)"]})]}),e.jsxs("div",{className:"flex items-center gap-1.5 text-gray-600",children:[e.jsx(Ht,{size:16}),e.jsxs("span",{className:"font-bold text-sm",children:[S.projects_completed," projets"]})]})]}),S.bio&&e.jsx("p",{className:"text-xs text-gray-600 mb-4 line-clamp-2 leading-relaxed",children:S.bio}),S.portfolio_first_image&&e.jsxs("div",{className:"flex items-center gap-2 mb-4 text-xs text-gray-500",children:[e.jsx(tl,{size:14}),e.jsx("span",{className:"font-medium",children:"Portfolio disponible"})]}),e.jsx("button",{onClick:()=>u(`/artisans/${S.id}`),className:"w-full py-3 bg-gray-900 text-white font-black rounded-xl hover:bg-brand-500 active:scale-[0.98] transition-all uppercase tracking-widest text-[10px]",children:"Voir le profil complet"})]})]},S.id))})}),k&&C.length>0&&e.jsx("div",{className:"fixed bottom-6 left-0 right-0 flex justify-center z-40 md:hidden",children:e.jsxs("button",{onClick:()=>u(`/create-project?category=${x.id}`),className:"flex items-center gap-2 bg-brand-500 text-white px-6 py-4 rounded-2xl font-black text-xs uppercase tracking-widest shadow-2xl shadow-brand-500/30 hover:bg-brand-600 transition-all",children:[e.jsx(Bi,{size:18}),"Crer un projet"]})})]}):e.jsx("div",{className:"min-h-screen flex flex-col items-center justify-center bg-gray-50 p-4",children:e.jsxs("div",{className:"text-center",children:[e.jsx("h2",{className:"text-2xl font-bold text-gray-900 mb-2",children:"Catgorie introuvable"}),e.jsx("p",{className:"text-gray-500 mb-6",children:"Cette catgorie n'existe pas ou a t supprime."}),e.jsx("button",{onClick:()=>u("/artisans"),className:"px-6 py-3 bg-brand-500 text-white font-bold rounded-xl",children:"Retour  l'accueil"})]})})}function Pp(){const[i,u]=c.useState(!1),[f,o]=c.useState(null),x=c.useCallback(async d=>{u(!0),o(null);try{const{data:v,error:b}=await j.from("projects").insert({client_id:d.client_id,category_id:d.category_id,title:d.title,audio_description_url:d.audio_description_url,photos_urls:d.photos_urls,location:d.location,status:"open"}).select().single();if(b)throw b;return v}catch(v){throw o(v.message),v}finally{u(!1)}},[]),y=c.useCallback(async d=>{u(!0);try{const{data:v,error:b}=await j.from("projects").select("*, categories(*)").eq("client_id",d).order("created_at",{ascending:!1});if(b)throw b;return v}catch(v){return o(v.message),[]}finally{u(!1)}},[]),N=c.useCallback(async d=>{u(!0);try{let v=j.from("projects").select("*, profiles(*), categories(*)").eq("status","open");d&&(v=v.eq("category_id",d));const{data:b,error:w}=await v.order("created_at",{ascending:!1});if(w)throw w;return b}catch(v){return o(v.message),[]}finally{u(!1)}},[]),h=c.useCallback(async d=>{u(!0),o(null);try{const{data:v,error:b}=await j.from("quotes").insert({project_id:d.project_id,artisan_id:d.artisan_id,amount:d.amount,message:d.message,estimated_duration:d.estimated_duration,status:"pending"}).select().single();if(b)throw b;return v}catch(v){throw o(v.message),v}finally{u(!1)}},[]),g=c.useCallback(async d=>{u(!0);try{const{data:v,error:b}=await j.from("quotes").select("*, profiles(*)").eq("project_id",d).order("created_at",{ascending:!1});if(b)throw b;return v}catch(v){return o(v.message),[]}finally{u(!1)}},[]),E=c.useCallback(async(d,v)=>{u(!0),o(null);try{const{error:b}=await j.from("quotes").update({status:"accepted"}).eq("id",d);if(b)throw b;await j.from("quotes").update({status:"rejected"}).eq("project_id",v).neq("id",d);const{error:w}=await j.from("projects").update({status:"quote_accepted"}).eq("id",v);if(w)throw w}catch(b){throw o(b.message),b}finally{u(!1)}},[]);return{loading:i,error:f,createProject:x,getClientProjects:y,getOpenProjects:N,createQuote:h,getProjectQuotes:g,acceptQuote:E}}function Sd({onRecordingComplete:i,onDelete:u}){const{error:f}=sa(),[o,x]=c.useState(!1),[y,N]=c.useState(null),[h,g]=c.useState(null),[E,d]=c.useState(0),v=c.useRef(null),b=c.useRef([]),w=c.useRef(null);c.useEffect(()=>()=>{w.current&&clearInterval(w.current)},[]);const _=async()=>{try{const U=await navigator.mediaDevices.getUserMedia({audio:!0}),J=new MediaRecorder(U);v.current=J,b.current=[],J.ondataavailable=F=>{F.data.size>0&&b.current.push(F.data)},J.onstop=()=>{const F=new Blob(b.current,{type:"audio/webm"});N(F),g(URL.createObjectURL(F)),i(F),U.getTracks().forEach(G=>G.stop())},J.start(),x(!0),d(0),w.current=window.setInterval(()=>{d(F=>F+1)},1e3)}catch(U){console.error("Error accessing microphone:",U),f("Impossible d'accder au micro.")}},L=()=>{v.current&&o&&(v.current.stop(),x(!1),w.current&&clearInterval(w.current))},M=U=>{const J=Math.floor(U/60),F=U%60;return`${J}:${F.toString().padStart(2,"0")}`},D=()=>{N(null),g(null),d(0),u()};return h?e.jsxs("div",{className:"flex items-center gap-3 bg-brand-50 p-4 rounded-2xl border-2 border-brand-100 animate-in zoom-in duration-200",children:[e.jsx("button",{type:"button",onClick:()=>{new Audio(h).play()},className:"w-12 h-12 bg-brand-500 text-white rounded-full flex items-center justify-center shadow-lg active:scale-90 transition-transform",children:e.jsx(Nl,{fill:"currentColor",size:20})}),e.jsxs("div",{className:"flex-1",children:[e.jsx("div",{className:"text-xs font-bold text-brand-900 uppercase tracking-widest",children:"Message Vocal"}),e.jsx("div",{className:"text-brand-600 font-medium",children:M(E)})]}),e.jsx("button",{type:"button",onClick:D,className:"p-3 text-red-500 hover:bg-red-50 rounded-xl transition-colors",children:e.jsx(gr,{size:20})})]}):e.jsx("div",{className:"flex flex-col items-center gap-4",children:o?e.jsxs("div",{className:"flex flex-col items-center gap-4 animate-pulse",children:[e.jsx("div",{className:"text-2xl font-black text-brand-600",children:M(E)}),e.jsx("button",{type:"button",onClick:L,className:"w-20 h-20 bg-red-500 text-white rounded-full flex items-center justify-center shadow-xl shadow-red-100 animate-bounce",children:e.jsx(Np,{fill:"currentColor",size:32})}),e.jsx("p",{className:"text-sm font-bold text-gray-400 uppercase tracking-widest",children:"Appuyez pour arrter"})]}):e.jsxs("div",{className:"flex flex-col items-center gap-4",children:[e.jsx("button",{type:"button",onClick:_,className:"w-20 h-20 bg-brand-500 text-white rounded-full flex items-center justify-center shadow-xl shadow-brand-100 hover:bg-brand-600 active:scale-90 transition-all",children:e.jsx(gn,{size:32})}),e.jsxs("p",{className:"text-sm font-bold text-gray-400 uppercase tracking-widest text-center",children:["Expliquez votre besoin ",e.jsx("br",{})," vocalement"]})]})})}async function Ra(i){try{const{error:u}=await j.from("notifications").insert({user_id:i.userId,type:i.type,title:i.title,message:i.message||null,data:i.data||{},is_read:!1});if(u)throw console.error("Error creating notification:",u),u}catch(u){console.error("Failed to create notification:",u)}}async function of(i){try{if(!i.is_open&&i.target_artisan_id){await Ra({userId:i.target_artisan_id,type:"new_project",title:"Nouvelle demande pour vous",message:`Une nouvelle demande "${i.title}" vous a t assigne.`,data:{project_id:i.id}});return}const{data:u}=await j.from("artisans").select("id, category_id, rating_avg, verification_status").eq("category_id",i.category_id).eq("is_available",!0);if(!u||u.length===0)return;let f=u;i.min_rating&&(f=u.filter(x=>(x.rating_avg||0)>=i.min_rating));const o=f.map(x=>({user_id:x.id,type:"new_project",title:"Nouvelle demande dans votre catgorie",message:`Une nouvelle demande "${i.title}" a t publie.`,data:{project_id:i.id}}));o.length>0&&await j.from("notifications").insert(o)}catch(u){console.error("Error notifying artisans:",u)}}async function cf(i,u,f){await Ra({userId:u,type:"new_quote",title:"Nouveau devis reu",message:`${f} a soumis un devis pour votre projet. Vous pouvez maintenant discuter avec lui via le chat.`,data:{project_id:i,chat_enabled:!0}})}async function df(i,u,f){await Ra({userId:u,type:"quote_accepted",title:"Devis accept !",message:`Votre devis pour "${f}" a t accept. En attente du paiement du client pour dmarrer les travaux.`,data:{project_id:i}})}async function uf(i,u,f){await Ra({userId:u,type:"quote_rejected",title:"Devis refus",message:`Votre devis pour "${f}" a t refus.`,data:{project_id:i}})}async function Kp(i,u,f,o,x){const y="Nouvelle demande de rvision",N=`${o} a demand une rvision de votre devis`,h={project_id:i,quote_id:u,revision_id:x,kind:"quote_revision_requested"},{error:g}=await j.from("notifications").insert({user_id:f,type:"quote_revision_requested",title:y,message:N,data:{project_id:i,quote_id:u,revision_id:x},is_read:!1});if(g&&(String(g.code)==="23514"||/notifications_type_check|invalid enum/i.test(String(g.message))))await j.from("notifications").insert({user_id:f,type:"system",title:y,message:N,data:h,is_read:!1});else if(g)throw console.error("Error creating notification (revision requested):",g),g}async function Jp(i,u,f,o,x,y){const N={accepted:"a accept votre demande de rvision",rejected:"a refus votre demande de rvision",modified:"a modifi le devis selon votre demande"},h="Rponse  votre demande de rvision",g=`${o} ${N[x]}`,E={project_id:i,quote_id:u,revision_id:y,revision_status:x,kind:"quote_revision_responded"};try{await j.from("notifications").insert({user_id:f,type:"system",title:h,message:g,data:E,is_read:!1})}catch(d){console.error("Error creating notification (revision responded):",d)}}async function Yi(i,u,f){await Ra({userId:u,type:"project_completed",title:"Travaux termins",message:`Les travaux pour "${f}" sont termins. Confirmez la clture.`,data:{project_id:i}})}async function mf(i,u,f){await Ra({userId:u,type:"project_completed",title:"Demande de clture par le client",message:`Le client a demand la clture du projet "${f}". Il va confirmer et noter votre prestation.`,data:{project_id:i}})}async function xf(i,u,f){await Ra({userId:u,type:"project_completed",title:"Clture confirme par le client",message:`Le client a confirm la fin des travaux pour "${f}". La plateforme va procder au versement de votre paiement.`,data:{project_id:i}})}async function ff(i,u,f,o){await Ra({userId:u,type:"system",title:"Participation clture",message:`${o||"L'artisan"} a cltur sa participation au projet "${f}". Aucun paiement ne sera effectu. Vous pouvez choisir un autre devis.`,data:{project_id:i}})}async function Ki(i,u,f){await Ra({userId:u,type:"payment_received",title:"Paiement reu",message:`Vous avez reu ${f.toLocaleString("fr-FR")} FCFA. Vous pouvez maintenant commencer les travaux.`,data:{project_id:i}})}async function gf(i,u,f){const{total_amount:o,tva_amount:x,commission_amount:y,artisan_payout:N}=f,h=o>0?Math.round(y/o*100):0,g=`Paiement du client reu et scuris (${o.toLocaleString("fr-FR")} FCFA). Aprs dduction TVA et commission plateforme (${h}%), votre reliquat : ${N.toLocaleString("fr-FR")} FCFA. Conformment aux CGV, ce montant vous sera vers  la clture du projet.`;await Ra({userId:u,type:"payment_received",title:"Paiement reu et scuris",message:g,data:{project_id:i,total_amount:o,tva_amount:x,commission_amount:y,artisan_payout:N,cgv_reminder:!0}})}async function hf(i,u,f){await Ra({userId:f,type:"dispute_raised",title:"Litige signal",message:`Un litige a t signal sur le projet "${u}". Le projet est en attente. L'quipe Mbourake vous contactera.`,data:{project_id:i}})}async function Gi(i,u,f){await Ra({userId:u,type:"new_message",title:"Nouveau message",message:`${f} vous a envoy un message.`,data:{project_id:i}})}async function pf(i,u,f,o){try{const{data:x,error:y}=await j.from("messages").select("id").eq("project_id",i).or(`sender_id.eq.${u},sender_id.eq.${f}`).limit(1);if(y&&console.error("Error checking existing chat:",y),!x||x.length===0){const{data:N}=await j.from("profiles").select("full_name").eq("id",f).single(),h=(N==null?void 0:N.full_name)||"l'artisan",{error:g}=await j.from("messages").insert({project_id:i,sender_id:f,receiver_id:u,content:`Bonjour ! Votre devis pour "${o}" a t accept. Nous pouvons maintenant discuter des dtails du projet. N'hsitez pas  me contacter si vous avez des questions.`,type:"text"});g?console.error("Error creating welcome message:",g):console.log(`Chat cr automatiquement pour le projet ${i}`)}}catch(x){console.error("Error ensuring project chat exists:",x)}}const bf=Object.freeze(Object.defineProperty({__proto__:null,createNotification:Ra,ensureProjectChatExists:pf,notifyArtisanClientConfirmedClosure:xf,notifyArtisanClientRequestedCompletion:mf,notifyArtisanPaymentHeldWithBreakdown:gf,notifyArtisanPaymentReceived:Ki,notifyArtisanQuoteAccepted:df,notifyArtisanQuoteRejected:uf,notifyArtisanRevisionRequested:Kp,notifyArtisansNewProject:of,notifyClientArtisanAbandoned:ff,notifyClientNewQuote:cf,notifyClientProjectCompleted:Yi,notifyClientRevisionResponded:Jp,notifyNewMessage:Gi,notifyOtherPartyDisputeRaised:hf},Symbol.toStringTag,{value:"Module"})),Wp=["Dakar","This","Diourbel","Fatick","Kaolack","Kaffrine","Kolda","Ziguinchor","Sdhiou","Saint-Louis","Louga","Matam","Tambacounda","Kdougou"],Ip=[5,10,20,50,100],eb=[1,2,3,4,5];function tb(){const i=Nt(),u=ht(),{categories:f}=Pi(),{loading:o}=Pp(),[x,y]=c.useState(""),[N,h]=c.useState(),[g,E]=c.useState(""),[d,v]=c.useState(null),[b,w]=c.useState(""),[_,L]=c.useState([]),[M,D]=c.useState(null),[U,J]=c.useState(!0),[F,G]=c.useState(null),[Z,X]=c.useState(null),[R,ae]=c.useState(null),[ge,k]=c.useState(""),[q,T]=c.useState(""),[C,B]=c.useState(""),[z,S]=c.useState(!1),[V,le]=c.useState({type:"",accessNotes:""}),[he,Ne]=c.useState(1),[fe,ye]=c.useState(!1),[Y,$]=c.useState(null),[ce,we]=c.useState(""),[We,pe]=c.useState(!1),[Ye,st]=c.useState(null),[Ke,ft]=c.useState(!1),_e=f.filter(xe=>xe.name.toLowerCase().includes(ce.toLowerCase())),je=f.find(xe=>xe.id===N);c.useEffect(()=>{(async()=>{if(!N){st(null);return}ft(!0);const{data:Se}=await j.from("projects").select("id").eq("category_id",N);if(!Se||Se.length===0){st(null),ft(!1);return}const Pe=Se.map(gt=>gt.id),{data:Xe}=await j.from("quotes").select("amount").in("project_id",Pe).eq("status","accepted").not("amount","is",null);if(Xe&&Xe.length>=3){const gt=Xe.map(Rt=>Number(Rt.amount)).filter(Rt=>Rt>0),Lt=Math.min(...gt),qt=Math.max(...gt),kt=gt.reduce((Rt,Ce)=>Rt+Ce,0)/gt.length;st({min:Math.round(Lt/1e3)*1e3,max:Math.round(qt/1e3)*1e3,avg:Math.round(kt/1e3)*1e3,count:gt.length})}else st(null);ft(!1)})()},[N]);const Le=xe=>{if(xe.target.files){const Se=Array.from(xe.target.files);_.length+Se.length<=5&&L(Pe=>[...Pe,...Se])}},ue=xe=>{xe.target.files&&xe.target.files[0]&&D(xe.target.files[0])},Ae=xe=>{L(Se=>Se.filter((Pe,Xe)=>Xe!==xe))},ze=()=>{if(q){const xe=parseInt(q.split(":")[0]);(xe<8||xe>=19)&&S(!0)}},Ge=async xe=>{var Se,Pe,Xe,gt,Lt,qt,kt,Rt;if(xe.preventDefault(),!i.user){$("Vous devez tre connect pour crer un projet");return}if(!N){$("Veuillez choisir une catgorie");return}ye(!0),$(null);try{const{data:{session:Ce},error:Me}=await j.auth.getSession();if(Me||!Ce)throw new Error("Votre session a expir. Veuillez vous reconnecter.");let tt="",Q="",be=[];if(d){const at=`${i.user.id}/projects/${Date.now()}.webm`,{data:se,error:oe}=await j.storage.from("audio").upload(at,d);if(oe)throw oe;tt=j.storage.from("audio").getPublicUrl(se.path).data.publicUrl}if(M){const at=((Se=M.name.split(".").pop())==null?void 0:Se.toLowerCase())||"mp4",se=`${i.user.id}/projects/${Date.now()}-video.${at}`,{data:oe,error:ve}=await j.storage.from("videos").upload(se,M,{contentType:M.type||"video/mp4"});if(ve)throw ve;Q=j.storage.from("videos").getPublicUrl(oe.path).data.publicUrl}for(const at of _){const se=`${i.user.id}/projects/${Date.now()}-${at.name}`,{data:oe,error:ve}=await j.storage.from("photos").upload(se,at);if(ve)throw ve;be.push(j.storage.from("photos").getPublicUrl(oe.path).data.publicUrl)}let Ee=null;V.type&&(Ee={type:V.type,accessNotes:V.accessNotes||null});const{data:Oe,error:ct}=await j.from("projects").insert({client_id:i.user.id,category_id:N,title:x||"Projet sans titre",description:(b||"").trim()||null,audio_description_url:tt||null,video_url:Q||null,photos_urls:be,location:g||null,is_open:U,target_artisan_id:U?null:F,max_distance_km:U&&Z!==null?Number(Z):null,min_rating:U&&R!==null?Number(R):null,preferred_date:ge||null,preferred_time_start:q||null,preferred_time_end:C||null,is_urgent:z,property_details:Ee,status:"open",expires_at:new Date(Date.now()+8640*60*1e3).toISOString()}).select().single();if(ct){console.error("Erreur cration projet:",ct);let at=ct.message;throw(Pe=ct.message)!=null&&Pe.includes("invalid input syntax for type integer")?at="Erreur de format de donnes. Veuillez vrifier les champs numriques (distance, note minimum).":(Xe=ct.message)!=null&&Xe.includes("row-level security policy")&&(at="Erreur d'autorisation. Veuillez vous reconnecter et ressayer."),new Error(at)}if(Oe){try{await j.rpc("log_project_action",{p_project_id:Oe.id,p_user_id:i.user.id,p_action:"created",p_new_value:{title:Oe.title,category_id:N,status:"open",is_open:U,location:g||null},p_metadata:{has_audio:!!tt,has_video:!!Q,photos_count:be.length,is_urgent:z}})}catch(at){console.error("Error logging project creation:",at)}of({id:Oe.id,title:Oe.title||"Projet sans titre",category_id:N,location:g||void 0,is_open:U,target_artisan_id:U?void 0:F||void 0,max_distance_km:U&&Z||void 0,min_rating:U&&R||void 0}).catch(at=>console.error("Error notifying artisans:",at));try{await j.from("notifications").insert({user_id:i.user.id,type:"system",title:"Projet cr avec succs",message:`Votre projet "${Oe.title||"Projet sans titre"}" a t publi. Les artisans seront notifis.`,data:{project_id:Oe.id}})}catch(at){console.error("Error notifying client:",at)}}u("/dashboard",{replace:!0})}catch(Ce){let Me=Ce.message;(gt=Ce.message)!=null&&gt.includes("row-level security policy")?Me="Erreur d'autorisation. Veuillez vous reconnecter et ressayer.":(Lt=Ce.message)!=null&&Lt.includes("Failed to fetch")||(qt=Ce.message)!=null&&qt.includes("network")?Me="Erreur de connexion. Vrifiez votre connexion internet et ressayez.":((kt=Ce.message)!=null&&kt.includes("JWT")||(Rt=Ce.message)!=null&&Rt.includes("token"))&&(Me="Votre session a expir. Veuillez vous reconnecter."),$(Me)}finally{ye(!1)}};return e.jsxs("div",{className:"min-h-screen bg-gradient-to-br from-gray-50 via-white to-gray-50",children:[e.jsxs("header",{className:"sticky top-0 z-20 bg-white/80 backdrop-blur-lg border-b border-gray-100/50 shadow-sm",children:[e.jsx("div",{className:"max-w-lg mx-auto px-4 py-4",children:e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("button",{onClick:()=>he>1?Ne(he-1):u(-1),className:"w-11 h-11 rounded-xl bg-gray-100 flex items-center justify-center text-gray-600 hover:bg-gray-200 active:scale-95 transition-all","aria-label":"Retour",children:e.jsx(Wt,{size:22})}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("h1",{className:"text-lg font-black text-gray-900",children:"Publier un projet"}),e.jsxs("div",{className:"flex items-center gap-2 mt-1",children:[e.jsxs("span",{className:"text-xs font-bold text-gray-500",children:["tape ",he," sur 3"]}),e.jsx("div",{className:"flex gap-1",children:[1,2,3].map(xe=>e.jsx("span",{className:`w-2 h-2 rounded-full transition-all ${xe===he?"bg-brand-500 scale-110":xe<he?"bg-brand-300":"bg-gray-200"}`},xe))})]})]})]})}),e.jsx("div",{className:"h-1 bg-gray-100",children:e.jsx("div",{className:"h-full bg-gradient-to-r from-brand-500 to-brand-600 rounded-r-full transition-all duration-300 ease-out",style:{width:`${he/3*100}%`}})})]}),e.jsx("main",{className:"max-w-lg mx-auto px-4 py-6 pb-32",children:e.jsxs("form",{onSubmit:Ge,children:[he===1&&e.jsxs("div",{className:"space-y-5 animate-in fade-in duration-300",children:[e.jsxs("div",{className:"text-center mb-6",children:[e.jsx("div",{className:"w-20 h-20 rounded-2xl bg-gradient-to-br from-brand-400 to-brand-600 p-1 shadow-lg shadow-brand-200/50 inline-flex items-center justify-center mb-4",children:e.jsx("div",{className:"w-full h-full rounded-xl bg-white flex items-center justify-center",children:e.jsx(gn,{size:28,className:"text-brand-500"})})}),e.jsx("h2",{className:"text-xl font-black text-gray-900",children:"Dcrivez votre besoin"}),e.jsx("p",{className:"text-sm text-gray-500 mt-1.5",children:"Message vocal, texte ou photos"})]}),e.jsxs("div",{className:"bg-white/85 backdrop-blur-xl rounded-2xl p-5 border border-white/60 shadow-glass",children:[e.jsxs("h3",{className:"font-bold text-gray-900 mb-3 flex items-center gap-2",children:[e.jsx("span",{className:"w-8 h-8 rounded-lg bg-brand-100 flex items-center justify-center",children:e.jsx(et,{size:16,className:"text-brand-600"})}),"Description crite (optionnel)"]}),e.jsx("textarea",{value:b,onChange:xe=>{w(xe.target.value),Y&&$(null)},placeholder:"Dcrivez votre besoin par crit si vous prfrez ne pas enregistrer de message vocal...",rows:4,className:"w-full rounded-xl border border-gray-200 px-4 py-3 focus:border-brand-500 focus:ring-2 focus:ring-brand-100 focus:outline-none text-gray-900 placeholder:text-gray-400 resize-y min-h-[100px]"}),e.jsx("p",{className:"text-xs text-gray-500 mt-2",children:"Vous pouvez crire, enregistrer un vocal ou les deux."})]}),Y&&e.jsxs("div",{className:"bg-red-50 border border-red-200 rounded-2xl p-4 flex items-start gap-3",children:[e.jsx(qa,{size:20,className:"text-red-500 flex-shrink-0 mt-0.5"}),e.jsx("p",{className:"text-sm text-red-600 font-medium",children:Y})]}),e.jsxs("div",{className:"bg-white/85 backdrop-blur-xl rounded-2xl p-5 border border-white/60 shadow-glass",children:[e.jsxs("h3",{className:"font-bold text-gray-900 mb-3 flex items-center justify-center gap-2",children:[e.jsx("span",{className:"w-8 h-8 rounded-lg bg-brand-100 flex items-center justify-center",children:e.jsx(gn,{size:16,className:"text-brand-600"})}),"Message vocal"]}),e.jsx(Sd,{onRecordingComplete:xe=>v(xe),onDelete:()=>v(null)})]}),e.jsxs("div",{className:"bg-white/85 backdrop-blur-xl rounded-2xl p-5 border border-white/60 shadow-glass",children:[e.jsxs("h3",{className:"font-bold text-gray-900 mb-3 flex items-center gap-2",children:[e.jsx("span",{className:"w-8 h-8 rounded-lg bg-brand-100 flex items-center justify-center",children:e.jsx(un,{size:16,className:"text-brand-600"})}),"Photos (max 5)"]}),e.jsxs("div",{className:"flex gap-3 flex-wrap",children:[_.map((xe,Se)=>e.jsxs("div",{className:"relative w-20 h-20 rounded-xl overflow-hidden border-2 border-white shadow-md",children:[e.jsx("img",{src:URL.createObjectURL(xe),alt:"",className:"w-full h-full object-cover"}),e.jsx("button",{type:"button",onClick:()=>Ae(Se),className:"absolute top-1 right-1 w-6 h-6 bg-red-500 text-white rounded-full flex items-center justify-center shadow",children:e.jsx(Ze,{size:12})})]},Se)),_.length<5&&e.jsxs("label",{className:"w-20 h-20 border-2 border-dashed border-gray-200 rounded-xl flex flex-col items-center justify-center cursor-pointer hover:border-brand-300 hover:bg-brand-50/30 transition-colors",children:[e.jsx(un,{size:22,className:"text-gray-400"}),e.jsx("span",{className:"text-[9px] text-gray-500 font-bold mt-1",children:"PHOTO"}),e.jsx("input",{type:"file",accept:"image/*",multiple:!0,className:"hidden",onChange:Le})]})]})]}),e.jsxs("div",{className:"bg-white/85 backdrop-blur-xl rounded-2xl p-5 border border-white/60 shadow-glass",children:[e.jsxs("h3",{className:"font-bold text-gray-900 mb-3 flex items-center gap-2",children:[e.jsx("span",{className:"w-8 h-8 rounded-lg bg-gray-100 flex items-center justify-center",children:e.jsx(zs,{size:16,className:"text-gray-600"})}),"Vido (optionnel)"]}),M?e.jsxs("div",{className:"flex items-center justify-between bg-gray-50 rounded-xl p-3 border border-gray-100",children:[e.jsxs("div",{className:"flex items-center gap-3 min-w-0",children:[e.jsx(zs,{size:20,className:"text-brand-500 flex-shrink-0"}),e.jsx("span",{className:"text-sm text-gray-600 truncate",children:M.name})]}),e.jsx("button",{type:"button",onClick:()=>D(null),className:"text-red-500 flex-shrink-0 p-1",children:e.jsx(Ze,{size:18})})]}):e.jsxs("label",{className:"block w-full border-2 border-dashed border-gray-200 rounded-xl p-6 text-center cursor-pointer hover:border-brand-300 hover:bg-brand-50/20 transition-colors",children:[e.jsx(zs,{size:24,className:"mx-auto text-gray-400 mb-2"}),e.jsx("p",{className:"text-sm text-gray-500 font-medium",children:"Ajouter une vido"}),e.jsx("input",{type:"file",accept:"video/*",className:"hidden",onChange:ue})]})]}),e.jsx("button",{type:"button",onClick:()=>{if(!(!!d||(b||"").trim().length>0||_.length>0)){$("Dcrivez votre besoin : message vocal, texte ou au moins une photo.");return}$(null),Ne(2)},className:"w-full bg-gradient-to-br from-brand-400 via-brand-500 to-brand-600 text-white rounded-xl py-4 font-bold shadow-cta hover:shadow-cta-hover hover:-translate-y-0.5 active:translate-y-0.5 active:shadow-cta-active transition-all duration-200",children:"Continuer"})]},"create-step-1"),he===2&&e.jsxs("div",{className:"space-y-5 animate-in fade-in duration-300",children:[e.jsxs("div",{className:"text-center mb-6",children:[e.jsx("div",{className:"w-20 h-20 rounded-2xl bg-gradient-to-br from-brand-400 to-brand-600 p-1 shadow-lg shadow-brand-200/50 inline-flex items-center justify-center mb-4",children:e.jsx("div",{className:"w-full h-full rounded-xl bg-white flex items-center justify-center",children:e.jsx(xa,{size:28,className:"text-brand-500"})})}),e.jsx("h2",{className:"text-xl font-black text-gray-900",children:"Dtails du projet"}),e.jsx("p",{className:"text-sm text-gray-500 mt-1.5",children:"Catgorie, localisation et prfrences"})]}),e.jsxs("div",{className:"bg-white/85 backdrop-blur-xl rounded-2xl p-5 border border-white/60 shadow-glass",children:[e.jsx("label",{className:"block text-xs font-bold text-gray-500 uppercase mb-2",children:"Titre du projet"}),e.jsx("input",{value:x,onChange:xe=>y(xe.target.value),className:"w-full rounded-xl border border-gray-200 px-4 py-3 focus:border-brand-500 focus:ring-2 focus:ring-brand-100 focus:outline-none",placeholder:"Ex: Rparation vier cuisine"})]}),e.jsxs("div",{className:"bg-white/85 backdrop-blur-xl rounded-2xl p-5 border border-white/60 shadow-glass",children:[e.jsx("label",{className:"block text-xs font-bold text-gray-500 uppercase mb-2",children:"Catgorie *"}),e.jsxs("div",{className:"relative",children:[e.jsx(xa,{size:18,className:"absolute left-4 top-1/2 -translate-y-1/2 text-gray-400"}),e.jsx("input",{value:ce,onChange:xe=>{we(xe.target.value),pe(!0)},onFocus:()=>pe(!0),className:"w-full rounded-xl border border-gray-200 pl-12 pr-4 py-3 focus:border-brand-500 focus:ring-2 focus:ring-brand-100 focus:outline-none",placeholder:"Rechercher un mtier..."}),je&&e.jsx("span",{className:"absolute right-4 top-1/2 -translate-y-1/2 bg-brand-100 text-brand-600 text-xs font-bold px-2 py-1 rounded-lg",children:je.name})]}),We&&e.jsx("div",{className:"mt-2 max-h-48 overflow-y-auto bg-white border border-gray-200 rounded-xl shadow-lg",children:_e.length===0?e.jsx("p",{className:"p-4 text-sm text-gray-400",children:"Aucun rsultat"}):_e.slice(0,20).map(xe=>e.jsx("button",{type:"button",onClick:()=>{h(xe.id),we(""),pe(!1)},className:`w-full text-left px-4 py-3 hover:bg-gray-50 transition-colors ${N===xe.id?"bg-brand-50 text-brand-600":"text-gray-700"}`,children:xe.name},xe.id))}),N&&e.jsx("div",{className:"mt-3",children:Ke?e.jsxs("div",{className:"bg-gray-50 rounded-xl p-3 flex items-center gap-2",children:[e.jsx("div",{className:"w-4 h-4 border-2 border-brand-500 border-t-transparent rounded-full animate-spin"}),e.jsx("span",{className:"text-sm text-gray-500",children:"Estimation en cours..."})]}):Ye?e.jsx("div",{className:"bg-gradient-to-r from-green-50 to-emerald-50 border border-green-200 rounded-xl p-4",children:e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx("div",{className:"w-10 h-10 bg-green-100 rounded-xl flex items-center justify-center flex-shrink-0",children:e.jsx(dr,{size:20,className:"text-green-600"})}),e.jsxs("div",{className:"flex-1",children:[e.jsx("p",{className:"text-sm font-bold text-green-800 mb-1",children:"Estimation de prix"}),e.jsxs("p",{className:"text-xl font-black text-green-700",children:[Ye.min.toLocaleString("fr-FR")," - ",Ye.max.toLocaleString("fr-FR")," FCFA"]}),e.jsxs("p",{className:"text-xs text-green-600 mt-1 flex items-center gap-1",children:[e.jsx(fn,{size:10}),"Bas sur ",Ye.count," projets similaires"]})]})]})}):e.jsxs("div",{className:"bg-blue-50 border border-blue-100 rounded-xl p-3 flex items-center gap-2",children:[e.jsx(fn,{size:16,className:"text-blue-500 flex-shrink-0"}),e.jsx("p",{className:"text-xs text-blue-600",children:"Pas assez de donnes pour estimer le prix. Les artisans vous proposeront leurs tarifs."})]})})]}),e.jsxs("div",{className:"bg-white/85 backdrop-blur-xl rounded-2xl p-5 border border-white/60 shadow-glass",children:[e.jsxs("label",{className:"block text-xs font-bold text-gray-500 uppercase mb-2 flex items-center gap-2",children:[e.jsx("span",{className:"w-7 h-7 rounded-lg bg-brand-100 flex items-center justify-center",children:e.jsx(ga,{size:14,className:"text-brand-600"})}),"Localisation"]}),e.jsxs("select",{value:g,onChange:xe=>E(xe.target.value),className:"w-full rounded-xl border border-gray-200 px-4 py-3 focus:border-brand-500 focus:ring-2 focus:ring-brand-100 focus:outline-none appearance-none",children:[e.jsx("option",{value:"",children:"Slectionnez une rgion"}),Wp.map(xe=>e.jsx("option",{value:xe,children:xe},xe))]})]}),e.jsxs("div",{className:"bg-white/85 backdrop-blur-xl rounded-2xl p-5 border border-white/60 shadow-glass space-y-4",children:[e.jsxs("label",{className:"block text-xs font-bold text-gray-500 uppercase flex items-center gap-2",children:[e.jsx("span",{className:"w-7 h-7 rounded-lg bg-brand-100 flex items-center justify-center",children:e.jsx(mr,{size:14,className:"text-brand-600"})}),"Date et horaires souhaits"]}),e.jsx("input",{type:"date",value:ge,onChange:xe=>k(xe.target.value),className:"w-full rounded-xl border border-gray-200 px-4 py-3 focus:border-brand-500 focus:ring-2 focus:ring-brand-100 focus:outline-none"}),e.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[e.jsxs("div",{children:[e.jsx("label",{className:"text-[10px] text-gray-400 font-bold",children:"De"}),e.jsx("input",{type:"time",value:q,onChange:xe=>{T(xe.target.value),ze()},className:"w-full rounded-xl border border-gray-200 px-4 py-3 focus:border-brand-500 focus:outline-none"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-[10px] text-gray-400 font-bold",children:""}),e.jsx("input",{type:"time",value:C,onChange:xe=>B(xe.target.value),className:"w-full rounded-xl border border-gray-200 px-4 py-3 focus:border-brand-500 focus:outline-none"})]})]}),z&&e.jsxs("div",{className:"bg-amber-50 border border-amber-200 rounded-xl p-3 flex items-start gap-2",children:[e.jsx(qa,{size:16,className:"text-amber-600 mt-0.5 flex-shrink-0"}),e.jsx("p",{className:"text-xs text-amber-800 font-medium",children:"Intervention hors horaires normaux (8h-19h). Des frais supplmentaires peuvent s'appliquer."})]})]}),e.jsx("button",{type:"button",onClick:()=>Ne(3),disabled:!N,className:"w-full bg-brand-500 text-white rounded-xl py-4 font-bold hover:bg-brand-600 active:scale-[0.99] transition-all shadow-md shadow-brand-500/30 disabled:opacity-50 disabled:shadow-none",children:"Continuer"})]}),he===3&&e.jsxs("div",{className:"space-y-5 animate-in fade-in duration-300",children:[e.jsxs("div",{className:"text-center mb-6",children:[e.jsx("div",{className:"w-20 h-20 rounded-2xl bg-gradient-to-br from-brand-400 to-brand-600 p-1 shadow-lg shadow-brand-200/50 inline-flex items-center justify-center mb-4",children:e.jsx("div",{className:"w-full h-full rounded-xl bg-white flex items-center justify-center",children:e.jsx(Is,{size:28,className:"text-brand-500"})})}),e.jsx("h2",{className:"text-xl font-black text-gray-900",children:"Type de demande"}),e.jsx("p",{className:"text-sm text-gray-500 mt-1.5",children:"Ouverte  tous ou cible"})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[e.jsxs("button",{type:"button",onClick:()=>J(!0),className:`p-5 rounded-2xl border-2 transition-all text-left shadow-sm ${U?"border-brand-500 bg-brand-50 shadow-brand-200/30":"border-gray-200 bg-white hover:border-gray-300 hover:bg-gray-50/50"}`,children:[e.jsx(Is,{size:26,className:`mb-2 ${U?"text-brand-500":"text-gray-400"}`}),e.jsx("p",{className:`font-bold text-sm ${U?"text-brand-700":"text-gray-700"}`,children:"Demande ouverte"}),e.jsx("p",{className:"text-[10px] text-gray-500 mt-1",children:"Tous les artisans peuvent rpondre"})]}),e.jsxs("button",{type:"button",onClick:()=>J(!1),className:`p-5 rounded-2xl border-2 transition-all text-left shadow-sm ${U?"border-gray-200 bg-white hover:border-gray-300 hover:bg-gray-50/50":"border-brand-500 bg-brand-50 shadow-brand-200/30"}`,children:[e.jsx(zp,{size:26,className:`mb-2 ${U?"text-gray-400":"text-brand-500"}`}),e.jsx("p",{className:`font-bold text-sm ${U?"text-gray-700":"text-brand-700"}`,children:"Artisan spcifique"}),e.jsx("p",{className:"text-[10px] text-gray-500 mt-1",children:"Choisir un artisan prcis"})]})]}),U&&e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"bg-white/85 backdrop-blur-xl rounded-2xl p-5 border border-white/60 shadow-glass",children:[e.jsx("label",{className:"block text-xs font-bold text-gray-500 uppercase mb-3",children:"Distance maximum"}),e.jsxs("div",{className:"flex gap-2 flex-wrap",children:[e.jsx("button",{type:"button",onClick:()=>X(null),className:`px-4 py-2 rounded-xl text-sm font-bold transition-all ${Z===null?"bg-brand-500 text-white":"bg-gray-100 text-gray-600"}`,children:"Tous"}),Ip.map(xe=>e.jsxs("button",{type:"button",onClick:()=>X(xe),className:`px-4 py-2 rounded-xl text-sm font-bold transition-all ${Z===xe?"bg-brand-500 text-white":"bg-gray-100 text-gray-600"}`,children:[xe," km"]},xe))]})]}),e.jsxs("div",{className:"bg-white/85 backdrop-blur-xl rounded-2xl p-5 border border-white/60 shadow-glass",children:[e.jsx("label",{className:"block text-xs font-bold text-gray-500 uppercase mb-3",children:"Note minimum"}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("button",{type:"button",onClick:()=>ae(null),className:`px-4 py-2 rounded-xl text-sm font-bold transition-all ${R===null?"bg-brand-500 text-white":"bg-gray-100 text-gray-600"}`,children:"Tous"}),eb.map(xe=>e.jsxs("button",{type:"button",onClick:()=>ae(xe),className:`px-3 py-2 rounded-xl text-sm font-bold transition-all flex items-center gap-1 ${R===xe?"bg-brand-500 text-white":"bg-gray-100 text-gray-600"}`,children:[xe,e.jsx(Ma,{size:12,className:R===xe?"fill-white":"fill-yellow-400 text-yellow-400"})]},xe))]})]})]}),e.jsxs("div",{className:"bg-white/85 backdrop-blur-xl rounded-2xl p-5 border border-white/60 shadow-glass",children:[e.jsxs("label",{className:"block text-xs font-bold text-gray-500 uppercase mb-3 flex items-center gap-2",children:[e.jsx("span",{className:"w-7 h-7 rounded-lg bg-gray-100 flex items-center justify-center",children:e.jsx(xr,{size:14,className:"text-gray-600"})}),"Dtails du logement (optionnel)"]}),e.jsxs("select",{value:V.type,onChange:xe=>le({...V,type:xe.target.value}),className:"w-full rounded-xl border border-gray-200 px-4 py-3 focus:border-brand-500 focus:ring-2 focus:ring-brand-100 focus:outline-none appearance-none mb-3",children:[e.jsx("option",{value:"",children:"Type de bien"}),e.jsx("option",{value:"appartement",children:"Appartement"}),e.jsx("option",{value:"maison",children:"Maison"}),e.jsx("option",{value:"bureau",children:"Bureau"}),e.jsx("option",{value:"commerce",children:"Commerce"}),e.jsx("option",{value:"autre",children:"Autre"})]}),V.type&&e.jsx("input",{value:V.accessNotes,onChange:xe=>le({...V,accessNotes:xe.target.value}),className:"w-full rounded-xl border border-gray-200 px-4 py-3 focus:border-brand-500 focus:ring-2 focus:ring-brand-100 focus:outline-none",placeholder:"Notes d'accs (code, tage, etc.)"})]}),Y&&e.jsxs("div",{className:"bg-red-50 border border-red-200 rounded-2xl p-4 flex items-start gap-3",children:[e.jsx(qa,{size:20,className:"text-red-500 flex-shrink-0 mt-0.5"}),e.jsx("p",{className:"text-sm text-red-600 font-medium",children:Y})]}),e.jsx("button",{type:"submit",disabled:fe||o||!N,className:"w-full flex items-center justify-center gap-3 bg-gradient-to-br from-brand-400 via-brand-500 to-brand-600 text-white rounded-xl py-4 font-bold shadow-cta hover:shadow-cta-hover hover:-translate-y-0.5 active:translate-y-0.5 active:shadow-cta-active transition-all duration-200 disabled:opacity-50 disabled:shadow-none disabled:translate-y-0",children:fe||o?e.jsx("div",{className:"w-5 h-5 border-2 border-white border-t-transparent rounded-full animate-spin"}):e.jsxs("span",{className:"inline-flex items-center justify-center gap-3",children:[e.jsx(ap,{size:22}),"Publier ma demande"]})})]},"create-step-3")]})})]})}const ab="modulepreload",sb=function(i,u){return new URL(i,u).href},M0={},Ji=function(u,f,o){let x=Promise.resolve();if(f&&f.length>0){let N=function(d){return Promise.all(d.map(v=>Promise.resolve(v).then(b=>({status:"fulfilled",value:b}),b=>({status:"rejected",reason:b}))))};const h=document.getElementsByTagName("link"),g=document.querySelector("meta[property=csp-nonce]"),E=(g==null?void 0:g.nonce)||(g==null?void 0:g.getAttribute("nonce"));x=N(f.map(d=>{if(d=sb(d,o),d in M0)return;M0[d]=!0;const v=d.endsWith(".css"),b=v?'[rel="stylesheet"]':"";if(!!o)for(let L=h.length-1;L>=0;L--){const M=h[L];if(M.href===d&&(!v||M.rel==="stylesheet"))return}else if(document.querySelector(`link[href="${d}"]${b}`))return;const _=document.createElement("link");if(_.rel=v?"stylesheet":ab,v||(_.as="script"),_.crossOrigin="",_.href=d,E&&_.setAttribute("nonce",E),document.head.appendChild(_),v)return new Promise((L,M)=>{_.addEventListener("load",L),_.addEventListener("error",()=>M(new Error(`Unable to preload CSS for ${d}`)))})}))}function y(N){const h=new Event("vite:preloadError",{cancelable:!0});if(h.payload=N,window.dispatchEvent(h),!h.defaultPrevented)throw N}return x.then(N=>{for(const h of N||[])h.status==="rejected"&&y(h.reason);return u().catch(y)})},lb=.18,D0=.5,rb=0;function zd(i,u=0,f=10,o=!1){const x=i*(u/100),y=i+x,N=y*(f/100),h=N*lb,g=y-N-h,E=o?D0*100:rb*100,d=o?g*D0:0,v=g-d;return{baseAmount:i,urgentSurcharge:x,totalAmount:y,commissionPercent:f,commissionAmount:N,tvaAmount:h,artisanPayout:g,advancePercent:E,advanceAmount:d,remainingAmount:v}}const nb=10;async function ib(i,u){const f=u.urgent_surcharge_percent??0,o=u.commission_percent??nb,x=zd(u.total_amount,f,o,u.artisan_is_verified),{data:y,error:N}=await i.from("escrows").insert({project_id:u.project_id,total_amount:x.totalAmount,base_amount:x.baseAmount,urgent_surcharge:x.urgentSurcharge,commission_percent:x.commissionPercent,commission_amount:x.commissionAmount,tva_amount:x.tvaAmount,artisan_payout:x.artisanPayout,advance_percent:x.advancePercent,advance_amount:x.advanceAmount,advance_paid:0,status:"pending"}).select().single();if(N)throw N;return y}async function ob(i,u,f){const{data:o}=await i.from("escrows").select("*, projects(id, title, client_id)").eq("id",u).single(),{error:x}=await i.from("escrows").update({status:"held",payment_method:f,updated_at:new Date().toISOString()}).eq("id",u);if(x)throw x;if(o!=null&&o.project_id){const{error:y}=await i.from("projects").update({status:"payment_received"}).eq("id",o.project_id);if(y)throw y}}async function cb(i,u){const{data:f}=await i.from("escrows").select("advance_amount, project_id").eq("id",u).single(),{error:o}=await i.from("escrows").update({is_advance_paid:!0,advance_paid:(f==null?void 0:f.advance_amount)??0,status:"advance_paid",updated_at:new Date().toISOString()}).eq("id",u);if(o)throw o}async function db(i,u){const{error:f}=await i.from("escrows").update({status:"released",updated_at:new Date().toISOString()}).eq("id",u);if(f)throw f}async function ub(i,u){const{error:f}=await i.from("escrows").update({status:"frozen",updated_at:new Date().toISOString()}).eq("id",u);if(f)throw f}async function mb(i,u){const{error:f}=await i.from("escrows").update({status:"refunded",updated_at:new Date().toISOString()}).eq("id",u);if(f)throw f}async function xb(i,u,f){const{data:o,error:x}=await i.from("escrows").select("id, commission_percent, advance_percent, status").eq("id",u).single();if(x||!o)throw x??new Error("Escrow introuvable");if(o.status!=="pending"&&o.status!=="held")throw new Error("Impossible de modifier le montant : l'escrow n'est plus en attente.");const y=Number(o.commission_percent)||10,N=(Number(o.advance_percent)||0)>0,h=zd(f,0,y,N),{error:g}=await i.from("escrows").update({total_amount:h.totalAmount,base_amount:h.baseAmount,urgent_surcharge:h.urgentSurcharge,commission_amount:h.commissionAmount,tva_amount:h.tvaAmount,artisan_payout:h.artisanPayout,advance_amount:h.advanceAmount,updated_at:new Date().toISOString()}).eq("id",u);if(g)throw g}function bn(){const[i,u]=c.useState(!1),[f,o]=c.useState(null),x=c.useCallback(async v=>{u(!0),o(null);try{return await ib(j,{...v,commission_percent:v.commission_percent??10})}catch(b){throw o(b.message),b}finally{u(!1)}},[]),y=c.useCallback(async(v,b)=>{u(!0);try{const{data:w}=await j.from("escrows").select("*, projects(id, title, client_id)").eq("id",v).single();if(await ob(j,v,b),w!=null&&w.project_id){const{data:_}=await j.from("quotes").select("artisan_id, amount").eq("project_id",w.project_id).eq("status","accepted").single();_!=null&&_.artisan_id&&await gf(w.project_id,_.artisan_id,{total_amount:Number(w.total_amount||0),tva_amount:Number(w.tva_amount||0),commission_amount:Number(w.commission_amount||0),artisan_payout:Number(w.artisan_payout||0)})}}catch(w){throw o(w.message),w}finally{u(!1)}},[]),N=c.useCallback(async v=>{u(!0);try{const{data:b}=await j.from("escrows").select("advance_amount, project_id").eq("id",v).single();if(await cb(j,v),b!=null&&b.project_id){const{data:w}=await j.from("quotes").select("artisan_id").eq("project_id",b.project_id).eq("status","accepted").single();w!=null&&w.artisan_id&&b.advance_amount&&await Ki(b.project_id,w.artisan_id,Number(b.advance_amount))}}catch(b){throw o(b.message),b}finally{u(!1)}},[]),h=c.useCallback(async v=>{u(!0);try{await db(j,v)}catch(b){throw o(b.message),b}finally{u(!1)}},[]),g=c.useCallback(async v=>{u(!0);try{await ub(j,v)}catch(b){throw o(b.message),b}finally{u(!1)}},[]),E=c.useCallback(async v=>{u(!0);try{await mb(j,v)}catch(b){throw o(b.message),b}finally{u(!1)}},[]),d=c.useCallback(async(v,b)=>{u(!0);try{await xb(j,v,b)}catch(w){throw o(w.message),w}finally{u(!1)}},[]);return{loading:i,error:f,initiateEscrow:x,confirmDeposit:y,releaseAdvance:N,releaseFullPayment:h,freezeEscrow:g,refundEscrow:E,updateEscrowForNewAmount:d,calculateEscrow:zd}}const ta=[{id:"wave",name:"Wave",icon:"",logo:"/payment-logos/wave.png",description:"Paiement mobile Wave",processingTime:"Instantan",fees:0,minAmount:100,maxAmount:5e6,available:!0},{id:"orange_money",name:"Orange Money",icon:"",logo:"/payment-logos/orange-money.png",description:"Paiement mobile Orange Money",processingTime:"Instantan",fees:1,minAmount:100,maxAmount:2e6,available:!0},{id:"free_money",name:"Free Money",icon:"",description:"Paiement mobile Free Money",processingTime:"Instantan",fees:0,minAmount:100,maxAmount:1e6,available:!0},{id:"card",name:"Carte Bancaire",icon:"",logo:"/payment-logos/card.png",description:"Visa, Mastercard",processingTime:"Instantan",fees:2.5,minAmount:1e3,maxAmount:1e7,available:!0},{id:"bank_transfer",name:"Virement Bancaire",icon:"",description:"Virement depuis votre banque",processingTime:"24-48h",fees:0,minAmount:1e4,maxAmount:5e7,available:!0}],R0=i=>{const u=Date.now().toString(36).toUpperCase(),f=Math.random().toString(36).substring(2,8).toUpperCase();return`${i}-${u}-${f}`},T0=()=>{const u=new Date().toISOString().slice(0,10).replace(/-/g,""),f=Math.floor(Math.random()*1e4).toString().padStart(4,"0");return`MBK-${u}-${f}`};async function kd(i,u,f){await new Promise(h=>setTimeout(h,1500+Math.random()*1e3));const o=ta.find(h=>h.id===u);if(!o)return{success:!1,transactionId:"",reference:"",timestamp:new Date,amount:i,fees:0,totalCharged:i,method:u,status:"failed",message:"Mthode de paiement non reconnue"};if(i<o.minAmount)return{success:!1,transactionId:"",reference:"",timestamp:new Date,amount:i,fees:0,totalCharged:i,method:u,status:"failed",message:`Montant minimum: ${o.minAmount.toLocaleString("fr-FR")} FCFA`};if(i>o.maxAmount)return{success:!1,transactionId:"",reference:"",timestamp:new Date,amount:i,fees:0,totalCharged:i,method:u,status:"failed",message:`Montant maximum: ${o.maxAmount.toLocaleString("fr-FR")} FCFA`};const x=Math.round(i*o.fees/100),y=i+x;return Math.random()>.05?{success:!0,transactionId:R0("PAY"),reference:T0(),timestamp:new Date,amount:i,fees:x,totalCharged:y,method:o.name,status:u==="bank_transfer"?"pending":"completed",message:u==="bank_transfer"?"Virement en attente de confirmation bancaire":"Paiement effectu avec succs"}:{success:!1,transactionId:R0("FAIL"),reference:T0(),timestamp:new Date,amount:i,fees:x,totalCharged:y,method:o.name,status:"failed",message:"Paiement refus par l'oprateur. Veuillez ressayer."}}const wl={message:"Mode dmonstration - Paiements simuls",warning:"Les transactions sont simules. Aucun vrai paiement n'est effectu."};function fb({open:i,escrow:u,initialMethodId:f,onClose:o,onSuccess:x}){const[y,N]=c.useState(Number(u.total_amount)||0),[h,g]=c.useState(f||ta[0].id),[E,d]=c.useState(""),[v,b]=c.useState(!1),[w,_]=c.useState(null),[L,M]=c.useState(null);c.useEffect(()=>{i&&(N(Number(u.total_amount)||0),g(f||ta[0].id),_(null),M(null),d(""))},[i,u,f]);const D=c.useMemo(()=>ta.find(F=>F.id===h)||ta[0],[h]),U=c.useMemo(()=>{const F=Math.round(y*((D==null?void 0:D.fees)||0)/100);return y+F},[y,D]),J=async()=>{if(y<=0){M("Saisissez un montant suprieur  0");return}b(!0),M(null);try{const F=await kd(y,h,{projectId:u.project_id??void 0,escrowId:u.id,phoneNumber:E||void 0});_(F),M(F.success?null:F.message),F.success&&(await x(h,F),o())}catch{M("Erreur lors du traitement du paiement")}finally{b(!1)}};return i?e.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black/40 p-4",children:e.jsxs("div",{className:"w-full max-w-md rounded-3xl bg-white p-6 shadow-2xl",children:[e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-xs font-bold uppercase text-gray-500 tracking-[0.2em]",children:"Paiement"}),e.jsx("h3",{className:"text-2xl font-bold text-gray-900",children:"Mode bypass"})]}),e.jsx("button",{onClick:o,className:"text-gray-400 hover:text-gray-600",children:e.jsx(el,{size:24})})]}),e.jsxs("div",{className:"mt-4 rounded-2xl border border-yellow-200 bg-yellow-50 px-4 py-3 text-xs text-yellow-700",children:[e.jsx("p",{className:"font-semibold",children:wl.message}),e.jsx("p",{children:wl.warning})]}),e.jsxs("div",{className:"mt-6 space-y-3",children:[e.jsx("label",{className:"text-xs font-bold uppercase text-gray-500",children:"Montant  scuriser"}),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("input",{type:"number",min:0,value:y,onChange:F=>N(Number(F.target.value)),className:"flex-1 rounded-2xl border border-gray-200 px-4 py-3 text-lg font-bold text-gray-900 focus:border-brand-500 focus:outline-none"}),e.jsx("span",{className:"text-xs font-black text-gray-500",children:"FCFA"})]})]}),e.jsxs("div",{className:"mt-5",children:[e.jsx("p",{className:"text-xs font-bold uppercase text-gray-500 tracking-[0.3em]",children:"Mthode"}),e.jsx("div",{className:"mt-2 flex flex-wrap gap-2",children:ta.filter(F=>F.logo).map(F=>e.jsxs("button",{type:"button",onClick:()=>g(F.id),className:`flex-1 min-w-[120px] rounded-2xl border-2 px-4 py-4 text-center transition ${h===F.id?"border-brand-500 bg-brand-50 text-brand-700":"border-gray-200 bg-white text-gray-600 hover:border-gray-300"}`,children:[e.jsx("div",{className:"flex items-center justify-center mb-2 h-14 min-h-[56px]",children:F.logo?e.jsx("img",{src:F.logo,alt:F.name,className:"max-h-14 max-w-full object-contain w-auto h-auto",style:{maxHeight:"56px",maxWidth:"100%"},onError:G=>{const Z=G.target,X=Z.parentElement;if(X){Z.style.display="none";const R=document.createElement("div");R.className="text-2xl",R.textContent=F.icon,X.appendChild(R)}}}):e.jsx("div",{className:"text-2xl",children:F.icon})}),e.jsx("div",{className:"text-xs font-bold uppercase",children:F.name})]},F.id))}),ta.filter(F=>!F.logo&&F.available).length>0&&e.jsx("div",{className:"mt-2 grid grid-cols-2 gap-2",children:ta.filter(F=>!F.logo&&F.available).map(F=>e.jsxs("button",{type:"button",onClick:()=>g(F.id),className:`rounded-2xl border px-4 py-3 text-left transition ${h===F.id?"border-brand-500 bg-brand-50 text-brand-700":"border-gray-200 bg-white text-gray-600 hover:border-gray-300"}`,children:[e.jsx("div",{className:"text-xl mb-2",children:F.icon}),e.jsx("div",{className:"text-sm font-bold",children:F.name}),e.jsx("p",{className:"text-xs text-gray-500",children:F.description})]},F.id))})]}),e.jsxs("div",{className:"mt-5 space-y-2",children:[e.jsx("label",{className:"text-xs font-bold uppercase text-gray-500",children:"Numro du payeur"}),e.jsx("input",{type:"tel",value:E,onChange:F=>d(F.target.value),placeholder:"ex: 77xxxxxx",className:"w-full rounded-2xl border border-gray-200 px-4 py-3 text-sm text-gray-700 focus:border-brand-500 focus:outline-none"}),e.jsx("p",{className:"text-[10px] text-gray-400",children:"Optionnel, permet de contextualiser la transaction ct oprateur."})]}),e.jsxs("div",{className:"mt-5 rounded-2xl border border-gray-100 bg-gray-50 p-4 text-sm space-y-2",children:[e.jsxs("div",{className:"flex justify-between text-gray-500",children:[e.jsxs("span",{children:["Frais (",(D==null?void 0:D.fees)??0,"%)"]}),e.jsxs("span",{children:[Math.round(y*(((D==null?void 0:D.fees)??0)/100)).toLocaleString("fr-FR")," FCFA"]})]}),e.jsxs("div",{className:"flex justify-between font-bold text-gray-900",children:[e.jsx("span",{children:"Total"}),e.jsxs("span",{children:[U.toLocaleString("fr-FR")," FCFA"]})]}),e.jsxs("p",{className:"text-[11px] text-gray-400",children:["Mthode slectionne : ",e.jsx("strong",{children:D==null?void 0:D.name})]})]}),w&&e.jsxs("div",{className:`mt-4 flex items-center gap-2 rounded-2xl border px-4 py-3 text-sm ${w.success?"border-green-200 bg-green-50 text-green-800":"border-red-200 bg-red-50 text-red-700"}`,children:[w.success?e.jsx(Qe,{size:20}):e.jsx(zt,{size:20}),e.jsx("span",{children:w.message})]}),L&&e.jsxs("div",{className:"mt-4 flex items-center gap-2 rounded-2xl border border-red-200 bg-red-50 px-4 py-3 text-sm text-red-700",children:[e.jsx(zt,{size:18}),e.jsx("span",{children:L})]}),e.jsxs("div",{className:"mt-6 flex items-center justify-between gap-3",children:[e.jsx("button",{type:"button",onClick:o,className:"flex-1 rounded-2xl border border-gray-200 bg-white px-4 py-3 text-sm font-bold text-gray-600 transition hover:border-gray-300",children:"Annuler"}),e.jsx("button",{type:"button",onClick:J,disabled:v,className:"flex-1 rounded-2xl bg-gradient-to-r from-brand-500 to-brand-600 px-4 py-3 text-sm font-bold uppercase tracking-[0.2em] text-white transition disabled:opacity-60",children:v?e.jsx(ma,{className:"mx-auto h-4 w-4 animate-spin"}):"Simuler le paiement"})]})]})}):null}const L0={pending:{label:"En attente de paiement",color:"text-yellow-700",bgColor:"bg-yellow-50",borderColor:"border-yellow-200",icon:St},held:{label:"Fonds scuriss",color:"text-green-700",bgColor:"bg-green-50",borderColor:"border-green-200",icon:dp},advance_paid:{label:"Avance verse",color:"text-blue-700",bgColor:"bg-blue-50",borderColor:"border-blue-200",icon:Nd},released:{label:"Paiement effectu",color:"text-green-700",bgColor:"bg-green-50",borderColor:"border-green-200",icon:aa},frozen:{label:"Fonds gels (litige)",color:"text-red-700",bgColor:"bg-red-50",borderColor:"border-red-200",icon:zt},refunded:{label:"Rembours",color:"text-gray-700",bgColor:"bg-gray-50",borderColor:"border-gray-200",icon:cp}};function gb({escrow:i,isClient:u,onRefresh:f,onPaymentSuccess:o}){const{confirmDeposit:x,releaseAdvance:y,loading:N}=bn(),[h,g]=c.useState(!1),[E,d]=c.useState(!1),[v,b]=c.useState("wave"),w=L0[i.status||"pending"]||L0.pending,_=w.icon,L=()=>g(!0),M=async k=>{await x(i.id,k),await Promise.resolve(f()),o==null||o()},D=async()=>{await y(i.id),f()},U=i.total_amount||0,J=i.base_amount||U,F=i.urgent_surcharge||0,G=i.commission_amount||0,Z=i.tva_amount||0,X=i.artisan_payout||0,R=i.advance_amount||0,ae=i.advance_paid||0,ge=X-ae;return e.jsxs("div",{className:`rounded-2xl p-5 border-2 mb-6 ${w.bgColor} ${w.borderColor}`,children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:`w-10 h-10 rounded-xl flex items-center justify-center ${i.status==="frozen"?"bg-red-500":i.status==="held"?"bg-green-500":"bg-brand-500"} text-white`,children:e.jsx(dn,{size:20})}),e.jsxs("div",{children:[e.jsx("h3",{className:"font-bold text-gray-900 text-sm",children:"Garantie Mbourake"}),e.jsxs("div",{className:`flex items-center gap-1 text-xs font-bold ${w.color}`,children:[e.jsx(_,{size:12}),w.label]})]})]}),i.transaction_number&&e.jsx("span",{className:"text-[9px] font-mono text-gray-400 bg-white px-2 py-1 rounded",children:i.transaction_number})]}),e.jsxs("div",{className:"bg-white rounded-xl p-4 mb-4",children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsx("span",{className:"text-xs text-gray-500 font-medium",children:"Montant total"}),e.jsxs("span",{className:"text-xl font-black text-gray-900",children:[U.toLocaleString("fr-FR")," FCFA"]})]}),e.jsxs("button",{onClick:()=>d(!E),className:"w-full flex items-center justify-center gap-1 text-xs text-gray-400 hover:text-gray-600 pt-2 border-t border-gray-100",children:[E?e.jsx(jd,{size:14}):e.jsx(yd,{size:14}),E?"Masquer":"Voir le dtail"]}),E&&e.jsxs("div",{className:"mt-3 pt-3 border-t border-gray-100 space-y-2 text-sm animate-in fade-in duration-200",children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-gray-500",children:"Montant de base"}),e.jsxs("span",{className:"font-bold",children:[J.toLocaleString("fr-FR")," FCFA"]})]}),F>0&&e.jsxs("div",{className:"flex justify-between text-yellow-600",children:[e.jsx("span",{children:"Majoration urgence"}),e.jsxs("span",{className:"font-bold",children:["+",F.toLocaleString("fr-FR")," FCFA"]})]}),e.jsxs("div",{className:"flex justify-between text-gray-400",children:[e.jsxs("span",{children:["Commission (",i.commission_percent||10,"%)"]}),e.jsxs("span",{children:["-",G.toLocaleString("fr-FR")," FCFA"]})]}),e.jsxs("div",{className:"flex justify-between text-gray-400",children:[e.jsx("span",{children:"TVA (18%)"}),e.jsxs("span",{children:["-",Z.toLocaleString("fr-FR")," FCFA"]})]}),e.jsxs("div",{className:"flex justify-between text-green-600 font-bold pt-2 border-t border-gray-100",children:[e.jsx("span",{children:"Paiement artisan"}),e.jsxs("span",{children:[X.toLocaleString("fr-FR")," FCFA"]})]}),R>0&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"flex justify-between text-blue-600",children:[e.jsxs("span",{children:["Avance (",i.advance_percent||50,"%)"]}),e.jsxs("span",{className:"font-bold",children:[R.toLocaleString("fr-FR")," FCFA"]})]}),ae>0&&e.jsxs("div",{className:"flex justify-between text-green-500",children:[e.jsx("span",{children:"Avance verse"}),e.jsxs("span",{className:"font-bold",children:["-",ae.toLocaleString("fr-FR")," FCFA"]})]}),e.jsxs("div",{className:"flex justify-between font-bold",children:[e.jsx("span",{children:"Reste  verser"}),e.jsxs("span",{children:[ge.toLocaleString("fr-FR")," FCFA"]})]})]})]})]}),u&&i.status==="pending"&&e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx("p",{className:"text-xs text-gray-600 text-center font-medium",children:"Moyens de paiement temporaires"}),e.jsx("div",{className:"rounded-xl border border-yellow-200 bg-yellow-50 px-3 py-2 text-[10px] font-bold text-yellow-700",children:wl.message})]}),e.jsx("div",{className:"flex gap-2",children:ta.filter(k=>["wave","orange_money","card"].includes(k.id)&&k.logo).map(k=>{const q=k.id==="orange_money"?"orange":k.id;return e.jsxs("button",{onClick:()=>b(q),className:`flex-1 p-3 rounded-xl border-2 text-center transition-all ${v===q?"border-brand-500 bg-brand-50":"border-gray-200 bg-white hover:border-gray-300"}`,children:[e.jsx("div",{className:"flex items-center justify-center mb-1 h-10 min-h-[40px]",children:k.logo?e.jsx("img",{src:k.logo,alt:k.name,className:"max-h-10 max-w-full object-contain",style:{maxHeight:"40px",maxWidth:"100%"},onError:T=>{const C=T.target,B=C.parentElement;if(B){C.style.display="none";const z=document.createElement("span");z.className="text-xl block",z.textContent=k.icon,B.appendChild(z)}}}):e.jsx("span",{className:"text-xl block",children:k.icon})}),e.jsx("span",{className:"text-[10px] font-bold text-gray-600 uppercase block",children:k.id==="orange_money"?"Orange":k.name.toUpperCase()})]},k.id)})}),e.jsxs("button",{onClick:L,className:"w-full bg-green-500 text-white font-bold py-4 rounded-xl flex items-center justify-center gap-2 hover:bg-green-600 transition-colors",children:[e.jsx(Na,{size:20}),"Payer ",U.toLocaleString("fr-FR")," FCFA"]})]}),e.jsx(fb,{open:h,escrow:i,initialMethodId:v,onClose:()=>g(!1),onSuccess:M}),!u&&i.status==="held"&&R>0&&!i.is_advance_paid&&e.jsxs("div",{className:"bg-white rounded-xl p-4 space-y-3",children:[e.jsxs("div",{className:"text-center",children:[e.jsx("p",{className:"text-sm font-bold text-gray-900",children:"Avance disponible"}),e.jsxs("p",{className:"text-2xl font-black text-brand-500",children:[R.toLocaleString("fr-FR")," FCFA"]}),e.jsxs("p",{className:"text-xs text-gray-400",children:[i.advance_percent||50,"% du paiement total"]})]}),e.jsx("button",{onClick:D,disabled:N,className:"w-full bg-brand-500 text-white font-bold py-3 rounded-xl flex items-center justify-center gap-2 hover:bg-brand-600 transition-colors disabled:opacity-50",children:N?e.jsx("div",{className:"w-5 h-5 border-2 border-white border-t-transparent rounded-full animate-spin"}):e.jsxs(e.Fragment,{children:[e.jsx(Nd,{size:18}),"Recevoir mon avance"]})})]}),i.status==="advance_paid"&&e.jsxs("div",{className:"bg-white rounded-xl p-4 text-center",children:[e.jsx(aa,{size:24,className:"text-green-500 mx-auto mb-2"}),e.jsx("p",{className:"font-bold text-gray-900 text-sm",children:"Avance verse"}),e.jsxs("p",{className:"text-xs text-gray-500",children:["Le reste (",ge.toLocaleString("fr-FR")," FCFA) sera vers  la fin du projet"]})]}),i.status==="held"&&(R===0||i.is_advance_paid)&&e.jsxs("div",{className:"flex items-center justify-center gap-2 text-green-700 font-bold text-sm",children:[e.jsx("div",{className:"w-2 h-2 bg-green-500 rounded-full animate-ping"}),"Fonds scuriss dans l'escrow"]}),i.status==="released"&&e.jsxs("div",{className:"bg-white rounded-xl p-4 text-center",children:[e.jsx(aa,{size:24,className:"text-green-500 mx-auto mb-2"}),e.jsx("p",{className:"font-bold text-green-600 text-sm",children:"Paiement complet effectu"})]}),i.status==="frozen"&&e.jsxs("div",{className:"bg-white rounded-xl p-4 text-center",children:[e.jsx(zt,{size:24,className:"text-red-500 mx-auto mb-2"}),e.jsx("p",{className:"font-bold text-red-600 text-sm",children:"Fonds gels"}),e.jsx("p",{className:"text-xs text-gray-500",children:"Un litige est en cours de rsolution"})]})]})}function hb(i){const u=i.lastIndexOf("."),f=u>0?i.substring(0,u):i,o=u>0?i.substring(u).toLowerCase():"";let x=f.normalize("NFD").replace(/[\u0300-\u036f]/g,"").replace(/[^a-zA-Z0-9._-]/g,"_").replace(/_+/g,"_").replace(/^_+|_+$/g,"").substring(0,150);return x||(x="file"),x.length<3&&(x=x+"_"+Math.random().toString(36).substring(2,6)),x+o}function pb(i,u){const f=hb(i),o=Date.now(),x=Math.random().toString(36).substring(2,9);return`${o}-${x}-${f}`}function bb(i,u){const f=c.useRef(u);return c.useEffect(()=>{f.current=u},[u]),c.useEffect(()=>{if(!i)return;const o=x=>{const y=f.current||"Vous avez une soumission en cours. tes-vous sr de vouloir quitter cette page ?";return x.preventDefault(),x.returnValue=y,y};return window.addEventListener("beforeunload",o),()=>{window.removeEventListener("beforeunload",o)}},[i]),{isBlocking:i}}const yb=[0,10,20,30,50,75,100];function yf({projectId:i,artisanId:u,isUrgent:f=!1,onSuccess:o,onCancel:x}){const[y,N]=c.useState(""),[h,g]=c.useState(""),[E,d]=c.useState(0),[v,b]=c.useState(""),[w,_]=c.useState(""),[L,M]=c.useState(48),[D,U]=c.useState(""),[J,F]=c.useState(""),[G,Z]=c.useState(""),[X,R]=c.useState(null),[ae,ge]=c.useState(null),[k,q]=c.useState(!1),[T,C]=c.useState(!1),[B,z]=c.useState(null),[S,V]=c.useState(!1);bb(S||T,"Vous tes en train de soumettre un devis. tes-vous sr de vouloir quitter cette page ? Vos modifications pourraient tre perdues.");const le=parseFloat(y)||0,he=parseFloat(h)||0,Ne=le+he,fe=f?Ne*E/100:0,ye=Ne+fe,Y=ce=>{ce.target.files&&ce.target.files[0]&&ge(ce.target.files[0])},$=async ce=>{var we,We,pe;if(ce.preventDefault(),S||T){console.log("[DEBUG QuoteForm] Submission already in progress, ignoring duplicate submit");return}if(ye<=0){z("Veuillez entrer un montant valide");return}V(!0),C(!0),z(null);try{console.log("[DEBUG QuoteForm] Submitting quote - Project:",i,"Artisan:",u);let Ye=null,st=null;if(X){const ue=`${u}/quotes/${Date.now()}.webm`,{data:Ae,error:ze}=await j.storage.from("audio").upload(ue,X);if(ze)throw ze;Ye=j.storage.from("audio").getPublicUrl(Ae.path).data.publicUrl}if(ae){const ue=ae.type||"",Ae=ae.name.toLowerCase().endsWith(".pdf")||ue==="application/pdf",ze=Ae?"documents":"photos",Ge=pb(ae.name),xe=`${u}/proformas/${Ge}`,{data:Se,error:Pe}=await j.storage.from(ze).upload(xe,ae,{contentType:ae.type||(Ae?"application/pdf":"image/jpeg"),upsert:!1});if(Pe)throw console.error("Erreur upload proforma:",Pe),console.error("Nom de fichier original:",ae.name),console.error("Nom de fichier nettoy:",Ge),console.error("Chemin complet:",xe),new Error(`Erreur lors de l'upload du fichier: ${Pe.message}`);st=j.storage.from(ze).getPublicUrl(Se.path).data.publicUrl}const Ke={project_id:i,artisan_id:u,amount:Number(ye)||0,labor_cost:Number(le)||0,materials_cost:Number(he)||0,urgent_surcharge_percent:f?Number(E):0,message:v||null,estimated_duration:w||null,validity_hours:Number(L)||48,proposed_date:D||null,proposed_time_start:J||null,proposed_time_end:G||null,audio_message_url:Ye||null,proforma_url:st||null,status:"pending"};let ft=null;const{data:_e,error:je}=await j.from("quotes").insert(Ke).select("id").single();if(je&&(je.code==="23505"||je.code==="409"||(we=je.message)!=null&&we.includes("duplicate")||(We=je.message)!=null&&We.includes("unique")||(pe=je.message)!=null&&pe.includes("Conflict"))){console.log("[DEBUG QuoteForm] Quote exists, updating most recent quote instead"),console.log("[DEBUG QuoteForm] Insert error details:",je);const{data:ue,error:Ae}=await j.from("quotes").select("id, status, quote_number").eq("project_id",i).eq("artisan_id",u).order("created_at",{ascending:!1}).limit(1);if(console.log("[DEBUG QuoteForm] Existing quotes fetched:",ue),Ae)throw console.error("[DEBUG QuoteForm] Error fetching existing quote:",Ae),new Error(`Erreur lors de la rcupration du devis existant: ${Ae.message}`);const ze=ue&&ue.length>0?ue[0]:null;if(ze!=null&&ze.id){if(ze.status==="accepted")throw new Error("Ce devis a dj t accept et ne peut plus tre modifi. Veuillez crer un nouveau devis si ncessaire.");const{data:Ge,error:xe}=await j.from("quotes").update({amount:Ke.amount,labor_cost:Ke.labor_cost,materials_cost:Ke.materials_cost,urgent_surcharge_percent:Ke.urgent_surcharge_percent,message:Ke.message,estimated_duration:Ke.estimated_duration,validity_hours:Ke.validity_hours,proposed_date:Ke.proposed_date,proposed_time_start:Ke.proposed_time_start,proposed_time_end:Ke.proposed_time_end,audio_message_url:Ke.audio_message_url,proforma_url:Ke.proforma_url,updated_at:new Date().toISOString(),status:ze.status==="rejected"||ze.status==="abandoned"?"pending":ze.status||"pending"}).eq("id",ze.id).select("id");if(xe)throw new Error(`Erreur lors de la mise  jour du devis: ${xe.message}`);const Se=Ge&&Ge.length>0?Ge[0]:null;ft=(Se==null?void 0:Se.id)||ze.id,console.log("[DEBUG QuoteForm] Quote updated successfully:",ft)}else{console.warn("[DEBUG QuoteForm] 409 error but quote not found - likely RLS blocking or already exists"),console.warn("[DEBUG QuoteForm] Considering as success - quote may already exist"),setTimeout(()=>{o()},500);return}}else{if(je)throw je;ft=(_e==null?void 0:_e.id)||null,console.log("[DEBUG QuoteForm] Quote created successfully:",ft)}const Le=ft?{id:ft}:null;try{const{data:ue}=await j.from("projects").select("client_id, title").eq("id",i).single();if(ue!=null&&ue.client_id){const{data:Ae}=await j.from("messages").select("id").eq("project_id",i).eq("sender_id",u).eq("receiver_id",ue.client_id).limit(1).maybeSingle();if(!Ae){const{data:ze}=await j.from("profiles").select("full_name").eq("id",u).single();await j.from("messages").insert({project_id:i,sender_id:u,receiver_id:ue.client_id,content:`Bonjour, j'ai soumis un devis pour votre projet "${ue.title||"votre projet"}". N'hsitez pas  me contacter pour discuter des dtails.`,is_system_message:!1}),Le!=null&&Le.id&&await j.rpc("log_quote_action",{p_quote_id:Le.id,p_project_id:i,p_user_id:u,p_action:"chat_created",p_metadata:{auto_created:!0}})}}}catch(ue){console.error("Error creating chat:",ue)}if(await j.from("projects").update({status:"quote_received"}).eq("id",i),Le!=null&&Le.id)try{await j.rpc("log_quote_action",{p_quote_id:Le.id,p_project_id:i,p_user_id:u,p_action:"submitted",p_new_value:{amount:ye,status:"pending"}})}catch(ue){console.error("Error logging quote action:",ue)}try{const{data:ue}=await j.from("projects").select("client_id").eq("id",i).single(),{data:Ae}=await j.from("profiles").select("full_name").eq("id",u).single();ue!=null&&ue.client_id&&(Ae!=null&&Ae.full_name)&&await cf(i,ue.client_id,Ae.full_name)}catch(ue){console.error("Error notifying client:",ue)}await Promise.resolve(o())}catch(Ye){z(Ye.message)}finally{C(!1),V(!1)}};return e.jsxs("div",{className:"bg-white rounded-2xl border border-gray-100 overflow-hidden",children:[e.jsxs("div",{className:"p-4 bg-gradient-to-r from-brand-500 to-brand-600 text-white",children:[e.jsx("h3",{className:"font-bold text-lg",children:"Proposer un devis"}),e.jsx("p",{className:"text-white/70 text-sm",children:"Envoyez votre proposition au client"})]}),e.jsxs("form",{onSubmit:$,className:"p-4 space-y-4",children:[e.jsxs("div",{className:"bg-white/80 rounded-2xl border border-gray-100 p-4 space-y-3",children:[e.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-bold text-gray-500 uppercase mb-1",children:"Cot de la prestation"}),e.jsxs("div",{className:"relative",children:[e.jsx("input",{type:"number",min:0,step:100,value:y,onChange:ce=>N(ce.target.value),className:"w-full rounded-xl border border-gray-200 px-4 py-3 pr-14 focus:border-brand-500 focus:ring-2 focus:ring-brand-100 focus:outline-none text-gray-900 transition-shadow",placeholder:"0",required:!0}),e.jsx("span",{className:"absolute right-3 top-1/2 -translate-y-1/2 text-xs text-gray-400 font-bold",children:"FCFA"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-bold text-gray-500 uppercase mb-1",children:"Charges"}),e.jsxs("div",{className:"relative",children:[e.jsx("input",{type:"number",min:0,step:100,value:h,onChange:ce=>g(ce.target.value),className:"w-full rounded-xl border border-gray-200 px-4 py-3 pr-14 focus:border-brand-500 focus:ring-2 focus:ring-brand-100 focus:outline-none text-gray-900 transition-shadow",placeholder:"0"}),e.jsx("span",{className:"absolute right-3 top-1/2 -translate-y-1/2 text-xs text-gray-400 font-bold",children:"FCFA"})]})]})]}),e.jsxs("div",{className:"flex items-center justify-between text-xs text-gray-500 pt-1 border-t border-gray-50",children:[e.jsxs("span",{children:["Prestation + Charges ",f&&fe>0&&`+ Majoration ${E}%`]}),e.jsxs("span",{className:"font-bold text-gray-700",children:[Ne.toLocaleString("fr-FR")," ",fe>0&&`+ ${fe.toLocaleString("fr-FR")}`," "]})]})]}),f&&e.jsxs("div",{className:"bg-yellow-50 rounded-xl p-4",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-3",children:[e.jsx(qa,{size:16,className:"text-yellow-600"}),e.jsx("label",{className:"text-xs font-bold text-yellow-700 uppercase",children:"Majoration intervention urgente"})]}),e.jsx("div",{className:"flex gap-2 flex-wrap",children:yb.map(ce=>e.jsxs("button",{type:"button",onClick:()=>d(ce),className:`px-3 py-2 rounded-lg text-sm font-bold transition-all ${E===ce?"bg-yellow-500 text-white":"bg-white text-gray-600 border border-gray-200"}`,children:["+",ce,"%"]},ce))})]}),e.jsxs("div",{className:"bg-gradient-to-r from-brand-50 to-brand-50/50 rounded-xl p-4 flex items-center justify-between border border-brand-100 shadow-sm",children:[e.jsx("span",{className:"font-bold text-gray-800",children:"Total TTC"}),e.jsxs("span",{className:"text-2xl font-black text-brand-600 tabular-nums",children:[ye.toLocaleString("fr-FR")," FCFA"]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-bold text-gray-500 uppercase mb-1",children:"Description du devis"}),e.jsx("textarea",{value:v,onChange:ce=>b(ce.target.value),rows:3,className:"w-full rounded-xl border border-gray-200 px-4 py-3 focus:border-brand-500 focus:outline-none resize-none text-gray-900",placeholder:"Dtaillez votre intervention..."})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-bold text-gray-500 uppercase mb-2",children:"Note vocale (optionnel)"}),e.jsx(Sd,{onRecordingComplete:ce=>R(ce),onDelete:()=>R(null)})]}),e.jsxs("button",{type:"button",onClick:()=>q(!k),className:"w-full flex items-center justify-between px-4 py-3 bg-gray-50 rounded-xl text-gray-600 font-medium",children:[e.jsx("span",{className:"text-sm",children:"Options avances"}),k?e.jsx(jd,{size:18}):e.jsx(yd,{size:18})]}),k&&e.jsxs("div",{className:"space-y-4 animate-in fade-in duration-200",children:[e.jsxs("div",{children:[e.jsxs("label",{className:"block text-xs font-bold text-gray-500 uppercase mb-1",children:[e.jsx(St,{size:12,className:"inline mr-1"}),"Dure estime"]}),e.jsx("input",{value:w,onChange:ce=>_(ce.target.value),className:"w-full rounded-xl border border-gray-200 px-4 py-3 focus:border-brand-500 focus:outline-none text-gray-900",placeholder:"Ex: 2 heures, 3 jours..."})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-xs font-bold text-gray-500 uppercase mb-1",children:[e.jsx(mr,{size:12,className:"inline mr-1"}),"Proposition d'intervention"]}),e.jsx("input",{type:"date",value:D,onChange:ce=>U(ce.target.value),className:"w-full rounded-xl border border-gray-200 px-4 py-3 focus:border-brand-500 focus:outline-none mb-2 text-gray-900"}),e.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[e.jsx("input",{type:"time",value:J,onChange:ce=>F(ce.target.value),className:"w-full rounded-xl border border-gray-200 px-4 py-3 focus:border-brand-500 focus:outline-none text-gray-900"}),e.jsx("input",{type:"time",value:G,onChange:ce=>Z(ce.target.value),className:"w-full rounded-xl border border-gray-200 px-4 py-3 focus:border-brand-500 focus:outline-none text-gray-900"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-bold text-gray-500 uppercase mb-1",children:"Validit du devis"}),e.jsxs("select",{value:L,onChange:ce=>M(Number(ce.target.value)),className:"w-full rounded-xl border border-gray-200 px-4 py-3 focus:border-brand-500 focus:outline-none text-gray-900",children:[e.jsx("option",{value:24,children:"24 heures"}),e.jsx("option",{value:48,children:"48 heures"}),e.jsx("option",{value:72,children:"72 heures"}),e.jsx("option",{value:168,children:"7 jours"})]})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-xs font-bold text-gray-500 uppercase mb-1",children:[e.jsx(et,{size:12,className:"inline mr-1"}),"Facture proforma"]}),ae?e.jsxs("div",{className:"flex items-center justify-between bg-gray-50 rounded-xl p-3",children:[e.jsx("span",{className:"text-sm text-gray-600 truncate max-w-[200px]",children:ae.name}),e.jsx("button",{type:"button",onClick:()=>ge(null),className:"text-red-500",children:e.jsx(Ze,{size:18})})]}):e.jsxs("label",{className:"block w-full border-2 border-dashed border-gray-200 rounded-xl p-4 text-center cursor-pointer hover:border-brand-300 transition-colors",children:[e.jsx(hr,{size:20,className:"mx-auto text-gray-400 mb-1"}),e.jsx("p",{className:"text-xs text-gray-500",children:"Joindre un PDF ou une image"}),e.jsx("input",{type:"file",accept:".pdf,image/*",className:"hidden",onChange:Y})]})]})]}),B&&e.jsxs("div",{className:"bg-red-50 border border-red-200 rounded-xl p-3 flex items-center gap-2",children:[e.jsx(qa,{size:16,className:"text-red-500"}),e.jsx("p",{className:"text-sm text-red-600",children:B})]}),e.jsxs("div",{className:"flex gap-3",children:[e.jsx("button",{type:"button",onClick:x,className:"flex-1 bg-gray-100 text-gray-600 rounded-xl py-3 font-bold hover:bg-gray-200 transition-colors",children:"Annuler"}),e.jsx("button",{type:"submit",disabled:T||S||ye<=0,className:"flex-1 bg-brand-500 text-white rounded-xl py-3 font-bold hover:bg-brand-600 transition-colors disabled:opacity-50 disabled:cursor-not-allowed flex items-center justify-center gap-2",children:T||S?e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"w-5 h-5 border-2 border-white border-t-transparent rounded-full animate-spin"}),e.jsx("span",{children:"Envoi en cours..."})]}):e.jsxs(e.Fragment,{children:[e.jsx(al,{size:18}),"Envoyer"]})})]})]})]})}function jb({open:i,onClose:u,onConfirm:f,quoteAmount:o,artisanName:x}){const[y,N]=c.useState(""),[h,g]=c.useState(!1);if(!i)return null;const E=async v=>{v.preventDefault(),g(!0);try{await f(y.trim()||void 0),N(""),u()}finally{g(!1)}},d=async()=>{g(!0);try{await f(void 0),N(""),u()}finally{g(!1)}};return e.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50 p-4",children:e.jsxs("div",{className:"bg-white rounded-2xl max-w-md w-full shadow-xl animate-in fade-in duration-200",children:[e.jsxs("div",{className:"p-5 border-b border-gray-100 flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"w-10 h-10 bg-red-100 rounded-full flex items-center justify-center",children:e.jsx(Ze,{size:20,className:"text-red-600"})}),e.jsxs("div",{children:[e.jsx("h3",{className:"font-bold text-gray-900",children:"Refuser le devis"}),e.jsxs("p",{className:"text-xs text-gray-500",children:["De ",x]})]})]}),e.jsx("button",{onClick:u,className:"w-8 h-8 rounded-full bg-gray-100 flex items-center justify-center hover:bg-gray-200 transition-colors",disabled:h,children:e.jsx(Ze,{size:16,className:"text-gray-600"})})]}),e.jsxs("form",{onSubmit:E,className:"p-5 space-y-4",children:[e.jsxs("div",{className:"bg-gray-50 rounded-xl p-3 flex items-center justify-between",children:[e.jsx("span",{className:"text-sm text-gray-500",children:"Montant du devis"}),e.jsxs("span",{className:"font-bold text-gray-900",children:[o.toLocaleString("fr-FR")," FCFA"]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-bold text-gray-500 uppercase mb-2",children:"Raison du refus (optionnel)"}),e.jsx("p",{className:"text-xs text-gray-600 mb-2",children:"Vous pouvez expliquer pourquoi vous refusez ce devis. Cela aidera l'artisan  mieux comprendre vos besoins."}),e.jsx("textarea",{value:y,onChange:v=>N(v.target.value),rows:4,maxLength:500,className:"w-full rounded-xl border border-gray-200 px-4 py-3 focus:border-red-500 focus:outline-none resize-none text-sm",placeholder:"Exemple: Le prix est trop lev, les dlais ne correspondent pas, etc."}),e.jsxs("p",{className:"text-xs text-gray-400 mt-1 text-right",children:[y.length,"/500 caractres"]})]}),e.jsxs("div",{className:"flex gap-3 pt-2",children:[e.jsx("button",{type:"button",onClick:d,disabled:h,className:"flex-1 bg-gray-100 text-gray-600 rounded-xl py-3 font-bold hover:bg-gray-200 transition-colors disabled:opacity-50 disabled:cursor-not-allowed",children:"Refuser sans raison"}),e.jsx("button",{type:"submit",disabled:h||y.trim().length>0&&y.trim().length<10,className:"flex-1 bg-red-500 text-white rounded-xl py-3 font-bold hover:bg-red-600 transition-colors disabled:opacity-50 disabled:cursor-not-allowed flex items-center justify-center gap-2",children:h?e.jsx("div",{className:"w-5 h-5 border-2 border-white border-t-transparent rounded-full animate-spin"}):e.jsxs(e.Fragment,{children:["Refuser",y.trim()&&" avec raison"]})})]}),y.trim().length>0&&y.trim().length<10&&e.jsxs("div",{className:"bg-yellow-50 border border-yellow-200 rounded-xl p-3 flex items-start gap-2",children:[e.jsx(qa,{size:16,className:"text-yellow-600 flex-shrink-0 mt-0.5"}),e.jsx("p",{className:"text-xs text-yellow-700",children:"Si vous souhaitez fournir une raison, elle doit contenir au moins 10 caractres."})]})]})]})})}function pd({open:i,title:u,message:f,confirmText:o="Confirmer",cancelText:x="Annuler",onConfirm:y,onCancel:N,variant:h="warning"}){if(!i)return null;const E={danger:{icon:"text-red-500",confirmButton:"bg-red-500 hover:bg-red-600 text-white",border:"border-red-200"},warning:{icon:"text-yellow-500",confirmButton:"bg-yellow-500 hover:bg-yellow-600 text-white",border:"border-yellow-200"},info:{icon:"text-blue-500",confirmButton:"bg-blue-500 hover:bg-blue-600 text-white",border:"border-blue-200"}}[h];return e.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black/40 p-4 animate-in fade-in duration-200",children:e.jsx("div",{className:"w-full max-w-md rounded-2xl bg-white p-6 shadow-2xl animate-in zoom-in-95 duration-200",children:e.jsxs("div",{className:"flex items-start gap-4",children:[e.jsx("div",{className:`flex-shrink-0 w-12 h-12 rounded-full flex items-center justify-center ${h==="danger"?"bg-red-50":h==="warning"?"bg-yellow-50":"bg-blue-50"} ${E.icon}`,children:e.jsx(zt,{size:24})}),e.jsxs("div",{className:"flex-1",children:[e.jsx("h3",{className:"text-lg font-bold text-gray-900 mb-2",children:u}),e.jsx("p",{className:"text-sm text-gray-600 mb-6",children:f}),e.jsxs("div",{className:"flex gap-3",children:[e.jsx("button",{onClick:N,className:"flex-1 px-4 py-3 bg-gray-100 text-gray-700 rounded-xl font-bold hover:bg-gray-200 transition-colors",children:x}),e.jsx("button",{onClick:y,className:`flex-1 px-4 py-3 rounded-xl font-bold transition-colors ${E.confirmButton}`,children:o})]})]}),e.jsx("button",{onClick:N,className:"flex-shrink-0 text-gray-400 hover:text-gray-600 transition-colors",children:e.jsx(Ze,{size:20})})]})})})}function vb({isOpen:i,onClose:u,projectId:f,projectTitle:o,artisanId:x,artisanName:y,artisanAvatar:N,onSuccess:h,requireComment:g=!1}){var F;const[E,d]=c.useState(5),[v,b]=c.useState(""),[w,_]=c.useState(!1),[L,M]=c.useState(!1),{success:D,error:U}=sa();c.useEffect(()=>{if(!i||!f)return;(async()=>{try{const{data:{user:Z}}=await j.auth.getUser();if(!Z)return;const{data:X}=await j.from("reviews").select("id").eq("project_id",f).eq("client_id",Z.id).eq("artisan_id",x).maybeSingle();X&&M(!0)}catch(Z){console.error("Error checking existing review:",Z)}})()},[i,f,x]),c.useEffect(()=>{i&&(d(5),b(""),M(!1))},[i]);const J=async G=>{if(G.preventDefault(),E<1||E>5){U("Veuillez slectionner une note entre 1 et 5 toiles");return}if(g&&!v.trim()){U("Veuillez rdiger un commentaire. Votre avis sera visible sur le profil de l'artisan.");return}_(!0);try{const{data:{user:Z}}=await j.auth.getUser();if(!Z){U("Vous devez tre connect");return}const{data:X}=await j.from("reviews").select("id").eq("project_id",f).eq("client_id",Z.id).eq("artisan_id",x).maybeSingle();if(X){const{error:R}=await j.from("reviews").update({rating:E,comment:v.trim()||null,created_at:new Date().toISOString()}).eq("id",X.id);if(R)throw R}else{const{error:R}=await j.from("reviews").insert({project_id:f,artisan_id:x,client_id:Z.id,rating:E,comment:v.trim()||null});if(R)throw R}try{await j.from("notifications").insert({user_id:x,type:"system",title:"Nouvelle note reue",message:`Vous avez reu une note de ${E}/5 pour le projet "${o}".${v?" Commentaire: "+v.substring(0,100):""}`,data:{project_id:f,rating:E}})}catch(R){console.error("Error notifying artisan:",R)}D("Merci pour votre avis !"),h(),u()}catch(Z){console.error("Error submitting rating:",Z),U(`Erreur: ${Z.message||"Impossible d'enregistrer votre avis"}`)}finally{_(!1)}};return i?e.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black/60 backdrop-blur-sm animate-in fade-in duration-200",children:e.jsxs("div",{className:"bg-white rounded-2xl shadow-2xl max-w-lg w-full mx-4 animate-in zoom-in-95 duration-200",children:[e.jsxs("div",{className:"flex items-center justify-between p-6 border-b border-gray-100",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-10 h-10 bg-yellow-100 rounded-xl flex items-center justify-center",children:e.jsx(Ma,{className:"text-yellow-600",size:20})}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-black text-gray-900",children:"Noter l'artisan"}),e.jsx("p",{className:"text-xs text-gray-500",children:"Partagez votre exprience"})]})]}),e.jsx("button",{onClick:u,className:"w-8 h-8 flex items-center justify-center rounded-lg hover:bg-gray-100 transition-colors",disabled:w,children:e.jsx(Ze,{size:18,className:"text-gray-400"})})]}),e.jsxs("form",{onSubmit:J,className:"p-6 space-y-5",children:[e.jsx("div",{className:"bg-gray-50 rounded-xl p-4 border border-gray-200",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-12 h-12 rounded-full bg-gray-200 overflow-hidden flex-shrink-0",children:N?e.jsx("img",{src:N,alt:y,className:"w-full h-full object-cover"}):e.jsx("div",{className:"w-full h-full flex items-center justify-center",children:e.jsx("span",{className:"text-lg text-gray-400",children:(F=y[0])==null?void 0:F.toUpperCase()})})}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("p",{className:"font-black text-gray-900 truncate",children:y}),e.jsx("p",{className:"text-xs text-gray-500 truncate",children:o})]})]})}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-bold text-gray-700 mb-3",children:["Votre note ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx("div",{className:"flex justify-center gap-3",children:[1,2,3,4,5].map(G=>e.jsx("button",{type:"button",onClick:()=>d(G),className:"focus:outline-none transform transition-all hover:scale-110 active:scale-95",disabled:w,children:e.jsx(Ma,{size:40,className:G<=E?"text-yellow-400 fill-yellow-400":"text-gray-300 fill-gray-300"})},G))}),e.jsxs("p",{className:"text-center text-xs text-gray-500 mt-2",children:[E===5&&"Excellent !",E===4&&"Trs bien",E===3&&"Bien",E===2&&"Moyen",E===1&&" amliorer"]})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-bold text-gray-700 mb-2",children:["Votre commentaire ",g?e.jsx("span",{className:"text-red-500",children:"*"}):"(optionnel)"]}),e.jsx("textarea",{value:v,onChange:G=>b(G.target.value),placeholder:"Partagez votre exprience avec cet artisan...",rows:4,maxLength:500,className:"w-full px-4 py-3 border border-gray-200 rounded-xl focus:ring-2 focus:ring-brand-500 focus:border-transparent resize-none text-sm",disabled:w}),e.jsxs("p",{className:"text-xs text-gray-500 mt-1 text-right",children:[v.length," / 500 caractres"]})]}),e.jsx("div",{className:"bg-blue-50 rounded-xl p-3 border border-blue-200",children:e.jsxs("div",{className:"flex items-start gap-2",children:[e.jsx(qa,{size:16,className:"text-blue-600 flex-shrink-0 mt-0.5"}),e.jsx("p",{className:"text-xs text-blue-800 leading-relaxed",children:"Votre note et votre commentaire seront visibles publiquement sur le profil de l'artisan et aideront les autres clients."})]})}),e.jsxs("div",{className:"flex gap-3 pt-2",children:[!g&&e.jsx("button",{type:"button",onClick:u,disabled:w,className:"flex-1 px-4 py-3 bg-gray-100 text-gray-700 font-bold rounded-xl hover:bg-gray-200 transition-colors disabled:opacity-50 disabled:cursor-not-allowed",children:"Plus tard"}),e.jsx("button",{type:"submit",disabled:w||E<1||g&&!v.trim(),className:`${g?"w-full":"flex-1"} px-4 py-3 bg-brand-500 text-white font-bold rounded-xl hover:bg-brand-600 transition-colors disabled:opacity-50 disabled:cursor-not-allowed flex items-center justify-center gap-2`,children:w?e.jsx("div",{className:"w-5 h-5 border-2 border-white border-t-transparent rounded-full animate-spin"}):e.jsxs(e.Fragment,{children:[e.jsx(al,{size:16}),"Envoyer l'avis"]})})]})]})]})}):null}const U0={draft:{label:"Brouillon",color:"bg-gray-100 text-gray-600"},open:{label:"En attente de devis",color:"bg-blue-100 text-blue-600"},quote_received:{label:"Devis reu",color:"bg-purple-100 text-purple-600"},quote_accepted:{label:"Devis accept",color:"bg-green-100 text-green-600"},payment_pending:{label:"Paiement en attente",color:"bg-yellow-100 text-yellow-600"},in_progress:{label:"En cours",color:"bg-brand-100 text-brand-600"},completion_requested:{label:"Clture demande",color:"bg-orange-100 text-orange-600"},disputed:{label:"En litige",color:"bg-red-100 text-red-600"},completed:{label:"Termin",color:"bg-green-100 text-green-700"},expired:{label:"Expir",color:"bg-gray-100 text-gray-500"},cancelled:{label:"Annul",color:"bg-gray-100 text-gray-500"}},md={pending:{label:"En attente",color:"bg-blue-50 text-blue-600 border-blue-200",icon:St},viewed:{label:"Vu",color:"bg-purple-50 text-purple-600 border-purple-200",icon:Qe},accepted:{label:"Accept",color:"bg-green-50 text-green-600 border-green-200",icon:Qe},rejected:{label:"Refus",color:"bg-red-50 text-red-600 border-red-200",icon:Ze},expired:{label:"Expir",color:"bg-gray-50 text-gray-500 border-gray-200",icon:St},abandoned:{label:"Abandonn",color:"bg-gray-50 text-gray-500 border-gray-200",icon:Ze}},O0=[{id:"created",label:"Publi",icon:ep},{id:"quoted",label:"Devis reu",icon:et},{id:"accepted",label:"Accept",icon:Qe},{id:"paid",label:"Pay",icon:Na},{id:"in_progress",label:"Travaux",icon:ns},{id:"completed",label:"Termin",icon:Sl}],V0=(i,u,f)=>{switch(i){case"open":return u?1:0;case"quote_accepted":case"payment_pending":return 3;case"payment_received":return 4;case"in_progress":return 4;case"completion_requested":return 4;case"completed":return 5;case"disputed":return 4;default:return 0}};function Nb(){var qt,kt,Rt,Ce,Me,tt,Q,be,Ee,Oe,ct,at;const{id:i}=Ya(),u=ht(),[f]=_l(),o=Nt(),{profile:x}=It(),{initiateEscrow:y}=bn(),{success:N,error:h,warning:g,info:E}=sa(),[d,v]=c.useState(null),[b,w]=c.useState([]),[_,L]=c.useState(null),[M,D]=c.useState(!0),[U,J]=c.useState(null),[F,G]=c.useState(!1),[Z,X]=c.useState(null),[R,ae]=c.useState(!1),[ge,k]=c.useState(null),[q,T]=c.useState(!1),[C,B]=c.useState(!1),[z,S]=c.useState(null),[V,le]=c.useState([]),[he,Ne]=c.useState(null),[fe,ye]=c.useState(null),Y=c.useRef(!1),$=c.useRef(!1),ce=c.useRef(!1),we=async()=>{var se,oe,ve,Te,ee,Fe,He;if(i){if(o.loading||!o.user){console.log("[DEBUG] Waiting for user to be loaded...");return}D(!0),J(null);try{const{data:te,error:de}=await j.from("projects").select("*, profiles!projects_client_id_fkey(*), categories(*)").eq("id",i).single();if(de){if(console.error("Error fetching project:",de),console.error("Project ID:",i),console.error("Error details:",JSON.stringify(de,null,2)),((se=de.message)==null?void 0:se.includes("Failed to fetch"))||((oe=de.message)==null?void 0:oe.includes("NetworkError"))||((ve=de.message)==null?void 0:ve.includes("ERR_FAILED"))||((Te=de.message)==null?void 0:Te.includes("CORS"))){J("Erreur de connexion. Vrifiez votre connexion internet et dsactivez les extensions de navigateur (AdBlock, VPN, etc.) qui pourraient bloquer les requtes."),v(null),D(!1);return}if(de.code==="PGRST116"||(ee=de.message)!=null&&ee.includes("No rows"))J("Projet introuvable. Il se peut que ce projet n'existe pas ou ait t supprim.");else if(de.code==="42501"||(Fe=de.message)!=null&&Fe.includes("permission denied"))J("Vous n'avez pas la permission d'accder  ce projet. Veuillez vrifier que vous tes bien connect et que ce projet vous appartient ou que vous y avez accs.");else if(de.code==="PGRST201"){console.warn("Ambiguity error, retrying with explicit relationship...");const{data:lt,error:ke}=await j.from("projects").select("*, profiles!projects_client_id_fkey(*), categories(*)").eq("id",i).single();if(ke){J(`Erreur lors du chargement du projet: ${ke.message||"Erreur inconnue"}`),v(null),D(!1);return}v(lt),J(null)}else J(`Erreur lors du chargement du projet: ${de.message||"Erreur inconnue"}`);if(de.code!=="PGRST201"){v(null),D(!1);return}}if(!te&&!de){J("Projet introuvable."),v(null),D(!1);return}if(!te){D(!1);return}if(v(te),J(null),(x==null?void 0:x.role)==="artisan"&&te){const{data:Ve}=await j.from("artisans").select("category_id").eq("id",x.id).single();if(Ve!=null&&Ve.category_id&&te.category_id!==Ve.category_id&&te.target_artisan_id!==x.id){J("Vous n'avez pas accs  ce projet. Ce projet n'est pas dans votre catgorie."),v(null),D(!1);return}}let De=[],qe=null;console.log("[DEBUG] Fetching quotes for project:",i),console.log("[DEBUG] Current user:",(He=o.user)==null?void 0:He.id);const{data:xt,error:jt}=await j.from("quotes").select(`
        *,
        profiles!quotes_artisan_id_fkey (
          id,
          full_name,
          avatar_url,
          role
        )
      `).eq("project_id",i).order("created_at",{ascending:!1});if(console.log("[DEBUG] Quotes with profile - Data:",xt),console.log("[DEBUG] Quotes with profile - Error:",jt),!jt&&xt)De=xt||[],console.log("[DEBUG] Successfully fetched",De.length,"quotes with profile");else{console.warn("[DEBUG] Error fetching quotes with profile, trying fallback:",jt);const{data:Ve,error:lt}=await j.from("quotes").select("*").eq("project_id",i).order("created_at",{ascending:!1});if(console.log("[DEBUG] Quotes fallback - Data:",Ve),console.log("[DEBUG] Quotes fallback - Error:",lt),!lt&&Ve){if(De=Ve||[],console.log("[DEBUG] Successfully fetched",De.length,"quotes without profile"),De.length>0){const ke=[...new Set(De.map(Tt=>Tt.artisan_id).filter(Boolean))];if(console.log("[DEBUG] Fetching profiles for artisan IDs:",ke),ke.length>0){const{data:Tt,error:ua}=await j.from("profiles").select("id, full_name, avatar_url, role").in("id",ke);console.log("[DEBUG] Profiles data:",Tt),console.log("[DEBUG] Profiles error:",ua),De=De.map(Pa=>({...Pa,profiles:(Tt==null?void 0:Tt.find(ts=>ts.id===Pa.artisan_id))||null}))}}}else console.error("[DEBUG] Error fetching quotes (fallback):",lt),qe=lt}console.log("[DEBUG] Final quotes array length:",De.length),console.log("[DEBUG] Final quotes:",De.map(Ve=>({id:Ve.id,status:Ve.status,artisan_id:Ve.artisan_id}))),w(De);const{data:Mt}=await j.from("quote_revisions").select("*").eq("project_id",i).order("created_at",{ascending:!1});Mt&&le(Mt);const{data:pt,error:Xa}=await j.from("escrows").select("*").eq("project_id",i).maybeSingle();if(Xa&&console.error("Error fetching escrow:",Xa),L(pt||null),(pt==null?void 0:pt.status)==="held"&&(te==null?void 0:te.status)==="payment_pending"){const{error:Ve}=await j.from("projects").update({status:"payment_received"}).eq("id",i);Ve?console.warn("[ProjectDetails] Sync statut payment_received:",Ve):v(lt=>lt&&{...lt,status:"payment_received"})}const wa=(De||[]).find(Ve=>Ve.status==="accepted"),Za=(Mt||[]).some(Ve=>Ve.status==="accepted");if((wa||Za)&&["open","quote_received"].includes((te==null?void 0:te.status)||"")){const{error:Ve}=await j.from("projects").update({status:"quote_accepted"}).eq("id",i);Ve?console.warn("[ProjectDetails] Sync statut quote_accepted:",Ve):v(lt=>lt&&{...lt,status:"quote_accepted"})}}catch(te){console.error("Unexpected error in fetchDetails:",te),J(`Erreur inattendue: ${te.message||"Erreur inconnue"}`),v(null)}finally{D(!1)}}};c.useEffect(()=>{const se=f.get("revision");se&&d&&u(`/revisions/${se}/respond`,{replace:!0})},[f,d,u]),c.useEffect(()=>{if(!d||M||typeof window>"u")return;const se=window.location.hash,oe=se==="#suivi"?document.getElementById("suivi"):se==="#devis"?document.getElementById("section-devis"):null;if(oe){const ve=setTimeout(()=>oe.scrollIntoView({behavior:"smooth",block:"start"}),200);return()=>clearTimeout(ve)}},[d,M]),c.useEffect(()=>{if(M||!d||!i||!o.user||d.status!=="completed"||d.client_id!==o.user.id)return;const se=b.find(ve=>ve.status==="accepted");if(!(se!=null&&se.artisan_id)||$.current)return;let oe=!1;return(async()=>{const{data:ve}=await j.from("reviews").select("id").eq("project_id",i).eq("client_id",o.user.id).eq("artisan_id",se.artisan_id).maybeSingle();oe||ve||($.current=!0,ae(!0))})(),()=>{oe=!0}},[M,i,d==null?void 0:d.status,d==null?void 0:d.client_id,b,o.user]),c.useEffect(()=>{if(M||!d||!i||!o.user)return;const se=d.client_id===o.user.id,oe=b.find(qe=>qe.status==="accepted"),ve=(oe==null?void 0:oe.artisan_id)===o.user.id;if(!se&&!ve)return;const Te=d.status||"",ee=Te==="payment_received"||(_==null?void 0:_.status)==="held"||(_==null?void 0:_.status)==="advance_paid"||(_==null?void 0:_.status)==="released",Fe=b.some(qe=>qe.status==="accepted"),He=V.some(qe=>qe.status==="accepted"),te=Te==="quote_accepted"||Te==="payment_pending"||(Fe||He)&&["open","quote_received"].includes(Te);if(ce.current)return;let de=null;if(["completion_requested","completed"].includes(Te)?de=se?`/projects/${i}/completion`:`/projects/${i}/work`:Te==="in_progress"?de=`/projects/${i}/work`:ee?de=`/projects/${i}/thank-you`:te&&se&&(de=`/projects/${i}/payment`),!de)return;ce.current=!0;const De=setTimeout(()=>u(de),0);return()=>{clearTimeout(De),ce.current=!1}},[M,i,d,_,b,V,o.user,u]),c.useEffect(()=>{Y.current=!1,$.current=!1,ce.current=!1,!o.loading&&o.user&&!Y.current?(Y.current=!0,we().finally(()=>{Y.current=!1})):o.loading&&D(!0)},[i,o.user,o.loading]);const We=c.useMemo(()=>{const se={};b.forEach(ve=>{const Te=ve.artisan_id||"unknown";se[Te]||(se[Te]=[]),se[Te].push(ve)}),Object.keys(se).forEach(ve=>{se[ve].sort((Te,ee)=>new Date(ee.created_at||0).getTime()-new Date(Te.created_at||0).getTime())});const oe=Object.entries(se);return oe.sort(([,ve],[,Te])=>{const ee=Math.max(...ve.map(He=>new Date(He.created_at||0).getTime()));return Math.max(...Te.map(He=>new Date(He.created_at||0).getTime()))-ee}),Object.fromEntries(oe)},[b]),pe=c.useMemo(()=>{const se=d==null?void 0:d.photos_urls;if(!se)return[];if(Array.isArray(se))return se;if(typeof se=="string")try{const oe=JSON.parse(se);return Array.isArray(oe)?oe:[]}catch{return[]}return[]},[d==null?void 0:d.photos_urls]),Ye=async se=>{var ve,Te,ee,Fe,He,te;if(!i||!((ve=o.user)!=null&&ve.id)){h("Erreur : informations manquantes");return}if((d==null?void 0:d.client_id)!==o.user.id){h("Vous n'tes pas autoris  accepter ce devis.");return}if(!["pending","viewed"].includes(se.status)){h("Ce devis ne peut plus tre accept (statut: "+se.status+")");return}if(b.some(de=>de.status==="accepted"&&de.id!==se.id)){h("Un devis a dj t accept pour ce projet.");return}try{T(!0);const de=se.status,De=10;try{const{error:Ve}=await j.rpc("consume_credits_for_quote",{p_artisan_id:se.artisan_id,p_project_id:i,p_quote_id:se.id,p_cost:De});if(Ve){(Te=Ve.message)!=null&&Te.includes("insufficient_credits")?h("L'artisan n'a pas assez de crdits pour ce projet. Demandez-lui de recharger son compte."):(console.error("Erreur lors du dbit des crdits de l'artisan :",Ve),h("Impossible de dbiter les crdits de l'artisan pour ce projet.")),T(!1);return}}catch(Ve){console.error("Unexpected error in consume_credits_for_quote:",Ve),h("Une erreur est survenue lors du dbit des crdits de l'artisan."),T(!1);return}const{error:qe}=await j.from("quotes").update({status:"accepted"}).eq("id",se.id);if(qe)throw new Error(`Erreur mise  jour devis: ${qe.message}`);try{await j.rpc("log_quote_action",{p_quote_id:se.id,p_project_id:i,p_user_id:o.user.id,p_action:"accepted",p_old_value:{status:de},p_new_value:{status:"accepted",amount:se.amount}})}catch(Ve){console.error("Error logging quote acceptance:",Ve)}const{data:xt,error:jt}=await j.from("quotes").select("id").eq("project_id",i).neq("id",se.id).in("status",["pending","viewed"]);if(jt)console.error("Error fetching quotes to reject:",jt);else if(xt&&xt.length>0){const{error:Ve}=await j.from("quotes").update({status:"rejected"}).in("id",xt.map(lt=>lt.id));Ve&&console.error("Error rejecting other quotes:",Ve);for(const lt of xt)try{await j.rpc("log_quote_action",{p_quote_id:lt.id,p_project_id:i,p_user_id:o.user.id,p_action:"rejected",p_old_value:{status:"pending"},p_new_value:{status:"rejected"},p_metadata:{reason:"other_quote_accepted"}})}catch(ke){console.error("Error logging quote rejection:",ke)}}const Mt=d==null?void 0:d.status,{error:pt}=await j.from("projects").update({status:"quote_accepted"}).eq("id",i);if(pt)throw new Error(`Erreur mise  jour projet: ${pt.message}`);try{await j.rpc("log_project_action",{p_project_id:i,p_user_id:o.user.id,p_action:"status_changed",p_old_value:{status:Mt},p_new_value:{status:"quote_accepted"},p_metadata:{quote_id:se.id}})}catch(Ve){console.error("Error logging project status change:",Ve)}const{data:Xa}=await j.from("escrows").select("id, status").eq("project_id",i).maybeSingle(),{data:wa}=await j.from("quotes").select("amount").eq("id",se.id).single(),Za=((wa==null?void 0:wa.amount)!=null?Number(wa.amount):null)??Number(se.amount||0);if(Xa)console.log("Escrow already exists for this project. Skipping creation.");else try{const Ve=await y({project_id:i,total_amount:Za,artisan_is_verified:((ee=se.profiles)==null?void 0:ee.is_verified)??!1});if(!(Ve!=null&&Ve.id))throw new Error("chec de la cration de l'escrow");L(Ve);try{await j.rpc("log_escrow_action",{p_escrow_id:Ve.id,p_user_id:o.user.id,p_action:"created",p_new_value:{total_amount:Za,status:"pending"}})}catch(lt){console.error("Error logging escrow creation:",lt)}}catch(Ve){if(console.error("Error creating escrow:",Ve),(Fe=Ve.message)!=null&&Fe.includes("infinite recursion")||(He=Ve.message)!=null&&He.includes("policy")){console.warn("Escrow creation failed due to RLS policy error. Trying bypass via RPC...");try{const{data:lt,error:ke}=await j.rpc("create_escrow_bypass",{p_project_id:i,p_total_amount:Za,p_artisan_is_verified:((te=se.profiles)==null?void 0:te.is_verified)??!1});ke||!lt?(console.warn("Bypass RPC failed or not available. Proceeding without escrow (bypass mode)."),await j.from("projects").update({status:"payment_pending"}).eq("id",i)):lt&&L(lt)}catch{console.warn("Bypass RPC not available. Proceeding without escrow (bypass mode)."),await j.from("projects").update({status:"payment_pending"}).eq("id",i)}}else console.warn("Escrow creation failed. Proceeding without escrow (bypass mode)."),await j.from("projects").update({status:"payment_pending"}).eq("id",i)}if(se.artisan_id&&(d!=null&&d.title))try{await df(i,se.artisan_id,d.title)}catch(Ve){console.error("Error notifying artisan:",Ve)}if(se.artisan_id&&(d!=null&&d.client_id)&&(d!=null&&d.title))try{await pf(i,d.client_id,se.artisan_id,d.title)}catch(Ve){console.error("Error ensuring chat exists:",Ve)}N("Devis accept avec succs ! Redirection vers la page de paiement..."),setTimeout(()=>{i&&u(`/projects/${i}/payment`)},0)}catch(de){console.error("Error accepting quote:",de),h(`Erreur lors de l'acceptation: ${de.message||"Erreur inconnue"}`),setTimeout(async()=>{await we()},100)}finally{T(!1)}},st=async(se,oe)=>{var Te;if(!((Te=o.user)!=null&&Te.id)||!i){h("Erreur : informations manquantes");return}if((d==null?void 0:d.client_id)!==o.user.id){h("Vous n'tes pas autoris  refuser ce devis.");return}const ve=b.find(ee=>ee.id===se);if(!ve){h("Devis introuvable");return}if(ve.status==="accepted"){h("Ce devis a dj t accept et ne peut plus tre refus.");return}if(ve.status==="rejected"){h("Ce devis a dj t refus.");return}try{T(!0);const ee=ve.status,Fe={status:"rejected"};oe&&oe.trim()&&(Fe.rejection_reason=oe.trim());const{error:He}=await j.from("quotes").update(Fe).eq("id",se);if(He)throw new Error(`Erreur mise  jour: ${He.message}`);try{await j.rpc("log_quote_action",{p_quote_id:se,p_project_id:i||ve.project_id,p_user_id:o.user.id,p_action:"rejected",p_old_value:{status:ee},p_new_value:{status:"rejected",rejection_reason:oe||null}})}catch(te){console.error("Error logging quote rejection:",te)}if(ve.artisan_id&&(d!=null&&d.title))try{await uf(i,ve.artisan_id,d.title,oe)}catch(te){console.error("Error notifying artisan:",te)}N("Devis refus avec succs. Vous pouvez continuer  consulter les autres devis."),await we()}catch(ee){console.error("Error rejecting quote:",ee),h(`Erreur lors du refus: ${ee.message||"Erreur inconnue"}`)}finally{T(!1)}},Ke=async se=>{var ve,Te;if(!i||!((ve=o.user)!=null&&ve.id))return;const oe=b.find(ee=>ee.id===se);if(!oe||oe.artisan_id!==o.user.id){h("Action non autorise");return}if(oe.status==="accepted"){h("Vous ne pouvez pas abandonner un devis accept.");return}if(oe.status==="abandoned"||oe.status==="expired"){h("Ce devis est dj cltur.");return}try{T(!0);const ee=oe.status,{error:Fe}=await j.from("quotes").update({status:"abandoned"}).eq("id",se).eq("artisan_id",o.user.id);if(Fe)throw Fe;try{await j.rpc("log_quote_action",{p_quote_id:se,p_project_id:i,p_user_id:o.user.id,p_action:"status_changed",p_old_value:{status:ee},p_new_value:{status:"abandoned"}})}catch(He){console.error("Error logging quote abandon:",He)}if(N("Votre devis a t cltur. Ce projet ne figurera plus parmi vos rponses en cours."),await we(),d!=null&&d.client_id)try{await ff(i,d.client_id,d.title||"Projet",(Te=oe.profiles)==null?void 0:Te.full_name)}catch(He){console.error("Error notifying client of abandon:",He)}}catch(ee){console.error("Error abandoning quote:",ee),h(ee.message||"Erreur lors de la clture du devis")}finally{T(!1)}},ft=async()=>{var se;if(!(!i||!((se=o.user)!=null&&se.id)||!d))try{await j.from("projects").update({client_confirmed_closure_at:new Date().toISOString(),updated_at:new Date().toISOString()}).eq("id",i).eq("client_id",o.user.id);const oe=b.find(ve=>ve.status==="accepted");if(oe!=null&&oe.artisan_id)try{await xf(i,oe.artisan_id,d.title||"Projet")}catch{}N("Demande de clture enregistre. La plateforme procdera au paiement de l'artisan aprs contrle. Vous pourrez noter l'artisan une fois le projet cltur."),await we()}catch(oe){console.error("Error confirming closure:",oe),h("Erreur lors de l'enregistrement de la demande")}},_e=async()=>{var se;if(!(!i||!((se=o.user)!=null&&se.id)||!d||d.client_id!==o.user.id))try{await j.from("projects").update({status:"completion_requested",client_confirmed_closure_at:new Date().toISOString(),updated_at:new Date().toISOString()}).eq("id",i).eq("client_id",o.user.id);const oe=b.find(ve=>ve.status==="accepted");if(oe!=null&&oe.artisan_id)try{await mf(i,oe.artisan_id,d.title||"Projet")}catch{}N("Demande de clture enregistre. La plateforme procdera au paiement de l'artisan aprs contrle. Vous pourrez noter l'artisan une fois le projet cltur."),await we()}catch(oe){console.error("Error requesting closure:",oe),h("Erreur lors de la demande de clture")}},je=async()=>{var oe;if(!i||!((oe=o.user)!=null&&oe.id)||(d==null?void 0:d.client_id)!==o.user.id){h("Action non autorise");return}if(_&&_.status!=="pending"){h("Impossible d'annuler : paiement dj effectu. Veuillez demander un remboursement.");return}if(b.some(ve=>ve.status==="accepted")){h("Impossible d'annuler : un devis a dj t accept.");return}B(!0)},Le=async()=>{var se,oe;if(!i||!((se=o.user)!=null&&se.id)||(d==null?void 0:d.client_id)!==o.user.id){h("Action non autorise"),B(!1);return}B(!1);try{if(T(!0),!((oe=o.user)!=null&&oe.id)||(d==null?void 0:d.client_id)!==o.user.id)throw new Error("Vous n'tes pas autoris  annuler ce projet.");console.log("[DEBUG] Cancelling project:",i,"User:",o.user.id);const{data:ve,error:Te}=await j.from("projects").update({status:"cancelled",updated_at:new Date().toISOString()}).eq("id",i).eq("client_id",o.user.id).select("id, status");if(console.log("[DEBUG] Update result - Data:",ve),console.log("[DEBUG] Update result - Error:",Te),Te)throw console.error("[DEBUG] Failed to update project:",Te),new Error(`Erreur lors de la mise  jour: ${Te.message}`);if(!ve||ve.length===0)throw console.error("[DEBUG] No rows updated - RLS might be blocking or project not found"),new Error("Impossible de mettre  jour le projet. Vrifiez que vous tes bien le propritaire du projet.");const ee=ve[0];if(ee.status!=="cancelled")throw console.warn("[DEBUG] Update might have failed - status is:",ee.status),new Error("Le statut du projet n'a pas t correctement mis  jour.");const{data:Fe}=await j.from("quotes").select("id, artisan_id").eq("project_id",i).in("status",["pending","viewed"]);Fe&&Fe.length>0&&await j.from("quotes").update({status:"rejected"}).in("id",Fe.map(He=>He.id));try{const He=j.rpc("log_project_action",{p_project_id:i,p_user_id:o.user.id,p_action:"cancelled",p_old_value:{status:d==null?void 0:d.status},p_new_value:{status:"cancelled"}});He&&typeof He.catch=="function"&&He.catch(()=>{})}catch(He){console.warn("Could not log project action:",He)}if(Fe&&Fe.length>0){for(const He of Fe)if(He.artisan_id)try{await j.from("notifications").insert({user_id:He.artisan_id,type:"system",title:"Projet annul",message:`Le projet "${d==null?void 0:d.title}" a t annul par le client.`,data:{project_id:i,kind:"project_cancelled"}})}catch(te){console.error("Error notifying artisan:",te)}}N("Projet annul avec succs. Vous pouvez crer un nouveau projet si ncessaire."),v(He=>He?{...He,status:"cancelled"}:null),await new Promise(He=>setTimeout(He,500)),await we(),setTimeout(()=>{u("/dashboard",{replace:!0})},800)}catch(ve){console.error("Error cancelling project:",ve),h(`Erreur: ${ve.message||"Erreur inconnue"}`)}finally{T(!1)}},ue=async()=>{var se;if(!(!i||!_||!d))try{await j.from("projects").update({status:"disputed"}).eq("id",i),await j.from("escrows").update({status:"frozen"}).eq("id",_.id);const oe=d.title||"Projet",ve=b.find(ee=>ee.status==="accepted"),Te=d.client_id===((se=o.user)==null?void 0:se.id)?ve==null?void 0:ve.artisan_id:d.client_id;if(Te)try{await hf(i,oe,Te)}catch{}we(),N("Un litige a t signal. Le projet est en attente. Notre quipe vous contactera.")}catch{h("Erreur lors du signalement")}},Ae=async()=>{if(i){if(!Se){h("Impossible de demander la clture : aucun devis accept n'est associ  ce projet.");return}try{await j.from("projects").update({status:"completion_requested"}).eq("id",i),await Yi(i,d.client_id,d.title),we(),N("Demande de clture envoye au client ! Le client doit confirmer la fin des travaux pour librer le paiement final.")}catch{h("Erreur lors de la demande")}}};if(M)return e.jsx(Yt,{});if(!d||U)return e.jsx("div",{className:"min-h-screen flex items-center justify-center bg-gray-50 px-4",children:e.jsxs("div",{className:"max-w-md w-full bg-white rounded-2xl p-6 shadow-sm border border-gray-100 text-center",children:[e.jsx("div",{className:"w-16 h-16 bg-red-100 rounded-full flex items-center justify-center mx-auto mb-4",children:e.jsx(zt,{size:32,className:"text-red-500"})}),e.jsx("h2",{className:"text-xl font-bold text-gray-900 mb-2",children:"Projet introuvable"}),e.jsx("p",{className:"text-gray-500 mb-6",children:U||"Ce projet n'existe pas ou n'est plus disponible."}),e.jsxs("div",{className:"flex flex-col gap-3",children:[e.jsx("button",{onClick:()=>u("/dashboard"),className:"w-full bg-brand-500 text-white font-bold py-3 rounded-xl hover:bg-brand-600 transition-colors",children:"Retour au tableau de bord"}),e.jsx("button",{onClick:()=>we(),className:"w-full bg-gray-100 text-gray-700 font-bold py-3 rounded-xl hover:bg-gray-200 transition-colors",children:"Ressayer"})]})]})});const ze=(d==null?void 0:d.client_id)===((qt=o.user)==null?void 0:qt.id),Ge=(x==null?void 0:x.role)==="artisan",xe=b.some(se=>{var oe;return se.artisan_id===((oe=o.user)==null?void 0:oe.id)}),Se=b.find(se=>se.status==="accepted"),Pe=V.some(se=>se.status==="accepted"),Xe=se=>V.some(oe=>oe.quote_id===se&&oe.status==="accepted"),gt=(Se||Pe)&&["open","quote_received"].includes((d==null?void 0:d.status)||"")?"quote_accepted":(d==null?void 0:d.status)||"",Lt=["payment_received","in_progress","completion_requested","completed"].includes((d==null?void 0:d.status)||"")||(_==null?void 0:_.status)==="held";return e.jsxs("div",{className:"min-h-screen bg-gray-50",children:[e.jsxs("header",{className:"sticky top-0 z-20 px-4 py-4 bg-white border-b border-gray-100 flex items-center gap-4",children:[e.jsx("button",{onClick:()=>u(-1),className:"w-10 h-10 rounded-full bg-gray-100 flex items-center justify-center",children:e.jsx(Wt,{size:20,className:"text-gray-600"})}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("h1",{className:"font-bold text-gray-900 truncate",children:d.title}),e.jsx("p",{className:"text-xs text-gray-400 font-mono",children:d.project_number})]}),e.jsx("span",{className:`px-3 py-1 rounded-full text-[10px] font-bold ${((kt=U0[gt])==null?void 0:kt.color)||"bg-gray-100 text-gray-600"}`,children:((Rt=U0[gt])==null?void 0:Rt.label)||gt})]}),e.jsxs("main",{className:"max-w-lg mx-auto px-4 py-6 pb-32",children:[_&&e.jsx(gb,{escrow:_,isClient:ze,onRefresh:we,onPaymentSuccess:ze&&i?()=>u(`/projects/${i}/thank-you`):void 0}),Ge&&(Se==null?void 0:Se.artisan_id)===((Ce=o.user)==null?void 0:Ce.id)&&(Se==null?void 0:Se.amount)!=null&&e.jsxs("div",{className:"bg-green-50 border border-green-200 rounded-2xl p-4 mb-6",children:[e.jsx("p",{className:"text-xs font-bold text-green-800 uppercase tracking-wide mb-1",children:"Montant du projet"}),e.jsxs("p",{className:"text-2xl font-black text-green-900",children:[Number(Se.amount).toLocaleString("fr-FR")," FCFA"]}),e.jsxs("p",{className:"text-xs text-green-700 mt-1",children:["Ce montant est celui retenu pour ce projet",V.some(se=>se.status==="accepted")?" (rvision accepte comprise)":"","."]})]}),Ge&&(Se==null?void 0:Se.artisan_id)===((Me=o.user)==null?void 0:Me.id)&&_&&_.status==="pending"&&e.jsxs("div",{className:"bg-blue-50 border border-blue-200 rounded-2xl p-5 mb-6",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-3",children:[e.jsx("div",{className:"w-10 h-10 rounded-xl bg-blue-500 flex items-center justify-center text-white",children:e.jsx(St,{size:20})}),e.jsxs("div",{children:[e.jsx("h3",{className:"font-bold text-blue-900 text-sm",children:"En attente du paiement du client"}),e.jsx("p",{className:"text-xs text-blue-700 font-medium",children:"Une fois le paiement effectu, vous pourrez commencer les travaux."})]})]}),e.jsx("p",{className:"text-sm text-blue-800 mb-2",children:"Votre devis a t accept ! Le client va procder au paiement pour scuriser les fonds."}),e.jsx("p",{className:"text-xs text-blue-600 mb-4",children:"Vous serez notifi ds que le paiement sera reu et vous pourrez alors commencer les travaux."}),e.jsxs("button",{type:"button",onClick:()=>u(`/projects/${i}/awaiting-payment`),className:"w-full py-3 rounded-xl bg-blue-600 text-white font-semibold flex items-center justify-center gap-2 hover:bg-blue-700 transition-colors",children:[e.jsx(St,{size:18}),"Voir la page En attente de paiement"]})]}),Ge&&(Se==null?void 0:Se.artisan_id)===((tt=o.user)==null?void 0:tt.id)&&!_&&((d==null?void 0:d.status)==="quote_accepted"||(d==null?void 0:d.status)==="payment_pending")&&e.jsxs("div",{className:"bg-blue-50 border border-blue-200 rounded-2xl p-5 mb-6",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-3",children:[e.jsx("div",{className:"w-10 h-10 rounded-xl bg-blue-500 flex items-center justify-center text-white",children:e.jsx(St,{size:20})}),e.jsxs("div",{children:[e.jsx("h3",{className:"font-bold text-blue-900 text-sm",children:"En attente du paiement du client"}),e.jsx("p",{className:"text-xs text-blue-700 font-medium",children:"Pour des raisons de scurit, ne commencez pas les travaux tant que le paiement n'est pas confirm."})]})]}),e.jsx("p",{className:"text-sm text-blue-800 mb-2",children:"Votre devis a t accept. Le client est en train de procder au paiement sur la plateforme."}),e.jsx("p",{className:"text-xs text-blue-600",children:"Vous serez notifi ds que le paiement sera effectif et vous pourrez alors commencer les travaux."})]}),d.status==="disputed"&&e.jsxs("section",{className:"bg-red-50 border-2 border-red-200 rounded-2xl p-5 mb-6",children:[e.jsxs("div",{className:"flex items-start gap-3 mb-2",children:[e.jsx("div",{className:"w-12 h-12 rounded-xl bg-red-500 flex items-center justify-center flex-shrink-0",children:e.jsx(zt,{size:24,className:"text-white"})}),e.jsxs("div",{children:[e.jsx("h3",{className:"font-bold text-red-800 text-base",children:"Projet en litige"}),e.jsx("p",{className:"text-sm text-red-700 mt-1",children:"L'escrow est gel. Le projet est mis en attente."})]})]}),e.jsxs("div",{className:"mt-3 pt-3 border-t border-red-200",children:[e.jsx("p",{className:"text-sm font-medium text-red-800",children:"Seul l'administrateur de la plateforme peut dbloquer le projet. Il contactera les deux parties pour rsoudre le litige."}),e.jsx("p",{className:"text-xs text-red-600 mt-2",children:"En attendant, aucune action (paiement, clture) n'est possible."})]})]}),d.status==="expired"&&e.jsxs("div",{className:"bg-gray-50 border border-gray-200 rounded-2xl p-4 mb-6 flex items-start gap-3",children:[e.jsx(St,{size:20,className:"text-gray-500 flex-shrink-0"}),e.jsxs("div",{children:[e.jsx("p",{className:"font-bold text-gray-700 text-sm",children:"Projet expir"}),e.jsx("p",{className:"text-xs text-gray-600 mt-0.5",children:"Ce projet a expir aprs 6 jours sans devis accept. Consultation en lecture seule."})]})]}),d.status==="cancelled"&&e.jsxs("div",{className:"bg-gray-50 border border-gray-200 rounded-2xl p-4 mb-6 flex items-start gap-3",children:[e.jsx(Ze,{size:20,className:"text-gray-500 flex-shrink-0"}),e.jsxs("div",{children:[e.jsx("p",{className:"font-bold text-gray-700 text-sm",children:"Projet annul"}),e.jsx("p",{className:"text-xs text-gray-600 mt-0.5",children:"Ce projet a t annul. Consultation en lecture seule."})]})]}),d.status!=="disputed"&&_&&Lt&&d.status!=="completed"&&(ze||Ge&&(Se==null?void 0:Se.artisan_id)===((Q=o.user)==null?void 0:Q.id))&&e.jsxs("div",{className:"bg-amber-50 border border-amber-200 rounded-2xl p-4 mb-6",children:[e.jsx("p",{className:"text-sm font-medium text-amber-800 mb-2",children:"En cas de diffrend avec l'autre partie, vous pouvez signaler un litige."}),e.jsx("p",{className:"text-xs text-amber-700 mb-3",children:"Le projet sera mis en attente. Seul l'administrateur pourra dbloquer la situation."}),e.jsxs("button",{onClick:ue,className:"px-4 py-2 bg-amber-600 text-white text-sm font-bold rounded-xl hover:bg-amber-700 transition-colors flex items-center gap-2",children:[e.jsx(zt,{size:16}),"Signaler un litige"]})]}),e.jsxs("section",{id:"suivi",className:"bg-white rounded-2xl border border-gray-100 p-4 mb-6",children:[e.jsx("h3",{className:"font-bold text-gray-900 text-sm mb-3",children:"Suivi du projet"}),e.jsxs("div",{className:"relative px-2",children:[e.jsx("div",{className:"absolute left-2 right-2 top-6 h-0.5 bg-gray-100"}),e.jsx("div",{className:"absolute left-2 top-6 h-0.5 bg-brand-500 transition-all duration-500",style:{width:`${V0(gt,b.length>0,_==null?void 0:_.status)/(O0.length-1)*100}%`}}),e.jsx("div",{className:"relative flex items-start justify-between gap-2",children:O0.map((se,oe)=>{const ve=V0(gt,b.length>0,_==null?void 0:_.status),Te=oe<=ve,ee=oe===ve,Fe=se.icon,He=se.id==="paid",te=d.status==="payment_received"||(_==null?void 0:_.status)==="held"||(_==null?void 0:_.status)==="advance_paid"||(_==null?void 0:_.status)==="released",de=He&&ee&&te,De=He&&ee&&!te;return e.jsxs("div",{className:"flex flex-col items-center flex-1 min-w-0",children:[e.jsx("div",{className:`relative z-10 w-10 h-10 rounded-xl flex items-center justify-center transition-all mb-2 ${Te?"bg-brand-500 text-white shadow-lg shadow-brand-200":"bg-gray-100 text-gray-400"} ${ee?"ring-4 ring-brand-100":""}`,children:e.jsx(Fe,{size:18,strokeWidth:Te?2.5:2})}),e.jsxs("div",{className:"text-center w-full",children:[e.jsx("p",{className:`font-bold text-xs leading-tight ${Te?"text-gray-900":"text-gray-400"}`,children:se.label}),ee&&!de&&!De&&e.jsx("p",{className:"text-[10px] text-brand-500 font-medium animate-pulse mt-0.5",children:"En cours"}),de&&e.jsxs("p",{className:"text-[10px] text-green-600 font-bold mt-0.5 flex items-center justify-center gap-1",children:[e.jsx(Qe,{size:12}),"Paiement OK"]}),De&&e.jsx("p",{className:"text-[10px] text-amber-600 font-medium mt-0.5",children:"En attente"}),Te&&!ee&&e.jsx(Qe,{size:14,className:"text-green-500 mx-auto mt-1"})]})]},se.id)})})]}),Se&&Lt&&(ze||Ge&&(Se==null?void 0:Se.artisan_id)===((be=o.user)==null?void 0:be.id))&&e.jsxs("div",{className:"mt-4 pt-4 border-t border-gray-100 space-y-2",children:[(d.status==="payment_received"||d.status==="in_progress"||(_==null?void 0:_.status)==="held")&&!["completion_requested","completed"].includes((d==null?void 0:d.status)||"")&&e.jsxs("button",{type:"button",onClick:ze?_e:Ae,disabled:q,className:"w-full py-3 px-4 bg-brand-500 text-white font-bold rounded-xl flex flex-col items-center justify-center gap-0.5 hover:bg-brand-600 transition-colors disabled:opacity-60",children:[e.jsxs("span",{className:"flex items-center gap-2",children:[e.jsx(da,{size:18}),"Passer  l'tape suivante"]}),e.jsx("span",{className:"text-xs font-medium opacity-90",children:"Travaux termins  Demander la clture"})]}),d.status==="completion_requested"&&ze&&!d.client_confirmed_closure_at&&e.jsxs("button",{type:"button",onClick:ft,disabled:q,className:"w-full py-3 px-4 bg-brand-500 text-white font-bold rounded-xl flex flex-col items-center justify-center gap-0.5 hover:bg-brand-600 transition-colors disabled:opacity-60",children:[e.jsxs("span",{className:"flex items-center gap-2",children:[e.jsx(da,{size:18}),"Passer  l'tape suivante"]}),e.jsx("span",{className:"text-xs font-medium opacity-90",children:"Confirmer la fin des travaux"})]}),d.status==="completed"&&ze&&e.jsxs("button",{type:"button",onClick:()=>ae(!0),className:"w-full py-3 px-4 bg-brand-500 text-white font-bold rounded-xl flex flex-col items-center justify-center gap-0.5 hover:bg-brand-600 transition-colors",children:[e.jsxs("span",{className:"flex items-center gap-2",children:[e.jsx(da,{size:18}),"Passer  l'tape suivante"]}),e.jsx("span",{className:"text-xs font-medium opacity-90",children:"Noter l'artisan"})]})]})]}),e.jsxs("section",{className:"bg-white rounded-2xl border border-gray-100 overflow-hidden mb-6",children:[e.jsxs("div",{className:"p-4 border-b border-gray-50 flex items-center gap-2 flex-wrap",children:[e.jsx("span",{className:"px-3 py-1 bg-brand-50 text-brand-600 text-[10px] font-bold rounded-lg uppercase",children:(Ee=d.categories)==null?void 0:Ee.name}),d.is_urgent&&e.jsx("span",{className:"px-3 py-1 bg-red-50 text-red-600 text-[10px] font-bold rounded-lg uppercase",children:"Urgent"}),d.is_open===!1&&e.jsx("span",{className:"px-3 py-1 bg-purple-50 text-purple-600 text-[10px] font-bold rounded-lg uppercase",children:"Demande cible"})]}),e.jsxs("div",{className:"p-4 space-y-4",children:[e.jsx("h2",{className:"text-xl font-bold text-gray-900",children:d.title}),e.jsxs("div",{className:"flex flex-wrap gap-4 text-sm text-gray-500",children:[d.location&&e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(ga,{size:14}),e.jsx("span",{children:d.location})]}),e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(mr,{size:14}),e.jsx("span",{children:new Date(d.created_at).toLocaleDateString("fr-FR")})]}),d.preferred_date&&e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(St,{size:14}),e.jsxs("span",{children:["Souhait: ",new Date(d.preferred_date).toLocaleDateString("fr-FR"),d.preferred_time_start&&d.preferred_time_end&&` de ${d.preferred_time_start.slice(0,5)}  ${d.preferred_time_end.slice(0,5)}`]})]})]}),d.is_open&&(d.max_distance_km||d.min_rating)&&e.jsxs("div",{className:"flex flex-wrap gap-2",children:[d.max_distance_km&&e.jsxs("span",{className:"px-2 py-1 bg-gray-100 text-gray-600 text-xs rounded-lg",children:["Max ",d.max_distance_km," km"]}),d.min_rating&&e.jsxs("span",{className:"px-2 py-1 bg-gray-100 text-gray-600 text-xs rounded-lg flex items-center gap-1",children:["Min ",d.min_rating," ",e.jsx(Ma,{size:10,className:"text-yellow-400 fill-yellow-400"})]})]}),d.description&&e.jsxs("div",{className:"bg-gray-50 rounded-xl p-4",children:[e.jsx("p",{className:"text-xs font-bold text-gray-500 uppercase mb-2",children:"Description"}),e.jsx("p",{className:"text-sm text-gray-800 whitespace-pre-wrap",children:d.description})]}),d.audio_description_url&&e.jsxs("div",{className:"bg-gray-50 rounded-xl p-4 flex items-center gap-4",children:[e.jsx("button",{type:"button",onClick:()=>{new Audio(d.audio_description_url).play().catch(()=>h("Impossible de lire la description vocale."))},className:"w-12 h-12 bg-brand-500 text-white rounded-full flex items-center justify-center shadow-lg flex-shrink-0",children:e.jsx(Nl,{fill:"currentColor",size:20})}),e.jsxs("div",{children:[e.jsx("p",{className:"font-bold text-gray-900 text-sm",children:"Description vocale"}),e.jsx("p",{className:"text-xs text-gray-400",children:"Appuyez pour couter"})]})]}),d.video_url&&e.jsxs("div",{className:"bg-gray-50 rounded-xl p-4 space-y-3",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"w-10 h-10 rounded-full bg-purple-100 flex items-center justify-center flex-shrink-0",children:e.jsx(zs,{size:18,className:"text-purple-600"})}),e.jsx("p",{className:"font-bold text-gray-900 text-sm",children:"Vido jointe"})]}),e.jsx("video",{src:d.video_url,controls:!0,className:"w-full rounded-xl bg-black max-h-64",playsInline:!0}),e.jsx("a",{href:d.video_url,target:"_blank",rel:"noopener noreferrer",className:"text-xs text-brand-500 underline",children:"Ouvrir dans un nouvel onglet"})]}),pe.length>0&&e.jsxs("div",{className:"space-y-2",children:[e.jsx("p",{className:"text-xs font-bold text-gray-500 uppercase",children:"Photos"}),e.jsx("div",{className:"flex gap-2 overflow-x-auto pb-2",children:pe.map((se,oe)=>e.jsx("img",{src:se,alt:`Photo ${oe+1}`,className:"w-20 h-20 rounded-xl object-cover flex-shrink-0 border-2 border-white shadow-sm cursor-pointer hover:opacity-90",onClick:()=>window.open(se,"_blank")},oe))})]}),((Oe=d.property_details)==null?void 0:Oe.type)&&e.jsxs("div",{className:"bg-gray-50 rounded-xl p-3",children:[e.jsx("p",{className:"text-xs text-gray-400 font-bold uppercase mb-1",children:"Logement"}),e.jsxs("p",{className:"text-sm text-gray-700 capitalize",children:[d.property_details.type,d.property_details.floor&&` - tage ${d.property_details.floor}`]}),d.property_details.accessNotes&&e.jsx("p",{className:"text-xs text-gray-500 mt-1",children:d.property_details.accessNotes})]})]})]}),F&&Ge&&!ze&&e.jsx("div",{className:"mb-6",children:e.jsx(yf,{projectId:i,artisanId:o.user.id,isUrgent:d.is_urgent,onSuccess:()=>{G(!1),we()},onCancel:()=>{G(!1)}})}),e.jsxs("section",{id:"section-devis",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsxs("h3",{className:"font-bold text-gray-900",children:["Devis",b.length>0&&e.jsx("span",{className:"ml-2 text-sm font-bold text-brand-500 bg-brand-50 px-2 py-0.5 rounded-full",children:b.length})]}),Ge&&!ze&&["open","quote_received"].includes(gt)&&d.status!=="expired"&&d.status!=="cancelled"&&!F&&e.jsx("button",{onClick:()=>G(!0),className:"px-4 py-2 bg-brand-500 text-white text-sm font-bold rounded-xl",children:xe?"Modifier ou envoyer un nouveau devis":"Proposer un devis"}),Ge&&!ze&&["expired","cancelled"].includes(d.status||"")&&e.jsx("p",{className:"text-xs text-gray-500 italic",children:"Ce projet n'accepte plus de nouveaux devis"})]}),Z&&(()=>{var oe;const se=b.find(ve=>ve.id===Z);return se?e.jsx(jb,{open:!!se,onClose:()=>X(null),onConfirm:async ve=>{await st(Z,ve),X(null)},quoteAmount:se.amount||0,artisanName:((oe=se.profiles)==null?void 0:oe.full_name)||"Artisan"}):null})(),b.length===0?e.jsxs("div",{className:"bg-white rounded-2xl p-8 text-center border border-gray-100",children:[e.jsx(gn,{size:32,className:"mx-auto text-gray-300 mb-3"}),e.jsx("p",{className:"text-gray-400 text-sm mb-4",children:"Aucun devis pour le moment"}),(Ge||ze)&&e.jsx("button",{onClick:()=>{console.log("[DEBUG] Manual refresh requested"),we()},className:"px-4 py-2 bg-gray-100 text-gray-700 text-sm font-medium rounded-lg hover:bg-gray-200 transition-colors",children:"Rafrachir "})]}):e.jsx("div",{className:"space-y-6",children:Object.entries(We).map(([se,oe])=>{var ve,Te;return oe.length===0?null:e.jsxs("div",{className:"space-y-3",children:[oe.length>1&&e.jsxs("div",{className:"flex items-center gap-2 mb-2 px-1",children:[e.jsx("div",{className:"w-8 h-8 rounded-full bg-gray-100 flex items-center justify-center overflow-hidden flex-shrink-0",children:(ve=oe[0].profiles)!=null&&ve.avatar_url?e.jsx("img",{src:oe[0].profiles.avatar_url,alt:"",className:"w-full h-full object-cover"}):e.jsx(ot,{size:14,className:"text-gray-400"})}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"font-bold text-gray-900 text-sm",children:((Te=oe[0].profiles)==null?void 0:Te.full_name)||"Artisan"}),e.jsxs("span",{className:"text-xs text-gray-400 bg-gray-100 px-2 py-0.5 rounded-full",children:[oe.length," devis"]})]})]}),e.jsx("div",{className:`space-y-3 ${oe.length>1?"pl-4 border-l-2 border-gray-200":""}`,children:oe.map((ee,Fe)=>{var xt,jt,Mt,pt,Xa,wa,Za,Ve,lt;const He=V.find(ke=>ke.quote_id===ee.id&&ke.status==="accepted"),te=He&&(He.suggested_price!=null||He.additional_fees!=null)&&Number(He.suggested_price??0)+Number(He.additional_fees??0)||Number(ee.amount??0),de=Xe(ee.id)?"accepted":ee.status,De=((xt=md[de])==null?void 0:xt.icon)||St,qe=ge===ee.id;return e.jsxs("div",{id:`quote-${ee.id}`,className:`bg-white rounded-2xl border transition-all relative ${de==="accepted"?"border-green-200":de==="rejected"?"border-gray-200 opacity-60":"border-gray-100"}`,children:[e.jsxs("div",{className:"p-4",children:[e.jsxs("div",{className:"flex items-start justify-between mb-3",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-10 h-10 rounded-full bg-gray-100 flex items-center justify-center overflow-hidden",children:(jt=ee.profiles)!=null&&jt.avatar_url?e.jsx("img",{src:ee.profiles.avatar_url,alt:"",className:"w-full h-full object-cover"}):e.jsx(ot,{size:18,className:"text-gray-400"})}),e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"font-bold text-gray-900",children:(Mt=ee.profiles)==null?void 0:Mt.full_name}),((pt=ee.profiles)==null?void 0:pt.is_verified)&&e.jsx(Gt,{size:14,className:"text-green-500"})]}),e.jsxs("p",{className:"text-[9px] text-gray-400 font-mono",children:["Devis #",ee.quote_number||ee.id.slice(0,8).toUpperCase()]}),Fe>0&&e.jsxs("p",{className:"text-[9px] text-yellow-600 font-medium mt-0.5",children:["Rvision #",Fe+1]})]})]}),e.jsxs("div",{className:"text-right",children:[e.jsxs("p",{className:"text-lg font-black text-brand-500",children:[te.toLocaleString("fr-FR")," FCFA"]}),ee.urgent_surcharge_percent>0&&e.jsxs("p",{className:"text-[10px] text-yellow-600",children:["+",ee.urgent_surcharge_percent,"% urgence"]}),e.jsx("p",{className:"text-[10px] text-gray-400 mt-1",children:new Date(ee.created_at).toLocaleDateString("fr-FR",{day:"numeric",month:"short",hour:"2-digit",minute:"2-digit"})}),Fe>0&&e.jsxs("p",{className:"text-[9px] text-yellow-600 mt-0.5",children:[" Devis #",oe[Fe-1].quote_number||oe[Fe-1].id.slice(0,8).toUpperCase()]})]})]}),e.jsxs("div",{className:`inline-flex items-center gap-1 px-2 py-1 rounded-lg text-xs font-bold border ${((Xa=md[de])==null?void 0:Xa.color)||"bg-gray-50 text-gray-600 border-gray-200"}`,children:[e.jsx(De,{size:12}),((wa=md[de])==null?void 0:wa.label)||de]}),de==="rejected"&&ee.rejection_reason&&e.jsx("div",{className:"mt-3 bg-red-50 rounded-xl p-4 border border-red-200",children:e.jsxs("div",{className:"flex items-start gap-2",children:[e.jsx(Ze,{size:16,className:"text-red-600 flex-shrink-0 mt-0.5"}),e.jsxs("div",{className:"flex-1",children:[e.jsx("p",{className:"text-xs font-bold text-red-800 mb-1 uppercase",children:"Raison du refus :"}),e.jsx("p",{className:"text-sm text-red-900 leading-relaxed",children:ee.rejection_reason})]})]})}),e.jsx("button",{type:"button",onClick:ke=>{ke.preventDefault(),ke.stopPropagation(),k(qe?null:ee.id)},className:"w-full mt-3 flex items-center justify-center gap-1 text-xs text-gray-400 hover:text-gray-600",children:e.jsxs("span",{className:"inline-flex items-center justify-center gap-1",children:[qe?e.jsx(jd,{size:14}):e.jsx(yd,{size:14}),qe?"Voir moins":"Voir dtails"]})})]}),qe&&e.jsxs("div",{className:"px-4 pb-4 pt-0 border-t border-gray-50 space-y-3 animate-in fade-in duration-200",children:[(ee.labor_cost||ee.materials_cost)&&e.jsxs("div",{className:"bg-gray-50 rounded-xl p-3",children:[e.jsx("p",{className:"text-xs font-bold text-gray-500 uppercase mb-2",children:"Dtail des cots"}),e.jsxs("div",{className:"space-y-1 text-sm",children:[ee.labor_cost&&e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-gray-600",children:"Main d'uvre"}),e.jsxs("span",{className:"font-bold",children:[ee.labor_cost.toLocaleString("fr-FR")," FCFA"]})]}),ee.materials_cost&&e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-gray-600",children:"Matriaux"}),e.jsxs("span",{className:"font-bold",children:[ee.materials_cost.toLocaleString("fr-FR")," FCFA"]})]})]})]}),ee.message&&e.jsxs("div",{className:"bg-gray-50 rounded-xl p-3",children:[e.jsx("p",{className:"text-xs font-bold text-gray-500 uppercase mb-1",children:"Message"}),e.jsx("p",{className:"text-sm text-gray-700",children:ee.message})]}),ee.audio_message_url&&e.jsxs("div",{className:"bg-gray-50 rounded-xl p-3 flex items-center gap-3",children:[e.jsx("button",{type:"button",onClick:()=>{new Audio(ee.audio_message_url).play().catch(()=>h("Impossible de lire le message vocal."))},className:"w-10 h-10 bg-brand-500 text-white rounded-full flex items-center justify-center",children:e.jsx(Nl,{fill:"currentColor",size:14})}),e.jsx("div",{children:e.jsx("p",{className:"text-xs font-bold text-gray-500",children:"Message vocal"})})]}),ee.proforma_url&&e.jsxs("a",{href:ee.proforma_url,target:"_blank",rel:"noopener noreferrer",className:"flex items-center gap-2 px-4 py-3 bg-blue-50 rounded-xl text-blue-600 hover:bg-blue-100 transition-colors",children:[e.jsx(et,{size:18}),e.jsx("span",{className:"text-sm font-bold",children:"Voir la facture proforma"})]}),e.jsxs("button",{type:"button",onClick:()=>{Ji(async()=>{const{downloadQuotePDF:ke}=await import("./quotePdfGenerator-DFDuCfA1.js");return{downloadQuotePDF:ke}},__vite__mapDeps([0,1,2,3]),import.meta.url).then(({downloadQuotePDF:ke})=>{var ua,Pa,ts,jn;const Tt={quote_number:ee.quote_number||"N/A",artisan_name:((ua=ee.profiles)==null?void 0:ua.full_name)||"Artisan",artisan_phone:((Pa=ee.profiles)==null?void 0:Pa.phone)||void 0,artisan_email:((ts=ee.profiles)==null?void 0:ts.email)||void 0,project_title:(d==null?void 0:d.title)||"Projet",client_name:((jn=d==null?void 0:d.profiles)==null?void 0:jn.full_name)||void 0,amount:te,labor_cost:ee.labor_cost?Number(ee.labor_cost):void 0,materials_cost:ee.materials_cost?Number(ee.materials_cost):void 0,urgent_surcharge_percent:ee.urgent_surcharge_percent||void 0,urgent_surcharge:ee.urgent_surcharge_percent&&te?te*(ee.urgent_surcharge_percent/100):void 0,message:ee.message||void 0,estimated_duration:ee.estimated_duration||void 0,proposed_date:ee.proposed_date||void 0,proposed_time_start:ee.proposed_time_start||void 0,proposed_time_end:ee.proposed_time_end||void 0,validity_hours:ee.validity_hours||48,created_at:ee.created_at||new Date().toISOString()};ke(Tt)})},className:"w-full flex items-center justify-center gap-2 px-4 py-3 bg-brand-500 text-white rounded-xl hover:bg-brand-600 transition-colors font-bold",children:[e.jsx(et,{size:18}),e.jsx("span",{children:"Tlcharger le devis en PDF"})]}),(ee.estimated_duration||ee.proposed_date)&&e.jsxs("div",{className:"flex flex-wrap gap-2 text-xs",children:[ee.estimated_duration&&e.jsxs("span",{className:"px-2 py-1 bg-gray-100 rounded-lg text-gray-600",children:["Dure: ",ee.estimated_duration]}),ee.proposed_date&&e.jsxs("span",{className:"px-2 py-1 bg-gray-100 rounded-lg text-gray-600",children:["Propos: ",new Date(ee.proposed_date).toLocaleDateString("fr-FR")]})]})]}),ze&&["open","quote_received"].includes(gt)&&!b.some(ke=>ke.status==="accepted")&&!Xe(ee.id)&&["pending","viewed"].includes(ee.status)&&!q&&e.jsxs("div",{className:"p-4 border-t border-gray-50 space-y-2",children:[e.jsx("button",{onClick:()=>Ye(ee),disabled:q,className:"w-full bg-green-500 text-white font-bold py-3 rounded-xl flex items-center justify-center gap-2 disabled:opacity-50 disabled:cursor-not-allowed",children:q?e.jsx("div",{className:"w-5 h-5 border-2 border-white border-t-transparent rounded-full animate-spin"}):e.jsxs(e.Fragment,{children:[e.jsx(Qe,{size:18,"aria-hidden":"true"}),"Accepter le devis"]})}),e.jsxs("button",{onClick:()=>X(ee.id),disabled:q,className:"w-full bg-red-50 text-red-600 font-bold py-3 rounded-xl border border-red-200 flex items-center justify-center gap-2 disabled:opacity-50 disabled:cursor-not-allowed","aria-label":"Refuser ce devis",children:[e.jsx(Ze,{size:16,"aria-hidden":"true"}),"Refuser le devis"]})]},`actions-${ee.id}`),ze&&q&&["pending","viewed"].includes(ee.status)&&e.jsx("div",{className:"p-4 border-t border-gray-50 flex items-center justify-center",children:e.jsx("div",{className:"w-5 h-5 border-2 border-brand-500 border-t-transparent rounded-full animate-spin"})},`loading-${ee.id}`),Ge&&ee.artisan_id===((Za=o.user)==null?void 0:Za.id)&&ee.status==="rejected"&&ee.rejection_reason&&e.jsxs("div",{className:"p-4 border-t border-gray-50 bg-blue-50 rounded-b-xl",children:[e.jsx("p",{className:"text-xs font-bold text-blue-800 mb-1 uppercase",children:"Message du client :"}),e.jsx("p",{className:"text-sm text-blue-900 mb-3",children:ee.rejection_reason}),e.jsx("p",{className:"text-xs text-blue-700 italic",children:"Vous pouvez soumettre un nouveau devis en tenant compte de ces commentaires."})]}),Ge&&ee.artisan_id===((Ve=o.user)==null?void 0:Ve.id)&&V.some(ke=>ke.quote_id===ee.id&&ke.status==="pending")&&e.jsxs("div",{className:"p-4 border-t border-gray-50 bg-yellow-50 rounded-b-xl",children:[e.jsx("div",{className:"flex items-start justify-between mb-2",children:e.jsxs("p",{className:"text-xs font-bold text-yellow-800 uppercase flex items-center gap-2",children:[e.jsx(zt,{size:14}),"Demande de rvision en attente"]})}),V.filter(ke=>ke.quote_id===ee.id&&ke.status==="pending").map(ke=>e.jsxs("div",{className:"mb-3 last:mb-0",children:[e.jsx("p",{className:"text-sm text-yellow-900 mb-2",children:ke.client_comments}),e.jsx("button",{onClick:()=>u(`/revisions/${ke.id}/respond`),className:"w-full bg-yellow-600 text-white font-bold py-2 rounded-xl text-sm hover:bg-yellow-700 transition-colors",children:"Rpondre  la rvision"})]},ke.id))]}),Ge&&ee.artisan_id===((lt=o.user)==null?void 0:lt.id)&&["pending","viewed","rejected"].includes(ee.status)&&e.jsxs("div",{className:"p-4 border-t border-gray-50",children:[e.jsxs("button",{type:"button",onClick:()=>ye(ee.id),disabled:q,className:"w-full bg-gray-100 text-gray-600 font-bold py-2.5 rounded-xl text-sm hover:bg-gray-200 transition-colors disabled:opacity-50 flex items-center justify-center gap-2",children:[e.jsx(Ze,{size:16}),q?"Clture...":"Clturer mon devis"]}),e.jsx("p",{className:"text-xs text-gray-500 text-center mt-2",children:"Ce projet ne figurera plus parmi vos rponses en cours."})]}),ze&&(ee.status==="accepted"||ee.status==="pending"||ee.status==="viewed")&&["open","quote_received","quote_accepted","payment_pending"].includes(gt)&&!b.some(ke=>ke.status==="accepted"&&ke.id!==ee.id)&&!V.some(ke=>ke.quote_id===ee.id&&ke.status==="pending")&&!Xe(ee.id)&&e.jsxs("div",{className:"p-4 border-t border-gray-50",children:[e.jsxs("button",{onClick:()=>u(`/projects/${i}/request-revision?quoteId=${ee.id}`),className:"w-full bg-yellow-50 text-yellow-700 font-bold py-3 rounded-xl border border-yellow-200 flex items-center justify-center gap-2 hover:bg-yellow-100 transition-colors",children:[e.jsx(zt,{size:16}),"Demander une rvision"]}),e.jsx("p",{className:"text-xs text-gray-500 text-center mt-2",children:ee.status==="accepted"?"Vous pouvez demander une modification du devis avant le dbut des travaux":"Vous pouvez demander une modification avant d'accepter le devis"})]}),ze&&V.some(ke=>ke.quote_id===ee.id)&&e.jsx("div",{className:"p-4 border-t border-gray-50",children:V.filter(ke=>ke.quote_id===ee.id).map(ke=>{const Tt={pending:{label:"En attente de rponse",color:"bg-yellow-50 text-yellow-700 border-yellow-200",icon:St},accepted:{label:"Rvision accepte",color:"bg-green-50 text-green-700 border-green-200",icon:Qe},rejected:{label:"Rvision refuse",color:"bg-red-50 text-red-700 border-red-200",icon:Ze},modified:{label:"Devis modifi",color:"bg-blue-50 text-blue-700 border-blue-200",icon:et}},ua=Tt[ke.status]||Tt.pending,Pa=ua.icon,ts=ke.status==="accepted"&&(ke.suggested_price!=null||ke.additional_fees!=null)?Number(ke.suggested_price??0)+Number(ke.additional_fees??0):null;return e.jsxs("div",{className:"bg-gray-50 rounded-xl p-4 space-y-3",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(Pa,{size:16,className:ua.color.split(" ")[1]}),e.jsx("span",{className:`text-xs font-bold px-2 py-1 rounded-lg border ${ua.color}`,children:ua.label})]}),e.jsx("span",{className:"text-xs text-gray-500",children:new Date(ke.requested_at).toLocaleDateString("fr-FR")})]}),ke.client_comments&&e.jsxs("div",{children:[e.jsx("p",{className:"text-xs font-bold text-gray-700 mb-1",children:"Votre demande :"}),e.jsx("p",{className:"text-sm text-gray-600",children:ke.client_comments})]}),ke.artisan_response&&e.jsxs("div",{children:[e.jsx("p",{className:"text-xs font-bold text-gray-700 mb-1",children:"Rponse de l'artisan :"}),e.jsx("p",{className:"text-sm text-gray-600",children:ke.artisan_response})]}),ke.status==="accepted"&&e.jsxs("div",{children:[e.jsx("p",{className:"text-xs font-bold text-gray-700 mb-1",children:"Montant convenu"}),e.jsx("p",{className:"text-sm font-bold text-green-700",children:ts!=null&&ts>0?`${ts.toLocaleString("fr-FR")} FCFA`:ee.amount!=null?`${Number(ee.amount).toLocaleString("fr-FR")} FCFA`:""})]})]},ke.id)})})]},ee.id)})})]},se)})}),ze&&["open","quote_received"].includes(gt)&&!b.some(se=>se.status==="accepted")&&!Pe&&e.jsxs("div",{className:"bg-white rounded-2xl border border-red-200 p-4 mt-4",children:[e.jsx("button",{onClick:je,disabled:q,className:"w-full bg-red-50 text-red-600 font-bold py-3 rounded-xl border border-red-200 flex items-center justify-center gap-2 disabled:opacity-50 disabled:cursor-not-allowed hover:bg-red-100 transition-colors",children:q?e.jsx("div",{className:"w-5 h-5 border-2 border-red-600 border-t-transparent rounded-full animate-spin"}):e.jsxs(e.Fragment,{children:[e.jsx(Ze,{size:18}),"Annuler le projet"]})}),e.jsx("p",{className:"text-xs text-gray-500 text-center mt-2",children:"Vous pourrez annuler tant qu'aucun devis n'a t accept"})]})]})]}),ze&&(gt==="quote_accepted"||d.status==="payment_pending")&&_&&_.status==="pending"&&e.jsx("div",{className:"fixed bottom-0 left-0 right-0 z-20 border-t border-gray-100 bg-white/95 backdrop-blur-md shadow-[0_-2px_20px_rgba(0,0,0,0.04)]",children:e.jsx("div",{className:"max-w-lg mx-auto px-4 pt-4 pb-5",children:e.jsxs("button",{onClick:()=>u(`/projects/${i}/payment`),className:"w-full py-3.5 rounded-xl bg-brand-500 text-white font-semibold flex items-center justify-center gap-2.5 hover:bg-brand-600 active:scale-[0.99] transition-all duration-200",children:[e.jsx(Na,{size:18,strokeWidth:2}),"Procder au paiement"]})})}),ze&&(Se||_&&["held","advance_paid"].includes(_.status))&&Lt&&!["completion_requested","completed"].includes((d==null?void 0:d.status)||"")&&e.jsx("div",{className:"fixed bottom-0 left-0 right-0 z-20 border-t border-gray-100 bg-white/95 backdrop-blur-md shadow-[0_-2px_20px_rgba(0,0,0,0.04)]",children:e.jsxs("div",{className:"max-w-lg mx-auto px-4 pt-4 pb-5 space-y-2.5",children:[e.jsxs("button",{onClick:()=>u(`/projects/${i}/work`),className:"w-full py-3.5 rounded-xl bg-brand-500 text-white font-semibold flex items-center justify-center gap-2.5 hover:bg-brand-600 active:scale-[0.99] transition-all duration-200",children:[e.jsx(ns,{size:18,strokeWidth:2}),"Voir les travaux"]}),e.jsxs("button",{onClick:()=>u(`/projects/${i}/completion`),className:"w-full py-3 rounded-xl border border-gray-200 bg-white text-gray-700 font-medium flex items-center justify-center gap-2 hover:bg-gray-50 active:scale-[0.99] transition-all duration-200",children:[e.jsx(Qe,{size:16,strokeWidth:2}),"Finaliser le projet"]})]})}),ze&&d.status==="completion_requested"&&(Se||_)&&e.jsx("div",{className:"fixed bottom-0 left-0 right-0 z-20 border-t border-gray-100 bg-white/95 backdrop-blur-md shadow-[0_-2px_20px_rgba(0,0,0,0.04)]",children:e.jsxs("div",{className:"max-w-lg mx-auto px-4 pt-4 pb-5 space-y-2.5",children:[e.jsxs("button",{onClick:()=>u(`/projects/${i}/completion`),className:"w-full py-3.5 rounded-xl bg-emerald-600 text-white font-semibold flex items-center justify-center gap-2.5 hover:bg-emerald-700 active:scale-[0.99] transition-all duration-200",children:[e.jsx(Qe,{size:18,strokeWidth:2}),"Finaliser le projet"]}),e.jsxs("button",{onClick:()=>u(`/chat/${i}`),className:"w-full py-3 rounded-xl border border-gray-200 bg-white text-gray-600 font-medium flex items-center justify-center gap-2 hover:bg-gray-50 active:scale-[0.99] transition-all duration-200",children:[e.jsx(es,{size:16,strokeWidth:2}),"Contacter l'artisan"]})]})}),ze&&d.status==="completed"&&(Se||_)&&e.jsx("div",{className:"fixed bottom-0 left-0 right-0 z-20 border-t border-gray-100 bg-white/95 backdrop-blur-md shadow-[0_-2px_20px_rgba(0,0,0,0.04)]",children:e.jsx("div",{className:"max-w-lg mx-auto px-4 pt-4 pb-5",children:e.jsxs("button",{onClick:()=>ae(!0),className:"w-full py-3.5 rounded-xl bg-brand-500 text-white font-semibold flex items-center justify-center gap-2.5 hover:bg-brand-600 active:scale-[0.99] transition-all duration-200",children:[e.jsx(Ma,{size:18,strokeWidth:2}),"Noter l'artisan"]})})}),Ge&&((Se==null?void 0:Se.artisan_id)===((ct=o.user)==null?void 0:ct.id)||_&&["held","advance_paid"].includes(_.status))&&Lt&&!["completion_requested","completed"].includes((d==null?void 0:d.status)||"")&&e.jsx("div",{className:"fixed bottom-0 left-0 right-0 z-20 border-t border-gray-100 bg-white/95 backdrop-blur-md shadow-[0_-2px_20px_rgba(0,0,0,0.04)]",children:e.jsx("div",{className:"max-w-lg mx-auto px-4 pt-4 pb-5",children:e.jsxs("button",{onClick:()=>u(`/projects/${i}/work`),className:"w-full py-3.5 rounded-xl bg-brand-500 text-white font-semibold flex items-center justify-center gap-2.5 hover:bg-brand-600 active:scale-[0.99] transition-all duration-200",children:[e.jsx(ns,{size:18,strokeWidth:2}),"Voir les travaux"]})})}),Ge&&((Se==null?void 0:Se.artisan_id)===((at=o.user)==null?void 0:at.id)||_)&&d.status==="completion_requested"&&e.jsx("div",{className:"fixed bottom-0 left-0 right-0 z-20 border-t border-gray-100 bg-white/95 backdrop-blur-md shadow-[0_-2px_20px_rgba(0,0,0,0.04)]",children:e.jsx("div",{className:"max-w-lg mx-auto px-4 pt-4 pb-5",children:e.jsxs("div",{className:"rounded-xl bg-amber-50/80 border border-amber-200/60 px-4 py-3 flex items-center gap-3",children:[e.jsx("div",{className:"w-9 h-9 rounded-lg bg-amber-100 flex items-center justify-center flex-shrink-0",children:e.jsx(St,{size:18,className:"text-amber-600",strokeWidth:2})}),e.jsxs("div",{className:"min-w-0",children:[e.jsx("p",{className:"font-semibold text-amber-900 text-sm",children:"En attente du client"}),e.jsx("p",{className:"text-xs text-amber-700/80 mt-0.5",children:"Il doit confirmer la fin des travaux."})]})]})})}),Se&&["quote_received","quote_accepted","in_progress","completion_requested","completed","expired","cancelled"].includes(gt)&&e.jsx("button",{onClick:()=>u(`/chat/${i}`),className:"fixed bottom-28 right-4 w-14 h-14 bg-brand-500 text-white rounded-full shadow-lg flex items-center justify-center z-30 hover:bg-brand-600 transition-colors",title:"Ouvrir le chat du projet",children:e.jsx(es,{size:24,fill:"currentColor"})}),R&&(()=>{const se=b.find(ve=>ve.status==="accepted");if(!se||!d)return null;const oe=se.profiles;return e.jsx(vb,{isOpen:R,onClose:()=>{ae(!1),u("/dashboard")},projectId:i,projectTitle:d.title,artisanId:se.artisan_id,artisanName:(oe==null?void 0:oe.full_name)||"Artisan",artisanAvatar:oe==null?void 0:oe.avatar_url,onSuccess:()=>{ae(!1),u("/dashboard")}})})(),e.jsx(pd,{open:C,title:"Annuler le projet",message:"tes-vous sr de vouloir annuler ce projet ? Cette action est irrversible et tous les devis en attente seront automatiquement rejets.",confirmText:"Oui, annuler",cancelText:"Non, garder le projet",variant:"danger",onConfirm:Le,onCancel:()=>B(!1)}),e.jsx(pd,{open:!!fe,title:"Clturer ma participation",message:"tes-vous sr de vouloir clturer votre participation  ce projet ? Aucun paiement ne sera effectu. Le client sera notifi.",confirmText:"Oui, clturer",cancelText:"Non, annuler",variant:"danger",onConfirm:()=>{const se=fe;ye(null),se&&Ke(se)},onCancel:()=>ye(null)})]})}function Da({className:i=""}){const u=ht(),{user:f}=Nt(),o=()=>{u(f?"/dashboard":"/")};return e.jsx("button",{type:"button",onClick:o,className:i||"w-10 h-10 rounded-full bg-gray-100 flex items-center justify-center text-gray-600 hover:bg-gray-200 transition-colors","aria-label":"Retour  l'accueil",children:e.jsx(xr,{size:20})})}const xd=[{id:"pack_5",label:"Pack Dcouverte",credits:5,price:2500},{id:"pack_10",label:"Pack Pro",credits:10,price:4500},{id:"pack_25",label:"Pack Premium",credits:25,price:1e4}];function wb(){const i=ht(),u=Nt(),{profile:f,loading:o}=It(),{success:x,error:y}=sa(),[N,h]=c.useState(null),[g,E]=c.useState(!0),[d,v]=c.useState(null),[b,w]=c.useState(ta[0].id),[_,L]=c.useState(""),[M,D]=c.useState(!1),[U,J]=c.useState(null),[F,G]=c.useState(null),Z=(f==null?void 0:f.role)==="artisan";c.useEffect(()=>{!u.loading&&!u.user&&i("/onboard?mode=signup")},[u.user,u.loading,i]),c.useEffect(()=>{const k=async()=>{if(!u.user||!Z){E(!1);return}E(!0);const{data:q,error:T}=await j.from("artisan_credit_wallets").select("*").eq("artisan_id",u.user.id).maybeSingle();T?console.error("Error fetching credit wallet:",T):h(q??{artisan_id:u.user.id,balance:0}),E(!1)};!o&&u.user&&Z&&k()},[u.user,o,Z]);const X=c.useMemo(()=>ta.find(k=>k.id===b)||ta[0],[b]),R=c.useMemo(()=>xd.find(k=>k.id===d),[d]),ae=c.useMemo(()=>{if(!R)return 0;const k=Math.round(R.price*((X==null?void 0:X.fees)||0)/100);return R.price+k},[R,X]),ge=async()=>{if(!u.user||!Z)return;const k=xd.find(q=>q.id===d);if(!k){G("Veuillez choisir un pack de crdits.");return}D(!0),G(null),J(null);try{const q=await kd(k.price,b,{userId:u.user.id,phoneNumber:_||void 0});if(J(q),G(q.success?null:q.message),q.success){const{data:T,error:C}=await j.rpc("purchase_credits",{p_artisan_id:u.user.id,p_credits:k.credits,p_payment_ref:q.reference,p_metadata:{method:q.method,amount:q.amount,total_charged:q.totalCharged}});if(C){console.error("purchase_credits error:",C),G("Le paiement a t valid mais l'ajout de crdits a chou. Contactez le support."),D(!1);return}h(B=>B?{...B,balance:T??B.balance}:{artisan_id:u.user.id,balance:T??k.credits}),x(`${k.credits} crdits ajouts avec succs !`),setTimeout(()=>{i("/dashboard")},2e3)}}catch(q){console.error("Unexpected error during credit purchase:",q),G((q==null?void 0:q.message)||"Une erreur est survenue lors de l'achat de crdits.")}finally{D(!1)}};return u.loading||o||g?e.jsx(Yt,{}):u.user?f?Z?e.jsxs("div",{className:"min-h-screen bg-gradient-to-br from-gray-50 via-white to-gray-50",children:[e.jsxs("header",{className:"sticky top-0 z-20 px-5 py-4 bg-white/80 backdrop-blur-lg border-b border-gray-100/50 flex items-center gap-4 shadow-sm",children:[e.jsx(Da,{}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("h1",{className:"font-black text-lg text-gray-900 truncate",children:"Recharger mon portefeuille"}),e.jsx("p",{className:"text-xs text-gray-400 font-mono",children:"Crdits artisan"})]})]}),e.jsxs("main",{className:"max-w-lg mx-auto px-5 py-6 pb-36",children:[e.jsxs("div",{className:"bg-white rounded-3xl p-6 mb-6 border border-gray-100 shadow-lg shadow-gray-100/50",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"font-black text-xl text-gray-900",children:"Solde actuel"}),e.jsx("p",{className:"text-xs text-gray-500 mt-1 font-medium",children:"Portefeuille de crdits"})]}),e.jsx("div",{className:"w-14 h-14 rounded-2xl bg-gradient-to-br from-purple-500 to-indigo-600 flex items-center justify-center text-white shadow-lg shadow-purple-500/40",children:e.jsx(Na,{size:26})})]}),e.jsxs("div",{className:"mt-5",children:[e.jsxs("p",{className:"text-4xl font-black text-gray-900",children:[(N==null?void 0:N.balance)??0," ",e.jsx("span",{className:"text-base font-bold text-gray-600",children:"crdits"})]}),e.jsx("p",{className:"text-xs text-gray-600 mt-3 font-medium",children:"10 crdits consomms par projet accept. Les crdits ne sont pas remboursables."})]})]}),e.jsxs("div",{className:"bg-brand-50 border-2 border-brand-200 rounded-3xl p-5 mb-6 flex items-start gap-4 shadow-sm",children:[e.jsx(dn,{size:26,className:"text-brand-600 flex-shrink-0 mt-0.5"}),e.jsxs("div",{className:"flex-1",children:[e.jsx("p",{className:"font-black text-sm text-brand-900 mb-1.5",children:"Paiement scuris"}),e.jsx("p",{className:"text-xs text-brand-700 leading-relaxed font-medium",children:"Votre paiement est trait de manire scurise. Les crdits sont ajouts immdiatement aprs confirmation du paiement."})]})]}),e.jsxs("div",{className:"bg-white rounded-3xl p-6 mb-6 border border-gray-100 shadow-lg shadow-gray-100/50",children:[e.jsx("h3",{className:"font-black text-xl text-gray-900 mb-5",children:"Choisissez un pack"}),e.jsx("div",{className:"space-y-3",children:xd.map(k=>e.jsxs("button",{onClick:()=>v(k.id),className:`w-full text-left rounded-3xl border-2 p-5 flex items-center justify-between transition-all hover:shadow-md ${d===k.id?"border-brand-500 bg-brand-50 shadow-lg shadow-brand-200/50":"border-gray-200 bg-white hover:border-gray-300"}`,children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-base font-black text-gray-900 mb-1",children:k.label}),e.jsxs("p",{className:"text-sm text-gray-600 font-medium",children:[k.credits," crdits  ",k.price.toLocaleString("fr-FR")," FCFA"]})]}),d===k.id&&e.jsx("div",{className:"w-7 h-7 rounded-full bg-brand-500 flex items-center justify-center shadow-md",children:e.jsx(aa,{size:16,className:"text-white",strokeWidth:3})})]},k.id))})]}),e.jsxs("div",{className:"rounded-2xl border border-yellow-200 bg-yellow-50 px-4 py-3 text-xs text-yellow-700 mb-6",children:[e.jsx("p",{className:"font-semibold",children:wl.message}),e.jsx("p",{children:wl.warning})]}),d&&e.jsxs("div",{className:"bg-white rounded-3xl p-6 mb-6 border border-gray-100 shadow-lg shadow-gray-100/50",children:[e.jsx("h3",{className:"font-black text-xl text-gray-900 mb-5",children:"Mode de paiement"}),e.jsxs("div",{className:"mb-5",children:[e.jsx("p",{className:"text-xs font-bold uppercase text-gray-500 tracking-[0.3em] mb-3",children:"Mthode"}),e.jsx("div",{className:"flex flex-wrap gap-2",children:ta.filter(k=>k.logo).map(k=>e.jsxs("button",{type:"button",onClick:()=>w(k.id),className:`flex-1 min-w-[120px] rounded-2xl border-2 px-4 py-4 text-center transition ${b===k.id?"border-brand-500 bg-brand-50 text-brand-700":"border-gray-200 bg-white text-gray-600 hover:border-gray-300"}`,children:[e.jsx("div",{className:"flex items-center justify-center mb-2 h-14 min-h-[56px]",children:k.logo?e.jsx("img",{src:k.logo,alt:k.name,className:"max-h-14 max-w-full object-contain w-auto h-auto",style:{maxHeight:"56px",maxWidth:"100%"},onError:q=>{const T=q.target,C=T.parentElement;if(C){T.style.display="none";const B=document.createElement("div");B.className="text-2xl",B.textContent=k.icon,C.appendChild(B)}}}):e.jsx("div",{className:"text-2xl",children:k.icon})}),e.jsx("div",{className:"text-xs font-bold uppercase",children:k.name})]},k.id))}),ta.filter(k=>!k.logo&&k.available).length>0&&e.jsx("div",{className:"mt-2 grid grid-cols-2 gap-2",children:ta.filter(k=>!k.logo&&k.available).map(k=>e.jsxs("button",{type:"button",onClick:()=>w(k.id),className:`rounded-2xl border px-4 py-3 text-left transition ${b===k.id?"border-brand-500 bg-brand-50 text-brand-700":"border-gray-200 bg-white text-gray-600 hover:border-gray-300"}`,children:[e.jsx("div",{className:"text-xl mb-2",children:k.icon}),e.jsx("div",{className:"text-sm font-bold",children:k.name}),e.jsx("p",{className:"text-xs text-gray-500",children:k.description})]},k.id))})]}),e.jsxs("div",{className:"mb-5 space-y-2",children:[e.jsx("label",{className:"text-xs font-bold uppercase text-gray-500",children:"Numro du payeur"}),e.jsx("input",{type:"tel",value:_,onChange:k=>L(k.target.value),placeholder:"ex: 77xxxxxx",className:"w-full rounded-2xl border border-gray-200 px-4 py-3 text-sm text-gray-700 focus:border-brand-500 focus:outline-none"}),e.jsx("p",{className:"text-[10px] text-gray-400",children:"Optionnel, permet de contextualiser la transaction ct oprateur."})]}),e.jsxs("div",{className:"rounded-3xl border-2 border-gray-200 bg-gray-50 p-5 text-sm space-y-3 mb-5 shadow-sm",children:[e.jsxs("div",{className:"flex justify-between text-gray-600 font-medium",children:[e.jsx("span",{children:"Pack slectionn"}),e.jsxs("span",{className:"font-bold",children:[R==null?void 0:R.credits," crdits  ",R==null?void 0:R.price.toLocaleString("fr-FR")," FCFA"]})]}),e.jsxs("div",{className:"flex justify-between text-gray-600 font-medium",children:[e.jsxs("span",{children:["Frais (",(X==null?void 0:X.fees)??0,"%)"]}),e.jsxs("span",{className:"font-bold",children:[Math.round(((R==null?void 0:R.price)||0)*(((X==null?void 0:X.fees)??0)/100)).toLocaleString("fr-FR")," FCFA"]})]}),e.jsxs("div",{className:"border-t-2 border-gray-300 pt-3 flex justify-between font-black text-gray-900",children:[e.jsx("span",{className:"text-base",children:"Total"}),e.jsxs("span",{className:"text-lg",children:[ae.toLocaleString("fr-FR")," FCFA"]})]}),e.jsxs("p",{className:"text-xs text-gray-500 font-medium pt-2 border-t border-gray-200",children:["Mthode slectionne : ",e.jsx("strong",{className:"text-gray-700",children:X==null?void 0:X.name})]})]}),U&&e.jsxs("div",{className:`mb-5 flex items-center gap-3 rounded-3xl border-2 px-5 py-4 text-sm font-medium ${U.success?"border-green-300 bg-green-50 text-green-800":"border-red-300 bg-red-50 text-red-700"}`,children:[U.success?e.jsx(Qe,{size:22,className:"flex-shrink-0"}):e.jsx(zt,{size:22,className:"flex-shrink-0"}),e.jsx("span",{children:U.message})]}),F&&e.jsxs("div",{className:"mb-5 flex items-center gap-3 rounded-3xl border-2 border-red-300 bg-red-50 px-5 py-4 text-sm text-red-700 font-medium",children:[e.jsx(zt,{size:20,className:"flex-shrink-0"}),e.jsx("span",{children:F})]}),e.jsx("button",{type:"button",onClick:ge,disabled:M||!d,className:"w-full rounded-3xl bg-gradient-to-r from-brand-500 to-brand-600 px-6 py-5 text-sm font-black uppercase tracking-[0.2em] text-white transition-all disabled:opacity-60 flex items-center justify-center gap-3 shadow-lg shadow-brand-500/30 hover:shadow-xl hover:shadow-brand-500/40 active:scale-[0.98]",children:M?e.jsxs(e.Fragment,{children:[e.jsx(ma,{className:"h-5 w-5 animate-spin"}),e.jsx("span",{children:"Traitement..."})]}):e.jsx("span",{children:"Simuler le paiement"})})]})]})]}):e.jsx("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center p-6",children:e.jsxs("div",{className:"max-w-md text-center",children:[e.jsx("div",{className:"w-16 h-16 rounded-full bg-blue-100 flex items-center justify-center mx-auto mb-4",children:e.jsx(dn,{size:28,className:"text-blue-600"})}),e.jsx("h1",{className:"text-2xl font-bold text-gray-900 mb-2",children:"Espace rserv aux artisans"}),e.jsx("p",{className:"text-gray-600 mb-6",children:"Les crdits sont utiliss pour accepter des projets en tant qu'artisan. Connectez-vous avec un compte artisan pour accder  cette page."}),e.jsx("button",{onClick:()=>i("/dashboard"),className:"px-6 py-3 rounded-xl bg-brand-500 text-white font-bold hover:bg-brand-600 transition-colors",children:"Retour au tableau de bord"})]})}):e.jsx("div",{className:"min-h-screen bg-gradient-to-br from-gray-50 via-white to-gray-50 flex items-center justify-center p-6",children:e.jsxs("div",{className:"max-w-md text-center",children:[e.jsx("div",{className:"w-16 h-16 rounded-full bg-blue-100 flex items-center justify-center mx-auto mb-4",children:e.jsx(dn,{size:28,className:"text-blue-600"})}),e.jsx("h1",{className:"text-2xl font-bold text-gray-900 mb-2",children:"Profil en cours de cration"}),e.jsx("p",{className:"text-gray-600 mb-6",children:"Votre profil est en cours de cration. Veuillez patienter ou retourner au tableau de bord."}),e.jsx("button",{onClick:()=>i("/dashboard"),className:"px-6 py-3 rounded-xl bg-brand-500 text-white font-bold hover:bg-brand-600 transition-colors",children:"Retour au tableau de bord"})]})}):null}function _b(){var V,le,he,Ne;const{id:i}=Ya(),u=ht(),f=Nt(),{profile:o}=It(),{confirmDeposit:x,loading:y}=bn(),{success:N,error:h}=sa(),[g,E]=c.useState(null),[d,v]=c.useState(null),[b,w]=c.useState(null),[_,L]=c.useState(!0),[M,D]=c.useState(0),[U,J]=c.useState(ta[0].id),[F,G]=c.useState(""),[Z,X]=c.useState(!1),[R,ae]=c.useState(null),[ge,k]=c.useState(null);c.useEffect(()=>{if(!i||!f.user)return;(async()=>{L(!0);try{const{data:ye,error:Y}=await j.from("projects").select("*").eq("id",i).single();if(Y)throw Y;if(E(ye),ye.client_id!==f.user.id){h("Vous n'tes pas autoris  accder  cette page."),u(`/projects/${i}`);return}const{data:$,error:ce}=await j.from("escrows").select("*").eq("project_id",i).maybeSingle();if(ce)throw ce;v($||null);const{data:we,error:We}=await j.from("quotes").select("id, amount, artisan_id, quote_number, created_at").eq("project_id",i).eq("status","accepted").maybeSingle();if(We&&console.warn("[ProjectPaymentPage] Fetch quote:",We.message),we!=null&&we.artisan_id){const{data:Ye}=await j.from("profiles").select("id, full_name, avatar_url").eq("id",we.artisan_id).maybeSingle();w(Ye?{...we,profiles:Ye}:we)}else we&&w(we);let pe=null;if((we==null?void 0:we.amount)!=null&&Number(we.amount)>0&&(pe=Number(we.amount)),pe==null){const{data:Ye}=await j.from("quote_revisions").select("suggested_price, additional_fees").eq("project_id",i).eq("status","accepted").order("responded_at",{ascending:!1}).limit(1).maybeSingle();if(Ye&&(Ye.suggested_price!=null||Ye.additional_fees!=null)){const st=Number(Ye.suggested_price??0),Ke=Number(Ye.additional_fees??0);(st>0||Ke>0)&&(pe=st+Ke)}}pe==null&&($==null?void 0:$.total_amount)!=null&&Number($.total_amount)>0&&(pe=Number($.total_amount)),D(pe??0)}catch(ye){console.error("Error fetching payment data:",ye),h(`Erreur: ${ye.message||"Erreur inconnue"}`)}finally{L(!1)}})()},[i,f.user,u,h]);const q=c.useMemo(()=>ta.find(fe=>fe.id===U)||ta[0],[U]),T=c.useMemo(()=>((b==null?void 0:b.amount)!=null&&Number(b.amount)>0?Number(b.amount):null)??M??0,[b==null?void 0:b.amount,M]),C=c.useMemo(()=>{const fe=Math.round(T*((q==null?void 0:q.fees)||0)/100);return T+fe},[T,q]),B=async()=>{const fe=T||M;if(fe<=0){k("Le montant du devis accept est absent. Impossible de procder au paiement.");return}X(!0),k(null),ae(null);try{const ye=await kd(fe,U,{projectId:(g==null?void 0:g.id)??void 0,escrowId:d==null?void 0:d.id,phoneNumber:F||void 0});ae(ye),k(ye.success?null:ye.message),ye.success&&(d!=null&&d.id?await x(d.id,U):g!=null&&g.id&&await j.from("projects").update({status:"payment_received"}).eq("id",g.id),N("Paiement confirm ! Redirection..."),setTimeout(()=>{u(`/projects/${i}/thank-you`)},400))}catch(ye){console.error("Error processing payment:",ye),k("Erreur lors du traitement du paiement")}finally{X(!1)}};if(_)return e.jsx(Yt,{});if(!g)return e.jsx("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center p-6",children:e.jsxs("div",{className:"text-center",children:[e.jsx(zt,{size:48,className:"text-red-500 mx-auto mb-4"}),e.jsx("h2",{className:"text-xl font-bold text-gray-900 mb-2",children:"Donnes non trouves"}),e.jsx("p",{className:"text-gray-600 mb-6",children:"Impossible de charger les informations de paiement."}),e.jsx("button",{onClick:()=>u(`/projects/${i}`),className:"px-6 py-3 bg-brand-500 text-white rounded-xl font-bold",children:"Retour au projet"})]})});const z=!!d&&(d.status==="held"||d.status==="advance_paid"||d.status==="released"),S=!z;return e.jsxs("div",{className:"min-h-screen bg-gray-50",children:[e.jsxs("header",{className:"sticky top-0 z-20 px-4 py-4 bg-white border-b border-gray-100 flex items-center gap-4",children:[e.jsx("button",{type:"button",onClick:()=>u(`/projects/${i}`),className:"w-10 h-10 rounded-xl bg-gray-100 flex items-center justify-center text-gray-600 hover:bg-gray-200","aria-label":"Retour au projet",children:e.jsx(Wt,{size:20})}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("h1",{className:"font-bold text-gray-900 truncate",children:"Paiement scuris"}),e.jsx("p",{className:"text-xs text-gray-400 font-mono",children:g.project_number})]}),e.jsx(Da,{})]}),e.jsxs("main",{className:"max-w-lg mx-auto px-4 py-6 pb-32",children:[e.jsxs("div",{className:"bg-white rounded-2xl p-5 mb-6 border border-gray-100",children:[e.jsx("h2",{className:"font-bold text-lg text-gray-900 mb-3",children:g.title}),b&&e.jsxs("div",{className:"flex items-center gap-3 mb-4",children:[e.jsx("div",{className:"w-10 h-10 rounded-full bg-gray-100 flex items-center justify-center overflow-hidden",children:(V=b.profiles)!=null&&V.avatar_url?e.jsx("img",{src:b.profiles.avatar_url,alt:"",className:"w-full h-full object-cover"}):e.jsx("span",{className:"text-gray-400 font-bold",children:((he=(le=b.profiles)==null?void 0:le.full_name)==null?void 0:he.charAt(0))||"A"})}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("p",{className:"font-bold text-sm text-gray-900",children:((Ne=b.profiles)==null?void 0:Ne.full_name)||"Artisan"}),e.jsx("p",{className:"text-xs text-gray-500",children:"Artisan slectionn"})]})]})]}),e.jsxs("div",{className:"bg-brand-50 border border-brand-200 rounded-2xl p-4 mb-6 flex items-start gap-3",children:[e.jsx(dn,{size:24,className:"text-brand-600 flex-shrink-0 mt-0.5"}),e.jsxs("div",{className:"flex-1",children:[e.jsx("p",{className:"font-bold text-sm text-brand-900 mb-1",children:"Paiement scuris"}),e.jsx("p",{className:"text-xs text-brand-700 leading-relaxed",children:"Votre paiement est protg par notre systme d'escrow. Les fonds seront librs uniquement aprs validation des travaux."})]})]}),z&&e.jsxs("div",{className:"bg-green-50 border-2 border-green-200 rounded-2xl p-6 mb-6 text-center",children:[e.jsx("div",{className:"w-16 h-16 bg-green-500 rounded-full flex items-center justify-center mx-auto mb-4",children:e.jsx(aa,{size:32,className:"text-white"})}),e.jsx("h3",{className:"font-bold text-lg text-green-900 mb-2",children:"Paiement effectu !"}),e.jsx("p",{className:"text-sm text-green-700 mb-5",children:"Votre paiement a t confirm. L'artisan a t notifi et peut maintenant commencer les travaux."}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("button",{onClick:()=>u(`/projects/${i}#suivi`),className:"w-full px-6 py-4 bg-green-600 text-white rounded-xl font-bold hover:bg-green-700 transition-colors flex items-center justify-center gap-2",children:[e.jsx(vl,{size:20}),"Voir le suivi du projet"]}),e.jsx("button",{onClick:()=>u(`/projects/${i}`),className:"w-full px-6 py-3 bg-white border-2 border-green-300 text-green-800 rounded-xl font-bold hover:bg-green-50 transition-colors",children:"Voir le dtail du projet"})]})]}),S&&e.jsxs(e.Fragment,{children:[d?e.jsxs("div",{className:"bg-white rounded-2xl p-5 mb-6 border border-gray-100",children:[e.jsx("h3",{className:"font-bold text-lg text-gray-900 mb-4",children:"Dtails du paiement"}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{className:"text-sm text-gray-600",children:"Montant du devis"}),e.jsxs("span",{className:"font-bold text-gray-900",children:[Number(d.base_amount||0).toLocaleString("fr-FR")," FCFA"]})]}),Number(d.urgent_surcharge||0)>0&&e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{className:"text-sm text-gray-600",children:"Majoration urgence"}),e.jsxs("span",{className:"font-bold text-gray-900",children:["+",Number(d.urgent_surcharge||0).toLocaleString("fr-FR")," FCFA"]})]}),e.jsxs("div",{className:"border-t border-gray-200 pt-3 flex justify-between items-center",children:[e.jsx("span",{className:"font-bold text-gray-900",children:"Total  payer"}),e.jsxs("span",{className:"font-black text-xl text-brand-600",children:[Number(d.total_amount||0).toLocaleString("fr-FR")," FCFA"]})]})]})]}):e.jsxs("div",{className:"bg-white rounded-2xl p-5 mb-6 border border-gray-100",children:[e.jsx("h3",{className:"font-bold text-lg text-gray-900 mb-4",children:"Dtails du paiement"}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{className:"text-sm text-gray-600",children:"Montant du devis"}),e.jsxs("span",{className:"font-bold text-gray-900",children:[Number(T||0).toLocaleString("fr-FR")," FCFA"]})]}),e.jsxs("div",{className:"border-t border-gray-200 pt-3 flex justify-between items-center",children:[e.jsx("span",{className:"font-bold text-gray-900",children:"Total  payer"}),e.jsxs("span",{className:"font-black text-xl text-brand-600",children:[Number(T||0).toLocaleString("fr-FR")," FCFA"]})]})]})]}),d&&e.jsxs("div",{className:"bg-gray-50 rounded-2xl p-5 mb-6 border border-gray-200",children:[e.jsxs("h4",{className:"font-bold text-sm text-gray-900 mb-3 flex items-center gap-2",children:[e.jsx(fn,{size:16,className:"text-gray-500"}),"Rpartition des fonds"]}),e.jsxs("div",{className:"space-y-2 text-xs",children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-gray-600",children:"Paiement artisan"}),e.jsxs("span",{className:"font-bold text-gray-900",children:[Number(d.artisan_payout||0).toLocaleString("fr-FR")," FCFA"]})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-gray-600",children:"Commission plateforme (10%)"}),e.jsxs("span",{className:"font-bold text-gray-900",children:[Number(d.commission_amount||0).toLocaleString("fr-FR")," FCFA"]})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-gray-600",children:"TVA (18%)"}),e.jsxs("span",{className:"font-bold text-gray-900",children:[Number(d.tva_amount||0).toLocaleString("fr-FR")," FCFA"]})]})]})]}),e.jsxs("div",{className:"rounded-2xl border border-yellow-200 bg-yellow-50 px-4 py-3 text-xs text-yellow-700 mb-6",children:[e.jsx("p",{className:"font-semibold",children:wl.message}),e.jsx("p",{children:wl.warning})]}),e.jsxs("div",{className:"bg-white rounded-2xl p-6 mb-6 border border-gray-100",children:[e.jsx("h3",{className:"font-bold text-lg text-gray-900 mb-4",children:"Mode de paiement"}),e.jsxs("div",{className:"mb-5 space-y-2",children:[e.jsx("label",{className:"text-xs font-bold uppercase text-gray-500",children:"Montant  scuriser"}),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("input",{type:"number",min:0,value:T,readOnly:!0,className:"flex-1 rounded-2xl border border-gray-200 px-4 py-3 text-lg font-bold text-gray-900 bg-gray-50 cursor-not-allowed"}),e.jsx("span",{className:"text-xs font-black text-gray-500",children:"FCFA"})]}),e.jsx("p",{className:"text-[10px] text-gray-500",children:"Ce montant correspond au devis valid entre le client et l'artisan et ne peut pas tre modifi ici."})]}),e.jsxs("div",{className:"mb-5",children:[e.jsx("p",{className:"text-xs font-bold uppercase text-gray-500 tracking-[0.3em] mb-3",children:"Mthode"}),e.jsx("div",{className:"flex flex-wrap gap-2",children:ta.filter(fe=>fe.logo).map(fe=>e.jsxs("button",{type:"button",onClick:()=>J(fe.id),className:`flex-1 min-w-[120px] rounded-2xl border-2 px-4 py-4 text-center transition ${U===fe.id?"border-brand-500 bg-brand-50 text-brand-700":"border-gray-200 bg-white text-gray-600 hover:border-gray-300"}`,children:[e.jsx("div",{className:"flex items-center justify-center mb-2 h-14 min-h-[56px]",children:fe.logo?e.jsx("img",{src:fe.logo,alt:fe.name,className:"max-h-14 max-w-full object-contain w-auto h-auto",style:{maxHeight:"56px",maxWidth:"100%"},onError:ye=>{const Y=ye.target,$=Y.parentElement;if($){Y.style.display="none";const ce=document.createElement("div");ce.className="text-2xl",ce.textContent=fe.icon,$.appendChild(ce)}}}):e.jsx("div",{className:"text-2xl",children:fe.icon})}),e.jsx("div",{className:"text-xs font-bold uppercase",children:fe.name})]},fe.id))})]}),e.jsxs("div",{className:"mb-5 space-y-2",children:[e.jsx("label",{className:"text-xs font-bold uppercase text-gray-500",children:"Numro du payeur"}),e.jsx("input",{type:"tel",value:F,onChange:fe=>G(fe.target.value),placeholder:"ex: 77xxxxxx",className:"w-full rounded-2xl border border-gray-200 px-4 py-3 text-sm text-gray-700 focus:border-brand-500 focus:outline-none"}),e.jsx("p",{className:"text-[10px] text-gray-400",children:"Optionnel, permet de contextualiser la transaction ct oprateur."})]}),e.jsxs("div",{className:"rounded-2xl border border-gray-100 bg-gray-50 p-4 text-sm space-y-2 mb-5",children:[e.jsxs("div",{className:"flex justify-between text-gray-500",children:[e.jsxs("span",{children:["Frais (",(q==null?void 0:q.fees)??0,"%)"]}),e.jsxs("span",{children:[Math.round(T*(((q==null?void 0:q.fees)??0)/100)).toLocaleString("fr-FR")," FCFA"]})]}),e.jsxs("div",{className:"flex justify-between font-bold text-gray-900",children:[e.jsx("span",{children:"Total"}),e.jsxs("span",{children:[C.toLocaleString("fr-FR")," FCFA"]})]}),e.jsxs("p",{className:"text-[11px] text-gray-400",children:["Mthode slectionne : ",e.jsx("strong",{children:q==null?void 0:q.name})]})]}),R&&e.jsxs("div",{className:`mb-4 flex items-center gap-2 rounded-2xl border px-4 py-3 text-sm ${R.success?"border-green-200 bg-green-50 text-green-800":"border-red-200 bg-red-50 text-red-700"}`,children:[R.success?e.jsx(Qe,{size:20}):e.jsx(zt,{size:20}),e.jsx("span",{children:R.message})]}),ge&&e.jsxs("div",{className:"mb-4 flex items-center gap-2 rounded-2xl border border-red-200 bg-red-50 px-4 py-3 text-sm text-red-700",children:[e.jsx(zt,{size:18}),e.jsx("span",{children:ge})]}),e.jsx("button",{type:"button",onClick:B,disabled:Z||y,className:"w-full rounded-2xl bg-gradient-to-r from-brand-500 to-brand-600 px-4 py-4 text-sm font-bold uppercase tracking-[0.2em] text-white transition disabled:opacity-60 flex items-center justify-center gap-2",children:Z?e.jsxs(e.Fragment,{children:[e.jsx(ma,{className:"h-4 w-4 animate-spin"}),e.jsx("span",{children:"Traitement..."})]}):e.jsx("span",{children:"Simuler le paiement"})})]})]})]})]})}function Sb(){var D,U;const{id:i}=Ya(),u=ht(),f=Nt(),{profile:o}=It(),[x,y]=c.useState(null),[N,h]=c.useState(null),[g,E]=c.useState(null),[d,v]=c.useState(null),[b,w]=c.useState(!0),_=(x==null?void 0:x.client_id)===((D=f.user)==null?void 0:D.id),L=(o==null?void 0:o.role)==="artisan",M=(g==null?void 0:g.artisan_id)===((U=f.user)==null?void 0:U.id);return c.useEffect(()=>{if(!i||!f.user)return;(async()=>{w(!0);try{const{data:F,error:G}=await j.from("projects").select("*").eq("id",i).single();if(G)throw G;y(F);const{data:Z}=await j.from("escrows").select("*").eq("project_id",i).maybeSingle();h(Z||null);const{data:X}=await j.from("quotes").select("*, profiles!quotes_artisan_id_fkey(*)").eq("project_id",i).eq("status","accepted").maybeSingle();X&&(E(X),v(X.profiles))}catch(F){console.error("Error fetching data:",F)}finally{w(!1)}})()},[i,f.user]),b?e.jsx(Yt,{}):x?e.jsxs("div",{className:"min-h-screen bg-gray-50",children:[e.jsxs("header",{className:"sticky top-0 z-20 px-4 py-4 bg-white border-b border-gray-100 flex items-center gap-4",children:[e.jsx(Da,{}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("h1",{className:"font-bold text-gray-900 truncate",children:"Confirmation"}),e.jsx("p",{className:"text-xs text-gray-400 font-mono",children:x.project_number})]})]}),e.jsxs("main",{className:"max-w-lg mx-auto px-4 py-8 pb-32",children:[e.jsxs("div",{className:"text-center mb-8",children:[e.jsx("div",{className:"w-24 h-24 bg-green-500 rounded-full flex items-center justify-center mx-auto mb-6 shadow-lg shadow-green-200",children:e.jsx(Qe,{size:56,className:"text-white"})}),e.jsx("h2",{className:"text-2xl font-black text-gray-900 mb-2",children:_?"Paiement confirm !":"Paiement reu !"}),e.jsx("p",{className:"text-gray-600 max-w-sm mx-auto",children:_?"Votre paiement a t scuris. L'artisan peut maintenant commencer les travaux.":"Le client a effectu le paiement. Vous pouvez maintenant commencer les travaux."})]}),e.jsxs("div",{className:"bg-green-50 border border-green-200 rounded-2xl p-5 mb-6",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-3",children:[e.jsx("div",{className:"w-10 h-10 rounded-xl bg-green-500 flex items-center justify-center",children:e.jsx(Gt,{size:20,className:"text-white"})}),e.jsxs("div",{children:[e.jsx("h3",{className:"font-bold text-green-900 text-sm",children:"Paiement scuris"}),e.jsx("p",{className:"text-xs text-green-700",children:"Les fonds sont protgs sur la plateforme"})]})]}),N&&e.jsxs("div",{className:"flex justify-between items-center pt-3 border-t border-green-200",children:[e.jsx("span",{className:"text-sm text-green-700",children:"Montant total"}),e.jsxs("span",{className:"font-black text-green-900 text-lg",children:[Number(N.total_amount||0).toLocaleString("fr-FR")," FCFA"]})]})]}),e.jsxs("div",{className:"bg-white rounded-2xl p-5 mb-6 border border-gray-100",children:[e.jsx("h3",{className:"font-bold text-gray-900 mb-3",children:x.title}),d&&e.jsxs("div",{className:"flex items-center gap-3 p-3 bg-gray-50 rounded-xl",children:[e.jsx("div",{className:"w-10 h-10 rounded-full bg-gray-200 flex items-center justify-center overflow-hidden flex-shrink-0",children:d.avatar_url?e.jsx("img",{src:d.avatar_url,alt:"",className:"w-full h-full object-cover"}):e.jsx(ot,{size:18,className:"text-gray-400"})}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("p",{className:"font-bold text-sm text-gray-900",children:d.full_name||"Artisan"}),e.jsx("p",{className:"text-xs text-gray-500",children:_?"Artisan assign":"Votre profil"})]})]})]}),e.jsxs("div",{className:"bg-brand-50 border border-brand-200 rounded-2xl p-5 mb-6",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-3",children:[e.jsx(St,{size:18,className:"text-brand-600"}),e.jsx("h4",{className:"font-bold text-brand-900 text-sm",children:"Prochaine tape"})]}),e.jsx("p",{className:"text-sm text-brand-800",children:_?"Suivez l'avancement des travaux et confirmez leur fin une fois satisfait.":"Ralisez les travaux conformment au devis et demandez la clture une fois termin."})]}),e.jsxs("div",{className:"space-y-3",children:[_&&e.jsxs("button",{onClick:()=>u(`/projects/${i}/work`),className:"w-full flex items-center justify-center gap-3 px-6 py-4 bg-brand-500 text-white rounded-2xl font-bold hover:bg-brand-600 transition-colors shadow-lg shadow-brand-200",children:[e.jsx(ns,{size:20}),"Suivre les travaux",e.jsx(vl,{size:18})]}),L&&M&&e.jsxs("button",{onClick:()=>u(`/projects/${i}/work`),className:"w-full flex items-center justify-center gap-3 px-6 py-4 bg-green-500 text-white rounded-2xl font-bold hover:bg-green-600 transition-colors shadow-lg shadow-green-200",children:[e.jsx(ns,{size:20}),"Commencer les travaux",e.jsx(vl,{size:18})]}),e.jsx("button",{onClick:()=>u(`/projects/${i}`),className:"w-full px-6 py-3 bg-gray-100 text-gray-700 rounded-xl font-bold hover:bg-gray-200 transition-colors",children:"Voir les dtails du projet"})]})]})]}):e.jsx("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center p-6",children:e.jsxs("div",{className:"text-center",children:[e.jsx(zt,{size:48,className:"text-amber-500 mx-auto mb-4"}),e.jsx("h2",{className:"text-xl font-bold text-gray-900 mb-2",children:"Projet non trouv"}),e.jsx("button",{onClick:()=>u("/dashboard"),className:"px-6 py-3 bg-brand-500 text-white rounded-xl font-bold mt-4",children:"Retour au tableau de bord"})]})})}function zb(){const{id:i}=Ya(),u=ht();return c.useEffect(()=>{i?u(`/projects/${i}`,{replace:!0}):u("/dashboard",{replace:!0})},[i,u]),e.jsx("div",{className:"min-h-screen flex items-center justify-center bg-gray-50",children:e.jsxs("div",{className:"flex flex-col items-center gap-4",children:[e.jsx("div",{className:"w-10 h-10 border-2 border-brand-500 border-t-transparent rounded-full animate-spin"}),e.jsx("p",{className:"text-sm text-gray-500",children:"Chargement du projet..."})]})})}function Cd({type:i="card",className:u=""}){return i==="card"?e.jsxs("div",{className:`bg-white rounded-2xl border border-gray-100 p-5 animate-pulse ${u}`,children:[e.jsxs("div",{className:"flex items-start gap-4 mb-4",children:[e.jsx("div",{className:"w-12 h-12 bg-gray-200 rounded-xl"}),e.jsxs("div",{className:"flex-1 space-y-2",children:[e.jsx("div",{className:"h-4 bg-gray-200 rounded w-3/4"}),e.jsx("div",{className:"h-3 bg-gray-200 rounded w-1/2"})]})]}),e.jsx("div",{className:"h-20 bg-gray-100 rounded-xl mb-3"}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("div",{className:"h-6 bg-gray-200 rounded-full w-20"}),e.jsx("div",{className:"h-6 bg-gray-200 rounded-full w-16"})]})]}):i==="list"?e.jsx("div",{className:`space-y-3 ${u}`,children:[1,2,3].map(f=>e.jsx("div",{className:"bg-white rounded-xl border border-gray-100 p-4 animate-pulse",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-10 h-10 bg-gray-200 rounded-full"}),e.jsxs("div",{className:"flex-1 space-y-2",children:[e.jsx("div",{className:"h-4 bg-gray-200 rounded w-2/3"}),e.jsx("div",{className:"h-3 bg-gray-200 rounded w-1/2"})]}),e.jsx("div",{className:"h-6 bg-gray-200 rounded-full w-16"})]})},f))}):i==="header"?e.jsxs("div",{className:`bg-white border-b border-gray-100 px-4 py-4 flex items-center gap-4 animate-pulse ${u}`,children:[e.jsx("div",{className:"w-10 h-10 bg-gray-200 rounded-full"}),e.jsxs("div",{className:"flex-1 space-y-2",children:[e.jsx("div",{className:"h-5 bg-gray-200 rounded w-1/3"}),e.jsx("div",{className:"h-3 bg-gray-200 rounded w-1/4"})]}),e.jsx("div",{className:"h-6 bg-gray-200 rounded-full w-20"})]}):i==="quote"?e.jsxs("div",{className:`bg-white rounded-2xl border border-gray-100 p-5 animate-pulse ${u}`,children:[e.jsxs("div",{className:"flex items-start justify-between mb-4",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-10 h-10 bg-gray-200 rounded-full"}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("div",{className:"h-4 bg-gray-200 rounded w-32"}),e.jsx("div",{className:"h-3 bg-gray-200 rounded w-24"})]})]}),e.jsxs("div",{className:"space-y-2 text-right",children:[e.jsx("div",{className:"h-5 bg-gray-200 rounded w-24 ml-auto"}),e.jsx("div",{className:"h-3 bg-gray-200 rounded w-16 ml-auto"})]})]}),e.jsx("div",{className:"h-4 bg-gray-200 rounded-full w-20 mb-4"}),e.jsxs("div",{className:"space-y-2 mb-4",children:[e.jsx("div",{className:"h-3 bg-gray-100 rounded w-full"}),e.jsx("div",{className:"h-3 bg-gray-100 rounded w-5/6"})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("div",{className:"h-10 bg-gray-200 rounded-xl flex-1"}),e.jsx("div",{className:"h-10 bg-gray-200 rounded-xl w-24"})]})]}):e.jsxs("div",{className:`animate-pulse space-y-6 ${u}`,children:[e.jsxs("div",{className:"bg-white border-b border-gray-100 px-4 py-4 flex items-center gap-4",children:[e.jsx("div",{className:"w-10 h-10 bg-gray-200 rounded-full"}),e.jsxs("div",{className:"flex-1 space-y-2",children:[e.jsx("div",{className:"h-5 bg-gray-200 rounded w-1/3"}),e.jsx("div",{className:"h-3 bg-gray-200 rounded w-1/4"})]}),e.jsx("div",{className:"h-6 bg-gray-200 rounded-full w-20"})]}),e.jsxs("div",{className:"max-w-lg mx-auto px-4 space-y-4",children:[e.jsxs("div",{className:"bg-white rounded-2xl border border-gray-100 p-5",children:[e.jsx("div",{className:"h-6 bg-gray-200 rounded w-2/3 mb-4"}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("div",{className:"h-4 bg-gray-100 rounded w-full"}),e.jsx("div",{className:"h-4 bg-gray-100 rounded w-5/6"}),e.jsx("div",{className:"h-4 bg-gray-100 rounded w-4/6"})]})]}),e.jsxs("div",{className:"bg-white rounded-2xl border border-gray-100 p-5",children:[e.jsx("div",{className:"h-5 bg-gray-200 rounded w-1/2 mb-3"}),e.jsxs("div",{className:"space-y-3",children:[e.jsx("div",{className:"h-20 bg-gray-100 rounded-xl"}),e.jsx("div",{className:"h-20 bg-gray-100 rounded-xl"})]})]})]})]})}const F0=[{id:"quote",label:"Devis accept",icon:et},{id:"payment",label:"Paiement",icon:Na},{id:"work",label:"Travaux",icon:ns},{id:"completed",label:"Termin",icon:Sl}];function kb(){var C,B;const{id:i}=Ya(),u=ht(),f=Nt(),{profile:o}=It(),{success:x,error:y}=sa(),[N,h]=c.useState(null),[g,E]=c.useState(null),[d,v]=c.useState(null),[b,w]=c.useState(null),[_,L]=c.useState(null),[M,D]=c.useState(!0),[U,J]=c.useState(!1),[F,G]=c.useState(!1);c.useEffect(()=>{if(!i||!f.user)return;(async()=>{D(!0);try{const{data:S,error:V}=await j.from("projects").select("*, profiles!projects_client_id_fkey(*)").eq("id",i).single();if(V)throw V;h(S),L(S.profiles);const{data:le}=await j.from("escrows").select("*").eq("project_id",i).maybeSingle();E(le||null);const{data:he,error:Ne}=await j.from("quotes").select("*").eq("project_id",i).eq("status","accepted").maybeSingle();if(!Ne&&he&&(v(he),he.artisan_id)){const{data:fe}=await j.from("profiles").select("id, full_name, avatar_url").eq("id",he.artisan_id).maybeSingle();w(fe||null)}}catch(S){console.error("Error fetching work data:",S),y(`Erreur: ${S.message||"Erreur inconnue"}`)}finally{D(!1)}})()},[i,f.user,y]);const Z=(N==null?void 0:N.client_id)===((C=f.user)==null?void 0:C.id),X=(o==null?void 0:o.role)==="artisan",R=(d==null?void 0:d.artisan_id)===((B=f.user)==null?void 0:B.id),ae=()=>{switch(N==null?void 0:N.status){case"completed":return 3;case"completion_requested":return 2;case"in_progress":return 2;default:return 1}},ge=async()=>{if(!(!i||!N))try{J(!0);const{error:z}=await j.from("projects").update({status:"completion_requested"}).eq("id",i);if(z)throw z;X&&N.client_id?(await Yi(i,N.client_id,N.title),x("Demande de clture envoye au client !")):Z&&(d!=null&&d.artisan_id)&&(await Yi(i,d.artisan_id,N.title),x("Demande de clture envoye  l'artisan !"));const{data:S}=await j.from("projects").select("*, profiles!projects_client_id_fkey(*)").eq("id",i).single();S&&(h(S),L(S.profiles))}catch(z){console.error("Error requesting completion:",z),y(`Erreur: ${z.message||"Erreur inconnue"}`)}finally{J(!1),G(!1)}};if(M)return e.jsx(Cd,{});if(!N)return e.jsx("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center p-6",children:e.jsxs("div",{className:"text-center",children:[e.jsx(zt,{size:48,className:"text-red-500 mx-auto mb-4"}),e.jsx("h2",{className:"text-xl font-bold text-gray-900 mb-2",children:"Projet non trouv"}),e.jsx("button",{onClick:()=>u("/dashboard"),className:"px-6 py-3 bg-brand-500 text-white rounded-xl font-bold mt-4",children:"Retour au tableau de bord"})]})});const k=ae(),q=N.status==="completion_requested",T=N.status==="completed";return e.jsxs("div",{className:"min-h-screen bg-gray-50",children:[e.jsxs("header",{className:"sticky top-0 z-20 px-4 py-4 bg-white border-b border-gray-100 flex items-center gap-4",children:[e.jsx(Da,{}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("h1",{className:"font-bold text-gray-900 truncate",children:T?"Projet termin":"Travaux en cours"}),e.jsx("p",{className:"text-xs text-gray-400 font-mono",children:N.project_number})]}),e.jsx("span",{className:`px-3 py-1 rounded-full text-[10px] font-bold ${T?"bg-green-100 text-green-700":q?"bg-orange-100 text-orange-700":"bg-brand-100 text-brand-700"}`,children:T?"Termin":q?"Clture demande":"En cours"})]}),e.jsxs("main",{className:"max-w-lg mx-auto px-4 py-6 pb-40",children:[e.jsxs("section",{className:"bg-white rounded-2xl border border-gray-100 p-5 mb-6",children:[e.jsx("h3",{className:"font-bold text-gray-900 text-sm mb-4",children:"Avancement du projet"}),e.jsxs("div",{className:"relative",children:[e.jsx("div",{className:"absolute left-5 top-0 bottom-0 w-0.5 bg-gray-200"}),e.jsx("div",{className:"absolute left-5 top-0 w-0.5 bg-brand-500 transition-all duration-500",style:{height:`${k/(F0.length-1)*100}%`}}),e.jsx("div",{className:"space-y-6",children:F0.map((z,S)=>{const V=S<=k,le=S===k,he=z.icon;return e.jsxs("div",{className:"flex items-center gap-4 relative",children:[e.jsx("div",{className:`relative z-10 w-10 h-10 rounded-full flex items-center justify-center transition-all ${V?"bg-brand-500 text-white shadow-lg shadow-brand-200":"bg-gray-100 text-gray-400"} ${le?"ring-4 ring-brand-100 scale-110":""}`,children:V&&S<k?e.jsx(Qe,{size:20}):e.jsx(he,{size:18})}),e.jsxs("div",{className:"flex-1",children:[e.jsx("p",{className:`font-bold text-sm ${V?"text-gray-900":"text-gray-400"}`,children:z.label}),le&&!T&&e.jsx("p",{className:"text-xs text-brand-600 animate-pulse",children:"tape actuelle"}),V&&S<k&&e.jsx("p",{className:"text-xs text-green-600",children:"Termin "})]})]},z.id)})})]})]}),e.jsxs("section",{className:"bg-white rounded-2xl p-5 mb-6 border border-gray-100",children:[e.jsx("h2",{className:"font-bold text-lg text-gray-900 mb-4",children:N.title}),Z&&b&&e.jsxs("div",{className:"flex items-center gap-3 p-3 bg-gray-50 rounded-xl mb-4",children:[e.jsx("div",{className:"w-12 h-12 rounded-full bg-gray-200 flex items-center justify-center overflow-hidden flex-shrink-0",children:b.avatar_url?e.jsx("img",{src:b.avatar_url,alt:"",className:"w-full h-full object-cover"}):e.jsx(ot,{size:20,className:"text-gray-400"})}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("p",{className:"font-bold text-sm text-gray-900",children:b.full_name||"Artisan"}),e.jsx("p",{className:"text-xs text-gray-500",children:"Artisan en charge des travaux"})]})]}),X&&_&&e.jsxs("div",{className:"flex items-center gap-3 p-3 bg-gray-50 rounded-xl mb-4",children:[e.jsx("div",{className:"w-12 h-12 rounded-full bg-gray-200 flex items-center justify-center overflow-hidden flex-shrink-0",children:_.avatar_url?e.jsx("img",{src:_.avatar_url,alt:"",className:"w-full h-full object-cover"}):e.jsx(ot,{size:20,className:"text-gray-400"})}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("p",{className:"font-bold text-sm text-gray-900",children:_.full_name||"Client"}),e.jsx("p",{className:"text-xs text-gray-500",children:"Client du projet"})]})]}),g&&e.jsxs("div",{className:"bg-green-50 border border-green-200 rounded-xl p-4",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[e.jsx(Gt,{size:16,className:"text-green-600"}),e.jsx("span",{className:"text-xs font-bold text-green-800",children:"Paiement scuris"})]}),e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{className:"text-sm text-green-700",children:"Montant"}),e.jsxs("span",{className:"font-black text-green-900",children:[Number(g.total_amount||0).toLocaleString("fr-FR")," FCFA"]})]})]})]}),q&&e.jsx("section",{className:"bg-yellow-50 border border-yellow-200 rounded-2xl p-5 mb-6",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(St,{size:24,className:"text-yellow-600 flex-shrink-0"}),e.jsxs("div",{children:[e.jsx("h4",{className:"font-bold text-yellow-900 text-sm",children:"Clture demande"}),e.jsx("p",{className:"text-xs text-yellow-700 mt-1",children:Z?"Vous pouvez maintenant confirmer la fin des travaux et noter l'artisan.":"En attente de la confirmation du client pour librer le paiement."})]})]})}),T&&e.jsx("section",{className:"bg-green-50 border border-green-200 rounded-2xl p-5 mb-6",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(Qe,{size:24,className:"text-green-600 flex-shrink-0"}),e.jsxs("div",{children:[e.jsx("h4",{className:"font-bold text-green-900 text-sm",children:"Projet termin"}),e.jsx("p",{className:"text-xs text-green-700 mt-1",children:"Le projet a t cltur avec succs. Le paiement a t vers  l'artisan."})]})]})})]}),!T&&e.jsxs("div",{className:"fixed bottom-0 left-0 right-0 p-4 bg-white border-t border-gray-100 z-20 space-y-3",children:[Z&&e.jsx(e.Fragment,{children:q?e.jsxs("button",{onClick:()=>u(`/projects/${i}/completion`),className:"w-full bg-green-500 text-white font-bold py-4 rounded-2xl flex items-center justify-center gap-3 hover:bg-green-600 transition-colors shadow-lg shadow-green-200",children:[e.jsx(Qe,{size:20}),"Confirmer et noter l'artisan"]}):e.jsxs("button",{onClick:()=>G(!0),disabled:U,className:"w-full bg-green-500 text-white font-bold py-4 rounded-2xl flex items-center justify-center gap-3 hover:bg-green-600 transition-colors disabled:opacity-50",children:[e.jsx(Qe,{size:20}),U?"Traitement...":"Travaux termins"]})}),X&&R&&e.jsx(e.Fragment,{children:q?e.jsxs("div",{className:"bg-yellow-50 border border-yellow-200 rounded-xl p-4 text-center",children:[e.jsx(St,{size:20,className:"text-yellow-600 mx-auto mb-2"}),e.jsx("p",{className:"text-sm font-bold text-yellow-800",children:"En attente du client"}),e.jsx("p",{className:"text-xs text-yellow-700",children:"Le client doit confirmer la fin des travaux."})]}):e.jsxs("button",{onClick:()=>G(!0),disabled:U,className:"w-full bg-green-500 text-white font-bold py-4 rounded-2xl flex items-center justify-center gap-3 hover:bg-green-600 transition-colors disabled:opacity-50",children:[e.jsx(Qe,{size:20}),U?"Traitement...":"J'ai termin les travaux"]})}),e.jsxs("button",{type:"button",onClick:()=>u(`/projects/${i}#devis`),className:"w-full bg-gray-100 text-gray-700 font-bold py-3 rounded-xl flex items-center justify-center gap-2 hover:bg-gray-200 transition-colors",children:[e.jsx(et,{size:18}),"Voir le projet et les devis"]}),e.jsxs("button",{type:"button",onClick:()=>u(`/chat/${i}`),className:"w-full bg-gray-100 text-gray-700 font-bold py-3 rounded-xl flex items-center justify-center gap-2 hover:bg-gray-200 transition-colors",children:[e.jsx(es,{size:18}),Z?"Contacter l'artisan":"Contacter le client"]})]}),T&&Z&&e.jsxs("div",{className:"fixed bottom-0 left-0 right-0 p-4 bg-white border-t border-gray-100 z-20 space-y-2",children:[e.jsxs("button",{type:"button",onClick:()=>u(`/projects/${i}#devis`),className:"w-full bg-brand-500 text-white font-bold py-4 rounded-2xl flex items-center justify-center gap-3 hover:bg-brand-600 transition-colors",children:[e.jsx(et,{size:20}),"Voir le projet et les devis"]}),e.jsx("button",{type:"button",onClick:()=>u(`/projects/${i}`),className:"w-full bg-gray-100 text-gray-700 font-bold py-3 rounded-xl flex items-center justify-center gap-2 hover:bg-gray-200 transition-colors",children:"Voir le projet"})]}),e.jsx(pd,{open:F,onCancel:()=>G(!1),onConfirm:ge,title:"Confirmer la fin des travaux",message:Z?"Confirmez-vous que les travaux sont termins ? Vous pourrez ensuite noter l'artisan et librer le paiement.":"Confirmez-vous que les travaux sont termins ? Une notification sera envoye au client.",confirmText:"Oui, travaux termins",cancelText:"Annuler"})]})}function Cb(){var D;const{id:i}=Ya(),u=ht(),f=Nt(),{profile:o}=It(),[x,y]=c.useState(null),[N,h]=c.useState(null),[g,E]=c.useState(null),[d,v]=c.useState(!0),[b,w]=c.useState(null);c.useEffect(()=>{if(!i||!f.user)return;(async()=>{v(!0),w(null);try{const{data:J,error:F}=await j.from("projects").select("*, profiles!projects_client_id_fkey(id, full_name)").eq("id",i).single();if(F||!J){w("Projet introuvable"),v(!1);return}y(J);const{data:G}=await j.from("escrows").select("*").eq("project_id",i).maybeSingle();h(G||null);const{data:Z}=await j.from("quotes").select("*").eq("project_id",i).eq("status","accepted").maybeSingle();E(Z||null)}catch(J){w(J.message||"Erreur")}finally{v(!1)}})()},[i,f.user]);const _=(o==null?void 0:o.role)==="artisan",L=(g==null?void 0:g.artisan_id)===((D=f.user)==null?void 0:D.id),M=_&&L&&(N==null?void 0:N.status)==="pending"&&((x==null?void 0:x.status)==="quote_accepted"||(x==null?void 0:x.status)==="payment_pending");return c.useEffect(()=>{if(!(d||!x)){if(!_||!L){w("Accs rserv  l'artisan dont le devis a t accept.");return}if(M){w(null);return}w("Cette page est affiche uniquement en attente du paiement du client.")}},[d,x,_,L,M]),d?e.jsx(Cd,{}):b&&!M?e.jsxs("div",{className:"min-h-screen bg-gray-50 flex flex-col items-center justify-center px-4",children:[e.jsx("p",{className:"text-gray-600 text-center mb-4",children:b}),e.jsxs("div",{className:"flex flex-col gap-2 w-full max-w-xs",children:[e.jsxs("button",{onClick:()=>u(`/projects/${i}`),className:"w-full py-3 rounded-xl bg-brand-500 text-white font-semibold flex items-center justify-center gap-2",children:[e.jsx(Wt,{size:18}),"Voir le projet"]}),e.jsxs("button",{onClick:()=>u("/dashboard"),className:"w-full py-3 rounded-xl border border-gray-200 bg-white text-gray-700 font-medium flex items-center justify-center gap-2",children:[e.jsx(xr,{size:18}),"Tableau de bord"]})]}),e.jsx(Da,{})]}):e.jsxs("div",{className:"min-h-screen bg-gray-50",children:[e.jsxs("header",{className:"sticky top-0 z-20 px-4 py-4 bg-white border-b border-gray-100 flex items-center gap-4",children:[e.jsx("button",{onClick:()=>u(`/projects/${i}`),className:"w-10 h-10 rounded-full bg-gray-100 flex items-center justify-center",children:e.jsx(Wt,{size:20,className:"text-gray-600"})}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("h1",{className:"font-bold text-gray-900 truncate",children:(x==null?void 0:x.title)||"Projet"}),e.jsx("p",{className:"text-xs text-gray-400 font-mono",children:x==null?void 0:x.project_number})]})]}),e.jsxs("main",{className:"max-w-lg mx-auto px-4 py-8",children:[e.jsxs("div",{className:"bg-blue-50 border-2 border-blue-200 rounded-2xl p-6 mb-6",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-4",children:[e.jsx("div",{className:"w-14 h-14 rounded-xl bg-blue-500 flex items-center justify-center text-white flex-shrink-0",children:e.jsx(St,{size:28})}),e.jsxs("div",{children:[e.jsx("h2",{className:"font-bold text-blue-900 text-lg",children:"En attente du paiement du client"}),e.jsx("p",{className:"text-sm text-blue-700 mt-0.5",children:"Votre devis a t accept"})]})]}),e.jsx("p",{className:"text-sm text-blue-800 mb-4",children:"Le client va procder au paiement pour scuriser les fonds dans l'escrow Mbourake."}),e.jsx("p",{className:"text-xs text-blue-600",children:'Vous serez notifi ds que le paiement sera reu. Vous pourrez alors commencer les travaux et accder  la page "Travaux".'})]}),(g==null?void 0:g.amount)!=null&&e.jsxs("div",{className:"bg-white rounded-2xl border border-gray-100 p-4 mb-6",children:[e.jsxs("div",{className:"flex items-center gap-2 text-gray-500 text-xs font-bold uppercase mb-1",children:[e.jsx(et,{size:14}),"Montant du projet"]}),e.jsxs("p",{className:"text-2xl font-black text-gray-900",children:[Number(g.amount).toLocaleString("fr-FR")," FCFA"]})]}),e.jsxs("div",{className:"flex flex-col gap-3",children:[e.jsxs("button",{onClick:()=>u(`/projects/${i}`),className:"w-full py-3.5 rounded-xl bg-brand-500 text-white font-semibold flex items-center justify-center gap-2",children:[e.jsx(Wt,{size:18}),"Voir le projet"]}),e.jsxs("button",{onClick:()=>u("/dashboard"),className:"w-full py-3 rounded-xl border border-gray-200 bg-white text-gray-700 font-medium flex items-center justify-center gap-2",children:[e.jsx(xr,{size:18}),"Tableau de bord"]})]})]}),e.jsx(Da,{})]})}function Eb(){const{id:i}=Ya(),u=ht(),f=Nt(),{releaseFullPayment:o}=bn(),{success:x,error:y}=sa(),[N,h]=c.useState(null),[g,E]=c.useState(null),[d,v]=c.useState(null),[b,w]=c.useState(null),[_,L]=c.useState(!0),[M,D]=c.useState(!1),[U,J]=c.useState(!1),[F,G]=c.useState(!1),[Z,X]=c.useState(!1),[R,ae]=c.useState(0),[ge,k]=c.useState("");c.useEffect(()=>{if(!i||!f.user)return;(async()=>{L(!0);try{const{data:C,error:B}=await j.from("projects").select("*").eq("id",i).single();if(B)throw B;h(C);const{data:z}=await j.from("escrows").select("*").eq("project_id",i).maybeSingle();E(z||null);let S=null;const{data:V,error:le}=await j.from("quotes").select("id, artisan_id, amount, status, created_at").eq("project_id",i).eq("status","accepted").maybeSingle();if(!le&&V&&(S=V,v(V),V.artisan_id)){const{data:fe}=await j.from("profiles").select("id, full_name, avatar_url").eq("id",V.artisan_id).maybeSingle();w(fe||null)}if(!S){const{data:fe}=await j.from("quote_revisions").select("quote_id").eq("project_id",i).eq("status","accepted").order("responded_at",{ascending:!1}).limit(1).maybeSingle();if(fe!=null&&fe.quote_id){const{data:ye}=await j.from("quotes").select("id, artisan_id, amount, status, created_at").eq("id",fe.quote_id).maybeSingle();if(ye&&(S=ye,v(ye),ye.artisan_id)){const{data:Y}=await j.from("profiles").select("id, full_name, avatar_url").eq("id",ye.artisan_id).maybeSingle();w(Y||null)}}}const he=C.client_id===f.user.id,Ne=(S==null?void 0:S.artisan_id)===f.user.id;if(G(he),X(Ne),!he&&!Ne){y("Vous n'tes pas autoris  accder  cette page."),u(`/projects/${i}`);return}C.status==="completed"&&J(!0)}catch(C){console.error("Error fetching completion data:",C),y(`Erreur: ${C.message||"Erreur inconnue"}`)}finally{L(!1)}})()},[i,f.user,u,y]);const q=async()=>{var T;if(!i||!((T=f.user)!=null&&T.id)){y("Session invalide. Rechargez la page.");return}if(!(d!=null&&d.artisan_id)){y("Devis accept introuvable. Rechargez la page ou contactez le support.");return}if(R<1||R>5){y("Veuillez slectionner une note entre 1 et 5 toiles");return}try{D(!0);const{error:C}=await j.from("reviews").insert({project_id:i,artisan_id:d.artisan_id,client_id:f.user.id,rating:R,comment:ge.trim()||null});if(C&&console.error("Review error:",C),g!=null&&g.id)try{await o(g.id)}catch(z){console.error("Payment release error:",z)}const{error:B}=await j.from("projects").update({status:"completed"}).eq("id",i);if(B)throw B;if(d!=null&&d.artisan_id&&(N!=null&&N.title))try{await Ki(i,d.artisan_id,Number((g==null?void 0:g.artisan_payout)||0)),await j.from("notifications").insert({user_id:d.artisan_id,type:"system",title:"Nouvelle note reue",message:`Vous avez reu une note de ${R}/5 pour le projet "${N.title}".`,data:{project_id:i,rating:R}})}catch(z){console.error("Notification error:",z)}J(!0),x("Projet termin avec succs ! Merci pour votre avis.")}catch(C){console.error("Error completing project:",C),y(`Erreur: ${C.message||"Erreur inconnue"}`)}finally{D(!1)}};if(_)return e.jsx(Cd,{});if(!N)return e.jsx("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center p-6",children:e.jsxs("div",{className:"text-center",children:[e.jsx(zt,{size:48,className:"text-red-500 mx-auto mb-4"}),e.jsx("h2",{className:"text-xl font-bold text-gray-900 mb-2",children:"Projet non trouv"}),e.jsx("button",{onClick:()=>u("/dashboard"),className:"px-6 py-3 bg-brand-500 text-white rounded-xl font-bold mt-4",children:"Retour au tableau de bord"})]})});if(U)return e.jsxs("div",{className:"min-h-screen bg-gray-50",children:[e.jsxs("header",{className:"sticky top-0 z-20 px-4 py-4 bg-white border-b border-gray-100 flex items-center gap-4",children:[e.jsx(Da,{}),e.jsx("div",{className:"flex-1 min-w-0",children:e.jsx("h1",{className:"font-bold text-gray-900 truncate",children:"Projet termin"})})]}),e.jsxs("main",{className:"max-w-lg mx-auto px-4 py-12 text-center",children:[e.jsx("div",{className:"w-24 h-24 bg-green-500 rounded-full flex items-center justify-center mx-auto mb-6 shadow-lg shadow-green-200",children:e.jsx(Sl,{size:48,className:"text-white"})}),e.jsx("h2",{className:"text-2xl font-black text-gray-900 mb-3",children:"Flicitations !"}),e.jsx("p",{className:"text-gray-600 mb-8 max-w-sm mx-auto",children:"Le projet a t cltur avec succs. Le paiement a t vers  l'artisan. Merci pour votre confiance !"}),e.jsxs("div",{className:"space-y-3",children:[e.jsx("button",{onClick:()=>u("/dashboard"),className:"w-full bg-brand-500 text-white font-bold py-4 rounded-2xl hover:bg-brand-600 transition-colors",children:"Retour au tableau de bord"}),e.jsx("button",{onClick:()=>u(`/projects/${i}`),className:"w-full bg-gray-100 text-gray-700 font-bold py-3 rounded-xl hover:bg-gray-200 transition-colors",children:"Voir le projet"})]})]})]});if(Z&&!F){const T=N.status==="completed";return e.jsxs("div",{className:"min-h-screen bg-gray-50",children:[e.jsxs("header",{className:"sticky top-0 z-20 px-4 py-4 bg-white border-b border-gray-100 flex items-center gap-4",children:[e.jsx(Da,{}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("h1",{className:"font-bold text-gray-900 truncate",children:T?"Projet termin":"Clture demande"}),e.jsx("p",{className:"text-xs text-gray-400 font-mono",children:N.project_number})]})]}),e.jsxs("main",{className:"max-w-lg mx-auto px-4 py-8",children:[e.jsxs("section",{className:"bg-white rounded-2xl p-5 mb-6 border border-gray-100",children:[e.jsx("h2",{className:"font-bold text-lg text-gray-900 mb-4",children:N.title}),e.jsx("div",{className:"bg-gray-50 border border-gray-200 rounded-xl p-4 mb-4",children:e.jsx("p",{className:"text-sm text-gray-700",children:T?"Le client a cltur le projet. Le paiement vous a t vers.":"En attente de la confirmation du client pour clturer le projet."})})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("button",{onClick:()=>u(`/projects/${i}/work`),className:"w-full bg-brand-500 text-white font-bold py-3.5 rounded-xl flex items-center justify-center gap-2 hover:bg-brand-600 transition-colors",children:[e.jsx(ns,{size:18}),"Voir les travaux"]}),e.jsx("button",{onClick:()=>u("/dashboard"),className:"w-full bg-gray-100 text-gray-700 font-bold py-3 rounded-xl hover:bg-gray-200 transition-colors",children:"Retour au tableau de bord"})]})]})]})}return e.jsxs("div",{className:"min-h-screen bg-gray-50",children:[e.jsxs("header",{className:"sticky top-0 z-20 px-4 py-4 bg-white border-b border-gray-100 flex items-center gap-4",children:[e.jsx(Da,{}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("h1",{className:"font-bold text-gray-900 truncate",children:"Clturer le projet"}),e.jsx("p",{className:"text-xs text-gray-400 font-mono",children:N.project_number})]})]}),e.jsxs("main",{className:"max-w-lg mx-auto px-4 py-6 pb-40",children:[e.jsxs("section",{className:"bg-white rounded-2xl p-5 mb-6 border border-gray-100",children:[e.jsx("h2",{className:"font-bold text-lg text-gray-900 mb-4",children:N.title}),b&&e.jsxs("div",{className:"flex items-center gap-3 p-3 bg-gray-50 rounded-xl mb-4",children:[e.jsx("div",{className:"w-12 h-12 rounded-full bg-gray-200 flex items-center justify-center overflow-hidden flex-shrink-0",children:b.avatar_url?e.jsx("img",{src:b.avatar_url,alt:"",className:"w-full h-full object-cover"}):e.jsx(ot,{size:20,className:"text-gray-400"})}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("p",{className:"font-bold text-sm text-gray-900",children:b.full_name||"Artisan"}),e.jsx("p",{className:"text-xs text-gray-500",children:"Artisan"})]})]}),g&&e.jsxs("div",{className:"bg-green-50 border border-green-200 rounded-xl p-4",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[e.jsx(Gt,{size:16,className:"text-green-600"}),e.jsx("span",{className:"text-xs font-bold text-green-800",children:"Paiement  librer"})]}),e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{className:"text-sm text-green-700",children:"Montant total"}),e.jsxs("span",{className:"font-black text-green-900 text-lg",children:[Number(g.total_amount||0).toLocaleString("fr-FR")," FCFA"]})]})]})]}),e.jsxs("section",{className:"bg-white rounded-2xl p-5 mb-6 border border-gray-100",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-4",children:[e.jsx(Ma,{size:20,className:"text-yellow-500"}),e.jsx("h3",{className:"font-bold text-gray-900",children:"Noter l'artisan"})]}),e.jsx("p",{className:"text-sm text-gray-600 mb-4",children:"Votre avis aide les autres clients  choisir le bon artisan."}),e.jsx("div",{className:"flex justify-center gap-3 mb-6",children:[1,2,3,4,5].map(T=>e.jsx("button",{type:"button",onClick:()=>ae(T),className:"focus:outline-none transform transition-all hover:scale-110 active:scale-95",children:e.jsx(Ma,{size:40,className:T<=R?"text-yellow-400 fill-yellow-400":"text-gray-300"})},T))}),e.jsx("p",{className:"text-center text-sm text-gray-500 mb-4",children:R===0?"Slectionnez une note entre 1 et 5 toiles":R===5?"Excellent !":R===4?"Trs bien":R===3?"Bien":R===2?"Moyen":" amliorer"}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-bold text-gray-700 mb-2",children:["Votre commentaire ",e.jsx("span",{className:"text-gray-400 font-normal text-xs ml-1",children:"(optionnel)"})]}),e.jsx("textarea",{value:ge,onChange:T=>k(T.target.value),placeholder:"Dcrivez votre exprience avec cet artisan...",rows:4,maxLength:500,className:"w-full px-4 py-3 border border-gray-200 rounded-xl focus:ring-2 focus:ring-brand-500 focus:border-transparent resize-none text-sm"}),e.jsxs("p",{className:"text-xs text-gray-500 mt-1 text-right",children:[ge.length," / 500 caractres"]})]})]}),e.jsx("section",{className:"bg-blue-50 border border-blue-200 rounded-2xl p-4 mb-6",children:e.jsxs("p",{className:"text-xs text-blue-800 leading-relaxed",children:[e.jsx("strong",{children:"En clturant ce projet :"}),e.jsx("br",{})," Le paiement sera immdiatement vers  l'artisan",e.jsx("br",{})," Votre avis sera visible sur son profil",e.jsx("br",{})," Cette action est dfinitive"]})})]}),e.jsxs("div",{className:"fixed bottom-0 left-0 right-0 p-4 bg-white border-t border-gray-100 z-20 space-y-3",children:[e.jsx("div",{className:"min-h-0 shrink-0",children:d!=null&&d.artisan_id?null:e.jsx("p",{className:"text-center text-sm text-amber-700 bg-amber-50 border border-amber-200 rounded-xl py-2 px-3",children:"Devis accept introuvable. Rechargez la page ou retournez au projet."})},"quote-warning"),e.jsx("button",{type:"button",onClick:T=>{T.preventDefault(),q().catch(C=>{console.error("Clture / notation:",C),y((C==null?void 0:C.message)??"Une erreur est survenue. Ressayez.")})},disabled:M||R<1,className:"w-full bg-green-500 text-white font-semibold py-3.5 rounded-xl flex items-center justify-center gap-2.5 hover:bg-green-600 active:scale-[0.99] transition-all duration-200 disabled:opacity-50 disabled:cursor-not-allowed disabled:active:scale-100",children:M?e.jsx("div",{className:"w-5 h-5 border-2 border-white border-t-transparent rounded-full animate-spin"}):e.jsxs(e.Fragment,{children:[e.jsx(Qe,{size:18,strokeWidth:2}),"Clturer et envoyer mon avis"]})}),e.jsxs("button",{type:"button",onClick:()=>u(`/projects/${i}#devis`),className:"w-full py-2.5 rounded-xl text-gray-600 font-medium text-sm flex items-center justify-center gap-2 hover:bg-gray-50 hover:text-gray-800 transition-colors",children:[e.jsx(et,{size:16,strokeWidth:2}),"Voir le projet et les devis"]}),e.jsxs("button",{type:"button",onClick:()=>u(`/chat/${i}`),className:"w-full py-2.5 rounded-xl text-gray-600 font-medium text-sm flex items-center justify-center gap-2 hover:bg-gray-50 hover:text-gray-800 transition-colors",children:[e.jsx(es,{size:16,strokeWidth:2}),"Contacter l'artisan"]})]})]})}function Ab(i){const[u,f]=c.useState([]),[o,x]=c.useState(!1),y=c.useCallback(async()=>{if(!i)return;x(!0);const{data:h,error:g}=await j.from("messages").select("*").eq("project_id",i).order("created_at",{ascending:!0});!g&&h&&f(h),x(!1)},[i]);return c.useEffect(()=>{if(y(),!i)return;const h=j.channel(`project-messages-${i}`).on("postgres_changes",{event:"INSERT",schema:"public",table:"messages",filter:`project_id=eq.${i}`},g=>{const E=g.new;f(d=>d.some(v=>v.id===E.id)?d:[...d,E])}).subscribe();return()=>{j.removeChannel(h)}},[i,y]),{messages:u,loading:o,sendMessage:async h=>{const{data:g,error:E}=await j.from("messages").insert({project_id:h.project_id,sender_id:h.sender_id,content:h.content,audio_url:h.audio_url,type:h.type}).select().single();if(E)throw E;g&&f(d=>[...d,g])},refresh:y}}function qb(){try{const i=new Audio("/notification.mp3");i.volume=.3,i.play().catch(()=>{try{const u=new(window.AudioContext||window.webkitAudioContext),f=u.createOscillator(),o=u.createGain();f.connect(o),o.connect(u.destination),f.frequency.value=880,o.gain.setValueAtTime(.15,u.currentTime),o.gain.exponentialRampToValueAtTime(.01,u.currentTime+.15),f.start(u.currentTime),f.stop(u.currentTime+.15)}catch{}})}catch{try{const i=new(window.AudioContext||window.webkitAudioContext),u=i.createOscillator(),f=i.createGain();u.connect(f),f.connect(i.destination),u.frequency.value=880,f.gain.setValueAtTime(.15,i.currentTime),f.gain.exponentialRampToValueAtTime(.01,i.currentTime+.15),u.start(i.currentTime),u.stop(i.currentTime+.15)}catch{}}}function yn(){const{user:i}=Nt(),[u,f]=c.useState([]),[o,x]=c.useState(0),[y,N]=c.useState(!0),h=c.useCallback(async()=>{if(!i){f([]),x(0),N(!1);return}try{const{data:w,error:_}=await j.from("notifications").select("*").eq("user_id",i.id).order("created_at",{ascending:!1}).limit(50);if(_)throw _;f(w||[]),x((w==null?void 0:w.filter(L=>!L.is_read).length)||0)}catch(w){console.error("Error fetching notifications:",w)}finally{N(!1)}},[i]),g=c.useCallback(async w=>{if(i)try{await j.from("notifications").update({is_read:!0}).eq("id",w),f(_=>_.map(L=>L.id===w?{...L,is_read:!0}:L)),x(_=>Math.max(0,_-1))}catch(_){console.error("Error marking notification as read:",_)}},[i]),E=c.useCallback(async()=>{if(i)try{await j.from("notifications").update({is_read:!0}).eq("user_id",i.id).eq("is_read",!1),f(w=>w.map(_=>({..._,is_read:!0}))),x(0)}catch(w){console.error("Error marking all notifications as read:",w)}},[i]),d=c.useCallback(async w=>{if(i)try{await j.from("notifications").delete().eq("id",w),f(_=>_.filter(L=>L.id!==w))}catch(_){console.error("Error deleting notification:",_)}},[i]),v=c.useCallback(async w=>{if(!i)return;const _=u.filter(L=>{var M;return!L.is_read&&L.type==="new_message"&&((M=L.data)==null?void 0:M.project_id)===w});if(_.length!==0)try{await Promise.all(_.map(M=>j.from("notifications").update({is_read:!0}).eq("id",M.id)));const L=new Set(_.map(M=>M.id));f(M=>M.map(D=>L.has(D.id)?{...D,is_read:!0}:D)),x(M=>Math.max(0,M-_.length))}catch(L){console.error("Error marking notifications as read for project:",L)}},[i,u]);c.useEffect(()=>{if(!i)return;h();const w=j.channel("notifications_realtime").on("postgres_changes",{event:"INSERT",schema:"public",table:"notifications",filter:`user_id=eq.${i.id}`},_=>{const L=_.new;f(M=>[L,...M]),x(M=>M+1),qb()}).subscribe();return()=>{j.removeChannel(w)}},[i,h]);const b=u.filter(w=>!w.is_read&&w.type==="new_message").length;return{notifications:u,unreadCount:o,unreadMessageCount:b,loading:y,markAsRead:g,markAllAsRead:E,markAsReadForProject:v,deleteNotification:d,refresh:h}}const jl="call_signal";function Mb(i){return i&&typeof i=="object"&&"payload"in i&&i.payload&&typeof i.payload=="object"?i.payload:i&&typeof i=="object"&&"type"in i?i:null}function Db(i,u,f,o){const[x,y]=c.useState("idle"),[N,h]=c.useState(null),[g,E]=c.useState(null),[d,v]=c.useState(null),[b,w]=c.useState(null),[_,L]=c.useState(!1),M=c.useRef(null),D=c.useRef(null),U=c.useRef(null),J=c.useRef(""),F=c.useRef(null),G=c.useRef(null),Z=c.useCallback(()=>{M.current&&(M.current.close(),M.current=null),D.current&&(D.current.getTracks().forEach(q=>q.stop()),D.current=null),U.current&&(j.removeChannel(U.current),U.current=null),J.current="",F.current=null,G.current=null,v(null),w(null),L(!1)},[]),X=c.useCallback(()=>{U.current&&f&&U.current.send({type:"broadcast",event:jl,payload:{type:"hangup",from:f}}),Z(),y("idle"),h(null),E(null)},[f,Z]);c.useEffect(()=>{if(!i||!f)return;const q=j.channel(`call-${i}`);return U.current=q,q.on("broadcast",{event:jl},T=>{const C=Mb(T);if(!(!C||C.from===f))if(C.type==="offer"&&C.to===f){const B=C.senderName||"Quelqu'un",z=!!C.video;h({id:C.from,name:B,video:z}),F.current=C.sdp,G.current={id:C.from,name:B,video:z},y("ringing")}else C.type==="answer"&&C.to===f&&M.current?M.current.setRemoteDescription(new RTCSessionDescription(C.sdp)).catch(console.error):C.type==="ice"&&C.to===f&&M.current?C.candidate&&M.current.addIceCandidate(new RTCIceCandidate(C.candidate)).catch(console.error):C.type==="hangup"&&C.from!==f?(Z(),y("idle"),h(null)):C.type==="reject"&&C.to===f&&(Z(),y("idle"),E("Appel refus"),setTimeout(()=>E(null),3e3))}).subscribe(T=>{J.current=T}),()=>{X()}},[i,f,X]);const R=c.useCallback(()=>new Promise((q,T)=>{if(J.current==="SUBSCRIBED"){q();return}const C=Date.now()+5e3,B=setInterval(()=>{J.current==="SUBSCRIBED"?(clearInterval(B),q()):Date.now()>C&&(clearInterval(B),T(new Error("Canal non prt")))},100)}),[]),ae=c.useCallback(async(q={})=>{const T=!!q.video;if(!(!i||!u||!f)){E(null),y("calling"),L(T);try{await R();const C=await navigator.mediaDevices.getUserMedia({audio:!0,video:T?{facingMode:"user"}:!1});D.current=C,w(C);const B=new RTCPeerConnection({iceServers:[{urls:"stun:stun.l.google.com:19302"}]});M.current=B,C.getTracks().forEach(S=>B.addTrack(S,C)),B.onicecandidate=S=>{S.candidate&&U.current&&U.current.send({type:"broadcast",event:jl,payload:{type:"ice",from:f,to:u,candidate:S.candidate.toJSON()}})},B.ontrack=S=>{var V;(V=S.streams)!=null&&V[0]?v(S.streams[0]):S.stream&&v(S.stream)},B.onconnectionstatechange=()=>{B.connectionState==="connected"&&y("connected"),["disconnected","failed","closed"].includes(B.connectionState)&&X()};const z=await B.createOffer();if(await B.setLocalDescription(z),!U.current)throw new Error("Canal non disponible");U.current.send({type:"broadcast",event:jl,payload:{type:"offer",from:f,to:u,senderName:o||"Quelqu'un",sdp:z,video:T}})}catch(C){console.error("Start call error:",C),E(C instanceof Error?C.message:"Impossible d'accder au micro ou  la camra"),y("idle"),L(!1),Z()}}},[i,u,f,o,Z,X,R]),ge=c.useCallback(async()=>{const q=F.current,T=G.current;if(!q||!T||!i||!f)return;const C=T.video;h(null),y("calling"),E(null),L(C),F.current=null,G.current=null;try{const B=await navigator.mediaDevices.getUserMedia({audio:!0,video:C?{facingMode:"user"}:!1});D.current=B,w(B);const z=new RTCPeerConnection({iceServers:[{urls:"stun:stun.l.google.com:19302"}]});M.current=z,B.getTracks().forEach(V=>z.addTrack(V,B)),z.onicecandidate=V=>{V.candidate&&U.current&&U.current.send({type:"broadcast",event:jl,payload:{type:"ice",from:f,to:T.id,candidate:V.candidate.toJSON()}})},z.ontrack=V=>{var le;(le=V.streams)!=null&&le[0]?v(V.streams[0]):V.stream&&v(V.stream)},z.onconnectionstatechange=()=>{z.connectionState==="connected"&&y("connected"),["disconnected","failed","closed"].includes(z.connectionState)&&X()},await z.setRemoteDescription(new RTCSessionDescription(q));const S=await z.createAnswer();if(await z.setLocalDescription(S),!U.current)throw new Error("Canal non disponible");U.current.send({type:"broadcast",event:jl,payload:{type:"answer",from:f,to:T.id,sdp:S}})}catch(B){console.error("Accept call error:",B),E("Impossible de rejoindre l'appel"),y("idle"),h(null),L(!1),Z()}},[i,f,Z,X]),k=c.useCallback(()=>{const q=G.current;q&&U.current&&f&&U.current.send({type:"broadcast",event:jl,payload:{type:"reject",from:f,to:q.id}}),h(null),F.current=null,G.current=null,y("idle")},[f]);return{status:x,incomingCallFrom:N,error:g,remoteStream:d,localStream:b,isVideoCall:_,startCall:ae,endCall:X,acceptCall:ge,rejectCall:k}}function Rb(){var Ye,st,Ke,ft;const{projectId:i}=Ya(),u=ht(),f=Nt(),{messages:o,sendMessage:x,loading:y}=Ab(i),{markAsReadForProject:N}=yn(),[h,g]=c.useState(""),[E,d]=c.useState(!1),[v,b]=c.useState(null),[w,_]=c.useState(null),[L,M]=c.useState(null),[D,U]=c.useState(!1),[J,F]=c.useState(!1),G=((st=(Ye=f.user)==null?void 0:Ye.user_metadata)==null?void 0:st.full_name)||"",{status:Z,incomingCallFrom:X,error:R,remoteStream:ae,localStream:ge,isVideoCall:k,endCall:q,acceptCall:T,rejectCall:C}=Db(i,w==null?void 0:w.id,(Ke=f.user)==null?void 0:Ke.id,G),B=c.useRef(null),z=c.useRef(null);c.useEffect(()=>{B.current&&ae&&(B.current.srcObject=ae)},[ae]),c.useEffect(()=>{z.current&&ge&&(z.current.srcObject=ge)},[ge]);const S=c.useRef(null),V=c.useRef(null),le=c.useRef(new Map),he=c.useRef(null),Ne=[10,14,8,16,11,13,9,15,12,10,14,11];c.useEffect(()=>{(async()=>{var Le,ue;if(!i||!f.user)return;const{data:je}=await j.from("projects").select(`
          id, title, client_id, target_artisan_id,
          profiles!projects_client_id_fkey (full_name, avatar_url)
        `).eq("id",i).single();if(je)if(b(je),je.client_id===f.user.id){const{data:ze}=await j.from("quotes").select(`
              artisan_id,
              profiles!quotes_artisan_id_fkey (full_name, avatar_url)
            `).eq("project_id",i).eq("status","accepted").maybeSingle();if(ze!=null&&ze.profiles)_({id:ze.artisan_id,name:ze.profiles.full_name,avatar:ze.profiles.avatar_url,role:"artisan"});else{const{data:Ge}=await j.from("quotes").select(`
                artisan_id,
                profiles!quotes_artisan_id_fkey (full_name, avatar_url)
              `).eq("project_id",i).in("status",["pending","viewed"]).order("created_at",{ascending:!1}).limit(1),xe=Ge==null?void 0:Ge[0];if(xe!=null&&xe.profiles)_({id:xe.artisan_id,name:xe.profiles.full_name,avatar:xe.profiles.avatar_url,role:"artisan"});else if(je.target_artisan_id){const Se=je.target_artisan_id,{data:Pe}=await j.from("profiles").select("id, full_name, avatar_url").eq("id",Se).single();Pe&&_({id:Pe.id,name:Pe.full_name,avatar:Pe.avatar_url,role:"artisan"})}}}else _({id:je.client_id,name:((Le=je.profiles)==null?void 0:Le.full_name)||"Client",avatar:((ue=je.profiles)==null?void 0:ue.avatar_url)||null,role:"client"})})()},[i,f.user]);const fe=()=>{var _e;(_e=S.current)==null||_e.scrollIntoView({behavior:"smooth"})};c.useEffect(()=>{i&&N(i)},[i,N]);const ye=c.useRef(0);c.useEffect(()=>{const _e=V.current;if(!_e||o.length===0)return;const je=ye.current===0;ye.current=o.length;const Le=_e.scrollHeight-_e.scrollTop-_e.clientHeight<150;(je||Le)&&requestAnimationFrame(()=>fe())},[o]);const Y=c.useRef(null);c.useEffect(()=>{var Le,ue;if(!((Le=f.user)!=null&&Le.id)||o.length===0)return;const _e=Y.current,je=_e!==null&&o.length>_e&&((ue=o[o.length-1])==null?void 0:ue.sender_id)&&o[o.length-1].sender_id!==f.user.id;if(Y.current=o.length,je)try{const Ae=new Audio("/notification.mp3");Ae.volume=.4,Ae.play().catch(()=>{})}catch{}},[o,(ft=f.user)==null?void 0:ft.id]);const $=(_e,je)=>{const Le=le.current.get(_e);if(L===_e&&Le)Le.pause(),M(null);else{le.current.forEach(Ae=>Ae.pause());let ue=le.current.get(_e);ue||(ue=new Audio(je),ue.onended=()=>M(null),le.current.set(_e,ue)),ue.play(),M(_e)}},ce=async()=>{var _e;if(!(!h.trim()||!i||!f.user||J)){F(!0);try{await x({project_id:i,sender_id:f.user.id,content:h,type:"text"}),w&&await Gi(i,w.id,((_e=f.user.user_metadata)==null?void 0:_e.full_name)||"Quelqu'un"),g("")}catch(je){console.error("Error sending message:",je)}finally{F(!1)}}},we=async _e=>{var je;if(!(!i||!f.user)){F(!0);try{const Le=`${f.user.id}/${Date.now()}.webm`,{data:ue,error:Ae}=await j.storage.from("audio").upload(`messages/${Le}`,_e);if(Ae)throw Ae;const ze=j.storage.from("audio").getPublicUrl(ue.path).data.publicUrl;await x({project_id:i,sender_id:f.user.id,audio_url:ze,type:"audio"}),w&&await Gi(i,w.id,((je=f.user.user_metadata)==null?void 0:je.full_name)||"Quelqu'un"),d(!1)}catch(Le){console.error("Error sending audio:",Le)}finally{F(!1)}}},We=async _e=>{var Ae,ze;const je=(Ae=_e.target.files)==null?void 0:Ae[0];if(!je||!i||!f.user)return;const ue=je.type.startsWith("video/")?"video":"image";F(!0);try{const Ge=`${f.user.id}/${Date.now()}-${je.name}`,{data:xe,error:Se}=await j.storage.from("photos").upload(`messages/${Ge}`,je);if(Se)throw Se;const Pe=j.storage.from("photos").getPublicUrl(xe.path).data.publicUrl;await x({project_id:i,sender_id:f.user.id,content:Pe,type:ue}),w&&await Gi(i,w.id,((ze=f.user.user_metadata)==null?void 0:ze.full_name)||"Quelqu'un")}catch(Ge){console.error("Error sending media:",Ge)}finally{F(!1),he.current&&(he.current.value="")}},pe=o.reduce((_e,je)=>{const Le=new Date(je.created_at).toLocaleDateString("fr-FR",{weekday:"long",day:"numeric",month:"long"}),ue=_e.find(Ae=>Ae.date===Le);return ue?ue.messages.push(je):_e.push({date:Le,messages:[je]}),_e},[]);return e.jsxs("div",{className:"flex flex-col h-screen bg-gray-50",children:[e.jsxs("header",{className:"px-4 py-3 bg-white border-b shadow-sm flex items-center justify-between sticky top-0 z-10",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("button",{onClick:()=>u(-1),className:"w-10 h-10 rounded-xl bg-gray-100 flex items-center justify-center text-gray-600 hover:bg-gray-200 transition-colors",children:e.jsx(Wt,{size:20})}),(w||v)&&e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsxs("div",{className:"relative",children:[e.jsx("div",{className:"w-10 h-10 rounded-full bg-brand-100 flex items-center justify-center overflow-hidden",children:w!=null&&w.avatar?e.jsx("img",{src:w.avatar,alt:"",className:"w-full h-full object-cover"}):e.jsx(ot,{size:20,className:"text-brand-500"})}),e.jsx("div",{className:"absolute bottom-0 right-0 w-3 h-3 bg-green-500 rounded-full border-2 border-white"})]}),e.jsxs("div",{children:[e.jsx("p",{className:"font-bold text-gray-900 text-sm",children:(w==null?void 0:w.name)??"Professionnel"}),e.jsxs("p",{className:"text-[10px] text-green-500 font-bold uppercase tracking-wider flex items-center gap-1",children:[e.jsx("div",{className:"w-1.5 h-1.5 bg-green-500 rounded-full animate-pulse"}),"En ligne"]})]})]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs("div",{className:"flex items-center gap-1 flex-shrink-0",title:"Appels en dveloppement  Bientt disponible",children:[e.jsxs("span",{className:"text-[10px] font-medium text-amber-600 bg-amber-50 border border-amber-200 rounded-lg px-1.5 sm:px-2 py-0.5 whitespace-nowrap",children:[e.jsx("span",{className:"sm:hidden",children:"Bientt"}),e.jsx("span",{className:"hidden sm:inline",children:"En dev  Bientt"})]}),e.jsx("button",{type:"button",disabled:!0,className:"w-10 h-10 rounded-xl flex items-center justify-center text-gray-300 bg-gray-50 cursor-not-allowed",title:"Appel audio  en dveloppement, disponible prochainement","aria-label":"Appel audio (bientt disponible)",children:e.jsx(hn,{size:18})}),e.jsx("button",{type:"button",disabled:!0,className:"w-10 h-10 rounded-xl flex items-center justify-center text-gray-300 bg-gray-50 cursor-not-allowed",title:"Appel vido  en dveloppement, disponible prochainement","aria-label":"Appel vido (bientt disponible)",children:e.jsx(zs,{size:18})})]}),e.jsx("button",{onClick:()=>U(!D),className:"w-10 h-10 rounded-xl flex items-center justify-center text-gray-400 hover:bg-gray-100 transition-colors",children:e.jsx(Z0,{size:18})})]}),D&&e.jsx("div",{className:"absolute right-4 top-16 w-48 bg-white rounded-xl shadow-lg border border-gray-100 py-1 z-20 animate-in fade-in slide-in-from-top-2 duration-200",children:e.jsxs("button",{onClick:()=>{u(`/projects/${i}`),U(!1)},className:"w-full px-4 py-3 text-left text-sm font-medium text-gray-700 hover:bg-gray-50 flex items-center gap-2",children:[e.jsx(fn,{size:16}),"Voir le projet"]})})]}),v&&e.jsx("div",{className:"px-4 py-2 bg-brand-50 border-b border-brand-100",children:e.jsxs("p",{className:"text-xs text-brand-600 font-medium text-center",children:["Discussion pour : ",e.jsx("span",{className:"font-bold",children:v.title})]})}),(Z==="calling"||Z==="connected")&&!k&&e.jsxs("div",{className:"px-4 py-3 bg-brand-500 text-white flex items-center justify-between gap-3",children:[e.jsxs("div",{className:"flex items-center gap-2 min-w-0",children:[e.jsx("div",{className:"w-2 h-2 rounded-full bg-white animate-pulse flex-shrink-0"}),e.jsxs("span",{className:"text-sm font-bold truncate",children:[Z==="calling"&&!X&&"Appel en cours",Z==="connected"&&w&&`En appel avec ${w.name}`,Z==="calling"&&X&&"Connexion"]})]}),e.jsx("button",{type:"button",onClick:q,className:"flex-shrink-0 w-10 h-10 rounded-xl bg-white/20 flex items-center justify-center hover:bg-white/30 transition-colors","aria-label":"Raccrocher",children:e.jsx(Ri,{size:18})})]}),Z==="connected"&&k&&e.jsxs("div",{className:"absolute inset-0 z-40 flex flex-col bg-gray-900",children:[e.jsxs("div",{className:"relative flex-1 min-h-0",children:[e.jsx("video",{ref:B,autoPlay:!0,playsInline:!0,className:"w-full h-full object-cover"}),ge&&e.jsx("div",{className:"absolute bottom-4 right-4 w-32 h-40 rounded-xl overflow-hidden border-2 border-white shadow-lg",children:e.jsx("video",{ref:z,autoPlay:!0,playsInline:!0,muted:!0,className:"w-full h-full object-cover scale-x-[-1]"})})]}),e.jsxs("div",{className:"p-4 bg-black/60 flex items-center justify-center gap-4",children:[e.jsxs("span",{className:"text-white text-sm font-medium truncate",children:["En appel avec ",(w==null?void 0:w.name)||""]}),e.jsx("button",{type:"button",onClick:q,className:"w-14 h-14 rounded-full bg-red-500 flex items-center justify-center hover:bg-red-600 transition-colors","aria-label":"Raccrocher",children:e.jsx(Ri,{size:24,className:"text-white"})})]})]}),Z==="calling"&&k&&e.jsxs("div",{className:"px-4 py-3 bg-brand-500 text-white flex items-center justify-between gap-3",children:[e.jsxs("div",{className:"flex items-center gap-2 min-w-0",children:[e.jsx("div",{className:"w-2 h-2 rounded-full bg-white animate-pulse flex-shrink-0"}),e.jsx("span",{className:"text-sm font-bold truncate",children:"Appel vido en cours"})]}),e.jsx("button",{type:"button",onClick:q,className:"flex-shrink-0 w-10 h-10 rounded-xl bg-white/20 flex items-center justify-center hover:bg-white/30 transition-colors","aria-label":"Raccrocher",children:e.jsx(Ri,{size:18})})]}),R&&e.jsx("div",{className:"px-4 py-2 bg-red-50 border-b border-red-100 flex items-center justify-center",children:e.jsx("p",{className:"text-sm font-medium text-red-600",children:R})}),e.jsx("div",{ref:V,className:"flex-1 overflow-y-auto px-4 py-4 scroll-smooth",children:y?e.jsx("div",{className:"flex flex-col gap-4 py-4",children:[1,2,3,4].map(_e=>e.jsx("div",{className:`flex ${_e%2===0?"justify-end":"justify-start"}`,children:e.jsx("div",{className:`h-12 rounded-2xl w-[70%] max-w-[240px] animate-pulse ${_e%2===0?"bg-brand-200/50 rounded-br-sm":"bg-gray-200 rounded-bl-sm"}`})},_e))}):o.length===0?e.jsxs("div",{className:"flex flex-col items-center justify-center h-full text-center",children:[e.jsx("div",{className:"w-16 h-16 bg-gray-100 rounded-full flex items-center justify-center mb-4",children:e.jsx(al,{size:24,className:"text-gray-300"})}),e.jsx("p",{className:"text-gray-400 font-medium",children:"Aucun message"}),e.jsx("p",{className:"text-xs text-gray-300 mt-1",children:"Commencez la conversation !"})]}):e.jsxs("div",{className:"space-y-6",children:[pe.map(_e=>e.jsxs("div",{children:[e.jsx("div",{className:"flex items-center justify-center mb-4",children:e.jsx("span",{className:"px-3 py-1 bg-gray-100 text-gray-500 text-[10px] font-medium uppercase tracking-wider rounded-full",children:_e.date})}),e.jsx("div",{className:"space-y-3",children:_e.messages.map(je=>{var Ae;const Le=je.sender_id===((Ae=f.user)==null?void 0:Ae.id),ue=L===je.id;return e.jsx("div",{className:`flex ${Le?"justify-end":"justify-start"} animate-in fade-in slide-in-from-bottom-1 duration-200`,children:e.jsxs("div",{className:`max-w-[80%] ${Le?"order-2":"order-1"}`,children:[e.jsxs("div",{className:`rounded-2xl px-4 py-3 transition-all duration-200 ${Le?"bg-brand-500 text-white rounded-br-sm":"bg-white border border-gray-100 text-gray-800 rounded-bl-sm shadow-sm"}`,children:[je.type==="text"&&e.jsx("p",{className:"text-sm leading-relaxed",children:je.content}),je.type==="audio"&&je.audio_url&&e.jsxs("button",{onClick:()=>$(je.id,je.audio_url),className:`flex items-center gap-3 py-1 min-w-[140px] ${Le?"text-white":"text-brand-600"}`,children:[e.jsx("div",{className:`w-10 h-10 rounded-full flex items-center justify-center ${Le?"bg-white/20":"bg-brand-100"}`,children:ue?e.jsx(fp,{size:18,fill:"currentColor"}):e.jsx(Nl,{size:18,fill:"currentColor",className:"ml-0.5"})}),e.jsxs("div",{className:"flex-1",children:[e.jsx("div",{className:"flex items-center gap-1",children:Ne.map((ze,Ge)=>e.jsx("div",{className:`w-1 rounded-full ${Le?"bg-white/60":"bg-brand-300"} ${ue?"animate-pulse":""}`,style:{height:`${ze}px`,animationDelay:`${Ge*50}ms`}},Ge))}),e.jsx("p",{className:`text-[9px] font-bold uppercase tracking-wider mt-1 ${Le?"text-white/70":"text-gray-400"}`,children:"Message vocal"})]})]}),je.type==="image"&&je.content&&e.jsx("img",{src:je.content,alt:"Image partage",className:"rounded-xl max-w-full max-h-60 object-cover cursor-pointer hover:opacity-90 transition-opacity",onClick:()=>window.open(je.content,"_blank")}),je.type==="video"&&je.content&&e.jsx("video",{src:je.content,controls:!0,className:"rounded-xl max-w-full max-h-64 w-full object-contain bg-black",preload:"metadata",playsInline:!0})]}),e.jsxs("div",{className:`flex items-center gap-1 mt-1 ${Le?"justify-end":"justify-start"}`,children:[e.jsx("span",{className:"text-[10px] text-gray-400",children:new Date(je.created_at).toLocaleTimeString("fr-FR",{hour:"2-digit",minute:"2-digit"})}),Le&&e.jsx(bd,{size:12,className:"text-brand-400"})]})]})},je.id)})})]},_e.date)),e.jsx("div",{ref:S})]})}),e.jsx("div",{className:"p-4 bg-white border-t safe-area-pb",children:E?e.jsx("div",{className:"animate-in slide-in-from-bottom-4 duration-300",children:e.jsx(Sd,{onRecordingComplete:we,onDelete:()=>d(!1)})}):e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("input",{ref:he,type:"file",accept:"image/*,video/*",onChange:We,className:"hidden"}),e.jsx("button",{onClick:()=>{var _e;return(_e=he.current)==null?void 0:_e.click()},disabled:J,className:"w-12 h-12 rounded-xl bg-gray-100 text-gray-500 flex items-center justify-center hover:bg-gray-200 transition-all duration-200 active:scale-95 disabled:opacity-50",title:"Photo ou vido",children:e.jsx(tl,{size:20})}),e.jsx("button",{onClick:()=>d(!0),disabled:J,className:"w-12 h-12 rounded-xl bg-brand-50 text-brand-500 flex items-center justify-center hover:bg-brand-100 transition-all duration-200 active:scale-95 disabled:opacity-50",children:e.jsx(gn,{size:20})}),e.jsxs("div",{className:"flex-1 relative",children:[e.jsx("input",{type:"text",value:h,onChange:_e=>g(_e.target.value),onKeyPress:_e=>_e.key==="Enter"&&ce(),placeholder:"Votre message...",disabled:J,className:"w-full pl-4 pr-12 py-3 bg-gray-100 rounded-xl focus:outline-none focus:ring-2 ring-brand-200 transition-all text-sm disabled:opacity-50"}),e.jsx("button",{onClick:ce,disabled:!h.trim()||J,className:"absolute right-1.5 top-1/2 -translate-y-1/2 w-9 h-9 bg-brand-500 text-white rounded-lg flex items-center justify-center disabled:opacity-50 disabled:bg-gray-300 transition-all duration-200 active:scale-95",children:J?e.jsx("div",{className:"w-4 h-4 border-2 border-white border-t-transparent rounded-full animate-spin"}):e.jsx(al,{size:16})})]})]})}),D&&e.jsx("div",{className:"fixed inset-0 z-10",onClick:()=>U(!1)}),Z==="ringing"&&X&&e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"fixed inset-0 z-20 bg-black/50","aria-hidden":"true"}),e.jsxs("div",{className:"fixed left-1/2 top-1/2 -translate-x-1/2 -translate-y-1/2 z-30 w-[90%] max-w-sm bg-white rounded-2xl shadow-xl p-6 text-center animate-in fade-in zoom-in-95 duration-200",children:[e.jsx("p",{className:"text-sm text-gray-500 mb-1",children:X.video?"Appel vido entrant":"Appel entrant"}),e.jsxs("h3",{className:"text-xl font-bold text-gray-900 mb-6",children:[X.name," vous appelle"]}),e.jsxs("div",{className:"flex gap-3",children:[e.jsxs("button",{type:"button",onClick:C,className:"flex-1 py-3 bg-red-500 text-white font-bold rounded-xl hover:bg-red-600 transition-colors flex items-center justify-center gap-2",children:[e.jsx(Ri,{size:20}),"Refuser"]}),e.jsxs("button",{type:"button",onClick:T,className:"flex-1 py-3 bg-green-500 text-white font-bold rounded-xl hover:bg-green-600 transition-colors flex items-center justify-center gap-2",children:[X.video?e.jsx(zs,{size:20}):e.jsx(hn,{size:20}),"Accepter"]})]})]})]})]})}const B0={new_project:{icon:e.jsx(Ht,{size:16}),color:"text-blue-600",bg:"bg-blue-100"},new_quote:{icon:e.jsx(et,{size:16}),color:"text-purple-600",bg:"bg-purple-100"},quote_accepted:{icon:e.jsx(aa,{size:16}),color:"text-green-600",bg:"bg-green-100"},quote_rejected:{icon:e.jsx(Ze,{size:16}),color:"text-red-600",bg:"bg-red-100"},project_completed:{icon:e.jsx(aa,{size:16}),color:"text-green-600",bg:"bg-green-100"},payment_received:{icon:e.jsx(Na,{size:16}),color:"text-green-600",bg:"bg-green-100"},verification_approved:{icon:e.jsx(Gt,{size:16}),color:"text-blue-600",bg:"bg-blue-100"},verification_rejected:{icon:e.jsx(Gt,{size:16}),color:"text-red-600",bg:"bg-red-100"},new_message:{icon:e.jsx(fr,{size:16}),color:"text-brand-600",bg:"bg-brand-100"},quote_revision_requested:{icon:e.jsx(zt,{size:16}),color:"text-yellow-600",bg:"bg-yellow-100"},quote_revision_responded:{icon:e.jsx(et,{size:16}),color:"text-blue-600",bg:"bg-blue-100"},system:{icon:e.jsx(ur,{size:16}),color:"text-gray-600",bg:"bg-gray-100"}},Tb=i=>{const u=new Date(i),o=new Date().getTime()-u.getTime(),x=Math.floor(o/(1e3*60)),y=Math.floor(o/(1e3*60*60)),N=Math.floor(o/(1e3*60*60*24));return x<1?" l'instant":x<60?`Il y a ${x} min`:y<24?`Il y a ${y}h`:N<7?`Il y a ${N}j`:u.toLocaleDateString("fr-FR",{day:"numeric",month:"short"})};function Lb(){const i=ht(),{notifications:u,unreadCount:f,markAsRead:o,markAllAsRead:x,deleteNotification:y}=yn(),[N,h]=c.useState(!1),g=c.useRef(null);c.useEffect(()=>{const d=v=>{g.current&&!g.current.contains(v.target)&&h(!1)};return document.addEventListener("mousedown",d),()=>document.removeEventListener("mousedown",d)},[]);const E=d=>{o(d.id);const v=d.data,b=typeof v=="string"?(()=>{try{return JSON.parse(v)}catch{return{}}})():v||{};switch(window.scrollTo({top:0,left:0,behavior:"instant"}),document.documentElement.scrollTop=0,document.body.scrollTop=0,d.type){case"new_project":case"quote_accepted":case"quote_rejected":b!=null&&b.project_id&&i(`/projects/${b.project_id}#devis`);break;case"project_completed":b!=null&&b.project_id&&i(`/projects/${b.project_id}#suivi`);break;case"quote_revision_requested":if(b!=null&&b.project_id){const w=b.revision_id?`?revision=${b.revision_id}`:"";i(`/projects/${b.project_id}${w}`)}else i("/revisions");break;case"quote_revision_responded":if(b!=null&&b.project_id){const w=b.revision_id?`?revision=${b.revision_id}`:"";i(`/projects/${b.project_id}${w}`)}break;case"new_quote":b!=null&&b.project_id&&i(`/projects/${b.project_id}`);break;case"payment_received":i("/dashboard");break;case"verification_approved":case"verification_rejected":i("/dashboard");break;case"new_message":b!=null&&b.project_id&&i(`/chat/${b.project_id}`);break;case"system":case"dispute_raised":b!=null&&b.project_id?(b==null?void 0:b.kind)==="quote_revision_requested"&&(b!=null&&b.revision_id)?i(`/projects/${b.project_id}?revision=${b.revision_id}`):i(`/projects/${b.project_id}#devis`):i("/dashboard");break;default:i("/dashboard")}h(!1)};return e.jsxs("div",{className:"relative",ref:g,children:[e.jsxs("button",{onClick:()=>h(!N),className:`relative w-11 h-11 rounded-xl flex items-center justify-center transition-colors ${N?"bg-brand-500 text-white":"bg-gray-100 text-gray-500 hover:bg-brand-50 hover:text-brand-500"}`,"aria-label":"Notifications",children:[e.jsx(ur,{size:20}),f>0&&e.jsx("span",{className:"absolute -top-1 -right-1 w-5 h-5 bg-red-500 text-white text-[10px] font-bold rounded-full flex items-center justify-center border-2 border-white animate-pulse",children:f>9?"9+":f})]}),N&&e.jsxs("div",{className:"absolute right-0 mt-2 w-80 md:w-96 bg-white rounded-2xl shadow-2xl border border-gray-100 overflow-hidden z-50 animate-in fade-in slide-in-from-top-2 duration-200",children:[e.jsxs("div",{className:"px-4 py-3 border-b border-gray-100 flex items-center justify-between bg-gray-50",children:[e.jsx("h3",{className:"font-bold text-gray-900",children:"Notifications"}),f>0&&e.jsxs("button",{onClick:()=>x(),className:"text-xs text-brand-500 font-bold hover:underline flex items-center gap-1",children:[e.jsx(bd,{size:14}),"Tout marquer comme lu"]})]}),e.jsx("div",{className:"max-h-[400px] overflow-y-auto",children:u.length===0?e.jsxs("div",{className:"py-12 text-center",children:[e.jsx(ur,{size:32,className:"mx-auto text-gray-200 mb-3"}),e.jsx("p",{className:"text-gray-400 font-medium text-sm",children:"Aucune notification"})]}):e.jsx("div",{className:"divide-y divide-gray-50",children:u.slice(0,20).map(d=>{const v=B0[d.type]||B0.system;return e.jsxs("div",{role:"button",tabIndex:0,onClick:()=>E(d),onKeyDown:b=>{(b.key==="Enter"||b.key===" ")&&(b.preventDefault(),E(d))},className:`flex items-start gap-3 p-4 cursor-pointer transition-colors hover:bg-gray-50 ${d.is_read?"":"bg-brand-50/30"}`,children:[e.jsx("div",{className:`w-10 h-10 rounded-xl flex items-center justify-center flex-shrink-0 ${v.bg} ${v.color}`,children:v.icon}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsxs("div",{className:"flex items-start justify-between gap-2",children:[e.jsx("p",{className:`text-sm font-bold text-gray-900 ${d.is_read?"text-gray-700":""}`,children:d.title}),!d.is_read&&e.jsx("span",{className:"w-2 h-2 bg-brand-500 rounded-full flex-shrink-0 mt-1.5"})]}),d.message&&e.jsx("p",{className:"text-xs text-gray-500 mt-0.5 truncate max-w-full",children:d.message}),e.jsx("p",{className:"text-[10px] text-gray-400 mt-1 font-medium",children:Tb(d.created_at)})]}),e.jsx("button",{onClick:b=>{b.stopPropagation(),y(d.id)},className:"p-1.5 text-gray-300 hover:text-red-500 hover:bg-red-50 rounded-lg transition-colors",children:e.jsx(gr,{size:14})})]},d.id)})})}),u.length>0&&e.jsx("div",{className:"px-4 py-3 border-t border-gray-100 bg-gray-50",children:e.jsxs("button",{onClick:()=>{i("/notifications"),h(!1)},className:"w-full text-center text-xs text-brand-500 font-bold hover:underline flex items-center justify-center gap-1",children:["Voir toutes les notifications",e.jsx(da,{size:14})]})})]})]})}const Js={open:{label:"En attente",color:"bg-blue-100 text-blue-700",icon:e.jsx(St,{size:14})},quote_received:{label:"Devis reu",color:"bg-purple-100 text-purple-700",icon:e.jsx(et,{size:14})},quote_accepted:{label:"Accept",color:"bg-green-100 text-green-700",icon:e.jsx(aa,{size:14})},payment_pending:{label:"Paiement en attente",color:"bg-amber-100 text-amber-700",icon:e.jsx(Na,{size:14})},in_progress:{label:"En cours",color:"bg-brand-100 text-brand-700",icon:e.jsx(dr,{size:14})},completion_requested:{label:" finaliser",color:"bg-orange-100 text-orange-700",icon:e.jsx(Qe,{size:14})},completed:{label:"Termin",color:"bg-green-100 text-green-700",icon:e.jsx(Qe,{size:14})},pending:{label:"En attente",color:"bg-blue-100 text-blue-700",icon:e.jsx(St,{size:14})},accepted:{label:"Accept",color:"bg-green-100 text-green-700",icon:e.jsx(aa,{size:14})},rejected:{label:"Refus",color:"bg-red-100 text-red-700",icon:e.jsx(Ze,{size:14})},expired:{label:"Expir",color:"bg-gray-100 text-gray-500",icon:e.jsx(St,{size:14})},cancelled:{label:"Annul",color:"bg-gray-100 text-gray-500",icon:e.jsx(Ze,{size:14})},abandoned:{label:"Cltur",color:"bg-gray-100 text-gray-500",icon:e.jsx(Ze,{size:14})}},H0=()=>{const i=new Date().getHours();return i<12?"Bonjour":i<18?"Bon aprs-midi":"Bonsoir"};function Ub(){var Ge,xe,Se,Pe,Xe,gt,Lt,qt,kt,Rt,Ce,Me,tt;const i=ht(),u=pn(),f=Nt(),{profile:o,loading:x,upsertProfile:y}=It(),{unreadMessageCount:N}=yn(),h=Q=>!(!Q||!["role","full_name","location"].every(Oe=>Q[Oe]&&Q[Oe].toString().trim().length>0)||Q.role==="artisan"&&!Q.category_id),[g,E]=c.useState("home"),[d,v]=c.useState([]),[b,w]=c.useState([]),[_,L]=c.useState([]),[M,D]=c.useState([]),[U,J]=c.useState(!0),[F,G]=c.useState(null),[Z,X]=c.useState(null),[R,ae]=c.useState(null),[ge,k]=c.useState(!1),[q,T]=c.useState(!0),[C,B]=c.useState(!1),[z,S]=c.useState(null),[V,le]=c.useState(!1),[he,Ne]=c.useState([]),[fe,ye]=c.useState("all"),[Y,$]=c.useState("demandes"),{signOut:ce}=f;c.useEffect(()=>{var oe,ve;if(V||f.loading||!f.user||x||!f.session)return;const Q=new URLSearchParams(u.search),be=Q.get("mode"),Ee=Q.get("role");if(be==="signup"&&Ee==="artisan"){const Te=new URLSearchParams;Te.set("mode","onboarding"),Te.set("role","artisan"),console.log("[Dashboard] Redirection artisan signup vers edit-profile"),i(`/edit-profile?${Te.toString()}`,{replace:!0});return}if(Ee!=="client"&&Ee!=="artisan")return;const Oe=(o==null?void 0:o.full_name)||((oe=f.user.user_metadata)==null?void 0:oe.full_name)||((ve=f.user.user_metadata)==null?void 0:ve.name)||f.user.email||"Utilisateur";if(o&&o.role===Ee)return;if(!f.user){console.error("[Dashboard] auth.user est null, impossible de crer/mettre  jour le profil"),le(!1);return}le(!0);const at=(o==null?void 0:o.full_name)||Oe;(async()=>{if(await new Promise(Te=>setTimeout(Te,100)),!f.user){console.error("[Dashboard] auth.user est devenu null pendant l'initialisation"),le(!1);return}try{await y({full_name:at,role:Ee,phone:(o==null?void 0:o.phone)??null,location:(o==null?void 0:o.location)??null,company_name:(o==null?void 0:o.company_name)??null,region:(o==null?void 0:o.region)??null,department:(o==null?void 0:o.department)??null,commune:(o==null?void 0:o.commune)??null,category_id:(o==null?void 0:o.category_id)??void 0,bio:(o==null?void 0:o.bio)??void 0,specialty:(o==null?void 0:o.specialty)??void 0})}catch(Te){console.error("Erreur lors de l'initialisation/mise  jour du profil:",Te)}finally{le(!1)}})()},[f.loading,(Ge=f.user)==null?void 0:Ge.id,o==null?void 0:o.id,o==null?void 0:o.role,x,u.search,V,y,o,i]),c.useEffect(()=>{if(!o)return;(async()=>{var be;if(J(!0),o.role==="artisan"){try{const{data:ct}=await j.from("artisan_credit_wallets").select("balance").eq("artisan_id",o.id).maybeSingle();S((ct==null?void 0:ct.balance)??0)}catch(ct){console.error("Error fetching artisan credit wallet:",ct),S(null)}const{data:Ee}=await j.from("artisans").select("*, categories(*)").eq("id",o.id).single();if(Ee){X(Ee),G(Ee.verification_status||"unverified"),ae(((be=Ee.categories)==null?void 0:be.name)||null),T(Ee.is_available!==!1);const{data:ct}=await j.from("projects").select("*, categories(*), profiles!projects_client_id_fkey(*)").eq("category_id",Ee.category_id).in("status",["open","quote_received"]).order("created_at",{ascending:!1}).limit(10);v(ct||[])}const{data:Oe}=await j.from("quotes").select("*, projects(*, categories(*), profiles!projects_client_id_fkey(*))").eq("artisan_id",o.id).order("created_at",{ascending:!1});if(w(Oe||[]),Oe&&Oe.length>0){const ct=Oe.map(oe=>oe.id),{data:at}=await j.from("quote_revisions").select(`
              *,
              quotes!quote_revisions_quote_id_fkey(*),
              projects!quote_revisions_project_id_fkey(id, title),
              profiles!quote_revisions_requested_by_fkey(id, full_name, avatar_url)
            `).in("quote_id",ct).eq("status","pending").order("created_at",{ascending:!1});L(at||[]);const{data:se}=await j.from("quote_revisions").select(`
              *,
              quotes!quote_revisions_quote_id_fkey(*),
              projects!quote_revisions_project_id_fkey(id, title),
              profiles!quote_revisions_requested_by_fkey(id, full_name, avatar_url)
            `).in("quote_id",ct).neq("status","pending").order("responded_at",{ascending:!1});D(se||[])}}else{const{data:Ee}=await j.from("projects").select("*, categories(*), quotes(*)").eq("client_id",o.id).neq("status","cancelled").order("created_at",{ascending:!1});v(Ee||[])}J(!1)})()},[o,u.pathname]),c.useEffect(()=>{window.scrollTo({top:0,left:0,behavior:"instant"}),document.documentElement.scrollTop=0,document.body.scrollTop=0},[g]);const we=async()=>{await ce(),i("/")},We=async()=>{if(!o||C)return;B(!0);const Q=!q,{error:be}=await j.from("artisans").update({is_available:Q,updated_at:new Date().toISOString()}).eq("id",o.id);be||T(Q),B(!1)},pe=(o==null?void 0:o.role)==="artisan",st=((o==null?void 0:o.full_name)||((Se=(xe=f.user)==null?void 0:xe.user_metadata)==null?void 0:Se.full_name)||((Xe=(Pe=f.user)==null?void 0:Pe.user_metadata)==null?void 0:Xe.name)||"").trim().split(/\s+/)[0]||((Lt=(gt=f.user)==null?void 0:gt.email)==null?void 0:Lt.split("@")[0])||"Utilisateur",Ke=F==="verified",ft=o?!h(o):!1,_e=c.useMemo(()=>fe==="active"?d.filter(Q=>["open","quote_received","quote_accepted","payment_pending","payment_received","in_progress","completion_requested"].includes(Q.status)):fe==="completed"?d.filter(Q=>Q.status==="completed"):d,[d,fe]),je=c.useMemo(()=>fe==="active"?b.filter(Q=>{var be,Ee,Oe;return((be=Q.projects)==null?void 0:be.status)!=="completed"&&((Ee=Q.projects)==null?void 0:Ee.status)!=="expired"&&((Oe=Q.projects)==null?void 0:Oe.status)!=="cancelled"}):fe==="completed"?b.filter(Q=>{var be;return((be=Q.projects)==null?void 0:be.status)==="completed"}):b,[b,fe]),Le=c.useMemo(()=>{if(!pe)return[];const Q=new Set(b.map(be=>be.project_id));return d.filter(be=>be.status==="open"&&!Q.has(be.id))},[pe,d,b]);if(!o){if(x)return e.jsx(Yt,{});const Q=((Rt=(kt=(qt=f.user)==null?void 0:qt.user_metadata)==null?void 0:kt.full_name)==null?void 0:Rt.split(" ")[0])||((tt=(Me=(Ce=f.user)==null?void 0:Ce.user_metadata)==null?void 0:Me.name)==null?void 0:tt.split(" ")[0])||"Utilisateur";return e.jsxs("div",{className:"min-h-screen bg-gray-50 flex flex-col",children:[e.jsx("header",{className:"bg-white sticky top-0 z-30 shadow-sm border-b border-gray-100",children:e.jsx("div",{className:"max-w-lg mx-auto px-5 py-3 flex items-center justify-between",children:e.jsxs("div",{children:[e.jsxs("p",{className:"text-base font-bold text-gray-900",children:[H0(),", ",Q]}),e.jsx("p",{className:"text-xs text-gray-500 font-medium",children:"Bienvenue sur Mbourak"})]})})}),e.jsx("main",{className:"flex-1 max-w-lg mx-auto px-5 py-10 flex items-center",children:e.jsx("div",{className:"w-full space-y-6",children:e.jsxs("div",{className:"bg-white rounded-3xl p-6 border border-gray-100 shadow-sm text-center",children:[e.jsx("h1",{className:"text-xl font-black text-gray-900 mb-2",children:"Compltez votre profil pour commencer"}),e.jsx("p",{className:"text-sm text-gray-500 mb-6",children:"Nous avons bien cr votre compte. Ajoutez maintenant quelques informations de base pour accder  toutes les fonctionnalits."}),e.jsxs("button",{onClick:()=>i("/edit-profile?mode=onboarding"),className:"w-full flex items-center justify-center gap-2 rounded-2xl bg-gradient-to-br from-brand-400 via-brand-500 to-brand-600 text-white font-black py-3 shadow-cta hover:shadow-cta-hover hover:-translate-y-0.5 active:translate-y-0.5 active:shadow-cta-active transition-all duration-200 text-sm",children:[e.jsx(ot,{size:18}),"Complter mon profil"]})]})})})]})}const ue=pe?b.filter(Q=>Q.status==="pending"&&!Q.is_read).length:d.filter(Q=>{var be;return((be=Q.quotes)==null?void 0:be.length)>0&&Q.status==="open"}).length,Ae=pe?b.filter(Q=>{var Ee;const be=(Ee=Q.projects)==null?void 0:Ee.status;return be!=="completed"&&be!=="expired"&&be!=="cancelled"&&["pending","accepted"].includes(Q.status)}).length:d.filter(Q=>["open","quote_received","quote_accepted","payment_pending","payment_received","in_progress","completion_requested"].includes(Q.status)).length,ze=pe?b.filter(Q=>{var be;return((be=Q.projects)==null?void 0:be.status)==="completed"}).length:d.filter(Q=>Q.status==="completed").length;return pe?b.slice(0,5):d.slice(0,5),U?e.jsx(Yt,{}):e.jsxs("div",{className:"min-h-screen bg-gradient-to-br from-gray-50 via-white to-gray-50",children:[e.jsxs("header",{className:"bg-white/80 backdrop-blur-lg sticky top-0 z-30 shadow-sm border-b border-gray-100/50",children:[e.jsx("div",{className:"max-w-lg mx-auto px-5 py-4",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsxs("button",{onClick:()=>{pe&&(o!=null&&o.id)?i(`/artisans/${o.id}?focus=portfolio`):E("profile")},className:"relative",children:[e.jsx("div",{className:"w-14 h-14 rounded-2xl bg-gradient-to-br from-brand-400 to-brand-600 p-0.5 shadow-lg shadow-brand-200/50",children:e.jsx("div",{className:"w-full h-full rounded-2xl bg-white flex items-center justify-center overflow-hidden",children:o.avatar_url?e.jsx("img",{src:o.avatar_url,alt:"",className:"w-full h-full object-cover"}):e.jsx(ot,{size:24,className:"text-brand-500"})})}),pe&&Ke&&e.jsx("div",{className:"absolute -bottom-0.5 -right-0.5 w-5 h-5 bg-green-500 rounded-xl flex items-center justify-center border-2 border-white shadow-md",children:e.jsx(aa,{size:10,className:"text-white",strokeWidth:3})})]}),e.jsxs("div",{children:[e.jsxs("p",{className:"text-lg font-black text-gray-900",children:[H0(),", ",st]}),e.jsx("p",{className:"text-xs text-gray-500 font-medium flex items-center gap-1.5 mt-0.5",children:pe?e.jsxs(e.Fragment,{children:[e.jsx(Ht,{size:12}),R||"Artisan"]}):e.jsxs(e.Fragment,{children:[e.jsx(ga,{size:12}),o.location||"Sngal"]})})]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[!pe&&e.jsxs("button",{onClick:()=>i("/create-project"),className:"text-sm font-bold text-brand-600 hover:text-brand-700 flex items-center justify-center gap-1.5 min-w-[44px] min-h-[44px] sm:min-w-0 sm:min-h-0 p-2 sm:p-0 rounded-lg sm:rounded-none active:bg-brand-50/80 sm:active:bg-transparent","aria-label":"Nouveau projet",children:[e.jsx(Bi,{size:20,className:"flex-shrink-0"}),e.jsx("span",{className:"hidden sm:inline",children:"Nouveau projet"})]}),e.jsx(Lb,{}),e.jsxs("div",{className:"relative",children:[e.jsx("button",{onClick:()=>k(!ge),className:"w-11 h-11 rounded-xl bg-gray-100 flex items-center justify-center text-gray-600 hover:bg-gray-200 active:scale-95 transition-all shadow-sm","aria-label":"Options",children:ge?e.jsx(Ze,{size:22}):e.jsx(vd,{size:22})}),ge&&e.jsxs("div",{className:"absolute right-0 top-14 w-52 bg-white/90 backdrop-blur-xl rounded-2xl shadow-glass-hover border border-white/60 py-2 z-50 animate-in fade-in slide-in-from-top-2 duration-200",children:[pe?e.jsxs(e.Fragment,{children:[e.jsxs("button",{onClick:()=>{i(`/artisans/${o.id}?focus=portfolio`),k(!1)},className:"w-full px-5 py-3 flex items-center gap-3 text-left hover:bg-gray-50 transition-colors text-sm font-medium",children:[e.jsx(tl,{size:18,className:"text-gray-400"}),e.jsx("span",{className:"font-medium text-gray-700",children:"Mon portfolio"})]}),e.jsxs("button",{onClick:()=>{i("/edit-profile"),k(!1)},className:"w-full px-5 py-3 flex items-center gap-3 text-left hover:bg-gray-50 transition-colors text-sm font-medium",children:[e.jsx(ot,{size:18,className:"text-gray-400"}),e.jsx("span",{className:"font-medium text-gray-700",children:"Modifier mon profil"})]})]}):e.jsxs("button",{onClick:()=>{i("/edit-profile"),k(!1)},className:"w-full px-5 py-3 flex items-center gap-3 text-left hover:bg-gray-50 transition-colors text-sm font-medium",children:[e.jsx(ot,{size:18,className:"text-gray-400"}),e.jsx("span",{className:"font-medium text-gray-700",children:"Mon profil"})]}),e.jsx("div",{className:"h-px bg-gray-100 my-1"}),e.jsxs("button",{onClick:()=>{we(),k(!1)},className:"w-full px-5 py-3 flex items-center gap-3 text-left hover:bg-red-50 transition-colors text-sm font-medium",children:[e.jsx(K0,{size:18,className:"text-red-500"}),e.jsx("span",{className:"font-medium text-red-500",children:"Dconnexion"})]})]})]})]})]})}),ge&&e.jsx("div",{className:"fixed inset-0 z-20",onClick:()=>{k(!1)}})]}),e.jsxs("main",{className:"max-w-lg mx-auto px-5 py-6 pb-32",children:[g==="home"&&e.jsxs("div",{className:"space-y-5 animate-in fade-in duration-300",children:[ft&&e.jsxs("button",{onClick:()=>i("/edit-profile?mode=onboarding"),className:"w-full bg-white/85 backdrop-blur-xl border border-white/60 rounded-xl p-3 flex items-center gap-3 shadow-glass hover:shadow-glass-hover hover:-translate-y-0.5 transition-all duration-200 active:scale-[0.99] border-brand-200/80",children:[e.jsx("div",{className:"w-8 h-8 bg-brand-100 rounded-lg flex items-center justify-center flex-shrink-0",children:e.jsx(ot,{size:16,className:"text-brand-600"})}),e.jsx("div",{className:"flex-1 text-left",children:e.jsx("p",{className:"font-bold text-gray-900 text-sm",children:"Compltez votre profil"})}),e.jsx(da,{size:14,className:"text-gray-400"})]}),pe&&!ft&&(F==="unverified"||z!==null&&z<20)&&(()=>{const Q=F==="unverified",be=z!==null&&z<20,Ee=Q&&be;return e.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[Q&&e.jsxs("button",{type:"button",onClick:()=>i("/verification"),className:`bg-white/85 backdrop-blur-xl border border-white/60 rounded-xl p-3 flex items-center gap-3 shadow-glass hover:shadow-glass-hover hover:-translate-y-0.5 transition-all duration-200 active:scale-[0.99] text-left min-h-[72px] border-brand-200/80 ${Ee?"":"col-span-2"}`,children:[e.jsx("div",{className:"w-8 h-8 bg-brand-100 rounded-lg flex items-center justify-center flex-shrink-0",children:e.jsx(Gt,{size:16,className:"text-brand-600"})}),e.jsx("div",{className:"flex-1 min-w-0",children:e.jsx("p",{className:"font-bold text-gray-900 text-sm",children:"Faites-vous certifier"})}),e.jsx(da,{size:14,className:"text-brand-500 flex-shrink-0"})]}),be&&e.jsxs("button",{type:"button",onClick:()=>i("/credits"),className:`bg-white/85 backdrop-blur-xl border border-white/60 rounded-xl p-3 flex items-center gap-3 shadow-glass hover:shadow-glass-hover hover:-translate-y-0.5 transition-all duration-200 active:scale-[0.99] text-left min-h-[72px] border-brand-200/80 ${Ee?"":"col-span-2"}`,children:[e.jsx("div",{className:"w-8 h-8 bg-brand-100 rounded-lg flex items-center justify-center flex-shrink-0",children:e.jsx(Na,{size:16,className:"text-brand-600"})}),e.jsx("div",{className:"flex-1 min-w-0",children:e.jsxs("p",{className:"font-bold text-gray-900 text-sm",children:[z," crdit",z>1?"s":""," restant",z>1?"s":""]})}),e.jsx(da,{size:14,className:"text-brand-500 flex-shrink-0"})]})]})})(),e.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[e.jsxs("button",{type:"button",onClick:()=>i("/invoices"),className:"bg-white/85 backdrop-blur-xl rounded-2xl p-4 border border-white/60 shadow-glass hover:shadow-glass-hover hover:-translate-y-0.5 transition-all duration-200 active:scale-[0.99] text-left min-h-[92px]",children:[e.jsx("div",{className:"w-10 h-10 rounded-xl bg-brand-50 flex items-center justify-center mb-3",children:e.jsx(et,{size:18,className:"text-brand-600"})}),e.jsx("p",{className:"text-sm font-black text-gray-900",children:"Finances"}),e.jsx("p",{className:"text-xs text-gray-500 mt-0.5",children:"Factures"})]}),e.jsxs("button",{type:"button",onClick:()=>i("/expenses"),className:"bg-white/85 backdrop-blur-xl rounded-2xl p-4 border border-white/60 shadow-glass hover:shadow-glass-hover hover:-translate-y-0.5 transition-all duration-200 active:scale-[0.99] text-left min-h-[92px]",children:[e.jsx("div",{className:"w-10 h-10 rounded-xl bg-gray-50 flex items-center justify-center mb-3",children:e.jsx(J0,{size:18,className:"text-gray-600"})}),e.jsx("p",{className:"text-sm font-black text-gray-900",children:"Dpenses"}),e.jsx("p",{className:"text-xs text-gray-500 mt-0.5",children:"Suivi"})]})]}),(Ae>0||ze>0)&&e.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[e.jsxs("button",{onClick:()=>E("activity"),className:"bg-white/85 backdrop-blur-xl rounded-xl p-4 border border-white/60 shadow-glass hover:shadow-glass-hover hover:-translate-y-0.5 transition-all duration-200 active:scale-[0.99] text-left",children:[e.jsx("div",{className:"flex items-center gap-2 mb-2",children:e.jsx("div",{className:"w-8 h-8 bg-brand-100 rounded-lg flex items-center justify-center",children:pe?e.jsx(al,{size:16,className:"text-brand-600"}):e.jsx(Ht,{size:16,className:"text-brand-600"})})}),e.jsx("p",{className:"text-2xl font-black text-gray-900 mb-1",children:Ae}),e.jsx("p",{className:"text-xs font-medium text-gray-600",children:pe?"Projets en cours":"En cours"})]}),e.jsxs("button",{onClick:()=>E("activity"),className:"bg-white/85 backdrop-blur-xl rounded-xl p-4 border border-white/60 shadow-glass hover:shadow-glass-hover hover:-translate-y-0.5 transition-all duration-200 active:scale-[0.99] text-left",children:[e.jsx("div",{className:"flex items-center gap-2 mb-2",children:e.jsx("div",{className:"w-8 h-8 bg-green-100 rounded-lg flex items-center justify-center",children:e.jsx(Qe,{size:16,className:"text-green-600"})})}),e.jsx("p",{className:"text-2xl font-black text-gray-900 mb-1",children:ze}),e.jsx("p",{className:"text-xs font-medium text-gray-600",children:pe?"Projets termins":"Termins"})]})]}),!pe&&e.jsxs("section",{children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsx("h2",{className:"text-lg font-black text-gray-900",children:"Mes projets"}),d.length>3&&e.jsxs("button",{onClick:()=>E("activity"),className:"text-sm text-brand-500 font-bold flex items-center gap-1.5 min-h-[32px] px-2",children:["Tout voir",e.jsx(vl,{size:16})]})]}),d.length===0?e.jsxs("div",{className:"bg-white/85 backdrop-blur-xl rounded-2xl p-10 text-center border border-white/60 shadow-glass",children:[e.jsx("div",{className:"w-16 h-16 bg-brand-100 rounded-2xl flex items-center justify-center mx-auto mb-4",children:e.jsx(I0,{size:28,className:"text-brand-500"})}),e.jsx("p",{className:"text-gray-900 font-bold mb-1 text-base",children:"Crez votre premier projet"}),e.jsx("p",{className:"text-sm text-gray-500",children:"Trouvez l'artisan parfait"})]}):e.jsx("div",{className:"space-y-3",children:d.slice(0,3).map((Q,be)=>{var ct,at;const Ee=Js[Q.status]||Js.open,Oe=((ct=Q.quotes)==null?void 0:ct.length)>0;return e.jsxs("button",{onClick:()=>{window.scrollTo({top:0,left:0,behavior:"instant"}),document.documentElement.scrollTop=0,document.body.scrollTop=0,i(`/projects/${Q.id}`)},className:"w-full bg-white/85 backdrop-blur-xl rounded-2xl p-5 border border-white/60 shadow-glass hover:shadow-glass-hover hover:-translate-y-0.5 transition-all duration-200 active:scale-[0.99] text-left min-h-[120px]",style:{animationDelay:`${be*50}ms`},children:[e.jsxs("div",{className:"flex items-start justify-between mb-3",children:[e.jsx("span",{className:"px-3 py-1.5 bg-brand-50 text-brand-700 text-xs font-bold rounded-lg",children:(at=Q.categories)==null?void 0:at.name}),e.jsxs("span",{className:`px-2.5 py-1.5 rounded-lg text-xs font-bold flex items-center gap-1.5 ${Ee.color}`,children:[Ee.icon,Ee.label]})]}),e.jsx("h3",{className:"font-bold text-gray-900 mb-3 line-clamp-2 text-base leading-tight",children:Q.title}),e.jsxs("div",{className:"flex items-center justify-between text-sm",children:[e.jsxs("span",{className:"text-gray-500 flex items-center gap-1.5",children:[e.jsx(mr,{size:16}),new Date(Q.created_at).toLocaleDateString("fr-FR",{day:"numeric",month:"short"})]}),Oe&&e.jsxs("span",{className:"text-purple-600 font-bold flex items-center gap-1.5",children:[e.jsx(et,{size:16}),Q.quotes.length," devis"]})]})]},Q.id)})})]})]}),g==="activity"&&e.jsxs("div",{className:"space-y-6 animate-in fade-in duration-300",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-xl font-black text-gray-900 tracking-tight",children:pe?"Projets":"Mes projets"}),e.jsx("p",{className:"text-sm text-gray-500 mt-0.5",children:pe?"Projets sur lesquels vous avez rpondu":"Vos projets et les devis reus"})]}),pe?e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"flex gap-2 overflow-x-auto pb-1 -mx-1 scrollbar-hide",children:[{id:"demandes",label:"Nouvelles demandes",badge:Le.length},{id:"devis",label:"Mes devis",badge:void 0},{id:"revisions_attente",label:"Rvisions en attente",badge:_.length},{id:"revisions_envoyees",label:"Rvisions envoyes",badge:M.length}].map(Q=>e.jsxs("button",{type:"button",onClick:()=>$(Q.id),className:`flex-shrink-0 px-4 py-2.5 rounded-xl text-sm font-bold transition-all duration-200 ${Y===Q.id?"bg-gradient-to-r from-brand-500 to-brand-600 text-white shadow-cta":"bg-white/90 backdrop-blur-sm text-gray-600 border border-gray-200 hover:border-brand-200"}`,children:[Q.label,Q.badge!=null&&Q.badge>0&&e.jsx("span",{className:"ml-1.5 px-1.5 py-0.5 rounded-full bg-white/20 text-[10px]",children:Q.badge})]},Q.id))}),Y==="demandes"&&e.jsx("div",{className:"space-y-3",children:Le.length===0?e.jsxs("div",{className:"bg-white/85 backdrop-blur-xl rounded-2xl p-10 text-center border border-white/60 shadow-glass",children:[e.jsx(Ht,{size:40,className:"mx-auto text-gray-300 mb-3"}),e.jsx("p",{className:"font-bold text-gray-800",children:"Aucune nouvelle demande"}),e.jsx("p",{className:"text-sm text-gray-500 mt-1",children:"Les demandes de votre catgorie apparatront ici et dans vos notifications"})]}):Le.map((Q,be)=>{var Ee;return e.jsxs("button",{type:"button",onClick:()=>{window.scrollTo({top:0,left:0,behavior:"instant"}),i(`/projects/${Q.id}`)},className:"w-full bg-white/85 backdrop-blur-xl rounded-2xl p-5 border border-white/60 shadow-glass hover:shadow-glass-hover hover:-translate-y-0.5 transition-all duration-200 active:scale-[0.99] text-left",style:{animationDelay:`${be*40}ms`},children:[e.jsx("span",{className:"px-2.5 py-1 bg-blue-100 text-blue-700 text-[10px] font-bold rounded-lg uppercase tracking-wide",children:"Nouvelle demande"}),e.jsx("span",{className:"px-2.5 py-1 bg-brand-50 text-brand-700 text-[10px] font-bold rounded-lg ml-2",children:(Ee=Q.categories)==null?void 0:Ee.name}),e.jsx("h3",{className:"font-black text-gray-900 text-base leading-snug line-clamp-2 mt-3 mb-2",children:Q.title}),e.jsxs("p",{className:"text-xs text-gray-500 flex items-center gap-1",children:[e.jsx(mr,{size:12}),new Date(Q.created_at).toLocaleDateString("fr-FR",{day:"numeric",month:"short"})]}),e.jsxs("span",{className:"inline-flex items-center gap-1 mt-2 text-sm font-bold text-brand-600",children:["Voir la demande ",e.jsx(da,{size:14})]})]},Q.id)})}),Y==="devis"&&e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"flex flex-wrap gap-2",children:["all","active","completed"].map(Q=>e.jsxs("button",{type:"button",onClick:()=>ye(Q),className:`px-3 py-1.5 rounded-lg text-xs font-bold ${fe===Q?"bg-brand-500 text-white":"bg-gray-100 text-gray-600"}`,children:[Q==="all"&&"Tous",Q==="active"&&"En cours",Q==="completed"&&"Termins"]},Q))}),je.length===0?e.jsxs("div",{className:"bg-white/85 backdrop-blur-xl rounded-2xl p-12 text-center border border-white/60 shadow-glass",children:[e.jsx(Ht,{size:24,className:"mx-auto text-gray-400 mb-4"}),e.jsx("p",{className:"font-bold text-gray-900 text-base",children:"Aucun devis"}),e.jsx("p",{className:"text-sm text-gray-500 mt-1",children:"Rpondez  des demandes pour les retrouver ici"})]}):e.jsx("div",{className:"space-y-3",children:je.map((Q,be)=>{var at,se,oe,ve,Te;const Ee=(at=Q.projects)==null?void 0:at.status,Oe=Js[Ee]||Js.pending,ct=(Js[Q.status]||Js.pending).label;return e.jsxs("button",{type:"button",onClick:()=>{window.scrollTo({top:0,left:0,behavior:"instant"}),i(`/projects/${Q.project_id}`)},className:"w-full bg-white/85 backdrop-blur-xl rounded-2xl p-5 border border-white/60 shadow-glass hover:shadow-glass-hover hover:-translate-y-0.5 transition-all duration-200 active:scale-[0.99] text-left",style:{animationDelay:`${be*40}ms`},children:[e.jsxs("div",{className:"flex items-start justify-between gap-3 mb-2",children:[e.jsx("span",{className:"px-2.5 py-1 bg-brand-50 text-brand-700 text-[10px] font-bold rounded-lg uppercase tracking-wide",children:((oe=(se=Q.projects)==null?void 0:se.categories)==null?void 0:oe.name)||"Projet"}),e.jsxs("span",{className:`px-2.5 py-1.5 rounded-xl text-xs font-bold flex items-center gap-1.5 shrink-0 ${Oe.color}`,children:[Oe.icon,Oe.label]})]}),e.jsx("h3",{className:"font-black text-gray-900 text-base leading-snug line-clamp-2 mb-3",children:(ve=Q.projects)==null?void 0:ve.title}),e.jsxs("div",{className:"flex items-center justify-between text-sm",children:[e.jsxs("span",{className:"text-gray-500",children:["Mon devis : ",e.jsx("span",{className:"font-semibold text-gray-700",children:ct}),"  ",(Te=Q.amount)==null?void 0:Te.toLocaleString("fr-FR")," FCFA"]}),e.jsx("span",{className:"text-xs text-gray-400",children:new Date(Q.created_at).toLocaleDateString("fr-FR",{day:"numeric",month:"short"})})]}),Q.status==="rejected"&&Q.rejection_reason&&e.jsx("p",{className:"mt-2 text-xs text-red-600 bg-red-50 rounded-lg px-3 py-2 line-clamp-2",children:Q.rejection_reason})]},Q.id)})})]}),Y==="revisions_attente"&&e.jsx("div",{className:"space-y-3",children:_.length===0?e.jsxs("div",{className:"bg-white/85 backdrop-blur-xl rounded-2xl p-10 text-center border border-white/60 shadow-glass",children:[e.jsx(qa,{size:32,className:"mx-auto text-gray-300 mb-3"}),e.jsx("p",{className:"font-bold text-gray-800",children:"Aucune rvision en attente"})]}):e.jsxs(e.Fragment,{children:[e.jsx("button",{type:"button",onClick:()=>i("/revisions"),className:"text-sm font-bold text-brand-600 hover:underline mb-2",children:"Voir tout sur la page Rvisions"}),_.map(Q=>{var be;return e.jsxs("div",{className:"bg-yellow-50 border border-yellow-200 rounded-2xl p-4",children:[e.jsx("p",{className:"text-sm font-bold text-gray-900 line-clamp-1",children:((be=Q.projects)==null?void 0:be.title)||"Projet"}),e.jsx("p",{className:"text-xs text-gray-600 mt-1 line-clamp-2",children:Q.client_comments}),e.jsx("button",{type:"button",onClick:()=>{var Oe;const Ee=Q.project_id||((Oe=Q.projects)==null?void 0:Oe.id);i(Ee?`/projects/${Ee}?revision=${Q.id}`:"/revisions")},className:"mt-3 w-full bg-gradient-to-br from-brand-400 to-brand-600 text-white font-bold py-2 rounded-xl text-sm shadow-cta hover:shadow-cta-hover active:scale-[0.99]",children:"Rpondre"})]},Q.id)})]})}),Y==="revisions_envoyees"&&e.jsx("div",{className:"space-y-3",children:M.length===0?e.jsxs("div",{className:"bg-white/85 backdrop-blur-xl rounded-2xl p-10 text-center border border-white/60 shadow-glass",children:[e.jsx(et,{size:32,className:"mx-auto text-gray-300 mb-3"}),e.jsx("p",{className:"font-bold text-gray-800",children:"Aucune rvision envoye"}),e.jsx("p",{className:"text-sm text-gray-500 mt-1",children:"Vos rponses aux demandes de rvision apparatront ici"})]}):M.map(Q=>{var be;return e.jsxs("button",{type:"button",onClick:()=>{var Oe;const Ee=Q.project_id||((Oe=Q.projects)==null?void 0:Oe.id);Ee&&i(`/projects/${Ee}?revision=${Q.id}`)},className:"w-full bg-white/85 backdrop-blur-xl rounded-2xl p-4 border border-white/60 shadow-glass hover:shadow-glass-hover hover:-translate-y-0.5 transition-all duration-200 text-left",children:[e.jsxs("div",{className:"flex items-center justify-between gap-2",children:[e.jsx("p",{className:"font-bold text-gray-900 text-sm line-clamp-1",children:((be=Q.projects)==null?void 0:be.title)||"Projet"}),e.jsx("span",{className:`px-2 py-0.5 rounded-lg text-[10px] font-bold ${Q.status==="accepted"?"bg-green-100 text-green-700":"bg-gray-100 text-gray-600"}`,children:Q.status==="accepted"?"Accepte":"Rponse envoye"})]}),Q.responded_at&&e.jsx("p",{className:"text-xs text-gray-500 mt-1",children:new Date(Q.responded_at).toLocaleDateString("fr-FR")})]},Q.id)})})]}):e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"flex flex-wrap gap-2",children:["all","active","completed"].map(Q=>e.jsxs("button",{type:"button",onClick:()=>ye(Q),className:`px-4 py-2 rounded-xl text-sm font-bold transition-all duration-200 ${fe===Q?"bg-gradient-to-r from-brand-500 to-brand-600 text-white shadow-cta":"bg-white/90 backdrop-blur-sm text-gray-600 border border-gray-200 hover:border-brand-200"}`,children:[Q==="all"&&"Tous",Q==="active"&&"En cours",Q==="completed"&&"Termins"]},Q))}),d.length===0?e.jsxs("div",{className:"bg-white/85 backdrop-blur-xl rounded-2xl p-12 text-center border border-white/60 shadow-glass",children:[e.jsx("div",{className:"w-14 h-14 bg-gray-100 rounded-2xl flex items-center justify-center mx-auto mb-4",children:e.jsx(Ht,{size:24,className:"text-gray-400"})}),e.jsx("p",{className:"font-bold text-gray-900 text-base",children:"Aucun projet"}),e.jsx("p",{className:"text-sm text-gray-500 mt-1",children:"Crez votre premier projet"})]}):_e.length===0?e.jsx("div",{className:"bg-white/85 backdrop-blur-xl rounded-2xl p-10 text-center border border-white/60 shadow-glass",children:e.jsx("p",{className:"text-gray-500 text-sm",children:"Aucun projet dans cette catgorie"})}):e.jsx("div",{className:"space-y-3",children:_e.map((Q,be)=>{var ct;const Ee=Js[Q.status]||Js.open,Oe=((ct=Q.quotes)==null?void 0:ct.length)??0;return e.jsxs("button",{type:"button",onClick:()=>{window.scrollTo({top:0,left:0,behavior:"instant"}),i(`/projects/${Q.id}`)},className:"w-full bg-white/85 backdrop-blur-xl rounded-2xl p-5 border border-white/60 shadow-glass hover:shadow-glass-hover hover:-translate-y-0.5 transition-all duration-200 text-left active:scale-[0.99]",style:{animationDelay:`${be*40}ms`},children:[e.jsxs("div",{className:"flex items-start justify-between gap-3 mb-2",children:[e.jsx("span",{className:"text-[10px] font-mono text-gray-500 bg-gray-50 px-2.5 py-1 rounded-lg uppercase tracking-wide",children:Q.project_number}),e.jsxs("span",{className:`px-2.5 py-1.5 rounded-xl text-xs font-bold flex items-center gap-1.5 shrink-0 ${Ee.color}`,children:[Ee.icon,Ee.label]})]}),e.jsx("h3",{className:"font-black text-gray-900 text-base leading-snug line-clamp-2 mb-3",children:Q.title}),e.jsxs("div",{className:"flex items-center justify-between text-sm",children:[e.jsxs("span",{className:"text-gray-500 flex items-center gap-1.5",children:[e.jsx(ga,{size:14,className:"shrink-0"}),Q.location||"Sngal"]}),Oe>0&&e.jsxs("span",{className:"text-brand-600 font-bold flex items-center gap-1.5",children:[e.jsx(et,{size:14}),Oe," devis"]})]})]},Q.id)})})]})]}),g==="profile"&&e.jsxs("div",{className:"space-y-6 animate-in fade-in duration-300",children:[e.jsxs("div",{className:"bg-white rounded-3xl p-6 border border-gray-100 shadow-sm text-center",children:[e.jsxs("div",{className:"relative inline-block mb-4",children:[e.jsx("div",{className:"w-24 h-24 rounded-3xl bg-gradient-to-br from-brand-400 to-brand-600 p-1 shadow-lg shadow-brand-200/50",children:e.jsx("div",{className:"w-full h-full rounded-3xl bg-white flex items-center justify-center overflow-hidden",children:o.avatar_url?e.jsx("img",{src:o.avatar_url,alt:"",className:"w-full h-full object-cover"}):e.jsx(ot,{size:40,className:"text-brand-500"})})}),pe&&Ke&&e.jsx("div",{className:"absolute -bottom-1 -right-1 w-8 h-8 bg-green-500 rounded-xl flex items-center justify-center border-3 border-white shadow-lg",children:e.jsx(aa,{size:16,className:"text-white",strokeWidth:3})})]}),e.jsx("h2",{className:"text-xl font-black text-gray-900 mb-1",children:o.full_name}),e.jsx("p",{className:"text-brand-600 font-bold mb-1",children:pe?R||"Artisan":"Client"}),e.jsxs("p",{className:"text-sm text-gray-400 flex items-center justify-center gap-1",children:[e.jsx(ga,{size:14}),o.location||"Sngal"]}),o.member_id&&e.jsx("div",{className:"mt-4 inline-block px-4 py-2 bg-gray-100 rounded-xl",children:e.jsx("span",{className:"text-xs font-mono text-gray-500",children:o.member_id})}),pe&&e.jsx("div",{className:"mt-6 space-y-4",children:e.jsxs("button",{onClick:We,disabled:C,className:`w-full flex items-center justify-between px-5 py-4 rounded-xl transition-all ${q?"bg-green-50 border-2 border-green-200":"bg-gray-100 border-2 border-gray-200"}`,children:[e.jsxs("div",{className:"flex items-center gap-3",children:[C?e.jsx(ma,{size:20,className:"animate-spin text-gray-500"}):q?e.jsx(Sp,{size:28,className:"text-green-500"}):e.jsx(_p,{size:28,className:"text-gray-400"}),e.jsxs("div",{className:"text-left",children:[e.jsx("p",{className:`font-bold text-sm ${q?"text-green-700":"text-gray-600"}`,children:q?"Disponible":"Indisponible"}),e.jsx("p",{className:"text-xs text-gray-500",children:q?"Vous recevez les demandes":"Vous ne recevez pas de demandes"})]})]}),e.jsx("div",{className:`w-3 h-3 rounded-full ${q?"bg-green-500 animate-pulse":"bg-gray-300"}`})]})})]}),pe&&e.jsxs("button",{onClick:()=>i("/credits"),className:"flex items-center gap-1 px-3 py-1.5 rounded-xl bg-purple-50 text-purple-700 text-xs font-semibold hover:bg-purple-100 transition-colors",children:[e.jsx(Na,{size:14}),z!==null?`${z} crdits`:"Mes crdits"]})]})]}),e.jsx("nav",{className:"fixed bottom-0 left-0 right-0 bg-white/95 backdrop-blur-xl border-t border-gray-200/50 z-30 safe-area-pb shadow-[0_-4px_20px_rgba(0,0,0,0.08)]",children:e.jsxs("div",{className:"max-w-lg mx-auto px-2 py-3.5 flex items-center justify-around bg-white border-t border-gray-100 overflow-x-auto",children:[[{id:"home",icon:xr,label:"Accueil"},{id:"activity",icon:pe?al:Ht,label:"Projets",badge:ue>0?ue:void 0}].map(Q=>{const be=Q.icon,Ee=g===Q.id;return e.jsxs("button",{onClick:()=>E(Q.id),className:`relative flex flex-col items-center justify-center gap-1.5 py-3 px-3 min-w-[70px] rounded-2xl transition-all duration-200 flex-shrink-0 ${Ee?"text-brand-600":"text-gray-400 hover:text-gray-600"}`,"aria-label":Q.label,"aria-current":Ee?"page":void 0,children:[Ee&&e.jsx("div",{className:"absolute inset-0 bg-gradient-to-b from-brand-50 to-transparent rounded-2xl -z-10 animate-in fade-in duration-200"}),e.jsxs("div",{className:`relative ${Ee?"scale-110":"scale-100"} transition-transform duration-200`,children:[e.jsx(be,{size:22,strokeWidth:Ee?2.5:2,className:Ee?"text-brand-600":"text-gray-400"}),Q.badge&&Q.badge>0&&e.jsx("span",{className:`absolute -top-1.5 -right-1.5 min-w-[18px] h-[18px] flex items-center justify-center px-1 rounded-full text-[10px] font-black text-white ${Ee?"bg-brand-500":"bg-red-500"} animate-pulse shadow-md`,children:Q.badge>9?"9+":Q.badge})]}),e.jsx("span",{className:`text-[10px] font-bold transition-all duration-200 ${Ee?"text-brand-600 scale-105":"text-gray-400 scale-100"}`,children:Q.label}),Ee&&e.jsx("div",{className:"absolute -bottom-1 left-1/2 transform -translate-x-1/2 w-8 h-1 bg-brand-500 rounded-full shadow-md shadow-brand-500/50"})]},Q.id)}),e.jsxs("button",{type:"button",onClick:()=>i("/artisans"),className:"relative flex flex-col items-center justify-center gap-1.5 py-3 px-3 min-w-[70px] rounded-2xl transition-all duration-200 flex-shrink-0 text-gray-400 hover:text-gray-600","aria-label":"Recherche",children:[e.jsx("div",{className:"relative scale-100 transition-transform duration-200",children:e.jsx(xa,{size:22,strokeWidth:2,className:"text-gray-400"})}),e.jsx("span",{className:"text-[10px] font-bold transition-all duration-200 text-gray-400 scale-100",children:"Recherche"})]}),e.jsxs("button",{type:"button",onClick:()=>i("/conversations"),className:"relative flex flex-col items-center justify-center gap-1.5 py-3 px-3 min-w-[70px] rounded-2xl transition-all duration-200 flex-shrink-0 text-gray-400 hover:text-gray-600","aria-label":"Messagerie",children:[e.jsxs("div",{className:"relative scale-100 transition-transform duration-200",children:[e.jsx(fr,{size:22,strokeWidth:2,className:"text-gray-400"}),N>0&&e.jsx("span",{className:"absolute -top-1 -right-1 min-w-[18px] h-[18px] px-1 bg-red-500 text-white text-[10px] font-bold rounded-full flex items-center justify-center border-2 border-white",children:N>9?"9+":N})]}),e.jsx("span",{className:"text-[10px] font-bold transition-all duration-200 text-gray-400 scale-100",children:"Messages"})]}),e.jsxs("button",{type:"button",onClick:()=>i("/invoices"),className:"relative flex flex-col items-center justify-center gap-1.5 py-3 px-3 min-w-[70px] rounded-2xl transition-all duration-200 flex-shrink-0 text-gray-400 hover:text-gray-600","aria-label":"Finances",children:[e.jsx("div",{className:"relative scale-100 transition-transform duration-200",children:e.jsx(Nd,{size:22,strokeWidth:2,className:"text-gray-400"})}),e.jsx("span",{className:"text-[10px] font-bold transition-all duration-200 text-gray-400 scale-100",children:"Finances"})]})]})})]})}function Ob(){const i=ht(),{user:u}=Nt(),{profile:f}=It(),[o,x]=c.useState("intro"),[y,N]=c.useState(!1),[h,g]=c.useState(null),[E,d]=c.useState(null),[v,b]=c.useState(null),[w,_]=c.useState("cni"),[L,M]=c.useState(null),[D,U]=c.useState(""),[J,F]=c.useState(null),[G,Z]=c.useState(""),X=async(q,T)=>{try{const C=q.name.split(".").pop(),B=`${u==null?void 0:u.id}/${T}/${Date.now()}.${C}`,{error:z}=await j.storage.from("photos").upload(B,q);if(z)throw z;const{data:S}=j.storage.from("photos").getPublicUrl(B);return(S==null?void 0:S.publicUrl)||null}catch(C){return console.error("Upload error:",C),null}},R=async(q,T,C)=>{var S;const B=(S=q.target.files)==null?void 0:S[0];if(!B)return;N(!0);const z=await X(B,C);T(z),N(!1)},ae=async()=>{N(!0),g(null);try{const{error:q}=await j.from("verification_documents").upsert({artisan_id:u==null?void 0:u.id,selfie_url:E,id_card_url:v,id_card_type:w,ninea_url:L,ninea_number:D||null,registre_commerce_url:J,registre_commerce_number:G||null,status:"pending"});if(q)throw q;const{error:T}=await j.from("artisans").update({verification_status:"pending"}).eq("id",u==null?void 0:u.id);if(T)throw T;x("review")}catch(q){g(q.message||"Erreur lors de la soumission")}N(!1)},ge=[{id:"intro",title:"Introduction"},{id:"selfie",title:"Photo"},{id:"id",title:"Identit"},{id:"business",title:"Documents"}],k=ge.findIndex(q=>q.id===o);return e.jsxs("div",{className:"min-h-screen bg-gray-50",children:[e.jsxs("header",{className:"bg-white border-b border-gray-100 sticky top-0 z-10",children:[e.jsxs("div",{className:"max-w-lg mx-auto px-4 py-4 flex items-center gap-4",children:[e.jsx("button",{onClick:()=>{var q;return o==="intro"||o==="review"?i("/dashboard"):x((q=ge[k-1])==null?void 0:q.id)},className:"w-10 h-10 rounded-full bg-gray-100 flex items-center justify-center text-gray-600",children:e.jsx(Wt,{size:20})}),e.jsxs("div",{className:"flex-1",children:[e.jsx("h1",{className:"font-bold text-gray-900",children:"Vrification du compte"}),o!=="review"&&o!=="intro"&&e.jsxs("p",{className:"text-xs text-gray-400",children:["tape ",k," sur ",ge.length-1]})]})]}),o!=="intro"&&o!=="review"&&e.jsx("div",{className:"h-1 bg-gray-100",children:e.jsx("div",{className:"h-full bg-brand-500 transition-all duration-300",style:{width:`${k/(ge.length-1)*100}%`}})})]}),e.jsxs("main",{className:"max-w-lg mx-auto px-4 py-8",children:[o==="intro"&&e.jsxs("div",{className:"space-y-6 animate-in fade-in duration-300",children:[e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"w-20 h-20 bg-brand-100 rounded-full mx-auto mb-6 flex items-center justify-center",children:e.jsx(Gt,{size:40,className:"text-brand-500"})}),e.jsx("h2",{className:"text-2xl font-bold text-gray-900 mb-2",children:"Devenez certifi"}),e.jsx("p",{className:"text-gray-500",children:"Gagnez en confiance et accdez  plus d'avantages"})]}),e.jsxs("div",{className:"bg-white rounded-2xl p-6 border border-gray-100 space-y-4",children:[e.jsx("h3",{className:"font-bold text-gray-900",children:"Avantages de la certification"}),e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx(Qe,{size:20,className:"text-green-500 mt-0.5"}),e.jsxs("div",{children:[e.jsx("p",{className:"font-medium text-gray-900 text-sm",children:"Badge vrifi"}),e.jsx("p",{className:"text-xs text-gray-400",children:"Inspirez confiance aux clients"})]})]}),e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx(Qe,{size:20,className:"text-green-500 mt-0.5"}),e.jsxs("div",{children:[e.jsx("p",{className:"font-medium text-gray-900 text-sm",children:"Avances sur paiement"}),e.jsx("p",{className:"text-xs text-gray-400",children:"Recevez jusqu' 40% d'avance"})]})]}),e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx(Qe,{size:20,className:"text-green-500 mt-0.5"}),e.jsxs("div",{children:[e.jsx("p",{className:"font-medium text-gray-900 text-sm",children:"Crdit fournisseur"}),e.jsx("p",{className:"text-xs text-gray-400",children:"Accdez aux matriaux  crdit"})]})]})]}),e.jsxs("div",{className:"bg-white rounded-2xl p-6 border border-gray-100",children:[e.jsx("h3",{className:"font-bold text-gray-900 mb-4",children:"Documents requis"}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"flex items-center gap-3 text-sm",children:[e.jsx(un,{size:18,className:"text-gray-400"}),e.jsx("span",{className:"text-gray-600",children:"Photo de vous (selfie)"})]}),e.jsxs("div",{className:"flex items-center gap-3 text-sm",children:[e.jsx(Na,{size:18,className:"text-gray-400"}),e.jsx("span",{className:"text-gray-600",children:"Pice d'identit (CNI, Passeport)"})]}),e.jsxs("div",{className:"flex items-center gap-3 text-sm",children:[e.jsx(et,{size:18,className:"text-gray-400"}),e.jsx("span",{className:"text-gray-600",children:"NINEA (optionnel)"})]}),e.jsxs("div",{className:"flex items-center gap-3 text-sm",children:[e.jsx(Qa,{size:18,className:"text-gray-400"}),e.jsx("span",{className:"text-gray-600",children:"Registre de commerce (optionnel)"})]})]})]}),e.jsx("button",{onClick:()=>x("selfie"),className:"w-full bg-brand-500 text-white rounded-2xl py-4 font-bold hover:bg-brand-600 transition-colors",children:"Commencer la vrification"})]}),o==="selfie"&&e.jsxs("div",{className:"space-y-6 animate-in fade-in duration-300",children:[e.jsxs("div",{className:"text-center",children:[e.jsx("h2",{className:"text-xl font-bold text-gray-900 mb-2",children:"Votre photo"}),e.jsx("p",{className:"text-gray-500 text-sm",children:"Prenez une photo claire de votre visage"})]}),e.jsxs("div",{className:"relative",children:[E?e.jsx("div",{className:"aspect-square rounded-2xl overflow-hidden bg-gray-100",children:e.jsx("img",{src:E,alt:"Selfie",className:"w-full h-full object-cover"})}):e.jsxs("label",{className:"aspect-square rounded-2xl border-2 border-dashed border-gray-200 bg-white flex flex-col items-center justify-center cursor-pointer hover:border-brand-300 hover:bg-brand-50/50 transition-all",children:[e.jsx("input",{type:"file",accept:"image/*",capture:"user",onChange:q=>R(q,d,"verification/selfie"),className:"hidden"}),y?e.jsx(ma,{size:40,className:"text-brand-500 animate-spin"}):e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"w-20 h-20 bg-gray-100 rounded-full flex items-center justify-center mb-4",children:e.jsx(ot,{size:40,className:"text-gray-400"})}),e.jsx("p",{className:"font-bold text-gray-700",children:"Prendre une photo"}),e.jsx("p",{className:"text-xs text-gray-400 mt-1",children:"ou choisir un fichier"})]})]}),E&&e.jsx("button",{onClick:()=>d(null),className:"absolute top-2 right-2 w-8 h-8 bg-red-500 text-white rounded-full flex items-center justify-center",children:""})]}),e.jsx("button",{onClick:()=>x("id"),disabled:!E,className:"w-full bg-brand-500 text-white rounded-2xl py-4 font-bold hover:bg-brand-600 transition-colors disabled:opacity-50 disabled:cursor-not-allowed",children:"Continuer"})]}),o==="id"&&e.jsxs("div",{className:"space-y-6 animate-in fade-in duration-300",children:[e.jsxs("div",{className:"text-center",children:[e.jsx("h2",{className:"text-xl font-bold text-gray-900 mb-2",children:"Pice d'identit"}),e.jsx("p",{className:"text-gray-500 text-sm",children:"Photo recto de votre document"})]}),e.jsx("div",{className:"flex gap-2",children:[{value:"cni",label:"CNI"},{value:"passport",label:"Passeport"},{value:"permis",label:"Permis"}].map(q=>e.jsx("button",{onClick:()=>_(q.value),className:`flex-1 py-3 rounded-xl font-bold text-sm transition-all ${w===q.value?"bg-brand-500 text-white":"bg-white border border-gray-200 text-gray-600"}`,children:q.label},q.value))}),e.jsxs("div",{className:"relative",children:[v?e.jsx("div",{className:"aspect-video rounded-2xl overflow-hidden bg-gray-100",children:e.jsx("img",{src:v,alt:"ID Card",className:"w-full h-full object-cover"})}):e.jsxs("label",{className:"aspect-video rounded-2xl border-2 border-dashed border-gray-200 bg-white flex flex-col items-center justify-center cursor-pointer hover:border-brand-300 hover:bg-brand-50/50 transition-all",children:[e.jsx("input",{type:"file",accept:"image/*",onChange:q=>R(q,b,"verification/id"),className:"hidden"}),y?e.jsx(ma,{size:40,className:"text-brand-500 animate-spin"}):e.jsxs(e.Fragment,{children:[e.jsx(Na,{size:40,className:"text-gray-400 mb-3"}),e.jsx("p",{className:"font-bold text-gray-700",children:"Ajouter le document"})]})]}),v&&e.jsx("button",{onClick:()=>b(null),className:"absolute top-2 right-2 w-8 h-8 bg-red-500 text-white rounded-full flex items-center justify-center",children:""})]}),e.jsx("button",{onClick:()=>x("business"),disabled:!v,className:"w-full bg-brand-500 text-white rounded-2xl py-4 font-bold hover:bg-brand-600 transition-colors disabled:opacity-50 disabled:cursor-not-allowed",children:"Continuer"})]}),o==="business"&&e.jsxs("div",{className:"space-y-6 animate-in fade-in duration-300",children:[e.jsxs("div",{className:"text-center",children:[e.jsx("h2",{className:"text-xl font-bold text-gray-900 mb-2",children:"Documents professionnels"}),e.jsx("p",{className:"text-gray-500 text-sm",children:"Optionnel mais recommand"})]}),e.jsxs("div",{className:"bg-white rounded-2xl p-4 border border-gray-100 space-y-4",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(et,{size:20,className:"text-gray-400"}),e.jsx("span",{className:"font-bold text-gray-900",children:"NINEA"})]}),e.jsx("input",{type:"text",value:D,onChange:q=>U(q.target.value),placeholder:"Numro NINEA",className:"w-full rounded-xl border border-gray-200 px-4 py-3 focus:border-brand-500 focus:outline-none"}),L?e.jsxs("div",{className:"relative aspect-video rounded-xl overflow-hidden bg-gray-100",children:[e.jsx("img",{src:L,alt:"NINEA",className:"w-full h-full object-cover"}),e.jsx("button",{onClick:()=>M(null),className:"absolute top-2 right-2 w-6 h-6 bg-red-500 text-white rounded-full text-xs",children:""})]}):e.jsxs("label",{className:"block rounded-xl border border-dashed border-gray-200 p-4 text-center cursor-pointer hover:border-brand-300 transition-colors",children:[e.jsx("input",{type:"file",accept:"image/*",onChange:q=>R(q,M,"verification/ninea"),className:"hidden"}),e.jsx(hr,{size:20,className:"mx-auto text-gray-400 mb-1"}),e.jsx("p",{className:"text-sm text-gray-500",children:"Ajouter le document"})]})]}),e.jsxs("div",{className:"bg-white rounded-2xl p-4 border border-gray-100 space-y-4",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(Qa,{size:20,className:"text-gray-400"}),e.jsx("span",{className:"font-bold text-gray-900",children:"Registre de Commerce"})]}),e.jsx("input",{type:"text",value:G,onChange:q=>Z(q.target.value),placeholder:"Numro RC",className:"w-full rounded-xl border border-gray-200 px-4 py-3 focus:border-brand-500 focus:outline-none"}),J?e.jsxs("div",{className:"relative aspect-video rounded-xl overflow-hidden bg-gray-100",children:[e.jsx("img",{src:J,alt:"RC",className:"w-full h-full object-cover"}),e.jsx("button",{onClick:()=>F(null),className:"absolute top-2 right-2 w-6 h-6 bg-red-500 text-white rounded-full text-xs",children:""})]}):e.jsxs("label",{className:"block rounded-xl border border-dashed border-gray-200 p-4 text-center cursor-pointer hover:border-brand-300 transition-colors",children:[e.jsx("input",{type:"file",accept:"image/*",onChange:q=>R(q,F,"verification/rc"),className:"hidden"}),e.jsx(hr,{size:20,className:"mx-auto text-gray-400 mb-1"}),e.jsx("p",{className:"text-sm text-gray-500",children:"Ajouter le document"})]})]}),h&&e.jsxs("div",{className:"bg-red-50 border border-red-200 rounded-xl p-4 flex items-start gap-3",children:[e.jsx(qa,{size:20,className:"text-red-500 flex-shrink-0"}),e.jsx("p",{className:"text-sm text-red-600",children:h})]}),e.jsx("button",{onClick:ae,disabled:y,className:"w-full bg-brand-500 text-white rounded-2xl py-4 font-bold hover:bg-brand-600 transition-colors disabled:opacity-50 flex items-center justify-center gap-2",children:y?e.jsx(ma,{size:20,className:"animate-spin"}):"Soumettre la vrification"})]}),o==="review"&&e.jsxs("div",{className:"space-y-6 animate-in fade-in zoom-in duration-500 text-center",children:[e.jsx("div",{className:"w-24 h-24 bg-green-100 rounded-full mx-auto flex items-center justify-center",children:e.jsx(Qe,{size:48,className:"text-green-500"})}),e.jsx("h2",{className:"text-2xl font-bold text-gray-900",children:"Demande envoye !"}),e.jsx("p",{className:"text-gray-500",children:"Nous examinons vos documents. Vous recevrez une notification une fois la vrification termine."}),e.jsx("div",{className:"bg-blue-50 rounded-2xl p-4",children:e.jsx("p",{className:"text-sm text-blue-600",children:"Dlai estim : 24-48 heures"})}),e.jsx("button",{onClick:()=>i("/dashboard"),className:"w-full bg-gray-900 text-white rounded-2xl py-4 font-bold hover:bg-gray-800 transition-colors",children:"Retour  l'accueil"})]})]})]})}function Vb({artisanId:i}){const{showSuccess:u,showError:f}=sa(),[o,x]=c.useState([]),[y,N]=c.useState(!1),[h,g]=c.useState(null),[E,d]=c.useState(!1),[v,b]=c.useState("chambre"),[w,_]=c.useState(""),[L,M]=c.useState(""),[D,U]=c.useState(null),[J,F]=c.useState([]),[G,Z]=c.useState("");c.useEffect(()=>{i&&(X(),R())},[i]);const X=async()=>{try{const{data:C,error:B}=await j.from("artisan_affiliations").select("*").eq("artisan_id",i).order("created_at",{ascending:!1});if(B)throw B;x(C||[])}catch(C){console.error("Error loading affiliations:",C),f("Erreur lors du chargement des affiliations")}},R=async()=>{try{const{data:C,error:B}=await j.from("chambres_metier").select("id, name, region").eq("is_active",!0).order("name");if(B)throw B;F(C||[])}catch(C){console.error("Error loading chambres:",C)}},ae=async C=>{try{const B=C.name.split(".").pop(),S=`affiliations/${`${i}/${Date.now()}.${B}`}`,{error:V}=await j.storage.from("documents").upload(S,C,{upsert:!1});if(V)throw V;const{data:le}=j.storage.from("documents").getPublicUrl(S);return le.publicUrl}catch(B){throw console.error("Error uploading certificate:",B),B}},ge=async C=>{if(C.preventDefault(),!!i){N(!0),g("certificate");try{let B=null;D&&(B=await ae(D));let z=w;if(v==="chambre"&&G){const V=J.find(le=>le.id===G);z=(V==null?void 0:V.name)||""}const{error:S}=await j.from("artisan_affiliations").insert({artisan_id:i,affiliation_type:v,affiliation_name:z||null,affiliation_number:L||null,certificate_url:B,chambre_id:v==="chambre"&&G||null,status:"pending"});if(S)throw S;u("Affiliation soumise avec succs. Elle sera vrifie par un administrateur."),d(!1),k(),X()}catch(B){console.error("Error submitting affiliation:",B),f(B.message||"Erreur lors de la soumission de l'affiliation")}finally{N(!1),g(null)}}},k=()=>{b("chambre"),_(""),M(""),U(null),Z("")},q=C=>{switch(C){case"verified":return e.jsxs("span",{className:"inline-flex items-center gap-1 px-3 py-1 rounded-full bg-green-100 text-green-700 text-xs font-bold",children:[e.jsx(aa,{size:14}),"Vrifie"]});case"rejected":return e.jsxs("span",{className:"inline-flex items-center gap-1 px-3 py-1 rounded-full bg-red-100 text-red-700 text-xs font-bold",children:[e.jsx(el,{size:14}),"Rejete"]});default:return e.jsxs("span",{className:"inline-flex items-center gap-1 px-3 py-1 rounded-full bg-yellow-100 text-yellow-700 text-xs font-bold",children:[e.jsx(St,{size:14}),"En attente"]})}},T=C=>{switch(C){case"chambre":return"Chambre de Mtier";case"incubateur":return"Incubateur";case"sae":return"SAE";case"autre":return"Autre organisme";default:return C}};return e.jsxs("div",{className:"space-y-6",children:[e.jsx("div",{className:"bg-blue-50 rounded-xl p-4 mb-6",children:e.jsx("p",{className:"text-sm text-blue-700 font-medium",children:" Les affiliations avec des chambres de mtier, incubateurs ou SAE renforcent votre crdibilit auprs des clients."})}),o.length>0&&e.jsx("div",{className:"space-y-3 mb-6",children:o.map(C=>e.jsxs("div",{className:"bg-white border-2 border-gray-100 rounded-xl p-4",children:[e.jsxs("div",{className:"flex items-start justify-between mb-2",children:[e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[e.jsx(Qa,{size:18,className:"text-brand-500"}),e.jsx("span",{className:"font-bold text-gray-900",children:T(C.affiliation_type)})]}),C.affiliation_name&&e.jsx("p",{className:"text-sm text-gray-600 mb-1",children:C.affiliation_name}),C.affiliation_number&&e.jsxs("p",{className:"text-xs text-gray-500",children:["N ",C.affiliation_number]})]}),q(C.status)]}),C.rejection_reason&&e.jsxs("p",{className:"text-xs text-red-600 mt-2 bg-red-50 rounded p-2",children:["Raison du rejet : ",C.rejection_reason]}),C.certificate_url&&e.jsxs("a",{href:C.certificate_url,target:"_blank",rel:"noopener noreferrer",className:"inline-flex items-center gap-1 text-xs text-brand-600 hover:text-brand-700 mt-2",children:[e.jsx(et,{size:14}),"Voir le certificat"]})]},C.id))}),E?e.jsxs("form",{onSubmit:ge,className:"bg-white border-2 border-gray-200 rounded-xl p-6 space-y-4",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsx("h3",{className:"font-black text-gray-900",children:"Nouvelle affiliation"}),e.jsx("button",{type:"button",onClick:()=>{d(!1),k()},className:"text-gray-400 hover:text-gray-600",children:e.jsx(Ze,{size:20})})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-xs font-bold text-gray-500 uppercase tracking-wider mb-2",children:["Type d'organisme ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsxs("select",{value:v,onChange:C=>{b(C.target.value),Z(""),_("")},className:"w-full rounded-xl border border-gray-200 px-4 py-3 focus:border-brand-500 focus:outline-none bg-white",required:!0,children:[e.jsx("option",{value:"chambre",children:"Chambre de Mtier"}),e.jsx("option",{value:"incubateur",children:"Incubateur"}),e.jsx("option",{value:"sae",children:"SAE (Structure d'Accompagnement  l'Entrepreneuriat)"}),e.jsx("option",{value:"autre",children:"Autre organisme"})]})]}),v==="chambre"&&e.jsxs("div",{children:[e.jsxs("label",{className:"block text-xs font-bold text-gray-500 uppercase tracking-wider mb-2",children:["Chambre de Mtier ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsxs("select",{value:G,onChange:C=>Z(C.target.value),className:"w-full rounded-xl border border-gray-200 px-4 py-3 focus:border-brand-500 focus:outline-none bg-white",required:!0,children:[e.jsx("option",{value:"",children:"Slectionnez une chambre"}),J.map(C=>e.jsxs("option",{value:C.id,children:[C.name," (",C.region,")"]},C.id))]})]}),v!=="chambre"&&e.jsxs("div",{children:[e.jsxs("label",{className:"block text-xs font-bold text-gray-500 uppercase tracking-wider mb-2",children:["Nom de l'organisme ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx("input",{type:"text",value:w,onChange:C=>_(C.target.value),className:"w-full rounded-xl border border-gray-200 px-4 py-3 focus:border-brand-500 focus:outline-none bg-white",placeholder:"Ex: Incubateur Tech Hub Dakar",required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-bold text-gray-500 uppercase tracking-wider mb-2",children:"Numro d'affiliation / Certificat"}),e.jsx("input",{type:"text",value:L,onChange:C=>M(C.target.value),className:"w-full rounded-xl border border-gray-200 px-4 py-3 focus:border-brand-500 focus:outline-none bg-white",placeholder:"Ex: CM-DKR-2024-001"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-bold text-gray-500 uppercase tracking-wider mb-2",children:"Certificat d'affiliation (optionnel)"}),e.jsxs("div",{className:"relative",children:[e.jsx("input",{type:"file",accept:"image/*,.pdf",onChange:C=>{var z;const B=(z=C.target.files)==null?void 0:z[0];if(B){if(B.size>5*1024*1024){f("Le fichier ne doit pas dpasser 5MB");return}U(B)}},className:"absolute inset-0 w-full h-full opacity-0 cursor-pointer z-10"}),e.jsx("div",{className:"border-2 border-dashed border-gray-200 rounded-xl p-4 text-center",children:D?e.jsxs("div",{className:"flex items-center justify-center gap-2 text-sm text-gray-700",children:[e.jsx(et,{size:18,className:"text-brand-500"}),e.jsx("span",{className:"font-medium",children:D.name}),e.jsx("button",{type:"button",onClick:C=>{C.stopPropagation(),U(null)},className:"text-red-500 hover:text-red-700",children:e.jsx(Ze,{size:16})})]}):e.jsxs("div",{className:"flex flex-col items-center gap-2",children:[e.jsx(hr,{size:24,className:"text-gray-400"}),e.jsx("p",{className:"text-sm font-medium text-gray-600",children:"Cliquez pour uploader"}),e.jsx("p",{className:"text-xs text-gray-400",children:"JPG, PNG, PDF (max 5MB)"})]})})]})]}),e.jsxs("div",{className:"flex gap-3 pt-2",children:[e.jsx("button",{type:"button",onClick:()=>{d(!1),k()},className:"flex-1 px-4 py-3 bg-gray-100 text-gray-700 rounded-xl font-bold hover:bg-gray-200 transition-colors",children:"Annuler"}),e.jsx("button",{type:"submit",disabled:y,className:"flex-1 px-4 py-3 bg-brand-500 text-white rounded-xl font-bold hover:bg-brand-600 transition-colors disabled:opacity-50 disabled:cursor-not-allowed flex items-center justify-center gap-2",children:y&&h?e.jsxs(e.Fragment,{children:[e.jsx(ma,{size:18,className:"animate-spin"}),"Upload..."]}):"Soumettre"})]})]}):e.jsxs("button",{type:"button",onClick:()=>d(!0),className:"w-full border-2 border-dashed border-gray-300 rounded-xl p-6 text-center hover:border-brand-400 hover:bg-brand-50/50 transition-colors",children:[e.jsx(Qa,{size:24,className:"text-gray-400 mx-auto mb-2"}),e.jsx("p",{className:"font-bold text-gray-700",children:"Ajouter une affiliation"}),e.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Chambre de mtier, incubateur, SAE..."})]})]})}const Ti=10,Li=5,fd=5,gd=50,Xi={Dakar:{Dakar:["Plateau","Mdina","Fass-Colobane-Gueule Tape","Yoff","Ngor","Ouakam","Grand Dakar","Parcelles Assainies"],Pikine:["Guinaw Rails Nord","Guinaw Rails Sud","Thiaroye","Keur Massar","Dalifort"],Rufisque:["Rufisque Est","Rufisque Ouest","Bargny","Sbikhotane"],Gudiawaye:["Golf Sud","Sam Notaire","Ndiarme Limamoulaye"],"Keur Massar":["Keur Massar Nord","Keur Massar Sud"]},This:{"This Nord":["This Ville","Grand Standing"],"This Sud":["Mbour 1","Mbour 2"],Mbour:["Mbour Ville","Saly","Ngaparou","Somone"]},Diourbel:{Diourbel:["Diourbel Ville"],Mback:["Mback Ville","Touba"]},Fatick:{Fatick:["Fatick Ville"],Foundiougne:["Foundiougne Ville"]},Kaolack:{Kaolack:["Kaolack Ville"],Nioro:["Nioro Ville"]},Kaffrine:{Kaffrine:["Kaffrine Ville"]},Kolda:{Kolda:["Kolda Ville"]},Ziguinchor:{Ziguinchor:["Ziguinchor Ville"]},Sdhiou:{Sdhiou:["Sdhiou Ville"]},"Saint-Louis":{"Saint-Louis":["Saint-Louis Ville"],Podor:["Podor Ville"],Dagana:["Dagana Ville"]},Louga:{Louga:["Louga Ville"]},Matam:{Matam:["Matam Ville"]},Tambacounda:{Tambacounda:["Tambacounda Ville"]},Kdougou:{Kdougou:["Kdougou Ville"]}},Fb=Object.keys(Xi),Bb=i=>!i||!Xi[i]?[]:Object.keys(Xi[i]),Hb=(i,u)=>{var f;return!i||!u?[]:((f=Xi[i])==null?void 0:f[u])??[]};function Gb(){var He;const i=ht(),[u]=_l(),f=Nt(),{user:o}=f,{profile:x,loading:y,upsertProfile:N}=It(),{categories:h}=Pi(),{error:g}=sa(),[E,d]=c.useState(!1),[v,b]=c.useState(!1),[w,_]=c.useState(!1),[L,M]=c.useState(!1),[D,U]=c.useState(!1),[J,F]=c.useState(!1),[G,Z]=c.useState(!1),[X,R]=c.useState(!1),[ae,ge]=c.useState(1),[k,q]=c.useState(!1);c.useEffect(()=>(q(!0),()=>q(!1)),[]);const T=u.get("role"),C=u.get("mode")==="onboarding",[B,z]=c.useState(""),[S,V]=c.useState(""),[le,he]=c.useState(""),[Ne,fe]=c.useState(""),[ye,Y]=c.useState(""),[$,ce]=c.useState(""),[we,We]=c.useState(null),[pe,Ye]=c.useState(null),[st,Ke]=c.useState(""),[ft,_e]=c.useState(""),[je,Le]=c.useState([]),[ue,Ae]=c.useState([]),[ze,Ge]=c.useState(""),[xe,Se]=c.useState(!1),Pe=typeof window<"u"?localStorage.getItem("mbourake_pending_role"):null,Xe=T==="artisan"||Pe==="artisan"||(x==null?void 0:x.role)==="artisan",Lt=Xe?[{id:1,title:"Informations personnelles",icon:ot},{id:2,title:"Localisation",icon:ga},{id:3,title:"Informations professionnelles",icon:Ht},{id:4,title:"Portfolio",icon:tl},{id:5,title:"Affiliation",icon:Qa}]:[{id:1,title:"Informations personnelles",icon:ot},{id:2,title:"Localisation",icon:ga}],qt=Lt.length,kt=c.useRef(!1);c.useEffect(()=>{var xt,jt;if(f.loading||J||y||!f.user||!o||kt.current||!f.session||!C)return;const te=T||Pe;if(!te){console.warn("[EditProfilePage] En mode onboarding mais aucun rle dtermin (URL ou localStorage vide)");return}if(x&&x.role===te){kt.current=!0;return}const de=(x==null?void 0:x.full_name)||((xt=o.user_metadata)==null?void 0:xt.full_name)||((jt=o.user_metadata)==null?void 0:jt.name)||o.email||"Utilisateur";if(!f.user){console.error("[EditProfilePage] auth.user est null, impossible de crer le profil"),kt.current=!1,F(!1);return}F(!0),kt.current=!0,(async()=>{if(await new Promise(Mt=>setTimeout(Mt,100)),!f.user){console.error("[EditProfilePage] auth.user est devenu null pendant l'initialisation"),kt.current=!1,F(!1);return}try{await N({full_name:de,role:te,phone:(x==null?void 0:x.phone)??null,location:(x==null?void 0:x.location)??null,company_name:(x==null?void 0:x.company_name)??null,region:(x==null?void 0:x.region)??null,department:(x==null?void 0:x.department)??null,commune:(x==null?void 0:x.commune)??null})}catch(Mt){console.error("Erreur lors de l'initialisation/correction du profil dans EditProfilePage:",Mt),kt.current=!1}finally{F(!1)}})()},[f.loading,f.user,o==null?void 0:o.id,x==null?void 0:x.id,x==null?void 0:x.role,y,C,T,Pe,Xe,J,N,x]);const Rt=c.useRef(null),Ce=c.useCallback(async()=>{if(!o)return;const{data:te}=await j.from("artisans").select("*").eq("id",o.id).single();if(te){if(Ye(te.category_id),te.category_id){const de=h.find(De=>De.id===te.category_id);de&&Ge(de.name)}Ke(te.specialty||""),_e(te.bio||""),Le(te.portfolio_urls||[]),Ae(te.video_urls||[])}},[o,h]);c.useEffect(()=>{if(!x||Rt.current===x.id&&Rt.current)return;Rt.current=x.id,z(x.full_name||""),V(x.company_name||""),he(x.phone||"");const te=x.region||"";fe(te),Y(x.department||""),ce(x.commune||""),We(x.avatar_url),x.role==="artisan"&&Ce()},[x==null?void 0:x.id,x==null?void 0:x.full_name,x==null?void 0:x.company_name,x==null?void 0:x.phone,x==null?void 0:x.region,x==null?void 0:x.department,x==null?void 0:x.commune,x==null?void 0:x.avatar_url,x==null?void 0:x.role,Ce]);const Me=async te=>{const de=te.target.files;if(!(!de||!o)){if(je.length+de.length>Ti){g(`Maximum ${Ti} photos autorises`);return}_(!0);try{const De=[];for(const qe of Array.from(de)){if(qe.size>fd*1024*1024){g(`Photo trop volumineuse (max ${fd}MB)`);continue}if(!qe.type.startsWith("image/"))continue;const xt=qe.name.split(".").pop(),jt=`${o.id}/portfolio/${Date.now()}-${Math.random().toString(36).substr(2,9)}.${xt}`,{error:Mt}=await j.storage.from("photos").upload(jt,qe);if(Mt)continue;const{data:pt}=j.storage.from("photos").getPublicUrl(jt);pt!=null&&pt.publicUrl&&De.push(pt.publicUrl)}if(De.length>0){const qe=[...je,...De];Le(qe),await j.from("artisans").update({portfolio_urls:qe}).eq("id",o.id)}}catch(De){console.error("Portfolio upload error:",De)}_(!1),te.target.value=""}},tt=async te=>{if(!o)return;const de=je.filter((De,qe)=>qe!==te);Le(de),await j.from("artisans").update({portfolio_urls:de}).eq("id",o.id)},Q=async te=>{const de=te.target.files;if(!(!de||!o)){if(ue.length+de.length>Li){g(`Maximum ${Li} vidos autorises`);return}M(!0);try{const De=[];for(const qe of Array.from(de)){if(qe.size>gd*1024*1024){g(`Vido trop volumineuse (max ${gd}MB)`);continue}if(!qe.type.startsWith("video/"))continue;const xt=qe.name.split(".").pop(),jt=`${o.id}/videos/${Date.now()}-${Math.random().toString(36).substr(2,9)}.${xt}`,{error:Mt}=await j.storage.from("photos").upload(jt,qe);if(Mt)continue;const{data:pt}=j.storage.from("photos").getPublicUrl(jt);pt!=null&&pt.publicUrl&&De.push(pt.publicUrl)}if(De.length>0){const qe=[...ue,...De];Ae(qe),await j.from("artisans").update({video_urls:qe}).eq("id",o.id)}}catch(De){console.error("Video upload error:",De)}M(!1),te.target.value=""}},be=async te=>{if(!o)return;const de=ue.filter((De,qe)=>qe!==te);Ae(de),await j.from("artisans").update({video_urls:de}).eq("id",o.id)},Ee=async te=>{var De;const de=(De=te.target.files)==null?void 0:De[0];if(!(!de||!o)){b(!0);try{const qe=de.name.split(".").pop(),xt=`${o.id}/avatar/${Date.now()}.${qe}`,{error:jt}=await j.storage.from("photos").upload(xt,de);if(jt)throw jt;const{data:Mt}=j.storage.from("photos").getPublicUrl(xt);Mt!=null&&Mt.publicUrl&&(We(Mt.publicUrl),await j.from("profiles").update({avatar_url:Mt.publicUrl}).eq("id",o.id))}catch(qe){console.error("Photo upload error:",qe)}b(!1)}},Oe=async te=>{if(te&&te.preventDefault(),!!o){d(!0);try{const De=[Ne,ye,$].filter(pt=>pt&&pt.trim().length>0).join(", ")||null;let qe;C&&(T||Pe)?(qe=T||Pe,console.log("[EditProfilePage] Rle dtermin depuis choix utilisateur (onboarding):",qe,{roleFromUrl:T,roleFromStorage:Pe})):pe?(qe="artisan",console.log("[EditProfilePage] Rle dtermin: artisan (categoryId prsent:",pe,")")):(qe=(x==null?void 0:x.role)||"client",console.log("[EditProfilePage] Rle dtermin depuis profil existant ou dfaut:",qe)),console.log("[EditProfilePage] Sauvegarde du profil avec rle:",qe,{isArtisan:Xe,roleFromUrl:T,roleFromStorage:Pe,profileRole:x==null?void 0:x.role,categoryId:pe,totalSteps:qt,currentStep:ae});const{error:xt}=await j.from("profiles").upsert({id:o.id,role:qe,full_name:B,phone:le||null,location:De,company_name:Xe&&S||null,region:Ne||null,department:ye||null,commune:$||null,avatar_url:we,updated_at:new Date().toISOString()});if(xt)throw xt;if(qe==="artisan"){if(!pe){console.error("[EditProfilePage] ERREUR: Rle artisan mais categoryId manquant!",{finalRole:qe,categoryId:pe,isArtisan:Xe,roleFromUrl:T}),g("Veuillez slectionner votre mtier pour continuer."),d(!1);return}const{error:pt}=await j.from("artisans").upsert({id:o.id,user_id:o.id,category_id:pe,specialty:st||null,bio:ft||null,portfolio_urls:je.length>0?je:null,video_urls:ue.length>0?ue:null,updated_at:new Date().toISOString()});if(pt)throw console.error("[EditProfilePage] Erreur lors de la sauvegarde artisan:",pt),pt;console.log("[EditProfilePage] Donnes artisan sauvegardes avec succs")}const{data:jt,error:Mt}=await j.from("profiles").select("role").eq("id",o.id).single();if(!Mt&&jt&&(console.log("[EditProfilePage] Vrification aprs sauvegarde - Rle en base:",jt.role),jt.role!==qe)){console.error("[EditProfilePage] ERREUR: Le rle sauvegard ne correspond pas!",{attendu:qe,obtenu:jt.role}),g("Une erreur est survenue lors de la sauvegarde du rle. Veuillez ressayer."),d(!1);return}U(!0),typeof window<"u"&&(localStorage.removeItem("mbourake_pending_role"),localStorage.removeItem("mbourake_pending_mode")),setTimeout(()=>{try{k&&typeof window<"u"&&(window.location.href="/dashboard")}catch(pt){console.warn("[EditProfilePage] Erreur lors de la navigation:",pt)}},1500)}catch(de){console.error("[EditProfilePage] Save error:",de),g("Une erreur est survenue lors de la sauvegarde du profil.")}d(!1)}},ct=c.useRef("");c.useEffect(()=>{const te=JSON.stringify({isOnboarding:C,roleFromUrl:T,profileRole:x==null?void 0:x.role,isArtisan:Xe,profileExists:!!x,profileId:x==null?void 0:x.id,userId:o==null?void 0:o.id});te!==ct.current&&(console.log("[EditProfilePage] tat actuel:",{isOnboarding:C,roleFromUrl:T,profileRole:x==null?void 0:x.role,isArtisan:Xe,profileExists:!!x,profileId:x==null?void 0:x.id,userId:o==null?void 0:o.id,urlSearch:window.location.search}),ct.current=te)},[C,T,x==null?void 0:x.role,Xe,x,o==null?void 0:o.id]);const se=(te=>{switch(te){case 1:return!!B.trim();case 2:return!!Ne&&!!ye&&!!$;case 3:return Xe?!!pe:!0;case 4:return!0;case 5:return!0;default:return!0}})(ae),oe=ae>1,ve=c.useCallback(async()=>{var te;if(!((te=f.session)!=null&&te.access_token)){g("Session expire. Veuillez vous reconnecter.");return}R(!0);try{const{data:de,error:De}=await j.functions.invoke("delete-my-account",{headers:{Authorization:`Bearer ${f.session.access_token}`}});if(De)throw De;if(de!=null&&de.error)throw new Error(de.error);Z(!1),await f.signOut()}catch(de){const De=de instanceof Error?de.message:"Impossible de supprimer le compte.";g(De)}finally{R(!1)}},[(He=f.session)==null?void 0:He.access_token,f.signOut,g]),Te=()=>{if(k&&se){if(ae===4&&Xe&&qt===4){Oe();return}if(!(ae>=qt))try{Se(!1),c.startTransition(()=>{if(k)try{ge(ae+1),requestAnimationFrame(()=>{if(k)try{window.scrollTo({top:0,behavior:"smooth"})}catch{}})}catch{}})}catch{}}},ee=()=>{if(k&&oe)try{Se(!1),c.startTransition(()=>{if(k)try{ge(ae-1),requestAnimationFrame(()=>{if(k)try{window.scrollTo({top:0,behavior:"smooth"})}catch{}})}catch{}})}catch{}};c.useEffect(()=>{Se(!1)},[ae]);const Fe=c.useRef(null);return c.useEffect(()=>{if(!xe||ae!==3){Fe.current&&(document.removeEventListener("click",Fe.current,!0),Fe.current=null);return}Fe.current||(Fe.current=de=>{const De=de.target,qe=De.closest(".category-search-container"),xt=De.closest("[data-category-item]");!qe&&!xt&&Se(!1)});const te=setTimeout(()=>{Fe.current&&document.addEventListener("click",Fe.current,!0)},100);return()=>{clearTimeout(te),Fe.current&&(document.removeEventListener("click",Fe.current,!0),Fe.current=null)}},[xe,ae]),e.jsxs("div",{className:"min-h-screen bg-gray-50",children:[e.jsx("header",{className:"bg-white border-b border-gray-100 sticky top-0 z-10",children:e.jsxs("div",{className:"max-w-lg mx-auto px-4 py-4",children:[e.jsxs("div",{className:"flex items-center gap-4 mb-4",children:[e.jsx("button",{onClick:()=>i("/dashboard"),className:"w-10 h-10 rounded-full bg-gray-100 flex items-center justify-center text-gray-600 hover:bg-gray-200 transition-colors",children:e.jsx(ot,{size:20})}),e.jsx("h1",{className:"font-bold text-gray-900 flex-1",children:C?T==="artisan"||Pe==="artisan"?"Compltez votre profil artisan":T==="client"||Pe==="client"?"Compltez votre profil client":"Compltez votre profil":"Modifier mon profil"}),D&&e.jsx("div",{className:"w-8 h-8 bg-green-500 rounded-full flex items-center justify-center animate-in zoom-in",children:e.jsx(aa,{size:16,className:"text-white"})})]}),e.jsxs("div",{className:"w-full",children:[e.jsx("div",{className:"flex items-center justify-between mb-2",children:Lt.map((te,de)=>{const De=te.icon,qe=ae===te.id,xt=ae>te.id,jt=ae>=te.id;return e.jsxs($i.Fragment,{children:[e.jsxs("div",{className:"flex flex-col items-center flex-1",children:[e.jsx("div",{className:`w-10 h-10 rounded-full flex items-center justify-center transition-all ${xt?"bg-brand-500 text-white":qe?"bg-brand-500 text-white ring-4 ring-brand-200":jt?"bg-gray-200 text-gray-600":"bg-gray-100 text-gray-400"}`,children:xt?e.jsx(aa,{size:18}):e.jsx(De,{size:18})}),e.jsx("p",{className:`text-[10px] font-bold mt-1 text-center max-w-[60px] ${qe?"text-brand-600":"text-gray-500"}`,children:te.title.split(" ")[0]})]}),de<Lt.length-1&&e.jsx("div",{className:`flex-1 h-1 mx-1 transition-all ${xt?"bg-brand-500":"bg-gray-200"}`})]},`step-${te.id}-${de}`)})}),e.jsx("div",{className:"text-center mt-2",children:e.jsxs("p",{className:"text-xs font-bold text-gray-600",children:["tape ",ae," sur ",qt]})})]})]})}),e.jsxs("main",{className:"max-w-lg mx-auto px-4 py-6 pb-24",children:[C&&(T==="artisan"||Pe==="artisan")&&ae===1&&e.jsxs("div",{className:"bg-brand-50 border-2 border-brand-200 rounded-xl p-4 mb-6 animate-in fade-in",children:[e.jsx("h2",{className:"font-black text-brand-900 mb-2 text-lg",children:"Bienvenue ! "}),e.jsx("p",{className:"text-sm text-brand-700 font-medium",children:"Compltez votre profil en quelques tapes simples pour commencer  recevoir des demandes de clients."})]}),e.jsxs("form",{onSubmit:Oe,className:"space-y-6",children:[ae===1&&k&&e.jsxs("div",{className:"animate-in fade-in slide-in-from-right-4",children:[e.jsx("h2",{className:"text-xl font-black text-gray-900 mb-6",children:"Informations personnelles"}),e.jsxs("div",{className:"flex flex-col items-center mb-6",children:[e.jsxs("div",{className:"relative",children:[e.jsx("div",{className:"w-28 h-28 rounded-full bg-gradient-to-br from-brand-400 to-brand-600 p-1",children:e.jsx("div",{className:"w-full h-full rounded-full bg-white flex items-center justify-center overflow-hidden",children:we?e.jsx("img",{src:we,alt:"",className:"w-full h-full object-cover"}):e.jsx(ot,{size:48,className:"text-brand-300"})})}),e.jsxs("label",{className:"absolute bottom-0 right-0 w-10 h-10 bg-brand-500 rounded-full flex items-center justify-center text-white shadow-lg cursor-pointer hover:bg-brand-600 transition-colors",children:[e.jsx("input",{type:"file",accept:"image/*",onChange:Ee,className:"hidden"}),v?e.jsx(ma,{size:18,className:"animate-spin"}):e.jsx(un,{size:18})]})]}),e.jsx("p",{className:"text-xs text-gray-400 mt-3",children:"Appuyez pour changer la photo"})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-xs font-bold text-gray-500 uppercase tracking-wider mb-2",children:["Nom complet ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx("input",{type:"text",value:B,onChange:te=>z(te.target.value),className:"w-full rounded-xl border border-gray-200 px-4 py-3 focus:border-brand-500 focus:outline-none bg-white",placeholder:"Votre nom complet",required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-bold text-gray-500 uppercase tracking-wider mb-2",children:"Tlphone"}),e.jsx("input",{type:"tel",value:le,onChange:te=>he(te.target.value),className:"w-full rounded-xl border border-gray-200 px-4 py-3 focus:border-brand-500 focus:outline-none bg-white",placeholder:"+221 77 000 00 00"})]})]},"step-1"),ae===2&&k&&e.jsxs("div",{className:"animate-in fade-in slide-in-from-right-4",children:[e.jsx("h2",{className:"text-xl font-black text-gray-900 mb-6",children:"Localisation"}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-xs font-bold text-gray-500 uppercase tracking-wider mb-2",children:["Rgion ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsxs("select",{value:Ne,onChange:te=>{const de=te.target.value;fe(de),Y(""),ce("")},className:"w-full rounded-xl border border-gray-200 px-4 py-3 focus:border-brand-500 focus:outline-none bg-white appearance-none",required:!0,children:[e.jsx("option",{value:"",children:"Slectionnez une rgion"}),Fb.map(te=>e.jsx("option",{value:te,children:te},te))]})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-xs font-bold text-gray-500 uppercase tracking-wider mb-2",children:["Dpartement ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsxs("select",{value:ye,onChange:te=>{const de=te.target.value;Y(de),ce("")},disabled:!Ne,className:"w-full rounded-xl border border-gray-200 px-4 py-3 focus:border-brand-500 focus:outline-none bg-white appearance-none disabled:bg-gray-100 disabled:text-gray-400",required:!0,children:[e.jsx("option",{value:"",children:Ne?"Slectionnez un dpartement":"Choisissez d'abord une rgion"}),Bb(Ne).map(te=>e.jsx("option",{value:te,children:te},te))]})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-xs font-bold text-gray-500 uppercase tracking-wider mb-2",children:["Commune ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsxs("select",{value:$,onChange:te=>ce(te.target.value),disabled:!Ne||!ye,className:"w-full rounded-xl border border-gray-200 px-4 py-3 focus:border-brand-500 focus:outline-none bg-white appearance-none disabled:bg-gray-100 disabled:text-gray-400",required:!0,children:[e.jsx("option",{value:"",children:ye?"Slectionnez une commune":"Choisissez d'abord un dpartement"}),Hb(Ne,ye).map(te=>e.jsx("option",{value:te,children:te},te))]})]})]},"step-2"),ae===3&&Xe&&k&&e.jsxs("div",{className:"animate-in fade-in slide-in-from-right-4",children:[e.jsx("h2",{className:"text-xl font-black text-gray-900 mb-6",children:"Informations professionnelles"}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-bold text-gray-500 uppercase tracking-wider mb-2",children:"Nom de l'entreprise"}),e.jsx("input",{type:"text",value:S,onChange:te=>V(te.target.value),className:"w-full rounded-xl border border-gray-200 px-4 py-3 focus:border-brand-500 focus:outline-none bg-white",placeholder:"Ex: Entreprise Ndiaye & Fils"})]}),e.jsxs("div",{className:"relative category-search-container",children:[e.jsxs("label",{className:"block text-xs font-bold text-gray-500 uppercase tracking-wider mb-2",children:["Mtier / Catgorie ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsxs("div",{className:"relative",children:[e.jsx("div",{className:"absolute left-4 top-1/2 -translate-y-1/2 z-10",children:e.jsx(xa,{size:18,className:"text-gray-400"})}),e.jsx("input",{type:"text",value:ze,onChange:te=>{var De;const de=te.target.value;if(Ge(de),Se(!0),!de)Ye(null);else{const qe=pe?(De=h.find(xt=>xt.id===pe))==null?void 0:De.name:null;qe&&de!==qe&&Ye(null)}},onFocus:()=>Se(!0),placeholder:"Rechercher un mtier...",className:`w-full rounded-xl border pl-12 pr-4 py-3 focus:border-brand-500 focus:outline-none bg-white ${pe?"border-gray-200":"border-red-300 bg-red-50"}`}),pe&&e.jsx("button",{type:"button",onClick:()=>{Ye(null),Ge(""),Se(!1)},className:"absolute right-3 top-1/2 -translate-y-1/2 text-gray-400 hover:text-gray-600",children:e.jsx(Ze,{size:18})})]}),xe&&e.jsx("div",{className:"absolute z-50 w-full mt-2 bg-white border border-gray-200 rounded-xl shadow-lg max-h-64 overflow-y-auto",children:(()=>{const te=h.filter(de=>de.name.toLowerCase().includes(ze.toLowerCase()));return te.length===0?e.jsx("div",{className:"p-4 text-center text-gray-500 text-sm",children:"Aucun mtier trouv"}):te.map(de=>e.jsx("button",{type:"button","data-category-item":!0,onClick:De=>{De.preventDefault(),De.stopPropagation(),Ye(de.id),Ge(de.name),Se(!1)},onMouseDown:De=>{De.preventDefault()},className:`w-full text-left px-4 py-3 hover:bg-brand-50 transition-colors ${pe===de.id?"bg-brand-100 font-bold":""}`,children:de.name},de.id))})()}),!pe&&e.jsx("div",{className:"mt-2 p-3 bg-red-50 border border-red-200 rounded-xl",children:e.jsx("p",{className:"text-sm text-red-700 font-bold",children:" Vous devez choisir votre mtier pour continuer"})})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-bold text-gray-500 uppercase tracking-wider mb-2",children:"Spcialit"}),e.jsx("input",{type:"text",value:st,onChange:te=>Ke(te.target.value),className:"w-full rounded-xl border border-gray-200 px-4 py-3 focus:border-brand-500 focus:outline-none bg-white",placeholder:"Ex: Rparation de fuites"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-bold text-gray-500 uppercase tracking-wider mb-2",children:" propos de vous"}),e.jsx("textarea",{value:ft,onChange:te=>_e(te.target.value),rows:4,className:"w-full rounded-xl border border-gray-200 px-4 py-3 focus:border-brand-500 focus:outline-none bg-white resize-none",placeholder:"Dcrivez votre exprience et savoir-faire..."})]})]},"step-3"),ae===4&&Xe&&k&&e.jsxs("div",{className:"animate-in fade-in slide-in-from-right-4",children:[e.jsx("h2",{className:"text-xl font-black text-gray-900 mb-6",children:"Portfolio"}),e.jsx("div",{className:"bg-blue-50 rounded-xl p-4 mb-6",children:e.jsx("p",{className:"text-sm text-blue-700 font-medium",children:" Les photos et vidos sont visibles sur votre profil public et aident les clients  mieux connatre votre travail."})}),e.jsxs("section",{className:"mb-8",children:[e.jsx("div",{className:"flex items-center justify-between mb-4",children:e.jsxs("h3",{className:"font-bold text-gray-900 flex items-center gap-2",children:[e.jsx(tl,{size:18,className:"text-brand-500"}),"Photos (",je.length,"/",Ti,")"]})}),e.jsxs("div",{className:"relative mb-4",children:[e.jsx("input",{type:"file",accept:"image/*",multiple:!0,onChange:Me,disabled:w||je.length>=Ti,className:"absolute inset-0 w-full h-full opacity-0 cursor-pointer z-10"}),e.jsx("div",{className:`border-2 border-dashed rounded-2xl p-6 text-center transition-all ${w?"border-brand-300 bg-brand-50":"border-gray-200 hover:border-brand-300 hover:bg-brand-50/50"}`,children:w?e.jsxs("div",{className:"flex flex-col items-center gap-2",children:[e.jsx(ma,{size:28,className:"animate-spin text-brand-500"}),e.jsx("p",{className:"text-sm font-bold text-brand-600",children:"Upload en cours..."})]}):e.jsxs("div",{className:"flex flex-col items-center gap-2",children:[e.jsx(hr,{size:28,className:"text-gray-400"}),e.jsx("p",{className:"font-bold text-gray-600",children:"Ajouter des photos"}),e.jsxs("p",{className:"text-xs text-gray-400",children:["JPG, PNG (max ",fd,"MB par photo)"]})]})})]}),je.length>0&&e.jsx("div",{className:"grid grid-cols-3 gap-3",children:je.map((te,de)=>e.jsxs("div",{className:"relative aspect-square rounded-xl overflow-hidden group",children:[e.jsx("img",{src:te,alt:`Portfolio ${de+1}`,className:"w-full h-full object-cover"}),e.jsx("button",{type:"button",onClick:()=>tt(de),className:"absolute top-2 right-2 w-7 h-7 bg-red-500 text-white rounded-full flex items-center justify-center opacity-0 group-hover:opacity-100 transition-opacity shadow-lg",children:e.jsx(Ze,{size:14})})]},`portfolio-${te}-${de}`))})]}),e.jsxs("section",{children:[e.jsx("div",{className:"flex items-center justify-between mb-4",children:e.jsxs("h3",{className:"font-bold text-gray-900 flex items-center gap-2",children:[e.jsx(zs,{size:18,className:"text-brand-500"}),"Vidos (",ue.length,"/",Li,")"]})}),e.jsxs("div",{className:"relative mb-4",children:[e.jsx("input",{type:"file",accept:"video/*",multiple:!0,onChange:Q,disabled:L||ue.length>=Li,className:"absolute inset-0 w-full h-full opacity-0 cursor-pointer z-10"}),e.jsx("div",{className:`border-2 border-dashed rounded-2xl p-6 text-center transition-all ${L?"border-brand-300 bg-brand-50":"border-gray-200 hover:border-brand-300 hover:bg-brand-50/50"}`,children:L?e.jsxs("div",{className:"flex flex-col items-center gap-2",children:[e.jsx(ma,{size:28,className:"animate-spin text-brand-500"}),e.jsx("p",{className:"text-sm font-bold text-brand-600",children:"Upload en cours..."})]}):e.jsxs("div",{className:"flex flex-col items-center gap-2",children:[e.jsx(zs,{size:28,className:"text-gray-400"}),e.jsx("p",{className:"font-bold text-gray-600",children:"Ajouter des vidos"}),e.jsxs("p",{className:"text-xs text-gray-400",children:["MP4, MOV (max ",gd,"MB par vido)"]})]})})]}),ue.length>0&&e.jsx("div",{className:"grid grid-cols-2 gap-3",children:ue.map((te,de)=>e.jsxs("div",{className:"relative aspect-video rounded-xl overflow-hidden group bg-gray-900",children:[e.jsx("video",{src:te,className:"w-full h-full object-cover"}),e.jsx("div",{className:"absolute inset-0 bg-black/40 flex items-center justify-center",children:e.jsx(Nl,{size:32,className:"text-white",fill:"white"})}),e.jsx("button",{type:"button",onClick:()=>be(de),className:"absolute top-2 right-2 w-7 h-7 bg-red-500 text-white rounded-full flex items-center justify-center opacity-0 group-hover:opacity-100 transition-opacity shadow-lg",children:e.jsx(Ze,{size:14})})]},de))})]})]},"step-4"),ae===5&&Xe&&k&&((x==null?void 0:x.id)??(o==null?void 0:o.id))&&e.jsxs("div",{className:"animate-in fade-in slide-in-from-right-4",children:[e.jsx("h2",{className:"text-xl font-black text-gray-900 mb-6",children:"Affiliation"}),e.jsx("div",{className:"bg-blue-50 rounded-xl p-4 mb-6",children:e.jsx("p",{className:"text-sm text-blue-700 font-medium",children:"Associez votre profil  une Chambre de mtier, un incubateur ou une SAE pour renforcer votre crdibilit auprs des clients."})}),e.jsx(Vb,{artisanId:(x==null?void 0:x.id)??(o==null?void 0:o.id)??""})]},"step-5"),!C&&e.jsxs("div",{className:"mt-10 pt-8 border-t border-gray-200",children:[e.jsx("h2",{className:"text-lg font-bold text-gray-900 mb-2",children:"Paramtres du compte"}),e.jsx("p",{className:"text-sm text-gray-500 mb-4",children:"Cette action supprime dfinitivement votre compte, votre profil, vos projets, devis, messages et toutes les donnes lies  cette adresse email. Elle est irrversible."}),e.jsxs("button",{type:"button",onClick:()=>Z(!0),className:"flex items-center justify-center gap-2 w-full py-3 px-4 rounded-xl border-2 border-red-200 bg-red-50 text-red-700 font-bold hover:bg-red-100 transition-colors",children:[e.jsx(gr,{size:20}),"Supprimer mon compte et toutes mes donnes"]})]}),e.jsx(sf,{children:e.jsx("div",{className:"fixed bottom-0 left-0 right-0 bg-white border-t border-gray-200 p-4 shadow-lg z-20",children:e.jsxs("div",{className:"max-w-lg mx-auto flex gap-3",children:[oe&&e.jsxs("button",{type:"button",onClick:ee,className:"flex-1 flex items-center justify-center gap-2 bg-gray-100 text-gray-700 rounded-xl py-3 font-bold hover:bg-gray-200 transition-colors",children:[e.jsx(X0,{size:20}),"Prcdent"]}),ae<qt?e.jsx("button",{type:"button",onClick:Te,disabled:!se||E,className:"flex-1 flex items-center justify-center gap-2 bg-brand-500 text-white rounded-xl py-3 font-bold hover:bg-brand-600 transition-colors disabled:opacity-50 disabled:cursor-not-allowed",children:E&&ae===qt?e.jsxs(e.Fragment,{children:[e.jsx(ma,{size:20,className:"animate-spin"}),"Enregistrement..."]}):e.jsxs(e.Fragment,{children:["Suivant",e.jsx(da,{size:20})]})}):e.jsx("button",{type:"button",onClick:te=>{te.preventDefault();const de=document.querySelector("form");de?de.requestSubmit():Oe(te)},disabled:E||!se,className:"flex-1 flex items-center justify-center gap-2 bg-gray-900 text-white rounded-xl py-3 font-bold hover:bg-gray-800 transition-colors disabled:opacity-50 disabled:cursor-not-allowed",children:E?e.jsxs(e.Fragment,{children:[e.jsx(ma,{size:20,className:"animate-spin"}),"Enregistrement..."]}):e.jsxs(e.Fragment,{children:[e.jsx(aa,{size:20}),"Enregistrer"]})})]})})})]})]}),G&&e.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center p-4 bg-black/50",onClick:()=>!X&&Z(!1),children:e.jsxs("div",{className:"bg-white rounded-2xl shadow-xl max-w-md w-full p-6 animate-in fade-in zoom-in-95",onClick:te=>te.stopPropagation(),children:[e.jsxs("div",{className:"flex items-center gap-3 mb-4",children:[e.jsx("div",{className:"w-12 h-12 rounded-full bg-red-100 flex items-center justify-center",children:e.jsx(zt,{size:24,className:"text-red-600"})}),e.jsx("h3",{className:"text-lg font-bold text-gray-900",children:"Supprimer mon compte"})]}),e.jsx("p",{className:"text-sm text-gray-600 mb-6",children:"tes-vous sr de vouloir supprimer dfinitivement votre compte et toutes les donnes lies  cette adresse email ? Cette action est irrversible."}),e.jsxs("div",{className:"flex gap-3",children:[e.jsx("button",{type:"button",disabled:X,onClick:()=>Z(!1),className:"flex-1 py-3 rounded-xl border border-gray-300 font-bold text-gray-700 hover:bg-gray-50 disabled:opacity-50",children:"Annuler"}),e.jsxs("button",{type:"button",disabled:X,onClick:ve,className:"flex-1 py-3 rounded-xl bg-red-600 text-white font-bold hover:bg-red-700 disabled:opacity-50 flex items-center justify-center gap-2",children:[X?e.jsx(ma,{size:20,className:"animate-spin"}):e.jsx(gr,{size:20}),X?"Suppression...":"Supprimer"]})]})]})})]})}const Ui={materials:{label:"Matriaux",icon:e.jsx(mp,{size:20}),color:"bg-blue-100 text-blue-600"},labor:{label:"Main d'uvre",icon:e.jsx(ns,{size:20}),color:"bg-green-100 text-green-600"},transport:{label:"Transport",icon:e.jsx(ef,{size:20}),color:"bg-purple-100 text-purple-600"},equipment:{label:"quipement",icon:e.jsx(vd,{size:20}),color:"bg-orange-100 text-orange-600"},other:{label:"Autre",icon:e.jsx(et,{size:20}),color:"bg-gray-100 text-gray-600"}};function $b(){const i=ht(),{user:u}=Nt(),{profile:f}=It(),{error:o}=sa(),[x,y]=c.useState([]),[N,h]=c.useState([]),[g,E]=c.useState(!0),[d,v]=c.useState(!1),[b,w]=c.useState(null),[_,L]=c.useState(""),[M,D]=c.useState("all"),[U,J]=c.useState("all"),[F,G]=c.useState(""),[Z,X]=c.useState(""),[R,ae]=c.useState("materials"),[ge,k]=c.useState(""),[q,T]=c.useState(new Date().toISOString().split("T")[0]),[C,B]=c.useState(null),[z,S]=c.useState(!1),[V,le]=c.useState(!1);c.useEffect(()=>{!u||!f||(he(),Ne())},[u,f]);const he=async()=>{if(!u)return;let $=j.from("expenses").select("*, projects(title, project_number)").eq("user_id",u.id).order("expense_date",{ascending:!1});M!=="all"&&($=$.eq("category",M)),U!=="all"&&($=$.eq("project_id",U));const{data:ce,error:we}=await $;we?console.error("Error fetching expenses:",we):y(ce||[]),E(!1)},Ne=async()=>{if(!(!u||!f)){if(f.role==="client"){const{data:$}=await j.from("projects").select("id, title, project_number").eq("client_id",u.id).in("status",["open","quote_accepted","in_progress","completed"]).order("created_at",{ascending:!1});h($||[])}else if(f.role==="artisan"){const{data:$}=await j.from("quotes").select("project_id, projects(id, title, project_number)").eq("artisan_id",u.id).eq("status","accepted"),ce=($==null?void 0:$.map(we=>we.projects).filter(Boolean))||[];h(ce)}}};c.useEffect(()=>{he()},[M,U]);const fe=async $=>{if(!u)return null;S(!0);try{const ce=$.name.split(".").pop(),we=`${u.id}/expenses/${Date.now()}-${Math.random().toString(36).substr(2,9)}.${ce}`,{error:We}=await j.storage.from("photos").upload(we,$);if(We)throw We;const{data:pe}=j.storage.from("photos").getPublicUrl(we);return(pe==null?void 0:pe.publicUrl)||null}catch(ce){return console.error("Error uploading receipt:",ce),null}finally{S(!1)}},ye=async $=>{if($.preventDefault(),!!u){le(!0);try{let ce=null;C&&(ce=await fe(C));const we={user_id:u.id,category:R,amount:parseFloat(F),description:Z.trim()||null,expense_date:q,receipt_url:ce};ge&&(we.project_id=ge);const{error:We}=await j.from("expenses").insert(we);if(We)throw We;G(""),X(""),ae("materials"),k(""),T(new Date().toISOString().split("T")[0]),B(null),v(!1),await he()}catch(ce){o(`Erreur: ${ce.message||"Impossible d'enregistrer la dpense"}`)}finally{le(!1)}}},Y=x.reduce(($,ce)=>$+parseFloat(ce.amount||0),0);return x.reduce(($,ce)=>($[ce.category]=($[ce.category]||0)+parseFloat(ce.amount||0),$),{}),g?e.jsx(Yt,{}):e.jsxs("div",{className:"min-h-screen bg-gray-50",children:[e.jsxs("header",{className:"sticky top-0 z-20 px-4 py-4 bg-white border-b border-gray-100 flex items-center gap-4",children:[e.jsx("button",{onClick:()=>i("/dashboard"),className:"w-10 h-10 rounded-full bg-gray-100 flex items-center justify-center",children:e.jsx(Wt,{size:20,className:"text-gray-600"})}),e.jsx("div",{className:"flex-1",children:e.jsx("h1",{className:"font-bold text-gray-900",children:"Suivi des dpenses"})}),e.jsx("button",{onClick:()=>v(!0),className:"w-10 h-10 bg-brand-500 text-white rounded-full flex items-center justify-center",children:e.jsx(hp,{size:20})})]}),e.jsxs("main",{className:"max-w-lg mx-auto px-4 py-6 pb-32",children:[e.jsxs("div",{className:"grid grid-cols-2 gap-4 mb-6",children:[e.jsxs("div",{className:"bg-white rounded-2xl p-4 border border-gray-100",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[e.jsx(Ss,{size:18,className:"text-brand-500"}),e.jsx("p",{className:"text-xs text-gray-500 font-medium",children:"Total dpenses"})]}),e.jsxs("p",{className:"text-2xl font-black text-gray-900",children:[Y.toLocaleString("fr-FR")," FCFA"]})]}),e.jsxs("div",{className:"bg-white rounded-2xl p-4 border border-gray-100",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[e.jsx(dr,{size:18,className:"text-green-500"}),e.jsx("p",{className:"text-xs text-gray-500 font-medium",children:"Nombre"})]}),e.jsx("p",{className:"text-2xl font-black text-gray-900",children:x.length})]})]}),e.jsxs("div",{className:"flex gap-2 mb-4 overflow-x-auto pb-2",children:[e.jsxs("select",{value:M,onChange:$=>D($.target.value),className:"px-4 py-2 bg-white border border-gray-200 rounded-xl text-sm font-medium",children:[e.jsx("option",{value:"all",children:"Toutes catgories"}),Object.entries(Ui).map(([$,ce])=>e.jsx("option",{value:$,children:ce.label},$))]}),e.jsxs("select",{value:U,onChange:$=>J($.target.value),className:"px-4 py-2 bg-white border border-gray-200 rounded-xl text-sm font-medium",children:[e.jsx("option",{value:"all",children:"Tous les projets"}),N.map($=>e.jsx("option",{value:$.id,children:$.project_number||$.title},$.id))]})]}),x.length===0?e.jsxs("div",{className:"bg-white rounded-2xl p-12 text-center border border-gray-100",children:[e.jsx(J0,{size:48,className:"mx-auto text-gray-300 mb-4"}),e.jsx("p",{className:"text-gray-500 font-medium",children:"Aucune dpense enregistre"}),e.jsx("button",{onClick:()=>v(!0),className:"mt-4 px-6 py-2 bg-brand-500 text-white rounded-xl font-bold",children:"Ajouter une dpense"})]}):e.jsx("div",{className:"space-y-3",children:x.map($=>{const ce=Ui[$.category]||Ui.other;return e.jsxs("div",{className:"bg-white rounded-2xl p-4 border border-gray-100",children:[e.jsxs("div",{className:"flex items-start justify-between mb-3",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:`w-10 h-10 rounded-xl flex items-center justify-center ${ce.color}`,children:ce.icon}),e.jsxs("div",{children:[e.jsx("p",{className:"font-bold text-gray-900",children:ce.label}),e.jsx("p",{className:"text-xs text-gray-400",children:new Date($.expense_date).toLocaleDateString("fr-FR")})]})]}),e.jsxs("p",{className:"text-lg font-black text-gray-900",children:[parseFloat($.amount||0).toLocaleString("fr-FR")," FCFA"]})]}),$.description&&e.jsx("p",{className:"text-sm text-gray-600 mb-2",children:$.description}),$.projects&&e.jsxs("p",{className:"text-xs text-gray-400 mb-2",children:["Projet: ",$.projects.project_number||$.projects.title]}),$.receipt_url&&e.jsxs("a",{href:$.receipt_url,target:"_blank",rel:"noopener noreferrer",className:"inline-flex items-center gap-2 text-xs text-brand-500 font-medium",children:[e.jsx(tl,{size:14}),"Voir justificatif"]})]},$.id)})})]}),d&&e.jsx("div",{className:"fixed inset-0 bg-black/60 backdrop-blur-sm flex items-end z-50",children:e.jsxs("div",{className:"w-full max-w-lg mx-auto bg-white rounded-t-3xl p-6 max-h-[90vh] overflow-y-auto animate-in slide-in-from-bottom duration-300",children:[e.jsxs("div",{className:"flex items-center justify-between mb-6",children:[e.jsx("h2",{className:"text-xl font-bold text-gray-900",children:"Nouvelle dpense"}),e.jsx("button",{onClick:()=>v(!1),className:"w-10 h-10 rounded-full bg-gray-100 flex items-center justify-center",children:e.jsx(Ze,{size:20})})]}),e.jsxs("form",{onSubmit:ye,className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-bold text-gray-400 uppercase mb-2",children:"Montant (FCFA)"}),e.jsx("input",{type:"number",value:F,onChange:$=>G($.target.value),required:!0,min:"0",step:"0.01",className:"w-full px-4 py-3 bg-gray-50 border border-gray-200 rounded-xl focus:border-brand-500 focus:outline-none",placeholder:"0.00"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-bold text-gray-400 uppercase mb-2",children:"Catgorie"}),e.jsx("div",{className:"grid grid-cols-2 gap-2",children:Object.entries(Ui).map(([$,ce])=>e.jsxs("button",{type:"button",onClick:()=>ae($),className:`p-3 rounded-xl border-2 transition-all ${R===$?"border-brand-500 bg-brand-50":"border-gray-200 bg-white"}`,children:[e.jsx("div",{className:`w-8 h-8 rounded-lg flex items-center justify-center mb-2 ${ce.color}`,children:ce.icon}),e.jsx("p",{className:"text-xs font-bold text-gray-900",children:ce.label})]},$))})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-bold text-gray-400 uppercase mb-2",children:"Projet (optionnel)"}),e.jsxs("select",{value:ge,onChange:$=>k($.target.value),className:"w-full px-4 py-3 bg-gray-50 border border-gray-200 rounded-xl focus:border-brand-500 focus:outline-none",children:[e.jsx("option",{value:"",children:"Aucun projet"}),N.map($=>e.jsx("option",{value:$.id,children:$.project_number||$.title},$.id))]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-bold text-gray-400 uppercase mb-2",children:"Date"}),e.jsx("input",{type:"date",value:q,onChange:$=>T($.target.value),required:!0,className:"w-full px-4 py-3 bg-gray-50 border border-gray-200 rounded-xl focus:border-brand-500 focus:outline-none"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-bold text-gray-400 uppercase mb-2",children:"Description (optionnel)"}),e.jsx("textarea",{value:Z,onChange:$=>X($.target.value),rows:3,className:"w-full px-4 py-3 bg-gray-50 border border-gray-200 rounded-xl focus:border-brand-500 focus:outline-none resize-none",placeholder:"Dtails de la dpense..."})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-bold text-gray-400 uppercase mb-2",children:"Justificatif (optionnel)"}),e.jsxs("div",{className:"border-2 border-dashed border-gray-200 rounded-xl p-4 text-center",children:[e.jsx("input",{type:"file",accept:"image/*",onChange:$=>{var ce;return B(((ce=$.target.files)==null?void 0:ce[0])||null)},className:"hidden",id:"receipt-upload"}),e.jsx("label",{htmlFor:"receipt-upload",className:"cursor-pointer flex flex-col items-center gap-2",children:C?e.jsxs(e.Fragment,{children:[e.jsx(tl,{size:32,className:"text-brand-500"}),e.jsx("p",{className:"text-sm font-medium text-gray-900",children:C.name}),e.jsx("button",{type:"button",onClick:$=>{$.stopPropagation(),B(null)},className:"text-xs text-red-500",children:"Supprimer"})]}):e.jsxs(e.Fragment,{children:[e.jsx(hr,{size:32,className:"text-gray-400"}),e.jsx("p",{className:"text-sm text-gray-500",children:"Ajouter une photo du justificatif"})]})})]})]}),e.jsx("button",{type:"submit",disabled:V||z||!F,className:"w-full bg-brand-500 text-white font-bold py-4 rounded-xl disabled:opacity-50 disabled:cursor-not-allowed",children:V?"Enregistrement...":z?"Upload...":"Enregistrer la dpense"})]})]})})]})}const Ws={draft:{label:"Brouillon",color:"bg-gray-100 text-gray-600 border border-gray-200",icon:e.jsx(et,{size:16})},sent:{label:"Envoye",color:"bg-blue-50 text-blue-700 border border-blue-100",icon:e.jsx(Zi,{size:16})},paid:{label:"Paye",color:"bg-green-100 text-green-700 border border-green-200",icon:e.jsx(Qe,{size:16})},overdue:{label:"En retard",color:"bg-red-50 text-red-700 border border-red-100",icon:e.jsx(qa,{size:16})},cancelled:{label:"Annule",color:"bg-gray-100 text-gray-500 border border-gray-200",icon:e.jsx(Ze,{size:16})}};function Qb(){var J,F,G,Z,X;const i=ht(),{user:u}=Nt(),{profile:f}=It(),{info:o}=sa(),[x,y]=c.useState([]),[N,h]=c.useState(!0),[g,E]=c.useState("all"),[d,v]=c.useState(null);c.useEffect(()=>{!u||!f||b()},[u,f,g]);const b=async()=>{if(!u||!f)return;h(!0);let R;if(f.role==="client")R=j.from("invoices").select("*, projects(title, project_number), profiles!invoices_artisan_id_fkey(full_name)").eq("client_id",u.id);else if(f.role==="artisan")R=j.from("invoices").select("*, projects(title, project_number), profiles!invoices_client_id_fkey(full_name)").eq("artisan_id",u.id);else{h(!1);return}g!=="all"&&(R=R.eq("status",g));const{data:ae,error:ge}=await R.order("issue_date",{ascending:!1});ge?console.error("Error fetching invoices:",ge):y(ae||[]),h(!1)},w=async R=>{var k,q,T,C;if(R.pdf_url){window.open(R.pdf_url,"_blank");return}const{downloadInvoicePDF:ae}=await Ji(async()=>{const{downloadInvoicePDF:B}=await import("./invoicePdfGenerator-CKKVeecw.js");return{downloadInvoicePDF:B}},__vite__mapDeps([4,1,2,3]),import.meta.url),ge={invoice_number:R.invoice_number||`INV-${R.id.slice(0,8).toUpperCase()}`,issue_date:R.issue_date||R.created_at,due_date:R.due_date||null,client_name:(f==null?void 0:f.role)==="client"?f.full_name:(k=R.profiles)==null?void 0:k.full_name,client_address:null,client_phone:(f==null?void 0:f.role)==="client"?f.phone:null,client_email:(u==null?void 0:u.email)||null,artisan_name:(f==null?void 0:f.role)==="artisan"?f.full_name:(q=R.profiles)==null?void 0:q.full_name,artisan_address:null,artisan_phone:(f==null?void 0:f.role)==="artisan"?f.phone:null,artisan_email:null,project_title:((T=R.projects)==null?void 0:T.title)||"Projet",project_number:((C=R.projects)==null?void 0:C.project_number)||null,items:null,subtotal:parseFloat(R.subtotal_amount||R.total_amount||0),tax_amount:parseFloat(R.tax_amount||0),tax_percent:R.tax_percent||null,total_amount:parseFloat(R.total_amount||0),status:R.status||"sent",notes:R.notes||null};ae(ge)},_=async R=>{o("Envoi email  implmenter")},L=x.length,M=x.reduce((R,ae)=>R+parseFloat(ae.total_amount||0),0),D=x.filter(R=>R.status==="paid").reduce((R,ae)=>R+parseFloat(ae.total_amount||0),0),U=x.filter(R=>["sent","overdue"].includes(R.status)).reduce((R,ae)=>R+parseFloat(ae.total_amount||0),0);return N?e.jsx(Yt,{}):e.jsxs("div",{className:"min-h-screen bg-gray-50",children:[e.jsxs("header",{className:"sticky top-0 z-20 px-4 py-4 bg-white border-b border-gray-100 flex items-center gap-4",children:[e.jsx("button",{onClick:()=>i("/dashboard"),className:"w-10 h-10 rounded-full bg-gray-100 flex items-center justify-center",children:e.jsx(Wt,{size:20,className:"text-gray-600"})}),e.jsx("div",{className:"flex-1",children:e.jsx("h1",{className:"font-bold text-gray-900",children:"Mes factures"})})]}),e.jsxs("main",{className:"max-w-lg mx-auto px-4 py-6 pb-32",children:[e.jsxs("div",{className:"grid grid-cols-2 gap-4 mb-6",children:[e.jsxs("div",{className:"bg-white rounded-2xl p-4 border border-gray-100",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[e.jsx(et,{size:18,className:"text-brand-500"}),e.jsx("p",{className:"text-xs text-gray-500 font-medium",children:"Total factures"})]}),e.jsx("p",{className:"text-2xl font-black text-gray-900",children:L}),e.jsxs("p",{className:"text-xs text-gray-400 mt-1",children:[M.toLocaleString("fr-FR")," FCFA"]})]}),e.jsxs("div",{className:"bg-white rounded-2xl p-4 border border-gray-100",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[e.jsx(Qe,{size:18,className:"text-green-500"}),e.jsx("p",{className:"text-xs text-gray-500 font-medium",children:"Payes"})]}),e.jsxs("p",{className:"text-2xl font-black text-green-600",children:[D.toLocaleString("fr-FR")," FCFA"]}),e.jsxs("p",{className:"text-xs text-gray-400 mt-1",children:[x.filter(R=>R.status==="paid").length," facture(s)"]})]})]}),U>0&&e.jsxs("div",{className:"bg-yellow-50 border border-yellow-200 rounded-2xl p-4 mb-6 flex items-start gap-3",children:[e.jsx(qa,{size:20,className:"text-yellow-600 flex-shrink-0"}),e.jsxs("div",{children:[e.jsx("p",{className:"font-bold text-yellow-800 text-sm",children:"En attente de paiement"}),e.jsxs("p",{className:"text-sm text-yellow-700",children:[U.toLocaleString("fr-FR")," FCFA"]})]})]}),e.jsxs("div",{className:"flex gap-2 mb-4 overflow-x-auto pb-2",children:[e.jsx("button",{onClick:()=>E("all"),className:`px-4 py-2 rounded-xl text-xs font-bold whitespace-nowrap transition-all ${g==="all"?"bg-brand-500 text-white":"bg-white border border-gray-200 text-gray-600"}`,children:"Toutes"}),Object.entries(Ws).map(([R,ae])=>e.jsxs("button",{onClick:()=>E(R),className:`px-4 py-2 rounded-xl text-xs font-bold whitespace-nowrap transition-all flex items-center gap-2 ${g===R?"bg-brand-500 text-white":"bg-white border border-gray-200 text-gray-600"}`,children:[ae.icon,ae.label]},R))]}),x.length===0?e.jsxs("div",{className:"bg-white rounded-2xl p-12 text-center border border-gray-100",children:[e.jsx(et,{size:48,className:"mx-auto text-gray-300 mb-4"}),e.jsx("p",{className:"text-gray-500 font-medium",children:"Aucune facture"}),e.jsx("p",{className:"text-sm text-gray-400 mt-1",children:"Les factures seront gnres automatiquement aprs la fin des projets"})]}):e.jsx("div",{className:"space-y-3",children:x.map(R=>{var ge,k;const ae=Ws[R.status]||Ws.draft;return e.jsxs("div",{className:"bg-white rounded-2xl p-4 border border-gray-100 shadow-[0_2px_8px_rgba(0,0,0,0.06)] hover:shadow-[0_4px_12px_rgba(0,0,0,0.08)] transition-shadow",children:[e.jsxs("div",{className:"flex items-start justify-between mb-3",children:[e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[e.jsx("p",{className:"font-bold text-gray-900",children:R.invoice_number}),e.jsxs("span",{className:`px-3 py-1 rounded-full text-xs font-bold flex items-center gap-1 ${ae.color}`,children:[ae.icon,ae.label]})]}),e.jsx("p",{className:"text-sm text-gray-600",children:((ge=R.projects)==null?void 0:ge.title)||((k=R.projects)==null?void 0:k.project_number)||"Projet"}),(f==null?void 0:f.role)==="client"&&R.profiles&&e.jsxs("p",{className:"text-xs text-gray-400 mt-1",children:["Artisan: ",R.profiles.full_name]}),(f==null?void 0:f.role)==="artisan"&&R.profiles&&e.jsxs("p",{className:"text-xs text-gray-400 mt-1",children:["Client: ",R.profiles.full_name]})]}),e.jsxs("div",{className:"text-right",children:[e.jsxs("p",{className:"text-lg font-black text-gray-900",children:[parseFloat(R.total_amount||0).toLocaleString("fr-FR")," FCFA"]}),e.jsx("p",{className:"text-xs text-gray-400",children:new Date(R.issue_date).toLocaleDateString("fr-FR")})]})]}),e.jsxs("div",{className:"border-t border-gray-50 pt-3 mt-3 space-y-2",children:[e.jsxs("div",{className:"flex justify-between text-xs",children:[e.jsx("span",{className:"text-gray-500",children:"Montant HT:"}),e.jsxs("span",{className:"font-medium",children:[parseFloat(R.base_amount||0).toLocaleString("fr-FR")," FCFA"]})]}),e.jsxs("div",{className:"flex justify-between text-xs",children:[e.jsxs("span",{className:"text-gray-500",children:["TVA (",R.tva_percent||18,"%):"]}),e.jsxs("span",{className:"font-medium",children:[parseFloat(R.tva_amount||0).toLocaleString("fr-FR")," FCFA"]})]}),R.due_date&&e.jsxs("div",{className:"flex justify-between text-xs",children:[e.jsx("span",{className:"text-gray-500",children:"chance:"}),e.jsx("span",{className:`font-medium ${R.status==="overdue"?"text-red-600":"text-gray-700"}`,children:new Date(R.due_date).toLocaleDateString("fr-FR")})]}),R.payment_date&&e.jsxs("div",{className:"flex justify-between text-xs",children:[e.jsx("span",{className:"text-gray-500",children:"Paye le:"}),e.jsx("span",{className:"font-medium text-green-600",children:new Date(R.payment_date).toLocaleDateString("fr-FR")})]})]}),e.jsxs("div",{className:"flex gap-2 mt-4",children:[e.jsxs("button",{onClick:()=>v(R),className:"flex-1 px-4 py-2 bg-gray-100 text-gray-700 rounded-xl font-bold text-sm flex items-center justify-center gap-2",children:[e.jsx(rp,{size:16}),"Dtails"]}),R.pdf_url&&e.jsxs("button",{onClick:()=>w(R),className:"px-4 py-2 bg-brand-500 text-white rounded-xl font-bold text-sm flex items-center justify-center gap-2",children:[e.jsx(mn,{size:16}),"PDF"]}),R.status==="sent"&&(f==null?void 0:f.role)==="artisan"&&e.jsxs("button",{onClick:()=>_(),className:"px-4 py-2 bg-blue-500 text-white rounded-xl font-bold text-sm flex items-center justify-center gap-2",children:[e.jsx(Zi,{size:16}),"Envoyer"]})]})]},R.id)})})]}),d&&e.jsx("div",{className:"fixed inset-0 bg-black/60 backdrop-blur-sm flex items-end z-50",children:e.jsxs("div",{className:"w-full max-w-lg mx-auto bg-white rounded-t-3xl p-6 max-h-[90vh] overflow-y-auto animate-in slide-in-from-bottom duration-300",children:[e.jsxs("div",{className:"flex items-center justify-between mb-6",children:[e.jsx("h2",{className:"text-xl font-bold text-gray-900",children:"Dtails facture"}),e.jsx("button",{onClick:()=>v(null),className:"w-10 h-10 rounded-full bg-gray-100 flex items-center justify-center",children:e.jsx(Ze,{size:20})})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-xs text-gray-400 uppercase font-bold mb-1",children:"Numro"}),e.jsx("p",{className:"text-lg font-bold text-gray-900",children:d.invoice_number})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-xs text-gray-400 uppercase font-bold mb-1",children:"Projet"}),e.jsx("p",{className:"text-gray-900",children:((J=d.projects)==null?void 0:J.title)||((F=d.projects)==null?void 0:F.project_number)})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-xs text-gray-400 uppercase font-bold mb-1",children:"Date d'mission"}),e.jsx("p",{className:"text-gray-900",children:new Date(d.issue_date).toLocaleDateString("fr-FR")})]}),d.due_date&&e.jsxs("div",{children:[e.jsx("p",{className:"text-xs text-gray-400 uppercase font-bold mb-1",children:"Date d'chance"}),e.jsx("p",{className:`font-medium ${d.status==="overdue"?"text-red-600":"text-gray-900"}`,children:new Date(d.due_date).toLocaleDateString("fr-FR")})]})]}),e.jsxs("div",{className:"border-t border-gray-100 pt-4 space-y-2",children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-gray-600",children:"Montant HT"}),e.jsxs("span",{className:"font-bold",children:[parseFloat(d.base_amount||0).toLocaleString("fr-FR")," FCFA"]})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsxs("span",{className:"text-gray-600",children:["TVA (",d.tva_percent||18,"%)"]}),e.jsxs("span",{className:"font-bold",children:[parseFloat(d.tva_amount||0).toLocaleString("fr-FR")," FCFA"]})]}),e.jsxs("div",{className:"flex justify-between pt-2 border-t border-gray-100",children:[e.jsx("span",{className:"font-bold text-gray-900",children:"Total TTC"}),e.jsxs("span",{className:"text-xl font-black text-brand-600",children:[parseFloat(d.total_amount||0).toLocaleString("fr-FR")," FCFA"]})]})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-xs text-gray-400 uppercase font-bold mb-1",children:"Statut"}),e.jsxs("span",{className:`inline-flex items-center gap-2 px-3 py-1 rounded-lg text-sm font-bold ${((G=Ws[d.status])==null?void 0:G.color)||Ws.draft.color}`,children:[((Z=Ws[d.status])==null?void 0:Z.icon)||Ws.draft.icon,((X=Ws[d.status])==null?void 0:X.label)||d.status]})]}),d.payment_date&&e.jsxs("div",{children:[e.jsx("p",{className:"text-xs text-gray-400 uppercase font-bold mb-1",children:"Date de paiement"}),e.jsx("p",{className:"text-green-600 font-medium",children:new Date(d.payment_date).toLocaleDateString("fr-FR")})]}),d.payment_method&&e.jsxs("div",{children:[e.jsx("p",{className:"text-xs text-gray-400 uppercase font-bold mb-1",children:"Mthode de paiement"}),e.jsx("p",{className:"text-gray-900 capitalize",children:d.payment_method})]}),d.notes&&e.jsxs("div",{children:[e.jsx("p",{className:"text-xs text-gray-400 uppercase font-bold mb-1",children:"Notes"}),e.jsx("p",{className:"text-gray-700",children:d.notes})]}),e.jsxs("div",{className:"flex gap-3 pt-4 border-t border-gray-100",children:[d.pdf_url&&e.jsxs("button",{onClick:()=>w(d),className:"flex-1 bg-brand-500 text-white font-bold py-3 rounded-xl flex items-center justify-center gap-2",children:[e.jsx(mn,{size:18}),"Tlcharger PDF"]}),e.jsx("button",{onClick:()=>window.print(),className:"px-6 py-3 bg-gray-100 text-gray-700 font-bold rounded-xl flex items-center justify-center gap-2",children:e.jsx(pp,{size:18})})]})]})]})})]})}function jf(){const{user:i}=Nt(),[u,f]=c.useState([]),[o,x]=c.useState(new Set),[y,N]=c.useState(!0),h=c.useCallback(async()=>{if(!i){f([]),x(new Set),N(!1);return}N(!0);const{data:b,error:w}=await j.from("favorites").select(`
        id, artisan_id, created_at,
        profiles!favorites_artisan_id_fkey (
          id, full_name, avatar_url, location, specialty,
          categories (name)
        )
      `).eq("client_id",i.id).order("created_at",{ascending:!1});if(w)console.error("Error fetching favorites:",w);else{const _=(b||[]).map(L=>({id:L.id,artisan_id:L.artisan_id,created_at:L.created_at,artisan:L.profiles?{id:L.profiles.id,full_name:L.profiles.full_name,avatar_url:L.profiles.avatar_url,location:L.profiles.location,specialty:L.profiles.specialty,category:L.profiles.categories}:null}));f(_),x(new Set(_.map(L=>L.artisan_id)))}N(!1)},[i]);c.useEffect(()=>{h()},[h]);const g=c.useCallback(b=>o.has(b),[o]),E=c.useCallback(async b=>{if(!i)return!1;const{error:w}=await j.from("favorites").insert({client_id:i.id,artisan_id:b});return w?(console.error("Error adding favorite:",w),!1):(x(_=>new Set([..._,b])),h(),!0)},[i,h]),d=c.useCallback(async b=>{if(!i)return!1;const{error:w}=await j.from("favorites").delete().eq("client_id",i.id).eq("artisan_id",b);return w?(console.error("Error removing favorite:",w),!1):(x(_=>{const L=new Set(_);return L.delete(b),L}),f(_=>_.filter(L=>L.artisan_id!==b)),!0)},[i]),v=c.useCallback(async b=>g(b)?d(b):E(b),[g,E,d]);return{favorites:u,favoriteIds:o,loading:y,isFavorite:g,addFavorite:E,removeFavorite:d,toggleFavorite:v,refresh:h}}function Yb(){var Pe,Xe,gt,Lt,qt,kt,Rt;const{id:i}=Ya(),u=ht(),f=pn(),{user:o}=Nt(),{profile:x}=It(),{success:y,error:N}=sa(),[h,g]=c.useState(null),[E,d]=c.useState([]),[v,b]=c.useState({count:0,avg:0,projectsCount:0,tier:"Bronze"}),[w,_]=c.useState([]),[L,M]=c.useState(!0),[D,U]=c.useState(null),{isFavorite:J,toggleFavorite:F}=jf(),G=i?J(i):!1,[Z,X]=c.useState(!1),[R,ae]=c.useState(0),[ge,k]=c.useState("photo"),[q,T]=c.useState(null),[C,B]=c.useState(""),[z,S]=c.useState(!1),[V,le]=c.useState(null),[he,Ne]=c.useState(!1),fe=typeof window<"u"&&i?`${window.location.origin}/artisans/${i}`:"",ye=h?`${h.full_name} | Artisan sur Mbourake`:"Profil artisan | Mbourake",Y=h?`Dcouvrez le profil de ${h.full_name} sur Mbourake`:"Dcouvrez ce profil artisan sur Mbourake",$=typeof navigator<"u"&&!!navigator.share,ce=async()=>{if(!(!$||!fe))try{await navigator.share({title:ye,text:Y,url:fe}),Ne(!1),y("Partage russi")}catch(Ce){(Ce==null?void 0:Ce.name)!=="AbortError"&&(N==null||N((Ce==null?void 0:Ce.message)||"Partage annul"))}},we=Ce=>{Ce&&(window.open(Ce,"_blank","noopener,noreferrer,width=600,height=500"),Ne(!1),y("Ouverture du partage"))},We=async()=>{if(fe)try{await navigator.clipboard.writeText(fe),Ne(!1),y("Lien copi dans le presse-papiers")}catch{N==null||N("Impossible de copier le lien")}},pe=encodeURIComponent(fe),Ye=encodeURIComponent(Y),st={facebook:`https://www.facebook.com/sharer/sharer.php?u=${pe}`,whatsapp:`https://wa.me/?text=${Ye}%20${pe}`,twitter:`https://twitter.com/intent/tweet?url=${pe}&text=${Ye}`,linkedin:`https://www.linkedin.com/sharing/share-offsite/?url=${pe}`,telegram:`https://t.me/share/url?url=${pe}&text=${Ye}`,sms:`sms:?body=${Ye}%20${pe}`};c.useEffect(()=>{(async()=>{if(!i)return;M(!0),U(null);const{data:Me,error:tt}=await j.from("artisans").select(`
          bio, specialty, portfolio_urls, video_urls, verification_status, rating_avg, is_available,
          categories (id, name, icon_name)
        `).eq("id",i).maybeSingle();if(tt){console.error("Error fetching artisan details:",tt),U("Artisan non trouv"),M(!1);return}if(!Me){U("Artisan non trouv"),M(!1);return}let Q=null,be=null;const Ee=await j.from("profiles").select("id, full_name, email, phone, avatar_url, location, member_id, created_at, role").eq("id",i).maybeSingle();if(Q=Ee.data,be=Ee.error,(be||!Q)&&!o){const at=await j.from("profiles").select("id, full_name, avatar_url, location").eq("id",i).maybeSingle();Q=at.data,be=at.error}if(be){console.error("Error fetching profile:",be),U("Artisan non trouv"),M(!1);return}if(!Q){U("Artisan non trouv"),M(!1);return}g({...Q,artisan:Me?{bio:Me.bio,specialty:Me.specialty,portfolio_urls:Me.portfolio_urls||[],video_urls:Me.video_urls||[],verification_status:Me.verification_status,rating_avg:Me.rating_avg,is_available:Me.is_available,category:Me.categories}:null});const{data:Oe}=await j.from("reviews").select(`
          id, rating, comment, created_at,
          profiles!reviews_client_id_fkey (full_name, avatar_url)
        `).eq("artisan_id",i).order("created_at",{ascending:!1}).limit(10);if(Oe){const at=Oe.map(Fe=>({id:Fe.id,rating:Fe.rating,comment:Fe.comment,created_at:Fe.created_at,client:Fe.profiles?{full_name:Fe.profiles.full_name,avatar_url:Fe.profiles.avatar_url}:null}));d(at);const se=at.length,oe=(Me==null?void 0:Me.rating_avg)??0,ve=se>0?at.reduce((Fe,He)=>Fe+He.rating,0)/se:oe,{count:Te}=await j.from("quotes").select("*",{count:"exact",head:!0}).eq("artisan_id",i).eq("status","accepted"),ee=wd(Te||0);b({count:se,avg:ve||0,projectsCount:Te||0,tier:ee})}const{data:ct}=await j.from("artisan_affiliations").select("affiliation_type, affiliation_name").eq("artisan_id",i).eq("status","verified");ct&&_(ct),M(!1)})()},[i]);const Ke=(Ce,Me)=>{k(Ce),ae(Me),X(!0)},ft=()=>{X(!1)},_e=()=>{var Me,tt;const Ce=ge==="photo"?((Me=h==null?void 0:h.artisan)==null?void 0:Me.portfolio_urls)||[]:((tt=h==null?void 0:h.artisan)==null?void 0:tt.video_urls)||[];ae(Q=>(Q+1)%Ce.length)},je=()=>{var Me,tt;const Ce=ge==="photo"?((Me=h==null?void 0:h.artisan)==null?void 0:Me.portfolio_urls)||[]:((tt=h==null?void 0:h.artisan)==null?void 0:tt.video_urls)||[];ae(Q=>(Q-1+Ce.length)%Ce.length)},Le=()=>{if(!o){u("/onboard?mode=signup&role=client");return}if((x==null?void 0:x.role)!=="client"){u("/onboard?mode=signup&role=client");return}u(`/create-project?artisan=${i}`)},ue=((Pe=h==null?void 0:h.artisan)==null?void 0:Pe.verification_status)==="verified",Ae=((Xe=h==null?void 0:h.artisan)==null?void 0:Xe.portfolio_urls)||[],ze=((gt=h==null?void 0:h.artisan)==null?void 0:gt.video_urls)||[],Ge=(x==null?void 0:x.role)==="client",xe=!!(o&&i&&o.id===i),Se=!xe&&(!o||Ge);return c.useEffect(()=>{if(new URLSearchParams(f.search).get("focus")!=="portfolio"||L)return;const tt=window.setTimeout(()=>{const Q=document.getElementById("portfolio");Q&&Q.scrollIntoView({behavior:"smooth",block:"start"})},50);return()=>window.clearTimeout(tt)},[f.search,L]),c.useEffect(()=>{if(!(o!=null&&o.id)||!i||(x==null?void 0:x.role)!=="client"){le(null);return}(async()=>{const{data:Me}=await j.from("projects").select("id").eq("client_id",o.id),tt=(Me==null?void 0:Me.map(be=>be.id))??[];if(tt.length===0){le(null);return}const{data:Q}=await j.from("quotes").select("project_id").eq("artisan_id",i).in("project_id",tt).in("status",["accepted","pending","viewed"]).order("created_at",{ascending:!1}).limit(1).maybeSingle();le((Q==null?void 0:Q.project_id)??null)})()},[o==null?void 0:o.id,i,x==null?void 0:x.role]),L?e.jsx(Yt,{}):D||!h?e.jsx("div",{className:"min-h-screen bg-gray-50 flex flex-col items-center justify-center p-6",children:e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"w-20 h-20 bg-gray-100 rounded-full flex items-center justify-center mx-auto mb-6",children:e.jsx(Ht,{size:40,className:"text-gray-300"})}),e.jsx("h2",{className:"text-xl font-bold text-gray-900 mb-2",children:"Artisan non trouv"}),e.jsx("p",{className:"text-gray-500 mb-6",children:"Ce profil n'existe pas ou n'est plus disponible"}),e.jsx("button",{onClick:()=>u(-1),className:"px-6 py-3 bg-brand-500 text-white font-bold rounded-xl hover:bg-brand-600 transition-colors",children:"Retour"})]})}):e.jsxs("div",{className:"min-h-screen bg-gray-50",children:[e.jsx("header",{className:"bg-white border-b sticky top-0 z-40",children:e.jsxs("div",{className:"max-w-2xl mx-auto px-4 py-3 flex items-center justify-between",children:[e.jsx(nf,{}),e.jsx("h1",{className:"font-bold text-gray-900",children:"Profil artisan"}),e.jsxs("div",{className:"flex items-center gap-2",children:[xe?e.jsxs("button",{type:"button",onClick:()=>u("/edit-profile"),className:"p-2 rounded-xl transition-colors hover:bg-brand-50 text-brand-600 flex items-center gap-1.5","aria-label":"Modifier le profil",children:[e.jsx(gp,{size:18}),e.jsx("span",{className:"text-xs font-bold hidden sm:inline",children:"Modifier"})]}):e.jsx("button",{onClick:()=>i&&F(i),className:`p-2 rounded-xl transition-colors ${G?"bg-red-50 text-red-500":"hover:bg-gray-100 text-gray-400"}`,children:e.jsx(xn,{size:20,fill:G?"currentColor":"none"})}),e.jsx("button",{type:"button",onClick:()=>Ne(!0),className:"p-2 hover:bg-gray-100 rounded-xl transition-colors text-gray-400","aria-label":"Partager ce profil",children:e.jsx(k0,{size:20})})]})]})}),e.jsxs("main",{className:"max-w-2xl mx-auto pb-32",children:[e.jsx("div",{className:"bg-white border-b",children:e.jsxs("div",{className:"px-6 py-8",children:[e.jsxs("div",{className:"flex items-start gap-5",children:[e.jsxs("div",{className:"relative",children:[e.jsx("div",{className:"w-24 h-24 rounded-2xl bg-gradient-to-br from-brand-400 to-brand-600 p-0.5 shadow-lg",children:e.jsx("div",{className:"w-full h-full rounded-2xl bg-white flex items-center justify-center overflow-hidden",children:h.avatar_url?e.jsx("img",{src:h.avatar_url,alt:"",className:"w-full h-full object-cover"}):e.jsx(Ht,{size:32,className:"text-brand-500"})})}),ue&&e.jsx("div",{className:"absolute -bottom-1 -right-1 w-8 h-8 bg-green-500 rounded-xl flex items-center justify-center border-2 border-white shadow-lg",children:e.jsx(Qe,{size:16,className:"text-white"})})]}),e.jsxs("div",{className:"flex-1",children:[e.jsx("div",{className:"flex items-center gap-2 mb-1",children:e.jsx("h2",{className:"text-xl font-black text-gray-900",children:h.full_name})}),e.jsx("p",{className:"text-brand-600 font-bold text-sm mb-2",children:((qt=(Lt=h.artisan)==null?void 0:Lt.category)==null?void 0:qt.name)||"Artisan"}),((kt=h.artisan)==null?void 0:kt.specialty)&&e.jsx("p",{className:"text-gray-500 text-sm mb-2",children:h.artisan.specialty}),e.jsxs("div",{className:"flex items-center gap-3 text-sm",children:[e.jsxs("div",{className:"flex items-center gap-1 text-yellow-500",children:[e.jsx(Ma,{size:16,fill:"currentColor"}),e.jsx("span",{className:"font-bold text-gray-900",children:v.avg.toFixed(1)}),e.jsxs("span",{className:"text-gray-400",children:["(",v.count," avis)"]})]}),h.location&&e.jsxs("div",{className:"flex items-center gap-1 text-gray-400",children:[e.jsx(ga,{size:14}),e.jsx("span",{children:h.location})]})]})]})]}),e.jsxs("div",{className:"flex flex-wrap gap-2 mt-6",children:[ue&&e.jsxs("span",{className:"inline-flex items-center gap-1.5 px-3 py-1.5 bg-green-50 text-green-700 rounded-full text-xs font-bold",children:[e.jsx(Gt,{size:14}),"Certifi"]}),w.length>0&&w.map((Ce,Me)=>{const tt=Q=>{switch(Q){case"chambre":return"Chambre de Mtier";case"incubateur":return"Incubateur";case"sae":return"SAE";case"autre":return"Organisme";default:return Q}};return e.jsxs("span",{className:"inline-flex items-center gap-1.5 px-3 py-1.5 bg-brand-50 text-brand-700 rounded-full text-xs font-bold",title:Ce.affiliation_name||tt(Ce.affiliation_type),children:[e.jsx(Qa,{size:14}),Ce.affiliation_name||tt(Ce.affiliation_type)]},Me)}),h.artisan&&e.jsxs("span",{className:`inline-flex items-center gap-1.5 px-3 py-1.5 rounded-full text-xs font-bold ${h.artisan.is_available!==!1?"bg-green-50 text-green-700":"bg-gray-100 text-gray-600"}`,children:[e.jsx(St,{size:14}),h.artisan.is_available!==!1?"Disponible":"Occup"]}),h.member_id&&e.jsxs("span",{className:"inline-flex items-center gap-1.5 px-3 py-1.5 bg-gray-100 text-gray-600 rounded-full text-xs font-mono",children:[e.jsx(ip,{size:12}),h.member_id]}),e.jsxs("span",{className:`inline-flex items-center gap-1.5 px-3 py-1.5 rounded-full text-xs font-bold ${_d[v.tier]}`,children:[e.jsx(Sl,{size:14}),v.tier]}),h.created_at&&e.jsxs("span",{className:"inline-flex items-center gap-1.5 px-3 py-1.5 bg-blue-50 text-blue-700 rounded-full text-xs font-bold",children:[e.jsx(mr,{size:14}),"Membre depuis ",new Date(h.created_at).getFullYear()]})]})]})}),((Rt=h.artisan)==null?void 0:Rt.bio)&&e.jsxs("section",{className:"bg-white border-b px-6 py-6",children:[e.jsx("h3",{className:"font-bold text-gray-900 mb-3",children:" propos"}),e.jsx("p",{className:"text-gray-600 leading-relaxed",children:h.artisan.bio})]}),Ae.length>0&&e.jsxs("section",{id:"portfolio",className:"bg-white border-b px-6 py-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsxs("h3",{className:"font-bold text-gray-900 flex items-center gap-2",children:[e.jsx(tl,{size:18,className:"text-brand-500"}),"Portfolio Photos"]}),e.jsxs("span",{className:"text-xs text-gray-400 font-bold",children:[Ae.length,"/10"]})]}),e.jsx("div",{className:"grid grid-cols-3 gap-2",children:Ae.slice(0,6).map((Ce,Me)=>e.jsxs("button",{onClick:()=>Ke("photo",Me),className:"relative aspect-square rounded-xl overflow-hidden group",children:[e.jsx("img",{src:Ce,alt:`Portfolio ${Me+1}`,className:"w-full h-full object-cover group-hover:scale-110 transition-transform duration-300"}),e.jsx("div",{className:"absolute inset-0 bg-black/0 group-hover:bg-black/20 transition-colors"}),Me===5&&Ae.length>6&&e.jsx("div",{className:"absolute inset-0 bg-black/60 flex items-center justify-center",children:e.jsxs("span",{className:"text-white font-bold text-lg",children:["+",Ae.length-6]})})]},Me))})]}),ze.length>0&&e.jsxs("section",{id:Ae.length===0?"portfolio":void 0,className:"bg-white border-b px-6 py-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsxs("h3",{className:"font-bold text-gray-900 flex items-center gap-2",children:[e.jsx(zs,{size:18,className:"text-brand-500"}),"Portfolio Vidos"]}),e.jsxs("span",{className:"text-xs text-gray-400 font-bold",children:[ze.length,"/5"]})]}),e.jsx("div",{className:"grid grid-cols-2 gap-3",children:ze.map((Ce,Me)=>e.jsxs("button",{onClick:()=>Ke("video",Me),className:"relative aspect-video rounded-xl overflow-hidden group bg-gray-900",children:[e.jsx("video",{src:Ce,className:"w-full h-full object-cover"}),e.jsx("div",{className:"absolute inset-0 bg-black/40 flex items-center justify-center group-hover:bg-black/60 transition-colors",children:e.jsx("div",{className:"w-12 h-12 bg-white/20 backdrop-blur-sm rounded-full flex items-center justify-center",children:e.jsx(Nl,{size:24,className:"text-white ml-1",fill:"white"})})})]},Me))})]}),e.jsxs("section",{className:"bg-white border-b px-6 py-6",children:[e.jsx("h3",{className:"font-bold text-gray-900 mb-4",children:"Contact"}),e.jsxs("div",{className:"space-y-3",children:[h.phone&&e.jsxs("div",{className:"flex items-center gap-3 text-gray-400",children:[e.jsx("div",{className:"w-10 h-10 bg-gray-100 rounded-xl flex items-center justify-center",children:e.jsx(hn,{size:18,className:"text-gray-400"})}),e.jsx("span",{className:"font-medium text-sm",children:"Numro masqu pour la confidentialit"})]}),e.jsxs("div",{className:"flex items-center gap-3 text-gray-600",children:[e.jsx("div",{className:"w-10 h-10 bg-gray-100 rounded-xl flex items-center justify-center",children:e.jsx(Zi,{size:18,className:"text-gray-500"})}),e.jsx("span",{className:"font-medium",children:h.email})]}),h.location&&e.jsxs("div",{className:"flex items-center gap-3 text-gray-600",children:[e.jsx("div",{className:"w-10 h-10 bg-gray-100 rounded-xl flex items-center justify-center",children:e.jsx(ga,{size:18,className:"text-gray-500"})}),e.jsx("span",{className:"font-medium",children:h.location})]})]})]}),e.jsx("section",{className:"bg-white px-6 py-6",children:e.jsxs("div",{className:"grid grid-cols-3 gap-4",children:[e.jsxs("div",{className:"text-center p-4 bg-gray-50 rounded-2xl",children:[e.jsx("p",{className:"text-2xl font-black text-gray-900",children:v.projectsCount}),e.jsx("p",{className:"text-xs text-gray-500 font-bold uppercase",children:"Projets"})]}),e.jsxs("div",{className:"text-center p-4 bg-gray-50 rounded-2xl",children:[e.jsx("p",{className:"text-2xl font-black text-gray-900",children:v.avg.toFixed(1)}),e.jsx("p",{className:"text-xs text-gray-500 font-bold uppercase",children:"Note"})]}),e.jsxs("div",{className:"text-center p-4 bg-gray-50 rounded-2xl",children:[e.jsx("p",{className:"text-2xl font-black text-gray-900",children:v.count}),e.jsx("p",{className:"text-xs text-gray-500 font-bold uppercase",children:"Avis"})]})]})}),e.jsxs("section",{className:"bg-white border-b px-6 py-6",children:[e.jsxs("h3",{className:"font-bold text-gray-900 flex items-center gap-2 mb-4",children:[e.jsx(bp,{size:18,className:"text-brand-500"}),"Avis clients (",v.count,")"]}),E.length===0?e.jsxs("div",{className:"text-center py-8",children:[e.jsx("div",{className:"w-14 h-14 bg-gray-100 rounded-2xl flex items-center justify-center mx-auto mb-3",children:e.jsx(Ma,{size:24,className:"text-gray-300"})}),e.jsx("p",{className:"text-gray-500 font-medium",children:"Pas encore d'avis"}),e.jsx("p",{className:"text-sm text-gray-400",children:"Soyez le premier  donner votre avis !"})]}):e.jsxs("div",{className:"space-y-4",children:[E.map(Ce=>{var Me,tt;return e.jsxs("div",{className:"bg-gray-50 rounded-2xl p-4",children:[e.jsxs("div",{className:"flex items-start gap-3 mb-3",children:[e.jsx("div",{className:"w-10 h-10 rounded-xl bg-gray-200 flex items-center justify-center overflow-hidden flex-shrink-0",children:(Me=Ce.client)!=null&&Me.avatar_url?e.jsx("img",{src:Ce.client.avatar_url,alt:"",className:"w-full h-full object-cover"}):e.jsx(ot,{size:18,className:"text-gray-400"})}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("p",{className:"font-bold text-gray-900 truncate",children:((tt=Ce.client)==null?void 0:tt.full_name)||"Client"}),e.jsx("span",{className:"text-xs text-gray-400 flex-shrink-0 ml-2",children:new Date(Ce.created_at).toLocaleDateString("fr-FR",{day:"numeric",month:"short",year:"numeric"})})]}),e.jsx("div",{className:"flex items-center gap-0.5 mt-1",children:[...Array(5)].map((Q,be)=>e.jsx(Ma,{size:14,className:be<Ce.rating?"text-yellow-400 fill-yellow-400":"text-gray-300"},be))})]})]}),Ce.comment&&e.jsx("p",{className:"text-gray-600 text-sm leading-relaxed mb-3",children:Ce.comment}),Ce.artisan_response&&e.jsx("div",{className:"mt-3 pt-3 border-t border-gray-200",children:e.jsxs("div",{className:"flex items-start gap-2 mb-2",children:[e.jsx("div",{className:"w-8 h-8 rounded-lg bg-brand-100 flex items-center justify-center flex-shrink-0",children:e.jsx(es,{size:14,className:"text-brand-600"})}),e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[e.jsx("p",{className:"text-xs font-bold text-brand-700",children:"Rponse de l'artisan"}),Ce.artisan_response_at&&e.jsx("span",{className:"text-xs text-gray-400",children:new Date(Ce.artisan_response_at).toLocaleDateString("fr-FR",{day:"numeric",month:"short",year:"numeric"})})]}),e.jsx("p",{className:"text-sm text-gray-700 leading-relaxed",children:Ce.artisan_response})]})]})}),!Ce.artisan_response&&(o==null?void 0:o.id)===i&&e.jsxs("button",{onClick:()=>{const Q=Ce.id;T(Q)},className:"mt-3 w-full py-2 bg-brand-50 text-brand-700 font-bold text-xs rounded-xl hover:bg-brand-100 transition-colors flex items-center justify-center gap-2",children:[e.jsx(es,{size:14}),"Rpondre au commentaire"]})]},Ce.id)}),E.length>5&&e.jsxs("button",{className:"w-full py-3 text-center text-brand-600 font-bold text-sm hover:bg-brand-50 rounded-xl transition-colors",children:["Voir tous les avis (",v.count,")"]})]})]})]}),Se&&e.jsx("div",{className:"fixed bottom-0 left-0 right-0 bg-white border-t px-4 py-4 z-40",children:e.jsx("div",{className:"max-w-2xl mx-auto flex gap-3",children:o?e.jsxs(e.Fragment,{children:[V&&e.jsxs("button",{type:"button",onClick:()=>u(`/chat/${V}`),className:"flex-1 py-4 bg-gray-100 text-gray-700 font-bold rounded-2xl flex items-center justify-center gap-2 hover:bg-gray-200 transition-colors",children:[e.jsx(fr,{size:20}),"Message"]}),e.jsxs("button",{onClick:Le,className:`${V?"flex-[2]":"flex-1"} py-4 bg-brand-500 text-white font-black rounded-2xl flex items-center justify-center gap-2 hover:bg-brand-600 active:scale-[0.98] transition-all shadow-lg shadow-brand-200`,children:[e.jsx(Ht,{size:20}),"Demander un projet"]})]}):e.jsxs("button",{onClick:Le,className:"flex-[2] w-full py-4 bg-brand-500 text-white font-black rounded-2xl flex items-center justify-center gap-2 hover:bg-brand-600 active:scale-[0.98] transition-all shadow-lg shadow-brand-200",children:[e.jsx(es,{size:20}),"Contacter (s'inscrire ou se connecter)"]})})}),he&&e.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black/50 backdrop-blur-sm animate-in fade-in duration-200",children:e.jsxs("div",{className:"bg-white rounded-2xl shadow-2xl max-w-sm w-full mx-4 animate-in zoom-in-95 duration-200 overflow-hidden",children:[e.jsxs("div",{className:"flex items-center justify-between p-4 border-b border-gray-100",children:[e.jsx("h3",{className:"text-lg font-black text-gray-900",children:"Partager ce profil"}),e.jsx("button",{type:"button",onClick:()=>Ne(!1),className:"p-2 rounded-xl hover:bg-gray-100 transition-colors","aria-label":"Fermer",children:e.jsx(Ze,{size:20,className:"text-gray-500"})})]}),e.jsxs("div",{className:"p-4 space-y-2 max-h-[70vh] overflow-y-auto",children:[$&&e.jsxs("button",{type:"button",onClick:ce,className:"w-full py-3 px-4 rounded-xl bg-brand-500 text-white font-bold flex items-center justify-center gap-2 hover:bg-brand-600 transition-colors",children:[e.jsx(k0,{size:20}),"Partager via (WhatsApp, SMS, Bluetooth, etc.)"]}),e.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[e.jsxs("button",{type:"button",onClick:()=>we(st.facebook),className:"py-3 px-3 rounded-xl bg-[#1877F2] text-white font-bold text-sm flex items-center justify-center gap-2 hover:opacity-90 transition-opacity",children:[e.jsx("span",{"aria-hidden":!0,children:"f"})," Facebook"]}),e.jsx("button",{type:"button",onClick:()=>we(st.whatsapp),className:"py-3 px-3 rounded-xl bg-[#25D366] text-white font-bold text-sm flex items-center justify-center gap-2 hover:opacity-90 transition-opacity",children:"WhatsApp"}),e.jsx("button",{type:"button",onClick:()=>we(st.twitter),className:"py-3 px-3 rounded-xl bg-black text-white font-bold text-sm flex items-center justify-center gap-2 hover:opacity-90 transition-opacity",children:"X (Twitter)"}),e.jsx("button",{type:"button",onClick:()=>we(st.linkedin),className:"py-3 px-3 rounded-xl bg-[#0A66C2] text-white font-bold text-sm flex items-center justify-center gap-2 hover:opacity-90 transition-opacity",children:"LinkedIn"}),e.jsx("button",{type:"button",onClick:()=>we(st.telegram),className:"py-3 px-3 rounded-xl bg-[#0088cc] text-white font-bold text-sm flex items-center justify-center gap-2 hover:opacity-90 transition-opacity",children:"Telegram"}),e.jsx("button",{type:"button",onClick:()=>{window.location.href=st.sms,Ne(!1)},className:"py-3 px-3 rounded-xl bg-gray-600 text-white font-bold text-sm flex items-center justify-center gap-2 hover:bg-gray-700 transition-colors",children:"SMS"})]}),e.jsxs("button",{type:"button",onClick:We,className:"w-full py-3 px-4 rounded-xl border-2 border-gray-200 text-gray-700 font-bold flex items-center justify-center gap-2 hover:bg-gray-50 transition-colors",children:[e.jsx(sp,{size:18}),"Copier le lien"]}),e.jsx("p",{className:"text-xs text-gray-500 text-center pt-1",children:"Instagram, TikTok : collez le lien copi dans lapp."})]})]})}),Z&&e.jsxs("div",{className:"fixed inset-0 bg-black z-50 flex items-center justify-center",children:[e.jsx("button",{onClick:ft,className:"absolute top-4 right-4 w-12 h-12 bg-white/10 backdrop-blur-sm rounded-full flex items-center justify-center text-white hover:bg-white/20 transition-colors z-10",children:e.jsx(Ze,{size:24})}),e.jsx("button",{onClick:je,className:"absolute left-4 w-12 h-12 bg-white/10 backdrop-blur-sm rounded-full flex items-center justify-center text-white hover:bg-white/20 transition-colors",children:e.jsx(X0,{size:28})}),e.jsx("button",{onClick:_e,className:"absolute right-4 w-12 h-12 bg-white/10 backdrop-blur-sm rounded-full flex items-center justify-center text-white hover:bg-white/20 transition-colors",children:e.jsx(da,{size:28})}),e.jsx("div",{className:"max-w-4xl max-h-[80vh] w-full mx-4",children:ge==="photo"?e.jsx("img",{src:Ae[R],alt:`Portfolio ${R+1}`,className:"w-full h-full object-contain"}):e.jsx("video",{src:ze[R],controls:!0,autoPlay:!0,className:"w-full h-full object-contain"})}),e.jsxs("div",{className:"absolute bottom-6 left-1/2 -translate-x-1/2 text-white text-sm font-bold bg-black/50 px-4 py-2 rounded-full",children:[R+1," / ",ge==="photo"?Ae.length:ze.length]})]}),q&&e.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black/50 backdrop-blur-sm animate-in fade-in duration-200",children:e.jsxs("div",{className:"bg-white rounded-2xl shadow-2xl max-w-lg w-full mx-4 animate-in zoom-in-95 duration-200",children:[e.jsxs("div",{className:"flex items-center justify-between p-6 border-b border-gray-100",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-10 h-10 bg-brand-100 rounded-xl flex items-center justify-center",children:e.jsx(es,{className:"text-brand-600",size:20})}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-black text-gray-900",children:"Rpondre au commentaire"}),e.jsx("p",{className:"text-xs text-gray-500",children:"Votre rponse sera visible publiquement"})]})]}),e.jsx("button",{onClick:()=>{T(null),B("")},className:"w-8 h-8 flex items-center justify-center rounded-lg hover:bg-gray-100 transition-colors",disabled:z,children:e.jsx(Ze,{size:18,className:"text-gray-400"})})]}),e.jsxs("form",{onSubmit:async Ce=>{if(Ce.preventDefault(),!C.trim()){N("Veuillez saisir une rponse");return}S(!0);try{const{error:Me}=await j.from("reviews").update({artisan_response:C.trim(),artisan_response_at:new Date().toISOString()}).eq("id",q);if(Me)throw Me;y("Rponse publie avec succs");const{data:tt}=await j.from("reviews").select(`
                      id, rating, comment, created_at, artisan_response, artisan_response_at,
                      profiles!reviews_client_id_fkey (full_name, avatar_url)
                    `).eq("artisan_id",i).order("created_at",{ascending:!1}).limit(10);if(tt){const Q=tt.map(be=>({id:be.id,rating:be.rating,comment:be.comment,created_at:be.created_at,artisan_response:be.artisan_response,artisan_response_at:be.artisan_response_at,client:be.profiles?{full_name:be.profiles.full_name,avatar_url:be.profiles.avatar_url}:null}));d(Q)}T(null),B("")}catch(Me){console.error("Error submitting response:",Me),N(`Erreur: ${Me.message||"Impossible de publier la rponse"}`)}finally{S(!1)}},className:"p-6 space-y-4",children:[e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-bold text-gray-700 mb-2",children:["Votre rponse ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx("textarea",{value:C,onChange:Ce=>B(Ce.target.value),placeholder:"Merci pour votre commentaire...",rows:5,className:"w-full px-4 py-3 border border-gray-200 rounded-xl focus:ring-2 focus:ring-brand-500 focus:border-transparent resize-none text-sm",disabled:z,required:!0}),e.jsxs("p",{className:"text-xs text-gray-500 mt-1",children:[C.length," / 500 caractres"]})]}),e.jsxs("div",{className:"flex gap-3 pt-2",children:[e.jsx("button",{type:"button",onClick:()=>{T(null),B("")},disabled:z,className:"flex-1 px-4 py-3 bg-gray-100 text-gray-700 font-bold rounded-xl hover:bg-gray-200 transition-colors disabled:opacity-50 disabled:cursor-not-allowed",children:"Annuler"}),e.jsx("button",{type:"submit",disabled:z||!C.trim(),className:"flex-1 px-4 py-3 bg-brand-500 text-white font-bold rounded-xl hover:bg-brand-600 transition-colors disabled:opacity-50 disabled:cursor-not-allowed flex items-center justify-center gap-2",children:z?e.jsx("div",{className:"w-5 h-5 border-2 border-white border-t-transparent rounded-full animate-spin"}):e.jsxs(e.Fragment,{children:[e.jsx(al,{size:16}),"Publier la rponse"]})})]})]})]})})]})}function Xb(){const i=ht(),{favorites:u,loading:f,removeFavorite:o}=jf(),x=async(y,N)=>{N.stopPropagation(),await o(y)};return f?e.jsx(Yt,{}):e.jsxs("div",{className:"min-h-screen bg-gray-50",children:[e.jsx("header",{className:"bg-white border-b border-gray-100 sticky top-0 z-10",children:e.jsxs("div",{className:"max-w-lg mx-auto px-4 py-4 flex items-center gap-4",children:[e.jsx("button",{onClick:()=>i(-1),className:"w-10 h-10 rounded-full bg-gray-100 flex items-center justify-center text-gray-600",children:e.jsx(Wt,{size:20})}),e.jsxs("div",{className:"flex-1",children:[e.jsx("h1",{className:"font-bold text-gray-900",children:"Mes favoris"}),e.jsxs("p",{className:"text-xs text-gray-400",children:[u.length," artisan",u.length>1?"s":""," sauvegard",u.length>1?"s":""]})]}),e.jsx("div",{className:"w-10 h-10 rounded-full bg-red-100 flex items-center justify-center",children:e.jsx(xn,{size:20,className:"text-red-500 fill-red-500"})})]})}),e.jsx("main",{className:"max-w-lg mx-auto px-4 py-6",children:u.length===0?e.jsxs("div",{className:"py-12 text-center",children:[e.jsx("div",{className:"w-20 h-20 bg-gray-100 rounded-full mx-auto mb-4 flex items-center justify-center",children:e.jsx(xn,{size:40,className:"text-gray-300"})}),e.jsx("h3",{className:"font-bold text-gray-900 mb-2",children:"Aucun favori"}),e.jsx("p",{className:"text-gray-500 text-sm mb-6",children:"Sauvegardez vos artisans prfrs pour les retrouver facilement"}),e.jsx("button",{onClick:()=>i("/dashboard"),className:"px-6 py-3 bg-brand-500 text-white font-bold rounded-xl",children:"Dcouvrir les artisans"})]}):e.jsx("div",{className:"space-y-3",children:u.map(y=>{var N,h,g,E;return e.jsx("div",{className:"bg-white rounded-2xl p-4 border border-gray-100 hover:shadow-md transition-all cursor-pointer",onClick:()=>i(`/artisans/${y.artisan_id}`),children:e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("div",{className:"w-16 h-16 rounded-xl bg-brand-100 flex items-center justify-center overflow-hidden flex-shrink-0",children:(N=y.artisan)!=null&&N.avatar_url?e.jsx("img",{src:y.artisan.avatar_url,alt:"",className:"w-full h-full object-cover"}):e.jsx(ot,{size:28,className:"text-brand-500"})}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("h3",{className:"font-bold text-gray-900 truncate",children:(h=y.artisan)==null?void 0:h.full_name}),((g=y.artisan)==null?void 0:g.category)&&e.jsxs("div",{className:"flex items-center gap-1 text-sm text-brand-600 mt-0.5",children:[e.jsx(Ht,{size:12}),e.jsx("span",{children:y.artisan.category.name})]}),((E=y.artisan)==null?void 0:E.location)&&e.jsxs("div",{className:"flex items-center gap-1 text-xs text-gray-400 mt-1",children:[e.jsx(ga,{size:12}),e.jsx("span",{children:y.artisan.location})]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("button",{onClick:d=>x(y.artisan_id,d),className:"w-10 h-10 rounded-xl bg-red-50 flex items-center justify-center text-red-500 hover:bg-red-100 transition-colors",children:e.jsx(gr,{size:18})}),e.jsx(da,{size:20,className:"text-gray-300"})]})]})},y.id)})})})]})}function Zb(){const i=ht(),[u,f]=$i.useState(!1),[o,x]=$i.useState(!1),y=()=>{window.open("https://wa.me/221788324069","_blank")};return e.jsxs("div",{className:"min-h-screen bg-gray-50",children:[e.jsx("header",{className:"bg-white border-b sticky top-0 z-50",children:e.jsxs("div",{className:"max-w-7xl mx-auto px-4 md:px-6 py-4 flex items-center justify-between",children:[e.jsx("button",{onClick:()=>i(-1),className:"p-2 hover:bg-gray-100 rounded-xl transition-colors",children:e.jsx(Wt,{size:20,className:"text-gray-600"})}),e.jsx("h1",{className:"text-xl font-black text-gray-900",children:" propos"}),e.jsx("button",{onClick:()=>i("/"),className:"p-2 hover:bg-brand-50 rounded-xl transition-colors group",title:"Retour  l'accueil",children:e.jsx(xr,{size:20,className:"text-gray-600 group-hover:text-brand-500 transition-colors"})})]})}),e.jsxs("main",{className:"max-w-5xl mx-auto px-4 md:px-6 py-12",children:[e.jsxs("section",{className:"text-center mb-16",children:[e.jsxs("h2",{className:"text-4xl md:text-5xl font-black text-gray-900 mb-4 tracking-tight",children:["Mboura",e.jsx("span",{className:"text-brand-500",children:"k"})]}),e.jsx("p",{className:"text-xl text-gray-600 font-medium max-w-2xl mx-auto leading-relaxed",children:"La plateforme qui connecte les meilleurs artisans du Sngal avec des clients exigeants, ancre dans la culture sngalaise et tourne vers l'excellence."})]}),e.jsx("section",{className:"mb-16",children:e.jsxs("div",{className:"grid md:grid-cols-2 gap-8",children:[e.jsxs("div",{className:"bg-white rounded-2xl p-8 shadow-sm border border-gray-100",children:[e.jsx("div",{className:"w-16 h-16 bg-brand-50 rounded-2xl flex items-center justify-center mb-6",children:e.jsx(wp,{size:28,className:"text-brand-500"})}),e.jsx("h3",{className:"text-2xl font-black text-gray-900 mb-4",children:"Notre Mission"}),e.jsx("p",{className:"text-gray-600 leading-relaxed",children:"Faciliter la mise en relation entre artisans qualifis et clients  la recherche d'excellence. Nous crons un cosystme de confiance o chaque projet trouve l'artisan parfait, et o chaque artisan peut dvelopper son activit en toute srnit."})]}),e.jsxs("div",{className:"bg-white rounded-2xl p-8 shadow-sm border border-gray-100",children:[e.jsx("div",{className:"w-16 h-16 bg-purple-50 rounded-2xl flex items-center justify-center mb-6",children:e.jsx(P0,{size:28,className:"text-purple-500"})}),e.jsx("h3",{className:"text-2xl font-black text-gray-900 mb-4",children:"Notre Vision"}),e.jsx("p",{className:"text-gray-600 leading-relaxed",children:"Devenir la rfrence au Sngal pour la mise en relation artisanale, en valorisant le savoir-faire local et en promouvant l'excellence. Nous visons  transformer le secteur artisanal sngalais en le rendant plus accessible, transparent et performant."})]})]})}),e.jsxs("section",{className:"mb-16",children:[e.jsxs("div",{className:"text-center mb-12",children:[e.jsx("h2",{className:"text-3xl md:text-4xl font-black text-gray-900 mb-4",children:"Notre Impact"}),e.jsx("p",{className:"text-gray-600 max-w-2xl mx-auto",children:"Mbourak transforme la faon dont les Sngalais trouvent et travaillent avec des artisans."})]}),e.jsxs("div",{className:"grid md:grid-cols-2 lg:grid-cols-4 gap-6 mb-12",children:[e.jsxs("div",{className:"bg-gradient-to-br from-brand-50 to-orange-50 rounded-2xl p-6 text-center border border-brand-100 shadow-sm",children:[e.jsx(Is,{size:32,className:"text-brand-500 mx-auto mb-4"}),e.jsx("div",{className:"text-3xl font-black text-gray-900 mb-2",children:"500K"}),e.jsx("p",{className:"text-gray-600 font-medium text-sm",children:"Jeunes artisans cibls en 2026"})]}),e.jsxs("div",{className:"bg-gradient-to-br from-green-50 to-emerald-50 rounded-2xl p-6 text-center border border-green-100 shadow-sm",children:[e.jsx(dr,{size:32,className:"text-green-500 mx-auto mb-4"}),e.jsx("div",{className:"text-xl font-black text-gray-900 mb-2",children:"Formation"}),e.jsx("p",{className:"text-gray-600 font-medium text-sm",children:"Accompagnement & Digitalisation"})]}),e.jsxs("div",{className:"bg-gradient-to-br from-blue-50 to-cyan-50 rounded-2xl p-6 text-center border border-blue-100 shadow-sm",children:[e.jsx(z0,{size:32,className:"text-blue-500 mx-auto mb-4"}),e.jsx("div",{className:"text-3xl font-black text-gray-900 mb-2",children:"2026"}),e.jsx("p",{className:"text-gray-600 font-medium text-sm",children:"Objectif annuel"})]}),e.jsxs("div",{className:"bg-gradient-to-br from-purple-50 to-pink-50 rounded-2xl p-6 text-center border border-purple-100 shadow-sm",children:[e.jsx(Ma,{size:32,className:"text-purple-500 mx-auto mb-4"}),e.jsx("div",{className:"text-xl font-black text-gray-900 mb-2",children:"Impact"}),e.jsx("p",{className:"text-gray-600 font-medium text-sm",children:"Transformation du secteur"})]})]}),e.jsxs("div",{className:"bg-white rounded-2xl p-8 shadow-sm border border-gray-100",children:[e.jsxs("h3",{className:"text-2xl font-black text-gray-900 mb-6 flex items-center gap-3",children:[e.jsx(dr,{size:28,className:"text-brand-500"}),"Nos Objectifs"]}),e.jsxs("div",{className:"grid md:grid-cols-2 gap-6",children:[e.jsxs("div",{className:"flex items-start gap-4",children:[e.jsx(Qe,{size:24,className:"text-green-500 flex-shrink-0 mt-1"}),e.jsxs("div",{children:[e.jsx("h4",{className:"font-black text-gray-900 mb-2",children:"Valoriser l'artisanat local"}),e.jsx("p",{className:"text-gray-600 text-sm",children:"Mettre en avant le savoir-faire sngalais et crer des opportunits conomiques pour les artisans locaux."})]})]}),e.jsxs("div",{className:"flex items-start gap-4",children:[e.jsx(Qe,{size:24,className:"text-green-500 flex-shrink-0 mt-1"}),e.jsxs("div",{children:[e.jsx("h4",{className:"font-black text-gray-900 mb-2",children:"Garantir la qualit"}),e.jsx("p",{className:"text-gray-600 text-sm",children:"Systme de vrification et d'avis pour assurer la confiance entre clients et artisans."})]})]}),e.jsxs("div",{className:"flex items-start gap-4",children:[e.jsx(Qe,{size:24,className:"text-green-500 flex-shrink-0 mt-1"}),e.jsxs("div",{children:[e.jsx("h4",{className:"font-black text-gray-900 mb-2",children:"Faciliter l'accs"}),e.jsx("p",{className:"text-gray-600 text-sm",children:"Rendre les services artisanaux accessibles  tous, partout au Sngal, avec une interface simple et intuitive."})]})]}),e.jsxs("div",{className:"flex items-start gap-4",children:[e.jsx(Qe,{size:24,className:"text-green-500 flex-shrink-0 mt-1"}),e.jsxs("div",{children:[e.jsx("h4",{className:"font-black text-gray-900 mb-2",children:"Promouvoir l'excellence"}),e.jsx("p",{className:"text-gray-600 text-sm",children:"Systme de niveaux et de badges pour rcompenser les artisans les plus performants et encourager l'amlioration continue."})]})]})]})]})]}),e.jsxs("section",{className:"mb-16",children:[e.jsxs("div",{className:"text-center mb-12",children:[e.jsxs("div",{className:"inline-flex items-center gap-2 px-4 py-2 bg-brand-50 rounded-full mb-6",children:[e.jsx(ud,{size:18,className:"text-brand-500"}),e.jsx("span",{className:"text-sm font-black text-brand-600 uppercase tracking-widest",children:"Technologie"})]}),e.jsx("h2",{className:"text-3xl md:text-4xl font-black text-gray-900 mb-4",children:"L'innovation au service de l'excellence"}),e.jsx("p",{className:"text-gray-600 max-w-2xl mx-auto text-lg leading-relaxed",children:"Mbourak est le fruit d'une collaboration entre vision et expertise technique, porte par une quipe passionne d'innovation made in Africa."})]}),e.jsxs("div",{className:"bg-gradient-to-br from-brand-500 to-orange-600 rounded-3xl p-8 md:p-12 text-white shadow-2xl shadow-brand-200/50 mb-8",children:[e.jsxs("div",{className:"flex flex-col md:flex-row items-start gap-8 mb-8",children:[e.jsx("div",{className:"flex-shrink-0",children:e.jsx("div",{className:"w-32 h-32 bg-white/20 backdrop-blur-md rounded-3xl flex items-center justify-center border-2 border-white/30 shadow-xl",children:u?e.jsx(ud,{size:40,className:"text-white"}):e.jsx("img",{src:"/logo-impulcia-afrique.jpg",alt:"IMPULCIA AFRIQUE Logo",className:"w-24 h-24 object-contain",onError:()=>f(!0)})})}),e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"mb-4",children:[e.jsx("h3",{className:"text-3xl md:text-4xl font-black mb-2",children:"IMPULCIA AFRIQUE"}),e.jsx("p",{className:"text-white/90 font-bold text-lg mb-4",children:"Ingnierie & Solution Informatique  Made in Africa"})]}),e.jsxs("p",{className:"text-white/90 leading-relaxed mb-4 text-lg",children:[e.jsx("strong",{children:"IMPULCIA AFRIQUE"})," est un leader de l'innovation technologique en Afrique, reconnu pour son expertise exceptionnelle en ingnierie logicielle, intelligence artificielle et transformation digitale. Nous matrisons les technologies les plus avances et repoussons constamment les limites de l'innovation pour crer des solutions qui transforment rellement les entreprises, les organisations et les gouvernements."]}),e.jsxs("p",{className:"text-white/90 leading-relaxed mb-6 text-lg",children:["Notre approche unique combine ",e.jsx("strong",{children:"excellence technique"}),", ",e.jsx("strong",{children:"matrise des nouvelles technologies"}),",",e.jsx("strong",{children:" intelligence artificielle"})," et ",e.jsx("strong",{children:"vision stratgique"}),". Nous ne nous contentons pas de dvelopper des solutions : nous crons des cosystmes digitaux complets qui permettent  nos clients de baser leur fonctionnement sur la ",e.jsx("strong",{children:"performance"}),", la ",e.jsx("strong",{children:"traabilit"}),", l'",e.jsx("strong",{children:"automatisation"})," et la ",e.jsx("strong",{children:"culture de la data"})," avec des objectifs mesurables, quantifiables et vrifiables."]})]})]}),e.jsxs("div",{className:"border-t border-white/30 pt-8 mb-8",children:[e.jsxs("h4",{className:"text-xl font-black mb-6 flex items-center gap-2",children:[e.jsx(yp,{size:24}),"Nos Services"]}),e.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-3 lg:grid-cols-4 gap-4",children:[e.jsxs("div",{className:"flex items-center gap-3 bg-white/10 backdrop-blur-sm rounded-xl p-3 border border-white/20",children:[e.jsx(ud,{size:20,className:"text-white flex-shrink-0"}),e.jsx("span",{className:"text-sm font-bold",children:"Ingnierie Informatique"})]}),e.jsxs("div",{className:"flex items-center gap-3 bg-white/10 backdrop-blur-sm rounded-xl p-3 border border-white/20",children:[e.jsx(tf,{size:20,className:"text-white flex-shrink-0"}),e.jsx("span",{className:"text-sm font-bold",children:"Dveloppement de Logiciels"})]}),e.jsxs("div",{className:"flex items-center gap-3 bg-white/10 backdrop-blur-sm rounded-xl p-3 border border-white/20",children:[e.jsx(Qi,{size:20,className:"text-white flex-shrink-0"}),e.jsx("span",{className:"text-sm font-bold",children:"Applications Mobiles"})]}),e.jsxs("div",{className:"flex items-center gap-3 bg-white/10 backdrop-blur-sm rounded-xl p-3 border border-white/20",children:[e.jsx(Di,{size:20,className:"text-white flex-shrink-0"}),e.jsx("span",{className:"text-sm font-bold",children:"Sites Web Institutionnels"})]}),e.jsxs("div",{className:"flex items-center gap-3 bg-white/10 backdrop-blur-sm rounded-xl p-3 border border-white/20",children:[e.jsx(Ht,{size:20,className:"text-white flex-shrink-0"}),e.jsx("span",{className:"text-sm font-bold",children:"Applications Mtiers"})]}),e.jsxs("div",{className:"flex items-center gap-3 bg-white/10 backdrop-blur-sm rounded-xl p-3 border border-white/20",children:[e.jsx(Is,{size:20,className:"text-white flex-shrink-0"}),e.jsx("span",{className:"text-sm font-bold",children:"SIRH"})]}),e.jsxs("div",{className:"flex items-center gap-3 bg-white/10 backdrop-blur-sm rounded-xl p-3 border border-white/20",children:[e.jsx(up,{size:20,className:"text-white flex-shrink-0"}),e.jsx("span",{className:"text-sm font-bold",children:"Systmes d'Information"})]}),e.jsxs("div",{className:"flex items-center gap-3 bg-white/10 backdrop-blur-sm rounded-xl p-3 border border-white/20",children:[e.jsx(vp,{size:20,className:"text-white flex-shrink-0"}),e.jsx("span",{className:"text-sm font-bold",children:"Hbergement & Plateformes"})]}),e.jsxs("div",{className:"flex items-center gap-3 bg-white/10 backdrop-blur-sm rounded-xl p-3 border border-white/20",children:[e.jsx(et,{size:20,className:"text-white flex-shrink-0"}),e.jsx("span",{className:"text-sm font-bold",children:"Formulaires de Collecte"})]}),e.jsxs("div",{className:"flex items-center gap-3 bg-white/10 backdrop-blur-sm rounded-xl p-3 border border-white/20",children:[e.jsx(Wh,{size:20,className:"text-white flex-shrink-0"}),e.jsx("span",{className:"text-sm font-bold",children:"Data Analysis"})]}),e.jsxs("div",{className:"flex items-center gap-3 bg-white/10 backdrop-blur-sm rounded-xl p-3 border border-white/20",children:[e.jsx(dr,{size:20,className:"text-white flex-shrink-0"}),e.jsx("span",{className:"text-sm font-bold",children:"Solutions Performance"})]}),e.jsxs("div",{className:"flex items-center gap-3 bg-white/10 backdrop-blur-sm rounded-xl p-3 border border-white/20",children:[e.jsx(Kh,{size:20,className:"text-white flex-shrink-0"}),e.jsx("span",{className:"text-sm font-bold",children:"Conseil & Stratgie"})]})]})]}),e.jsxs("div",{className:"border-t border-white/30 pt-8",children:[e.jsxs("h4",{className:"text-xl font-black mb-4 flex items-center gap-2",children:[e.jsx(Sl,{size:24}),"Expertise & Engagement"]}),e.jsxs("p",{className:"text-white/90 leading-relaxed mb-4",children:["Notre quipe combine une expertise technique de niveau mondial, une comprhension profonde des enjeux locaux et une passion inbranlable pour l'innovation. Nous matrisons les technologies les plus rcentes :",e.jsx("strong",{children:" intelligence artificielle"}),", ",e.jsx("strong",{children:"machine learning"}),", ",e.jsx("strong",{children:"cloud computing"}),",",e.jsx("strong",{children:" architectures microservices"}),", et bien plus encore."]}),e.jsxs("p",{className:"text-white/90 leading-relaxed mb-6",children:["Au-del de l'ingnierie, nous offrons une ",e.jsx("strong",{children:"expertise managriale"})," en stratgie d'entreprise, combinant ",e.jsx("strong",{children:"conseil"}),", ",e.jsx("strong",{children:"accompagnement"})," et ",e.jsx("strong",{children:"excution"}),". Nous dveloppons des systmes de notation de projet, des solutions de gestion de performance, et accompagnons nos clients dans leur transformation digitale complte. Chaque ligne de code, chaque architecture, chaque solution est conue pour crer un impact rel et mesurable."]}),e.jsxs("div",{className:"flex flex-wrap gap-4",children:[e.jsxs("button",{onClick:y,className:"flex items-center gap-2 px-6 py-3 bg-green-500 hover:bg-green-600 rounded-xl transition-all text-sm font-black shadow-lg",children:[e.jsx(es,{size:18}),"WhatsApp",e.jsx(Hi,{size:14})]}),e.jsxs("a",{href:"mailto:impulcia-afrique@outlook.com",className:"flex items-center gap-2 px-6 py-3 bg-white/20 hover:bg-white/30 rounded-xl transition-all text-sm font-black border border-white/30",children:[e.jsx(Zi,{size:18}),"Email"]}),e.jsxs("a",{href:"https://impulcia-afrique.com/",target:"_blank",rel:"noopener noreferrer",className:"flex items-center gap-2 px-6 py-3 bg-white/20 hover:bg-white/30 rounded-xl transition-all text-sm font-black border border-white/30",children:[e.jsx(Di,{size:18}),"Site Web",e.jsx(Hi,{size:14})]})]})]})]})]}),e.jsxs("section",{className:"mb-16",children:[e.jsxs("div",{className:"text-center mb-12",children:[e.jsx("h2",{className:"text-3xl md:text-4xl font-black text-gray-900 mb-4",children:"Notre Partenaire"}),e.jsx("p",{className:"text-gray-600 max-w-2xl mx-auto",children:"Mbourak est une initiative porte par une organisation engage pour la transparence et la bonne gouvernance au Sngal."})]}),e.jsx("div",{className:"bg-gradient-to-br from-blue-50 to-indigo-50 rounded-2xl p-8 md:p-12 border border-blue-100 shadow-sm",children:e.jsxs("div",{className:"flex flex-col md:flex-row items-start gap-6",children:[e.jsx("div",{className:"flex-shrink-0",children:e.jsx("div",{className:"w-24 h-24 bg-white rounded-2xl flex items-center justify-center border-2 border-blue-200 shadow-lg",children:o?e.jsx(Qa,{size:32,className:"text-blue-500"}):e.jsx("img",{src:"/logo-senegel.png",alt:"SENEGEL Logo",className:"w-20 h-20 object-contain",onError:()=>x(!0)})})}),e.jsxs("div",{className:"flex-1",children:[e.jsx("h3",{className:"text-2xl font-black text-gray-900 mb-3",children:"SENEGEL"}),e.jsx("p",{className:"text-gray-700 font-bold mb-2",children:"Senegalese Next Generation of Leaders"}),e.jsx("p",{className:"text-gray-600 leading-relaxed mb-6",children:"SENEGEL est une plateforme de donnes ouvertes qui permet  tous de suivre la lgislation, la diplomatie, l'conomie et la culture sngalaise. Engage pour des pratiques thiques et une bonne gouvernance, SENEGEL a initi le projet Mbourak pour valoriser l'artisanat local et crer un cosystme de confiance entre artisans et clients."}),e.jsx("div",{className:"flex flex-wrap gap-4",children:e.jsxs("a",{href:"https://www.senegel.org/",target:"_blank",rel:"noopener noreferrer",className:"flex items-center gap-2 px-4 py-2 bg-white hover:bg-blue-50 rounded-xl transition-all text-sm font-bold text-gray-700 border border-blue-200 shadow-sm",children:[e.jsx(Di,{size:18}),"Visiter SENEGEL",e.jsx(Hi,{size:14})]})})]})]})})]}),e.jsx("section",{className:"mb-16",children:e.jsxs("div",{className:"bg-gradient-to-br from-brand-50 to-orange-50 rounded-2xl p-8 md:p-12",children:[e.jsxs("div",{className:"text-center mb-8",children:[e.jsx("div",{className:"w-16 h-16 bg-brand-500 rounded-2xl flex items-center justify-center mx-auto mb-4",children:e.jsx(xn,{size:28,className:"text-white",fill:"currentColor"})}),e.jsx("h2",{className:"text-3xl md:text-4xl font-black text-gray-900 mb-4",children:"Remerciements"})]}),e.jsxs("div",{className:"max-w-3xl mx-auto",children:[e.jsx("p",{className:"text-gray-700 leading-relaxed text-center mb-6",children:"Nous tenons  remercier tous ceux qui ont contribu  faire de Mbourak une ralit :"}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-start gap-4 bg-white/50 rounded-xl p-4",children:[e.jsx(Is,{size:24,className:"text-brand-500 flex-shrink-0 mt-1"}),e.jsxs("div",{children:[e.jsx("h4",{className:"font-black text-gray-900 mb-1",children:"Les Artisans"}),e.jsx("p",{className:"text-gray-600 text-sm",children:"Pour leur confiance et leur engagement  offrir des services de qualit."})]})]}),e.jsxs("div",{className:"flex items-start gap-4 bg-white/50 rounded-xl p-4",children:[e.jsx(z0,{size:24,className:"text-brand-500 flex-shrink-0 mt-1"}),e.jsxs("div",{children:[e.jsx("h4",{className:"font-black text-gray-900 mb-1",children:"Les Clients"}),e.jsx("p",{className:"text-gray-600 text-sm",children:"Pour leur confiance et leurs retours prcieux qui nous permettent d'amliorer continuellement la plateforme."})]})]}),e.jsxs("div",{className:"flex items-start gap-4 bg-white/50 rounded-xl p-4",children:[e.jsx(Qa,{size:24,className:"text-brand-500 flex-shrink-0 mt-1"}),e.jsxs("div",{children:[e.jsx("h4",{className:"font-black text-gray-900 mb-1",children:"SENEGEL"}),e.jsx("p",{className:"text-gray-600 text-sm",children:"Pour avoir initi ce projet et pour leur engagement en faveur de la transparence et de la bonne gouvernance au Sngal."})]})]}),e.jsxs("div",{className:"flex items-start gap-4 bg-white/50 rounded-xl p-4",children:[e.jsx(Di,{size:24,className:"text-brand-500 flex-shrink-0 mt-1"}),e.jsxs("div",{children:[e.jsx("h4",{className:"font-black text-gray-900 mb-1",children:"L'cosystme Tech Sngalais"}),e.jsx("p",{className:"text-gray-600 text-sm",children:"Pour l'inspiration et les changes qui enrichissent notre vision de la tech made in Africa."})]})]})]})]})]})}),e.jsx("section",{className:"text-center",children:e.jsxs("div",{className:"bg-white rounded-2xl p-8 md:p-12 shadow-sm border border-gray-100",children:[e.jsx("h2",{className:"text-3xl font-black text-gray-900 mb-4",children:"Rejoignez l'aventure"}),e.jsx("p",{className:"text-gray-600 mb-8 max-w-2xl mx-auto",children:"Que vous soyez artisan ou client, Mbourak est l pour vous accompagner dans vos projets. Ensemble, construisons l'avenir de l'artisanat sngalais."}),e.jsxs("div",{className:"flex flex-col sm:flex-row gap-4 justify-center",children:[e.jsx("button",{onClick:()=>i("/onboard?mode=signup"),className:"px-8 py-4 bg-brand-500 text-white font-black rounded-xl hover:bg-brand-600 transition-all uppercase tracking-widest text-xs shadow-lg",children:"S'inscrire maintenant"}),e.jsx("button",{onClick:()=>i("/artisans"),className:"px-8 py-4 bg-gray-100 text-gray-700 font-black rounded-xl hover:bg-gray-200 transition-all uppercase tracking-widest text-xs",children:"Dcouvrir les artisans"})]})]})})]}),e.jsx("footer",{className:"bg-white border-t mt-16 py-8",children:e.jsxs("div",{className:"max-w-5xl mx-auto px-4 md:px-6 text-center",children:[e.jsx("p",{className:"text-gray-400 text-sm font-medium mb-2",children:" 2026 Mbourak - L'alliance de l'excellence artisanale"}),e.jsxs("p",{className:"text-gray-500 text-xs",children:["Dvelopp par"," ",e.jsx("a",{href:"https://impulcia-afrique.com/",target:"_blank",rel:"noopener noreferrer",className:"font-black text-brand-500 hover:text-brand-600 transition-colors underline underline-offset-2",children:"IMPULCIA AFRIQUE"})," ","au Sngal"]})]})})]})}function Pb(){var _,L;const i=ht(),u=pn(),f=Nt(),{profile:o}=It(),[x,y]=c.useState({totalUsers:0,totalArtisans:0,totalClients:0,totalProjects:0,openProjects:0,completedProjects:0,totalEscrowHeld:0,pendingVerifications:0,disputedProjects:0}),[N,h]=c.useState(!0),[g,E]=c.useState([]),[d,v]=c.useState([]);c.useEffect(()=>{o&&o.role!=="admin"&&i("/dashboard",{replace:!0})},[o,i]),c.useEffect(()=>{(async()=>{h(!0);const{count:D}=await j.from("profiles").select("*",{count:"exact",head:!0}),{count:U}=await j.from("profiles").select("*",{count:"exact",head:!0}).eq("role","artisan"),{count:J}=await j.from("profiles").select("*",{count:"exact",head:!0}).eq("role","client"),{count:F}=await j.from("projects").select("*",{count:"exact",head:!0}),{count:G}=await j.from("projects").select("*",{count:"exact",head:!0}).eq("status","open"),{count:Z}=await j.from("projects").select("*",{count:"exact",head:!0}).eq("status","completed"),{data:X}=await j.from("escrows").select("total_amount").eq("status","held"),R=(X==null?void 0:X.reduce((V,le)=>V+(le.total_amount||0),0))||0,{count:ae}=await j.from("artisans").select("*",{count:"exact",head:!0}).eq("verification_status","pending"),{count:ge}=await j.from("projects").select("*",{count:"exact",head:!0}).eq("status","disputed"),k=new Date;k.setDate(k.getDate()-30);const{data:q}=await j.from("projects").select("created_at").gte("created_at",k.toISOString()).order("created_at",{ascending:!0}),T=new Map;q==null||q.forEach(V=>{const le=new Date(V.created_at).toLocaleDateString("fr-FR",{day:"2-digit",month:"2-digit"});T.set(le,(T.get(le)||0)+1)});const C=Array.from(T.entries()).map(([V,le])=>({date:V,count:le})).slice(-14);E(C);const{data:B}=await j.from("projects").select("status"),z=new Map;B==null||B.forEach(V=>{const le=V.status||"unknown";z.set(le,(z.get(le)||0)+1)});const S=Array.from(z.entries()).map(([V,le])=>({status:V.charAt(0).toUpperCase()+V.slice(1),count:le}));v(S),y({totalUsers:D||0,totalArtisans:U||0,totalClients:J||0,totalProjects:F||0,openProjects:G||0,completedProjects:Z||0,totalEscrowHeld:R,pendingVerifications:ae||0,disputedProjects:ge||0}),h(!1)})()},[]);const b=[{id:"overview",path:"/admin",icon:e.jsx(op,{size:20}),label:"Vue d'ensemble"},{id:"users",path:"/admin/users",icon:e.jsx(Is,{size:20}),label:"Utilisateurs"},{id:"projects",path:"/admin/projects",icon:e.jsx(Ht,{size:20}),label:"Projets"},{id:"escrows",path:"/admin/escrows",icon:e.jsx(Ss,{size:20}),label:"Paiements"},{id:"closures",path:"/admin/closures",icon:e.jsx(Qe,{size:20}),label:"Cltures"},{id:"verifications",path:"/admin/verifications",icon:e.jsx(Gt,{size:20}),label:"Vrifications"},{id:"affiliations",path:"/admin/affiliations",icon:e.jsx(Qa,{size:20}),label:"Affiliations"},{id:"disputes",path:"/admin/disputes",icon:e.jsx(zt,{size:20}),label:"Litiges"}],w=M=>M==="/admin"?u.pathname==="/admin":u.pathname.startsWith(M);return e.jsxs("div",{className:"min-h-screen bg-gray-50 flex",children:[e.jsxs("aside",{className:"w-72 bg-gray-900 text-white flex flex-col",children:[e.jsxs("div",{className:"p-6 border-b border-white/10",children:[e.jsxs("h1",{className:"text-2xl font-black tracking-tight",children:["Mboura",e.jsx("span",{className:"text-brand-500",children:"k"})]}),e.jsx("p",{className:"text-[10px] text-gray-500 uppercase tracking-widest font-bold mt-1",children:"Panel Admin"})]}),e.jsx("nav",{className:"flex-1 p-4 space-y-2",children:b.map(M=>e.jsxs(Mh,{to:M.path,className:`flex items-center gap-3 px-4 py-3 rounded-xl font-bold text-sm transition-all ${w(M.path)?"bg-brand-500 text-white shadow-lg":"text-gray-400 hover:text-white hover:bg-white/5"}`,children:[M.icon,M.label,M.id==="verifications"&&x.pendingVerifications>0&&e.jsx("span",{className:"ml-auto bg-red-500 text-white text-[10px] font-black px-2 py-0.5 rounded-full",children:x.pendingVerifications}),M.id==="disputes"&&x.disputedProjects>0&&e.jsx("span",{className:"ml-auto bg-red-500 text-white text-[10px] font-black px-2 py-0.5 rounded-full animate-pulse",children:x.disputedProjects})]},M.id))}),e.jsxs("div",{className:"p-4 border-t border-white/10",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-4",children:[e.jsx("div",{className:"w-10 h-10 bg-brand-500 rounded-xl flex items-center justify-center font-black",children:((_=o==null?void 0:o.full_name)==null?void 0:_[0])||"A"}),e.jsxs("div",{className:"flex-1",children:[e.jsx("p",{className:"font-bold text-sm truncate",children:o==null?void 0:o.full_name}),e.jsx("p",{className:"text-[10px] text-gray-500 uppercase tracking-widest",children:"Administrateur"})]})]}),e.jsxs("button",{onClick:async()=>{await f.signOut(),i("/")},className:"w-full flex items-center justify-center gap-2 py-3 bg-white/5 hover:bg-white/10 rounded-xl text-gray-400 hover:text-white font-bold text-sm transition-all",children:[e.jsx(K0,{size:18}),"Dconnexion"]})]})]}),e.jsxs("main",{className:"flex-1 flex flex-col",children:[e.jsxs("header",{className:"bg-white border-b px-8 py-4 flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"text-xl font-black text-gray-900",children:((L=b.find(M=>w(M.path)))==null?void 0:L.label)||"Dashboard"}),e.jsx("p",{className:"text-sm text-gray-400",children:"Grez votre plateforme Mbourake"})]}),e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsxs("button",{className:"p-2 text-gray-400 hover:text-gray-600 relative",children:[e.jsx(ur,{size:22}),e.jsx("span",{className:"absolute top-1 right-1 w-2 h-2 bg-red-500 rounded-full"})]}),e.jsx("button",{className:"p-2 text-gray-400 hover:text-gray-600",children:e.jsx(vd,{size:22})})]})]}),e.jsx("div",{className:"flex-1 p-8 overflow-auto",children:u.pathname==="/admin"?e.jsxs("div",{className:"space-y-8",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6",children:[e.jsx(Oi,{icon:e.jsx(Is,{className:"text-blue-500"}),label:"Utilisateurs",value:x.totalUsers,subtext:`${x.totalArtisans} artisans  ${x.totalClients} clients`,color:"blue"}),e.jsx(Oi,{icon:e.jsx(Ht,{className:"text-brand-500"}),label:"Projets",value:x.totalProjects,subtext:`${x.openProjects} ouverts  ${x.completedProjects} termins`,color:"orange"}),e.jsx(Oi,{icon:e.jsx(Ss,{className:"text-green-500"}),label:"Escrow Actif",value:`${x.totalEscrowHeld.toLocaleString()} FCFA`,subtext:"Fonds en garantie",color:"green"}),e.jsx(Oi,{icon:e.jsx(Gt,{className:"text-purple-500"}),label:"Vrifications",value:x.pendingVerifications,subtext:"En attente",color:"purple",alert:x.pendingVerifications>0})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6",children:[e.jsx(Vi,{icon:e.jsx(Gt,{}),title:"Vrifier les artisans",description:"Examinez les demandes de certification",count:x.pendingVerifications,onClick:()=>i("/admin/verifications")}),e.jsx(Vi,{icon:e.jsx(Ht,{}),title:"Projets en cours",description:"Suivez l'avancement des projets",count:x.openProjects,onClick:()=>i("/admin/projects")}),e.jsx(Vi,{icon:e.jsx(Ss,{}),title:"Paiements Escrow",description:"Grez les garanties et librations",onClick:()=>i("/admin/escrows")}),x.disputedProjects>0&&e.jsx(Vi,{icon:e.jsx(zt,{}),title:"Litiges  rsoudre",description:"Des projets ncessitent votre attention",count:x.disputedProjects,onClick:()=>i("/admin/disputes")})]}),e.jsxs("div",{className:"bg-white rounded-2xl p-6 shadow-sm border",children:[e.jsx("h3",{className:"font-black text-gray-900 mb-4",children:"Activit Rcente"}),e.jsxs("div",{className:"space-y-4",children:[e.jsx(Fi,{icon:e.jsx(Qe,{className:"text-green-500"}),text:"Nouveau projet cr: Rparation plomberie",time:"Il y a 5 min"}),e.jsx(Fi,{icon:e.jsx(Is,{className:"text-blue-500"}),text:"Nouvel artisan inscrit: Moussa Diop",time:"Il y a 15 min"}),e.jsx(Fi,{icon:e.jsx(Ss,{className:"text-green-500"}),text:"Paiement escrow reu: 25,000 FCFA",time:"Il y a 1h"}),e.jsx(Fi,{icon:e.jsx(Gt,{className:"text-purple-500"}),text:"Demande de vrification: Fatou Ciss",time:"Il y a 2h"})]})]})]}):e.jsx(Dh,{})})]})]})}function Oi({icon:i,label:u,value:f,subtext:o,color:x,alert:y}){const N={blue:"bg-blue-50",orange:"bg-orange-50",green:"bg-green-50",purple:"bg-purple-50"};return e.jsxs("div",{className:`${N[x]} rounded-2xl p-6 relative overflow-hidden`,children:[e.jsxs("div",{className:"flex items-start justify-between mb-4",children:[e.jsx("div",{className:"w-12 h-12 bg-white rounded-xl flex items-center justify-center shadow-sm",children:i}),y&&e.jsxs("span",{className:"flex items-center gap-1 text-red-500 text-xs font-bold",children:[e.jsx(qa,{size:14}),"Action requise"]})]}),e.jsx("p",{className:"text-3xl font-black text-gray-900 mb-1",children:f}),e.jsx("p",{className:"text-sm text-gray-500 font-medium",children:u}),e.jsx("p",{className:"text-xs text-gray-400 mt-1",children:o})]})}function Vi({icon:i,title:u,description:f,count:o,onClick:x}){return e.jsxs("button",{onClick:x,className:"bg-white rounded-2xl p-6 shadow-sm border text-left hover:shadow-md hover:border-brand-200 transition-all group",children:[e.jsxs("div",{className:"flex items-start justify-between mb-4",children:[e.jsx("div",{className:"w-12 h-12 bg-brand-50 rounded-xl flex items-center justify-center text-brand-500 group-hover:bg-brand-500 group-hover:text-white transition-all",children:i}),o!==void 0&&o>0&&e.jsx("span",{className:"bg-brand-500 text-white text-xs font-black px-2 py-1 rounded-full",children:o})]}),e.jsx("h4",{className:"font-black text-gray-900 mb-1",children:u}),e.jsx("p",{className:"text-sm text-gray-500",children:f}),e.jsxs("div",{className:"flex items-center gap-1 text-brand-500 text-sm font-bold mt-4 group-hover:gap-2 transition-all",children:["Accder ",e.jsx(da,{size:16})]})]})}function Fi({icon:i,text:u,time:f}){return e.jsxs("div",{className:"flex items-center gap-4 py-3 border-b border-gray-50 last:border-0",children:[e.jsx("div",{className:"w-10 h-10 bg-gray-50 rounded-xl flex items-center justify-center",children:i}),e.jsxs("div",{className:"flex-1",children:[e.jsx("p",{className:"text-sm font-medium text-gray-900",children:u}),e.jsx("p",{className:"text-xs text-gray-400",children:f})]})]})}function Kb(){const[i,u]=c.useState([]),[f,o]=c.useState(!0),[x,y]=c.useState(""),[N,h]=c.useState("all"),[g,E]=c.useState(null);c.useEffect(()=>{d()},[]);const d=async()=>{o(!0);const{data:w,error:_}=await j.from("profiles").select("*").order("created_at",{ascending:!1});!_&&w&&u(w),o(!1)},v=i.filter(w=>{var M,D;const _=((M=w.full_name)==null?void 0:M.toLowerCase().includes(x.toLowerCase()))||((D=w.email)==null?void 0:D.toLowerCase().includes(x.toLowerCase())),L=N==="all"||w.role===N;return _&&L}),b=async(w,_)=>{await j.from("profiles").update({role:_}).eq("id",w),d(),E(null)};return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex flex-col md:flex-row gap-4",children:[e.jsxs("div",{className:"flex-1 relative",children:[e.jsx(xa,{className:"absolute left-4 top-1/2 -translate-y-1/2 text-gray-400",size:20}),e.jsx("input",{type:"text",value:x,onChange:w=>y(w.target.value),placeholder:"Rechercher par nom ou email...",className:"w-full pl-12 pr-4 py-3 bg-white border border-gray-200 rounded-xl focus:border-brand-500 focus:outline-none"})]}),e.jsxs("select",{value:N,onChange:w=>h(w.target.value),className:"px-4 py-3 bg-white border border-gray-200 rounded-xl focus:border-brand-500 focus:outline-none font-medium",children:[e.jsx("option",{value:"all",children:"Tous les rles"}),e.jsx("option",{value:"client",children:"Clients"}),e.jsx("option",{value:"artisan",children:"Artisans"}),e.jsx("option",{value:"admin",children:"Admins"})]})]}),e.jsx("div",{className:"bg-white rounded-2xl shadow-sm border overflow-hidden",children:e.jsxs("table",{className:"w-full",children:[e.jsx("thead",{className:"bg-gray-50 border-b",children:e.jsxs("tr",{children:[e.jsx("th",{className:"text-left px-6 py-4 text-xs font-black text-gray-500 uppercase tracking-widest",children:"Utilisateur"}),e.jsx("th",{className:"text-left px-6 py-4 text-xs font-black text-gray-500 uppercase tracking-widest",children:"Rle"}),e.jsx("th",{className:"text-left px-6 py-4 text-xs font-black text-gray-500 uppercase tracking-widest",children:"Contact"}),e.jsx("th",{className:"text-left px-6 py-4 text-xs font-black text-gray-500 uppercase tracking-widest",children:"Inscription"}),e.jsx("th",{className:"text-right px-6 py-4 text-xs font-black text-gray-500 uppercase tracking-widest",children:"Actions"})]})}),e.jsx("tbody",{className:"divide-y divide-gray-50",children:v.length===0?e.jsx("tr",{children:e.jsx("td",{colSpan:5,className:"px-6 py-12 text-center text-gray-400",children:"Aucun utilisateur trouv"})}):v.map(w=>e.jsxs("tr",{className:"hover:bg-gray-50 transition-colors",children:[e.jsx("td",{className:"px-6 py-4",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-10 h-10 rounded-full bg-brand-100 flex items-center justify-center overflow-hidden",children:w.avatar_url?e.jsx("img",{src:w.avatar_url,alt:"",className:"w-full h-full object-cover"}):e.jsx(ot,{size:18,className:"text-brand-600"})}),e.jsxs("div",{children:[e.jsx("p",{className:"font-bold text-gray-900",children:w.full_name||"Sans nom"}),e.jsx("p",{className:"text-sm text-gray-500",children:w.email})]})]})}),e.jsx("td",{className:"px-6 py-4",children:e.jsxs("span",{className:`inline-flex items-center gap-1.5 px-3 py-1 rounded-full text-xs font-black uppercase tracking-wider ${w.role==="admin"?"bg-purple-100 text-purple-700":w.role==="artisan"?"bg-brand-100 text-brand-700":"bg-blue-100 text-blue-700"}`,children:[w.role==="artisan"&&e.jsx(Ht,{size:12}),w.role==="admin"&&e.jsx(Gt,{size:12}),w.role==="client"&&e.jsx(ot,{size:12}),w.role]})}),e.jsxs("td",{className:"px-6 py-4",children:[e.jsx("p",{className:"text-sm text-gray-900",children:w.phone||"-"}),e.jsx("p",{className:"text-xs text-gray-400",children:w.location||"-"})]}),e.jsx("td",{className:"px-6 py-4",children:e.jsx("p",{className:"text-sm text-gray-500",children:new Date(w.created_at).toLocaleDateString("fr-FR")})}),e.jsx("td",{className:"px-6 py-4 text-right",children:e.jsx("button",{onClick:()=>E(w),className:"p-2 text-gray-400 hover:text-gray-600 hover:bg-gray-100 rounded-lg transition-colors",children:e.jsx(Z0,{size:18})})})]},w.id))})]})}),g&&e.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50 p-6",children:e.jsxs("div",{className:"bg-white rounded-2xl max-w-md w-full p-6 shadow-2xl",children:[e.jsxs("div",{className:"flex items-center gap-4 mb-6",children:[e.jsx("div",{className:"w-16 h-16 rounded-full bg-brand-100 flex items-center justify-center overflow-hidden",children:g.avatar_url?e.jsx("img",{src:g.avatar_url,alt:"",className:"w-full h-full object-cover"}):e.jsx(ot,{size:28,className:"text-brand-600"})}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-xl font-black text-gray-900",children:g.full_name}),e.jsx("p",{className:"text-sm text-gray-500",children:g.email})]})]}),e.jsxs("div",{className:"space-y-4 mb-6",children:[e.jsxs("div",{className:"flex justify-between py-2 border-b",children:[e.jsx("span",{className:"text-gray-500",children:"Rle actuel"}),e.jsx("span",{className:"font-bold text-gray-900 capitalize",children:g.role})]}),e.jsxs("div",{className:"flex justify-between py-2 border-b",children:[e.jsx("span",{className:"text-gray-500",children:"Tlphone"}),e.jsx("span",{className:"font-bold text-gray-900",children:g.phone||"-"})]}),e.jsxs("div",{className:"flex justify-between py-2 border-b",children:[e.jsx("span",{className:"text-gray-500",children:"Rgion"}),e.jsx("span",{className:"font-bold text-gray-900",children:g.location||"-"})]})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsx("p",{className:"text-xs font-black text-gray-400 uppercase tracking-widest",children:"Changer le rle"}),e.jsx("div",{className:"grid grid-cols-3 gap-2",children:["client","artisan","admin"].map(w=>e.jsx("button",{onClick:()=>b(g.id,w),disabled:g.role===w,className:`py-2 rounded-xl font-bold text-sm capitalize transition-all ${g.role===w?"bg-brand-500 text-white":"bg-gray-100 text-gray-600 hover:bg-gray-200"}`,children:w},w))})]}),e.jsx("button",{onClick:()=>E(null),className:"w-full mt-6 py-3 bg-gray-100 text-gray-600 font-bold rounded-xl hover:bg-gray-200 transition-colors",children:"Fermer"})]})})]})}function Jb(){var L,M;const[i,u]=c.useState([]),[f,o]=c.useState(!0),[x,y]=c.useState(""),[N,h]=c.useState("all"),[g,E]=c.useState(null);c.useEffect(()=>{d()},[]);const d=async()=>{o(!0);const{data:D,error:U}=await j.from("projects").select("*, profiles(*), categories(*)").order("created_at",{ascending:!1});!U&&D&&u(D),o(!1)},v=i.filter(D=>{var F,G,Z;const U=((F=D.title)==null?void 0:F.toLowerCase().includes(x.toLowerCase()))||((Z=(G=D.profiles)==null?void 0:G.full_name)==null?void 0:Z.toLowerCase().includes(x.toLowerCase())),J=N==="all"||D.status===N;return U&&J}),b=async(D,U)=>{await j.from("projects").update({status:U}).eq("id",D),d(),E(null)},w=D=>({open:"bg-green-100 text-green-700",quote_accepted:"bg-blue-100 text-blue-700",in_progress:"bg-yellow-100 text-yellow-700",completed:"bg-purple-100 text-purple-700",cancelled:"bg-red-100 text-red-700"})[D]||"bg-gray-100 text-gray-700",_=D=>({open:"Ouvert",quote_accepted:"Devis accept",in_progress:"En cours",completed:"Termin",cancelled:"Annul"})[D]||D;return f?e.jsx(Yt,{}):e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex flex-col md:flex-row gap-4",children:[e.jsxs("div",{className:"flex-1 relative",children:[e.jsx(xa,{className:"absolute left-4 top-1/2 -translate-y-1/2 text-gray-400",size:20}),e.jsx("input",{type:"text",value:x,onChange:D=>y(D.target.value),placeholder:"Rechercher un projet...",className:"w-full pl-12 pr-4 py-3 bg-white border border-gray-200 rounded-xl focus:border-brand-500 focus:outline-none"})]}),e.jsxs("select",{value:N,onChange:D=>h(D.target.value),className:"px-4 py-3 bg-white border border-gray-200 rounded-xl focus:border-brand-500 focus:outline-none font-medium",children:[e.jsx("option",{value:"all",children:"Tous les statuts"}),e.jsx("option",{value:"open",children:"Ouvert"}),e.jsx("option",{value:"quote_accepted",children:"Devis accept"}),e.jsx("option",{value:"in_progress",children:"En cours"}),e.jsx("option",{value:"completed",children:"Termin"}),e.jsx("option",{value:"cancelled",children:"Annul"})]})]}),e.jsx("div",{className:"grid grid-cols-2 md:grid-cols-5 gap-4",children:["open","quote_accepted","in_progress","completed","cancelled"].map(D=>e.jsxs("button",{onClick:()=>h(D),className:`p-4 rounded-xl border transition-all ${N===D?"border-brand-500 bg-brand-50":"border-gray-100 bg-white hover:border-gray-200"}`,children:[e.jsx("p",{className:"text-2xl font-black text-gray-900",children:i.filter(U=>U.status===D).length}),e.jsx("p",{className:"text-xs font-bold text-gray-500 uppercase tracking-wider",children:_(D)})]},D))}),e.jsx("div",{className:"bg-white rounded-2xl shadow-sm border overflow-hidden",children:e.jsx("div",{className:"divide-y divide-gray-50",children:v.length===0?e.jsx("div",{className:"px-6 py-12 text-center text-gray-400",children:"Aucun projet trouv"}):v.map(D=>{var U,J,F;return e.jsx("div",{className:"p-6 hover:bg-gray-50 transition-colors cursor-pointer",onClick:()=>E(D),children:e.jsxs("div",{className:"flex items-start justify-between gap-4",children:[e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-2",children:[e.jsx("span",{className:`px-2 py-1 rounded-lg text-[10px] font-black uppercase tracking-wider ${w(D.status)}`,children:_(D.status)}),e.jsx("span",{className:"px-2 py-1 bg-gray-100 text-gray-600 rounded-lg text-[10px] font-black uppercase tracking-wider",children:((U=D.categories)==null?void 0:U.name)||"Sans catgorie"})]}),e.jsx("h4",{className:"font-bold text-gray-900 mb-1",children:D.title}),e.jsxs("div",{className:"flex items-center gap-4 text-sm text-gray-500",children:[e.jsxs("span",{className:"flex items-center gap-1",children:[e.jsx(ga,{size:14}),D.location||"Non spcifi"]}),e.jsxs("span",{className:"flex items-center gap-1",children:[e.jsx(St,{size:14}),new Date(D.created_at).toLocaleDateString("fr-FR")]})]})]}),e.jsxs("div",{className:"text-right",children:[e.jsx("p",{className:"text-sm font-bold text-gray-900",children:(J=D.profiles)==null?void 0:J.full_name}),e.jsx("p",{className:"text-xs text-gray-400",children:(F=D.profiles)==null?void 0:F.email})]})]})},D.id)})})}),g&&e.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50 p-6",children:e.jsxs("div",{className:"bg-white rounded-2xl max-w-lg w-full p-6 shadow-2xl",children:[e.jsxs("div",{className:"mb-6",children:[e.jsx("span",{className:`inline-block px-3 py-1 rounded-lg text-xs font-black uppercase tracking-wider mb-3 ${w(g.status)}`,children:_(g.status)}),e.jsx("h3",{className:"text-xl font-black text-gray-900",children:g.title}),e.jsxs("p",{className:"text-sm text-gray-500 mt-1",children:["Par ",(L=g.profiles)==null?void 0:L.full_name,"  ",(M=g.categories)==null?void 0:M.name]})]}),e.jsxs("div",{className:"space-y-4 mb-6",children:[e.jsxs("div",{className:"flex justify-between py-2 border-b",children:[e.jsx("span",{className:"text-gray-500",children:"ID Projet"}),e.jsxs("span",{className:"font-mono text-sm text-gray-900",children:[g.id.slice(0,8),"..."]})]}),e.jsxs("div",{className:"flex justify-between py-2 border-b",children:[e.jsx("span",{className:"text-gray-500",children:"Localisation"}),e.jsx("span",{className:"font-bold text-gray-900",children:g.location||"-"})]}),e.jsxs("div",{className:"flex justify-between py-2 border-b",children:[e.jsx("span",{className:"text-gray-500",children:"Date cration"}),e.jsx("span",{className:"font-bold text-gray-900",children:new Date(g.created_at).toLocaleString("fr-FR")})]})]}),e.jsxs("div",{className:"space-y-3 mb-6",children:[e.jsx("p",{className:"text-xs font-black text-gray-400 uppercase tracking-widest",children:"Changer le statut"}),e.jsx("div",{className:"grid grid-cols-2 gap-2",children:["open","quote_accepted","in_progress","completed","cancelled"].map(D=>e.jsx("button",{onClick:()=>b(g.id,D),disabled:g.status===D,className:`py-2 px-3 rounded-xl font-bold text-xs uppercase transition-all ${g.status===D?"bg-brand-500 text-white":"bg-gray-100 text-gray-600 hover:bg-gray-200"}`,children:_(D)},D))})]}),e.jsx("button",{onClick:()=>E(null),className:"w-full py-3 bg-gray-100 text-gray-600 font-bold rounded-xl hover:bg-gray-200 transition-colors",children:"Fermer"})]})})]})}function Wb(){var F,G,Z,X,R,ae,ge;const[i,u]=c.useState([]),[f,o]=c.useState(!0),[x,y]=c.useState(""),[N,h]=c.useState("all"),[g,E]=c.useState(null);c.useEffect(()=>{d()},[]);const d=async()=>{o(!0);const{data:k,error:q}=await j.from("escrows").select("*, projects(*, profiles(*))").order("created_at",{ascending:!1});!q&&k&&u(k),o(!1)},v=i.filter(k=>k.refund_status==="pending"),b=i.filter(k=>{var C,B,z,S;const q=((B=(C=k.projects)==null?void 0:C.title)==null?void 0:B.toLowerCase().includes(x.toLowerCase()))||((S=(z=k.projects)==null?void 0:z.project_number)==null?void 0:S.toLowerCase().includes(x.toLowerCase())),T=N==="all"||k.status===N||N==="refund_pending"&&k.refund_status==="pending";return q&&T}),w=i.filter(k=>k.status==="held").reduce((k,q)=>k+(q.total_amount||0),0),_=i.filter(k=>k.status==="released").reduce((k,q)=>k+(q.total_amount||0),0),L=i.filter(k=>k.status==="released").reduce((k,q)=>k+(q.platform_commission||0),0),M=async k=>{await j.from("escrows").update({status:"released"}).eq("id",k),d(),E(null)},D=async(k,q)=>{i.find(C=>C.id===k)&&(await j.from("escrows").update({advance_paid:q}).eq("id",k),d())},U=k=>({pending:"bg-yellow-100 text-yellow-700",held:"bg-blue-100 text-blue-700",advance_paid:"bg-purple-100 text-purple-700",released:"bg-green-100 text-green-700",refunded:"bg-red-100 text-red-700"})[k]||"bg-gray-100 text-gray-700",J=k=>({pending:"En attente",held:"En garantie",advance_paid:"Avance verse",released:"Libr",refunded:"Rembours"})[k]||k;return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6",children:[e.jsx("div",{className:"bg-gradient-to-br from-blue-500 to-blue-600 rounded-2xl p-6 text-white",children:e.jsxs("div",{className:"flex items-center gap-3 mb-4",children:[e.jsx("div",{className:"w-12 h-12 bg-white/20 rounded-xl flex items-center justify-center",children:e.jsx(Gt,{size:24})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-white/70 text-sm font-medium",children:"Fonds en garantie"}),e.jsxs("p",{className:"text-2xl font-black",children:[w.toLocaleString()," FCFA"]})]})]})}),e.jsx("div",{className:"bg-gradient-to-br from-green-500 to-green-600 rounded-2xl p-6 text-white",children:e.jsxs("div",{className:"flex items-center gap-3 mb-4",children:[e.jsx("div",{className:"w-12 h-12 bg-white/20 rounded-xl flex items-center justify-center",children:e.jsx(Qe,{size:24})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-white/70 text-sm font-medium",children:"Total libr"}),e.jsxs("p",{className:"text-2xl font-black",children:[_.toLocaleString()," FCFA"]})]})]})}),e.jsx("div",{className:"bg-gradient-to-br from-brand-500 to-brand-600 rounded-2xl p-6 text-white",children:e.jsxs("div",{className:"flex items-center gap-3 mb-4",children:[e.jsx("div",{className:"w-12 h-12 bg-white/20 rounded-xl flex items-center justify-center",children:e.jsx(Ss,{size:24})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-white/70 text-sm font-medium",children:"Commissions gagnes"}),e.jsxs("p",{className:"text-2xl font-black",children:[L.toLocaleString()," FCFA"]})]})]})})]}),e.jsxs("div",{className:"flex flex-col md:flex-row gap-4",children:[e.jsxs("div",{className:"flex-1 relative",children:[e.jsx(xa,{className:"absolute left-4 top-1/2 -translate-y-1/2 text-gray-400",size:20}),e.jsx("input",{type:"text",value:x,onChange:k=>y(k.target.value),placeholder:"Rechercher un projet...",className:"w-full pl-12 pr-4 py-3 bg-white border border-gray-200 rounded-xl focus:border-brand-500 focus:outline-none"})]}),e.jsxs("select",{value:N,onChange:k=>h(k.target.value),className:"px-4 py-3 bg-white border border-gray-200 rounded-xl focus:border-brand-500 focus:outline-none font-medium",children:[e.jsx("option",{value:"all",children:"Tous les statuts"}),e.jsx("option",{value:"pending",children:"En attente"}),e.jsx("option",{value:"held",children:"En garantie"}),e.jsx("option",{value:"advance_paid",children:"Avance verse"}),e.jsx("option",{value:"released",children:"Libr"}),e.jsx("option",{value:"refunded",children:"Rembours"}),e.jsxs("option",{value:"refund_pending",children:["Remboursements en attente (",v.length,")"]})]})]}),e.jsx("div",{className:"bg-white rounded-2xl shadow-sm border overflow-hidden",children:e.jsxs("table",{className:"w-full",children:[e.jsx("thead",{className:"bg-gray-50 border-b",children:e.jsxs("tr",{children:[e.jsx("th",{className:"text-left px-6 py-4 text-xs font-black text-gray-500 uppercase tracking-widest",children:"Projet"}),e.jsx("th",{className:"text-left px-6 py-4 text-xs font-black text-gray-500 uppercase tracking-widest",children:"Montant"}),e.jsx("th",{className:"text-left px-6 py-4 text-xs font-black text-gray-500 uppercase tracking-widest",children:"Commission"}),e.jsx("th",{className:"text-left px-6 py-4 text-xs font-black text-gray-500 uppercase tracking-widest",children:"Statut"}),e.jsx("th",{className:"text-left px-6 py-4 text-xs font-black text-gray-500 uppercase tracking-widest",children:"Date"}),e.jsx("th",{className:"text-right px-6 py-4 text-xs font-black text-gray-500 uppercase tracking-widest",children:"Actions"})]})}),e.jsx("tbody",{className:"divide-y divide-gray-50",children:b.length===0?e.jsx("tr",{children:e.jsx("td",{colSpan:6,className:"px-6 py-12 text-center text-gray-400",children:"Aucun escrow trouv"})}):b.map(k=>{var q,T,C,B,z;return e.jsxs("tr",{className:"hover:bg-gray-50 transition-colors",children:[e.jsx("td",{className:"px-6 py-4",children:e.jsxs("div",{children:[e.jsx("p",{className:"font-bold text-gray-900",children:(q=k.projects)==null?void 0:q.title}),e.jsx("p",{className:"text-sm text-gray-500",children:(C=(T=k.projects)==null?void 0:T.profiles)==null?void 0:C.full_name})]})}),e.jsxs("td",{className:"px-6 py-4",children:[e.jsxs("p",{className:"font-black text-gray-900",children:[(B=k.total_amount)==null?void 0:B.toLocaleString()," FCFA"]}),k.advance_paid>0&&e.jsxs("p",{className:"text-xs text-purple-600 font-bold",children:["Avance: ",k.advance_paid.toLocaleString()," FCFA"]})]}),e.jsxs("td",{className:"px-6 py-4",children:[e.jsxs("p",{className:"font-bold text-brand-600",children:[(z=k.platform_commission)==null?void 0:z.toLocaleString()," FCFA"]}),e.jsxs("p",{className:"text-xs text-gray-400",children:["(",Math.round(k.platform_commission/k.total_amount*100),"%)"]})]}),e.jsx("td",{className:"px-6 py-4",children:e.jsxs("div",{className:"flex flex-col gap-1",children:[e.jsx("span",{className:`inline-flex items-center gap-1 px-3 py-1 rounded-full text-xs font-black uppercase tracking-wider ${U(k.status)}`,children:J(k.status)}),k.refund_status==="pending"&&e.jsx("span",{className:"inline-flex items-center gap-1 px-2 py-0.5 rounded-full text-xs font-bold bg-red-100 text-red-700",children:"Remboursement demand"})]})}),e.jsx("td",{className:"px-6 py-4",children:e.jsx("p",{className:"text-sm text-gray-500",children:new Date(k.created_at).toLocaleDateString("fr-FR")})}),e.jsx("td",{className:"px-6 py-4 text-right",children:e.jsx("button",{onClick:()=>E(k),className:"px-4 py-2 bg-brand-50 text-brand-600 font-bold text-sm rounded-lg hover:bg-brand-100 transition-colors",children:"Grer"})})]},k.id)})})]})}),g&&e.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50 p-6",children:e.jsxs("div",{className:"bg-white rounded-2xl max-w-lg w-full p-6 shadow-2xl",children:[e.jsxs("div",{className:"mb-6",children:[e.jsx("span",{className:`inline-block px-3 py-1 rounded-lg text-xs font-black uppercase tracking-wider mb-3 ${U(g.status)}`,children:J(g.status)}),e.jsx("h3",{className:"text-xl font-black text-gray-900",children:(F=g.projects)==null?void 0:F.title}),e.jsxs("p",{className:"text-sm text-gray-500 mt-1",children:["Client: ",(Z=(G=g.projects)==null?void 0:G.profiles)==null?void 0:Z.full_name]})]}),e.jsxs("div",{className:"bg-gray-50 rounded-xl p-4 mb-6 space-y-3",children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-gray-500",children:"Montant total"}),e.jsxs("span",{className:"font-black text-gray-900",children:[(X=g.total_amount)==null?void 0:X.toLocaleString()," FCFA"]})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsxs("span",{className:"text-gray-500",children:["Commission (",Math.round(g.platform_commission/g.total_amount*100),"%)"]}),e.jsxs("span",{className:"font-bold text-brand-600",children:[(R=g.platform_commission)==null?void 0:R.toLocaleString()," FCFA"]})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-gray-500",children:"Paiement artisan"}),e.jsxs("span",{className:"font-bold text-green-600",children:[(ae=g.artisan_payout)==null?void 0:ae.toLocaleString()," FCFA"]})]}),g.advance_paid>0&&e.jsxs("div",{className:"flex justify-between pt-2 border-t",children:[e.jsx("span",{className:"text-gray-500",children:"Avance verse"}),e.jsxs("span",{className:"font-bold text-purple-600",children:[g.advance_paid.toLocaleString()," FCFA"]})]})]}),g.status==="held"&&e.jsxs("div",{className:"space-y-3 mb-6",children:[e.jsx("p",{className:"text-xs font-black text-gray-400 uppercase tracking-widest",children:"Actions disponibles"}),g.advance_paid===0&&e.jsxs("button",{onClick:()=>D(g.id,g.total_amount*.4),className:"w-full flex items-center justify-between p-4 bg-purple-50 text-purple-700 rounded-xl hover:bg-purple-100 transition-colors",children:[e.jsxs("div",{children:[e.jsx("p",{className:"font-bold",children:"Verser l'avance (40%)"}),e.jsxs("p",{className:"text-sm text-purple-500",children:[Math.round(g.total_amount*.4).toLocaleString()," FCFA"]})]}),e.jsx(Y0,{size:20})]}),e.jsxs("button",{onClick:()=>M(g.id),className:"w-full flex items-center justify-between p-4 bg-green-50 text-green-700 rounded-xl hover:bg-green-100 transition-colors",children:[e.jsxs("div",{children:[e.jsx("p",{className:"font-bold",children:"Librer le paiement complet"}),e.jsxs("p",{className:"text-sm text-green-500",children:[(ge=g.artisan_payout)==null?void 0:ge.toLocaleString()," FCFA  l'artisan"]})]}),e.jsx(Qe,{size:20})]})]}),g.refund_status==="approved"&&e.jsxs("div",{className:"p-4 bg-green-50 rounded-xl mb-6 flex items-center gap-3",children:[e.jsx(Qe,{className:"text-green-500",size:24}),e.jsxs("div",{children:[e.jsx("p",{className:"font-bold text-green-700",children:"Remboursement approuv"}),e.jsx("p",{className:"text-sm text-green-600",children:"Le remboursement a t trait"})]})]}),g.refund_status==="rejected"&&g.refund_notes&&e.jsxs("div",{className:"p-4 bg-red-50 rounded-xl mb-6 flex items-start gap-3",children:[e.jsx(Ze,{className:"text-red-500 mt-0.5",size:24}),e.jsxs("div",{children:[e.jsx("p",{className:"font-bold text-red-700",children:"Remboursement refus"}),e.jsxs("p",{className:"text-sm text-red-600 mt-1",children:["Raison: ",g.refund_notes]})]})]}),g.status==="released"&&!g.refund_status&&e.jsxs("div",{className:"p-4 bg-green-50 rounded-xl mb-6 flex items-center gap-3",children:[e.jsx(Qe,{className:"text-green-500",size:24}),e.jsxs("div",{children:[e.jsx("p",{className:"font-bold text-green-700",children:"Paiement libr"}),e.jsx("p",{className:"text-sm text-green-600",children:"L'artisan a reu son paiement"})]})]}),e.jsx("button",{onClick:()=>E(null),className:"w-full py-3 bg-gray-100 text-gray-600 font-bold rounded-xl hover:bg-gray-200 transition-colors",children:"Fermer"})]})})]})}function Ib(){var G,Z,X,R,ae,ge,k,q;const[i,u]=c.useState([]),[f,o]=c.useState(!0),[x,y]=c.useState(""),[N,h]=c.useState("pending"),[g,E]=c.useState(null),[d,v]=c.useState(null),[b,w]=c.useState("");c.useEffect(()=>{_()},[]);const _=async()=>{o(!0);const{data:T,error:C}=await j.from("artisans").select(`
        id, is_verified, verification_status, certification_number, experience_years, created_at,
        profiles!artisans_id_fkey (
          id, full_name, email, phone, location, avatar_url, specialty, bio,
          categories (name)
        )
      `).order("created_at",{ascending:!1});if(C){console.error("Error fetching artisans:",C),o(!1);return}const{data:B}=await j.from("verification_documents").select("*"),z=(T==null?void 0:T.map(S=>{var le;const V=B==null?void 0:B.find(he=>he.artisan_id===S.id);return{id:S.id,user_id:S.id,is_verified:S.is_verified||!1,verification_status:S.verification_status||"unverified",certification_number:S.certification_number||null,experience_years:S.experience_years||null,created_at:S.created_at,verification_documents:V||null,profiles:S.profiles,categories:((le=S.profiles)==null?void 0:le.categories)||null}}))||[];u(z),o(!1)},L=i.filter(T=>{var z,S,V,le;const C=((S=(z=T.profiles)==null?void 0:z.full_name)==null?void 0:S.toLowerCase().includes(x.toLowerCase()))||((le=(V=T.profiles)==null?void 0:V.email)==null?void 0:le.toLowerCase().includes(x.toLowerCase())),B=N==="all"||N==="verified"&&T.verification_status==="verified"||N==="pending"&&T.verification_status==="pending"||N==="unverified"&&T.verification_status==="unverified";return C&&B}),M=i.filter(T=>T.verification_status==="pending").length,D=i.filter(T=>T.verification_status==="verified").length,U=i.filter(T=>T.verification_status==="unverified").length,J=async T=>{try{await j.from("artisans").update({is_verified:!0,verification_status:"verified",can_receive_advance:!0,updated_at:new Date().toISOString()}).eq("id",T),await j.from("verification_documents").update({status:"approved"}).eq("artisan_id",T),await j.from("notifications").insert({user_id:T,type:"verification_approved",title:"Flicitations ! Vous tes certifi",message:"Votre compte a t vrifi. Vous bnficiez maintenant du badge certifi et pouvez recevoir des avances sur paiement.",data:{}}),_(),E(null)}catch(C){console.error("Error verifying artisan:",C)}},F=async T=>{try{await j.from("artisans").update({is_verified:!1,verification_status:"rejected",updated_at:new Date().toISOString()}).eq("id",T),await j.from("verification_documents").update({status:"rejected",rejection_reason:b||"Documents non conformes"}).eq("artisan_id",T),await j.from("notifications").insert({user_id:T,type:"verification_rejected",title:"Vrification refuse",message:b||"Vos documents n'ont pas pu tre valids. Veuillez soumettre de nouveaux documents.",data:{}}),_(),E(null),w("")}catch(C){console.error("Error rejecting artisan:",C)}};return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4",children:[e.jsx("button",{onClick:()=>h("all"),className:`p-5 rounded-2xl border transition-all ${N==="all"?"border-brand-500 bg-brand-50":"border-gray-100 bg-white hover:border-gray-200"}`,children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-10 h-10 bg-gray-100 rounded-xl flex items-center justify-center",children:e.jsx(ot,{size:20,className:"text-gray-600"})}),e.jsxs("div",{className:"text-left",children:[e.jsx("p",{className:"text-2xl font-black text-gray-900",children:i.length}),e.jsx("p",{className:"text-xs font-bold text-gray-500",children:"Total"})]})]})}),e.jsxs("button",{onClick:()=>h("pending"),className:`p-5 rounded-2xl border transition-all relative ${N==="pending"?"border-brand-500 bg-brand-50":"border-gray-100 bg-white hover:border-gray-200"}`,children:[M>0&&e.jsx("div",{className:"absolute -top-2 -right-2 w-6 h-6 bg-red-500 rounded-full flex items-center justify-center",children:e.jsx("span",{className:"text-white text-xs font-bold",children:M})}),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-10 h-10 bg-yellow-100 rounded-xl flex items-center justify-center",children:e.jsx(St,{size:20,className:"text-yellow-600"})}),e.jsxs("div",{className:"text-left",children:[e.jsx("p",{className:"text-2xl font-black text-gray-900",children:M}),e.jsx("p",{className:"text-xs font-bold text-gray-500",children:"En attente"})]})]})]}),e.jsx("button",{onClick:()=>h("verified"),className:`p-5 rounded-2xl border transition-all ${N==="verified"?"border-brand-500 bg-brand-50":"border-gray-100 bg-white hover:border-gray-200"}`,children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-10 h-10 bg-green-100 rounded-xl flex items-center justify-center",children:e.jsx(Gt,{size:20,className:"text-green-600"})}),e.jsxs("div",{className:"text-left",children:[e.jsx("p",{className:"text-2xl font-black text-gray-900",children:D}),e.jsx("p",{className:"text-xs font-bold text-gray-500",children:"Certifis"})]})]})}),e.jsx("button",{onClick:()=>h("unverified"),className:`p-5 rounded-2xl border transition-all ${N==="unverified"?"border-brand-500 bg-brand-50":"border-gray-100 bg-white hover:border-gray-200"}`,children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-10 h-10 bg-gray-100 rounded-xl flex items-center justify-center",children:e.jsx(ot,{size:20,className:"text-gray-400"})}),e.jsxs("div",{className:"text-left",children:[e.jsx("p",{className:"text-2xl font-black text-gray-900",children:U}),e.jsx("p",{className:"text-xs font-bold text-gray-500",children:"Non vrifis"})]})]})})]}),e.jsxs("div",{className:"relative",children:[e.jsx(xa,{className:"absolute left-4 top-1/2 -translate-y-1/2 text-gray-400",size:20}),e.jsx("input",{type:"text",value:x,onChange:T=>y(T.target.value),placeholder:"Rechercher un artisan...",className:"w-full pl-12 pr-4 py-3 bg-white border border-gray-200 rounded-xl focus:border-brand-500 focus:outline-none"})]}),e.jsx("div",{className:"bg-white rounded-2xl shadow-sm border overflow-hidden",children:e.jsx("div",{className:"divide-y divide-gray-50",children:L.length===0?e.jsx("div",{className:"px-6 py-12 text-center text-gray-400",children:N==="pending"?"Aucune vrification en attente":"Aucun artisan trouv"}):L.map(T=>{var z,S,V,le,he,Ne;const C=T.verification_documents!==null,B={verified:{label:"Certifi",color:"bg-green-100 text-green-700"},pending:{label:"En attente",color:"bg-yellow-100 text-yellow-700"},rejected:{label:"Refus",color:"bg-red-100 text-red-700"},unverified:{label:"Non vrifi",color:"bg-gray-100 text-gray-500"}}[T.verification_status]||{label:"Inconnu",color:"bg-gray-100 text-gray-500"};return e.jsx("div",{className:`p-6 hover:bg-gray-50 transition-colors cursor-pointer ${T.verification_status==="pending"?"bg-yellow-50/50":""}`,onClick:()=>E(T),children:e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsxs("div",{className:"w-14 h-14 rounded-full bg-brand-100 flex items-center justify-center overflow-hidden relative",children:[(z=T.profiles)!=null&&z.avatar_url?e.jsx("img",{src:T.profiles.avatar_url,alt:"",className:"w-full h-full object-cover"}):e.jsx(ot,{size:24,className:"text-brand-600"}),T.verification_status==="verified"&&e.jsx("div",{className:"absolute -bottom-1 -right-1 w-6 h-6 bg-green-500 rounded-full flex items-center justify-center border-2 border-white",children:e.jsx(Qe,{size:12,className:"text-white"})})]}),e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-1 flex-wrap",children:[e.jsx("h4",{className:"font-bold text-gray-900",children:(S=T.profiles)==null?void 0:S.full_name}),e.jsx("span",{className:`px-2 py-0.5 text-[10px] font-black rounded-full uppercase ${B.color}`,children:B.label}),C&&T.verification_status==="pending"&&e.jsxs("span",{className:"px-2 py-0.5 bg-blue-100 text-blue-700 text-[10px] font-black rounded-full uppercase flex items-center gap-1",children:[e.jsx(et,{size:10}),"Documents soumis"]})]}),e.jsx("p",{className:"text-sm text-gray-500",children:((V=T.categories)==null?void 0:V.name)||((le=T.profiles)==null?void 0:le.specialty)||"Non spcifi"}),e.jsxs("div",{className:"flex items-center gap-4 mt-2 text-xs text-gray-400",children:[((he=T.profiles)==null?void 0:he.location)&&e.jsxs("span",{className:"flex items-center gap-1",children:[e.jsx(ga,{size:12}),T.profiles.location]}),((Ne=T.profiles)==null?void 0:Ne.phone)&&e.jsxs("span",{className:"flex items-center gap-1",children:[e.jsx(hn,{size:12}),T.profiles.phone]})]})]}),e.jsxs("div",{className:"text-right",children:[e.jsxs("p",{className:"text-xs text-gray-400",children:["Inscrit le ",new Date(T.created_at).toLocaleDateString("fr-FR")]}),C&&e.jsx("p",{className:"text-xs text-blue-500 font-bold mt-1",children:"Voir les documents "})]})]})},T.user_id)})})}),g&&e.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50 p-4",children:e.jsxs("div",{className:"bg-white rounded-2xl max-w-2xl w-full shadow-2xl max-h-[90vh] overflow-auto",children:[e.jsxs("div",{className:"sticky top-0 bg-white border-b p-4 flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("div",{className:"w-14 h-14 rounded-full bg-brand-100 flex items-center justify-center overflow-hidden relative",children:(G=g.profiles)!=null&&G.avatar_url?e.jsx("img",{src:g.profiles.avatar_url,alt:"",className:"w-full h-full object-cover"}):e.jsx(ot,{size:28,className:"text-brand-600"})}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-black text-gray-900",children:(Z=g.profiles)==null?void 0:Z.full_name}),e.jsx("p",{className:"text-sm text-gray-500",children:(X=g.profiles)==null?void 0:X.email})]})]}),e.jsx("button",{onClick:()=>E(null),className:"w-10 h-10 rounded-full bg-gray-100 flex items-center justify-center text-gray-500 hover:bg-gray-200",children:e.jsx(Ze,{size:20})})]}),e.jsxs("div",{className:"p-6 space-y-6",children:[e.jsx("div",{className:"flex items-center gap-2",children:g.verification_status==="verified"?e.jsxs("span",{className:"inline-flex items-center gap-1 px-4 py-2 bg-green-100 text-green-700 text-sm font-black rounded-full",children:[e.jsx(Gt,{size:16})," Certifi"]}):g.verification_status==="pending"?e.jsxs("span",{className:"inline-flex items-center gap-1 px-4 py-2 bg-yellow-100 text-yellow-700 text-sm font-black rounded-full",children:[e.jsx(St,{size:16})," En attente de vrification"]}):g.verification_status==="rejected"?e.jsxs("span",{className:"inline-flex items-center gap-1 px-4 py-2 bg-red-100 text-red-700 text-sm font-black rounded-full",children:[e.jsx(el,{size:16})," Refus"]}):e.jsxs("span",{className:"inline-flex items-center gap-1 px-4 py-2 bg-gray-100 text-gray-600 text-sm font-black rounded-full",children:[e.jsx(ot,{size:16})," Non vrifi"]})}),e.jsx("div",{className:"bg-gray-50 rounded-xl p-4 space-y-3",children:e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(Ht,{size:18,className:"text-gray-400"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-xs text-gray-400 uppercase",children:"Mtier"}),e.jsx("p",{className:"font-bold text-gray-900",children:((R=g.categories)==null?void 0:R.name)||"Non spcifi"})]})]}),((ae=g.profiles)==null?void 0:ae.location)&&e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(ga,{size:18,className:"text-gray-400"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-xs text-gray-400 uppercase",children:"Localisation"}),e.jsx("p",{className:"font-bold text-gray-900",children:g.profiles.location})]})]}),((ge=g.profiles)==null?void 0:ge.phone)&&e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(hn,{size:18,className:"text-gray-400"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-xs text-gray-400 uppercase",children:"Tlphone"}),e.jsx("p",{className:"font-bold text-gray-900",children:g.profiles.phone})]})]})]})}),g.verification_documents?e.jsxs("div",{className:"space-y-4",children:[e.jsxs("h4",{className:"font-black text-gray-900 uppercase text-xs tracking-widest flex items-center gap-2",children:[e.jsx(et,{size:14}),"Documents soumis"]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[g.verification_documents.selfie_url&&e.jsxs("div",{className:"bg-gray-50 rounded-xl p-3 space-y-2",children:[e.jsxs("div",{className:"flex items-center gap-2 text-sm font-bold text-gray-700",children:[e.jsx(un,{size:16,className:"text-blue-500"}),"Photo (Selfie)"]}),e.jsxs("button",{onClick:()=>v(g.verification_documents.selfie_url),className:"relative w-full aspect-square rounded-lg overflow-hidden bg-gray-100 hover:opacity-90 transition-opacity",children:[e.jsx("img",{src:g.verification_documents.selfie_url,alt:"Selfie",className:"w-full h-full object-cover"}),e.jsx("div",{className:"absolute inset-0 flex items-center justify-center bg-black/0 hover:bg-black/20 transition-colors",children:e.jsx(Hi,{size:24,className:"text-white opacity-0 hover:opacity-100"})})]})]}),g.verification_documents.id_card_url&&e.jsxs("div",{className:"bg-gray-50 rounded-xl p-3 space-y-2",children:[e.jsxs("div",{className:"flex items-center gap-2 text-sm font-bold text-gray-700",children:[e.jsx(Na,{size:16,className:"text-purple-500"}),"Pice d'identit (",((k=g.verification_documents.id_card_type)==null?void 0:k.toUpperCase())||"CNI",")"]}),e.jsx("button",{onClick:()=>v(g.verification_documents.id_card_url),className:"relative w-full aspect-video rounded-lg overflow-hidden bg-gray-100 hover:opacity-90 transition-opacity",children:e.jsx("img",{src:g.verification_documents.id_card_url,alt:"ID Card",className:"w-full h-full object-cover"})})]}),g.verification_documents.ninea_url&&e.jsxs("div",{className:"bg-gray-50 rounded-xl p-3 space-y-2",children:[e.jsxs("div",{className:"flex items-center gap-2 text-sm font-bold text-gray-700",children:[e.jsx(et,{size:16,className:"text-green-500"}),"NINEA",g.verification_documents.ninea_number&&e.jsxs("span",{className:"text-xs text-gray-400 font-mono",children:["(",g.verification_documents.ninea_number,")"]})]}),e.jsx("button",{onClick:()=>v(g.verification_documents.ninea_url),className:"relative w-full aspect-video rounded-lg overflow-hidden bg-gray-100 hover:opacity-90 transition-opacity",children:e.jsx("img",{src:g.verification_documents.ninea_url,alt:"NINEA",className:"w-full h-full object-cover"})})]}),g.verification_documents.registre_commerce_url&&e.jsxs("div",{className:"bg-gray-50 rounded-xl p-3 space-y-2",children:[e.jsxs("div",{className:"flex items-center gap-2 text-sm font-bold text-gray-700",children:[e.jsx(Qa,{size:16,className:"text-orange-500"}),"Registre Commerce",g.verification_documents.registre_commerce_number&&e.jsxs("span",{className:"text-xs text-gray-400 font-mono",children:["(",g.verification_documents.registre_commerce_number,")"]})]}),e.jsx("button",{onClick:()=>v(g.verification_documents.registre_commerce_url),className:"relative w-full aspect-video rounded-lg overflow-hidden bg-gray-100 hover:opacity-90 transition-opacity",children:e.jsx("img",{src:g.verification_documents.registre_commerce_url,alt:"RC",className:"w-full h-full object-cover"})})]})]})]}):e.jsxs("div",{className:"bg-gray-50 rounded-xl p-6 text-center",children:[e.jsx(et,{size:32,className:"mx-auto text-gray-300 mb-2"}),e.jsx("p",{className:"text-gray-500 font-medium",children:"Aucun document soumis"}),e.jsx("p",{className:"text-xs text-gray-400",children:"L'artisan n'a pas encore envoy de demande de vrification"})]}),g.verification_status==="pending"&&g.verification_documents&&e.jsxs("div",{className:"space-y-4 border-t pt-6",children:[e.jsx("h4",{className:"font-black text-gray-900 uppercase text-xs tracking-widest",children:"Actions de vrification"}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-bold text-gray-500 uppercase mb-2",children:"Raison du refus (si applicable)"}),e.jsx("input",{type:"text",value:b,onChange:T=>w(T.target.value),placeholder:"Ex: Photo floue, document expir...",className:"w-full px-4 py-3 bg-gray-50 border border-gray-200 rounded-xl focus:border-brand-500 focus:outline-none"})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[e.jsxs("button",{onClick:()=>J(g.user_id),className:"flex items-center justify-center gap-2 py-4 bg-green-500 text-white font-bold rounded-xl hover:bg-green-600 transition-colors",children:[e.jsx(Qe,{size:20}),"Approuver"]}),e.jsxs("button",{onClick:()=>F(g.user_id),className:"flex items-center justify-center gap-2 py-4 bg-red-500 text-white font-bold rounded-xl hover:bg-red-600 transition-colors",children:[e.jsx(el,{size:20}),"Rejeter"]})]})]}),g.verification_status==="verified"&&e.jsxs("div",{className:"p-4 bg-green-50 rounded-xl flex items-center gap-3",children:[e.jsx(Gt,{className:"text-green-500",size:24}),e.jsxs("div",{children:[e.jsx("p",{className:"font-bold text-green-700",children:"Artisan certifi"}),e.jsx("p",{className:"text-sm text-green-600",children:"Ce professionnel bnficie du badge certifi et des avantages associs."})]})]}),g.verification_status==="rejected"&&((q=g.verification_documents)==null?void 0:q.rejection_reason)&&e.jsxs("div",{className:"p-4 bg-red-50 rounded-xl",children:[e.jsx("p",{className:"font-bold text-red-700 text-sm mb-1",children:"Raison du refus"}),e.jsx("p",{className:"text-red-600",children:g.verification_documents.rejection_reason})]})]})]})}),d&&e.jsxs("div",{className:"fixed inset-0 bg-black/90 flex items-center justify-center z-[60] p-4",children:[e.jsx("button",{onClick:()=>v(null),className:"absolute top-4 right-4 w-12 h-12 bg-white/10 rounded-full flex items-center justify-center text-white hover:bg-white/20",children:e.jsx(Ze,{size:24})}),e.jsx("img",{src:d,alt:"Preview",className:"max-w-full max-h-[90vh] object-contain rounded-lg"})]})]})}function ey(){var F,G,Z,X,R,ae,ge,k,q,T;const{error:i}=sa(),[u,f]=c.useState([]),[o,x]=c.useState(!0),[y,N]=c.useState(null),[h,g]=c.useState("pay_artisan"),[E,d]=c.useState(50),[v,b]=c.useState(""),[w,_]=c.useState(!1),[L,M]=c.useState("");c.useEffect(()=>{D()},[]);const D=async()=>{x(!0);const{data:C,error:B}=await j.from("projects").select(`
        id, title, project_number, status, created_at, location,
        categories (name),
        profiles!projects_client_id_fkey (id, full_name, email, phone, avatar_url)
      `).eq("status","disputed").order("created_at",{ascending:!1});if(B){console.error("Error fetching disputes:",B),x(!1);return}const z=await Promise.all((C||[]).map(async S=>{const{data:V}=await j.from("quotes").select(`
            artisan_id,
            profiles!quotes_artisan_id_fkey (id, full_name, email, phone, avatar_url)
          `).eq("project_id",S.id).eq("status","accepted").single(),{data:le}=await j.from("escrows").select("*").eq("project_id",S.id).single();return{id:S.id,title:S.title,project_number:S.project_number,status:S.status,created_at:S.created_at,location:S.location,client:S.profiles,artisan:(V==null?void 0:V.profiles)||null,escrow:le,category:S.categories}}));f(z),x(!1)},U=async()=>{var C,B;if(!(!y||!y.escrow)){_(!0);try{const z=y.escrow;let S=0,V=0,le="completed";switch(h){case"refund_client":S=z.total_amount,V=0,le="refunded";break;case"pay_artisan":S=0,V=z.artisan_payout,le="completed";break;case"split":const he=z.total_amount*(E/100);S=he,V=z.total_amount-he-z.commission_amount,le="completed";break}await j.from("escrows").update({status:le,updated_at:new Date().toISOString()}).eq("id",z.id),await j.from("projects").update({status:"completed",updated_at:new Date().toISOString()}).eq("id",y.id),await j.from("notifications").insert({user_id:(C=y.client)==null?void 0:C.id,type:"system",title:"Litige rsolu",message:v||`Le litige pour "${y.title}" a t rsolu.`+(S>0?` Remboursement: ${S.toLocaleString("fr-FR")} FCFA.`:""),data:{project_id:y.id}}),(B=y.artisan)!=null&&B.id&&await j.from("notifications").insert({user_id:y.artisan.id,type:"system",title:"Litige rsolu",message:v||`Le litige pour "${y.title}" a t rsolu.`+(V>0?` Paiement: ${V.toLocaleString("fr-FR")} FCFA.`:""),data:{project_id:y.id}}),D(),N(null),b("")}catch(z){console.error("Error resolving dispute:",z),i("Erreur lors de la rsolution du litige")}_(!1)}},J=u.filter(C=>{var B,z,S,V,le;return C.title.toLowerCase().includes(L.toLowerCase())||((B=C.project_number)==null?void 0:B.toLowerCase().includes(L.toLowerCase()))||((S=(z=C.client)==null?void 0:z.full_name)==null?void 0:S.toLowerCase().includes(L.toLowerCase()))||((le=(V=C.artisan)==null?void 0:V.full_name)==null?void 0:le.toLowerCase().includes(L.toLowerCase()))});return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[e.jsx("div",{className:"bg-red-50 border border-red-100 rounded-2xl p-6",children:e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("div",{className:"w-12 h-12 bg-red-100 rounded-xl flex items-center justify-center",children:e.jsx(zt,{size:24,className:"text-red-600"})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-3xl font-black text-red-700",children:u.length}),e.jsx("p",{className:"text-sm font-bold text-red-600",children:"Litiges en cours"})]})]})}),e.jsx("div",{className:"bg-yellow-50 border border-yellow-100 rounded-2xl p-6",children:e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("div",{className:"w-12 h-12 bg-yellow-100 rounded-xl flex items-center justify-center",children:e.jsx(Na,{size:24,className:"text-yellow-600"})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-3xl font-black text-yellow-700",children:u.reduce((C,B)=>{var z;return C+(((z=B.escrow)==null?void 0:z.total_amount)||0)},0).toLocaleString("fr-FR")}),e.jsx("p",{className:"text-sm font-bold text-yellow-600",children:"FCFA bloqus"})]})]})}),e.jsx("div",{className:"bg-blue-50 border border-blue-100 rounded-2xl p-6",children:e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("div",{className:"w-12 h-12 bg-blue-100 rounded-xl flex items-center justify-center",children:e.jsx(St,{size:24,className:"text-blue-600"})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-3xl font-black text-blue-700",children:u.length>0?Math.floor((Date.now()-new Date(((F=u[u.length-1])==null?void 0:F.created_at)||Date.now()).getTime())/(1e3*60*60*24)):0}),e.jsx("p",{className:"text-sm font-bold text-blue-600",children:"Jours (plus ancien)"})]})]})})]}),e.jsxs("div",{className:"relative",children:[e.jsx(xa,{className:"absolute left-4 top-1/2 -translate-y-1/2 text-gray-400",size:20}),e.jsx("input",{type:"text",value:L,onChange:C=>M(C.target.value),placeholder:"Rechercher par projet, client ou artisan...",className:"w-full pl-12 pr-4 py-3 bg-white border border-gray-200 rounded-xl focus:border-brand-500 focus:outline-none"})]}),e.jsx("div",{className:"bg-white rounded-2xl shadow-sm border overflow-hidden",children:J.length===0?e.jsxs("div",{className:"px-6 py-12 text-center",children:[e.jsx(zt,{size:48,className:"text-gray-200 mx-auto mb-4"}),e.jsx("p",{className:"text-gray-500 font-medium",children:"Aucun litige en cours"}),e.jsx("p",{className:"text-sm text-gray-400",children:"Tous les projets se passent bien !"})]}):e.jsx("div",{className:"divide-y divide-gray-50",children:J.map(C=>{var B,z,S,V;return e.jsx("div",{className:"p-6 hover:bg-red-50/30 transition-colors cursor-pointer",onClick:()=>N(C),children:e.jsxs("div",{className:"flex items-start gap-4",children:[e.jsx("div",{className:"w-12 h-12 bg-red-100 rounded-xl flex items-center justify-center flex-shrink-0",children:e.jsx(zt,{size:24,className:"text-red-600"})}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsxs("div",{className:"flex items-start justify-between gap-4",children:[e.jsxs("div",{children:[e.jsx("h4",{className:"font-bold text-gray-900 mb-1",children:C.title}),e.jsx("p",{className:"text-xs text-gray-400 font-mono",children:C.project_number})]}),e.jsx("span",{className:"px-3 py-1 bg-red-100 text-red-700 text-xs font-bold rounded-full",children:"En litige"})]}),e.jsxs("div",{className:"mt-3 flex items-center gap-6 text-sm",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"w-6 h-6 rounded-full bg-gray-100 flex items-center justify-center overflow-hidden",children:(B=C.client)!=null&&B.avatar_url?e.jsx("img",{src:C.client.avatar_url,alt:"",className:"w-full h-full object-cover"}):e.jsx(ot,{size:12,className:"text-gray-400"})}),e.jsx("span",{className:"text-gray-600",children:((z=C.client)==null?void 0:z.full_name)||"Client"})]}),e.jsx(vl,{size:14,className:"text-gray-300"}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"w-6 h-6 rounded-full bg-gray-100 flex items-center justify-center overflow-hidden",children:(S=C.artisan)!=null&&S.avatar_url?e.jsx("img",{src:C.artisan.avatar_url,alt:"",className:"w-full h-full object-cover"}):e.jsx(ot,{size:12,className:"text-gray-400"})}),e.jsx("span",{className:"text-gray-600",children:((V=C.artisan)==null?void 0:V.full_name)||"Artisan"})]})]}),C.escrow&&e.jsxs("div",{className:"mt-3 flex items-center gap-4",children:[e.jsxs("span",{className:"px-3 py-1 bg-yellow-100 text-yellow-700 text-xs font-bold rounded-full flex items-center gap-1",children:[e.jsx(Ss,{size:12}),C.escrow.total_amount.toLocaleString("fr-FR")," FCFA bloqus"]}),e.jsxs("span",{className:"text-xs text-gray-400",children:["Depuis ",new Date(C.created_at).toLocaleDateString("fr-FR")]})]})]}),e.jsx(da,{size:20,className:"text-gray-300"})]})},C.id)})})}),y&&e.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50 p-4",children:e.jsxs("div",{className:"bg-white rounded-2xl max-w-2xl w-full shadow-2xl max-h-[90vh] overflow-auto",children:[e.jsxs("div",{className:"sticky top-0 bg-white border-b p-4 flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-black text-gray-900",children:"Rsolution du litige"}),e.jsx("p",{className:"text-sm text-gray-500",children:y.project_number})]}),e.jsx("button",{onClick:()=>N(null),className:"w-10 h-10 rounded-full bg-gray-100 flex items-center justify-center text-gray-500 hover:bg-gray-200",children:e.jsx(Ze,{size:20})})]}),e.jsxs("div",{className:"p-6 space-y-6",children:[e.jsxs("div",{className:"bg-gray-50 rounded-xl p-4",children:[e.jsx("h4",{className:"font-bold text-gray-900 mb-2",children:y.title}),e.jsxs("p",{className:"text-sm text-gray-500",children:[(G=y.category)==null?void 0:G.name,"  ",y.location]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{className:"bg-blue-50 rounded-xl p-4",children:[e.jsx("p",{className:"text-xs font-bold text-blue-600 uppercase mb-3",children:"Client"}),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-12 h-12 rounded-full bg-blue-100 flex items-center justify-center overflow-hidden",children:(Z=y.client)!=null&&Z.avatar_url?e.jsx("img",{src:y.client.avatar_url,alt:"",className:"w-full h-full object-cover"}):e.jsx(ot,{size:20,className:"text-blue-500"})}),e.jsxs("div",{children:[e.jsx("p",{className:"font-bold text-gray-900",children:(X=y.client)==null?void 0:X.full_name}),e.jsx("p",{className:"text-xs text-gray-500",children:(R=y.client)==null?void 0:R.phone})]})]})]}),e.jsxs("div",{className:"bg-orange-50 rounded-xl p-4",children:[e.jsx("p",{className:"text-xs font-bold text-orange-600 uppercase mb-3",children:"Artisan"}),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-12 h-12 rounded-full bg-orange-100 flex items-center justify-center overflow-hidden",children:(ae=y.artisan)!=null&&ae.avatar_url?e.jsx("img",{src:y.artisan.avatar_url,alt:"",className:"w-full h-full object-cover"}):e.jsx(ot,{size:20,className:"text-orange-500"})}),e.jsxs("div",{children:[e.jsx("p",{className:"font-bold text-gray-900",children:(ge=y.artisan)==null?void 0:ge.full_name}),e.jsx("p",{className:"text-xs text-gray-500",children:(k=y.artisan)==null?void 0:k.phone})]})]})]})]}),y.escrow&&e.jsxs("div",{className:"bg-yellow-50 border border-yellow-200 rounded-xl p-4",children:[e.jsx("p",{className:"text-xs font-bold text-yellow-700 uppercase mb-3",children:"Fonds bloqus"}),e.jsxs("div",{className:"grid grid-cols-3 gap-4 text-center",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-2xl font-black text-yellow-700",children:y.escrow.total_amount.toLocaleString("fr-FR")}),e.jsx("p",{className:"text-xs text-yellow-600",children:"Total FCFA"})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-2xl font-black text-gray-600",children:((q=y.escrow.commission_amount)==null?void 0:q.toLocaleString("fr-FR"))||"0"}),e.jsx("p",{className:"text-xs text-gray-500",children:"Commission"})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-2xl font-black text-green-600",children:((T=y.escrow.artisan_payout)==null?void 0:T.toLocaleString("fr-FR"))||"0"}),e.jsx("p",{className:"text-xs text-green-600",children:"Part artisan"})]})]})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsx("p",{className:"text-xs font-bold text-gray-500 uppercase",children:"Dcision"}),e.jsxs("label",{className:`block p-4 rounded-xl border-2 cursor-pointer transition-all ${h==="refund_client"?"border-blue-500 bg-blue-50":"border-gray-200 hover:border-gray-300"}`,children:[e.jsx("input",{type:"radio",name:"resolution",value:"refund_client",checked:h==="refund_client",onChange:()=>g("refund_client"),className:"sr-only"}),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:`w-10 h-10 rounded-xl flex items-center justify-center ${h==="refund_client"?"bg-blue-500 text-white":"bg-gray-100 text-gray-400"}`,children:e.jsx(vl,{size:20,className:"rotate-180"})}),e.jsxs("div",{children:[e.jsx("p",{className:"font-bold text-gray-900",children:"Rembourser le client"}),e.jsx("p",{className:"text-xs text-gray-500",children:"Le client rcupre 100% des fonds"})]})]})]}),e.jsxs("label",{className:`block p-4 rounded-xl border-2 cursor-pointer transition-all ${h==="pay_artisan"?"border-green-500 bg-green-50":"border-gray-200 hover:border-gray-300"}`,children:[e.jsx("input",{type:"radio",name:"resolution",value:"pay_artisan",checked:h==="pay_artisan",onChange:()=>g("pay_artisan"),className:"sr-only"}),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:`w-10 h-10 rounded-xl flex items-center justify-center ${h==="pay_artisan"?"bg-green-500 text-white":"bg-gray-100 text-gray-400"}`,children:e.jsx(vl,{size:20})}),e.jsxs("div",{children:[e.jsx("p",{className:"font-bold text-gray-900",children:"Payer l'artisan"}),e.jsx("p",{className:"text-xs text-gray-500",children:"L'artisan reoit son paiement normal"})]})]})]}),e.jsxs("label",{className:`block p-4 rounded-xl border-2 cursor-pointer transition-all ${h==="split"?"border-yellow-500 bg-yellow-50":"border-gray-200 hover:border-gray-300"}`,children:[e.jsx("input",{type:"radio",name:"resolution",value:"split",checked:h==="split",onChange:()=>g("split"),className:"sr-only"}),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:`w-10 h-10 rounded-xl flex items-center justify-center ${h==="split"?"bg-yellow-500 text-white":"bg-gray-100 text-gray-400"}`,children:e.jsx(Ss,{size:20})}),e.jsxs("div",{children:[e.jsx("p",{className:"font-bold text-gray-900",children:"Partager les fonds"}),e.jsx("p",{className:"text-xs text-gray-500",children:"Rpartition personnalise"})]})]})]}),h==="split"&&e.jsx("div",{className:"bg-gray-50 rounded-xl p-4 space-y-3",children:e.jsxs("label",{className:"block",children:[e.jsx("span",{className:"text-sm font-bold text-gray-700",children:"% pour le client"}),e.jsx("input",{type:"range",min:"0",max:"100",value:E,onChange:C=>d(Number(C.target.value)),className:"w-full mt-2"}),e.jsxs("div",{className:"flex justify-between text-xs text-gray-500 mt-1",children:[e.jsxs("span",{children:["Client: ",E,"%"]}),e.jsxs("span",{children:["Artisan: ",100-E,"%"]})]})]})})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-bold text-gray-500 uppercase mb-2",children:"Note de rsolution (envoye aux deux parties)"}),e.jsx("textarea",{value:v,onChange:C=>b(C.target.value),placeholder:"Expliquez la dcision...",className:"w-full px-4 py-3 bg-gray-50 border border-gray-200 rounded-xl focus:border-brand-500 focus:outline-none min-h-24"})]}),e.jsxs("div",{className:"flex gap-3",children:[e.jsx("button",{onClick:()=>N(null),className:"flex-1 py-4 bg-gray-100 text-gray-600 font-bold rounded-xl hover:bg-gray-200 transition-colors",children:"Annuler"}),e.jsx("button",{onClick:U,disabled:w,className:"flex-1 py-4 bg-brand-500 text-white font-bold rounded-xl hover:bg-brand-600 transition-colors disabled:opacity-50 flex items-center justify-center gap-2",children:w?e.jsx(ma,{size:20,className:"animate-spin"}):e.jsxs(e.Fragment,{children:[e.jsx(Qe,{size:20}),"Rsoudre le litige"]})})]})]})]})})]})}function ty(){const{success:i,error:u}=sa(),[f,o]=c.useState([]),[x,y]=c.useState(!0),[N,h]=c.useState(null),g=async()=>{y(!0);const{data:d,error:v}=await j.from("projects").select(`
        id, title, project_number, client_confirmed_closure_at,
        categories (name),
        profiles!projects_client_id_fkey (id, full_name, email)
      `).eq("status","completion_requested").not("client_confirmed_closure_at","is",null).order("client_confirmed_closure_at",{ascending:!1});if(v){console.error("Error fetching pending closures:",v),y(!1);return}const b=await Promise.all((d||[]).map(async w=>{const{data:_}=await j.from("quotes").select("artisan_id, profiles!quotes_artisan_id_fkey(id, full_name)").eq("project_id",w.id).eq("status","accepted").single(),{data:L}=await j.from("escrows").select("id, total_amount, artisan_payout, status").eq("project_id",w.id).single();return{id:w.id,title:w.title,project_number:w.project_number,client_confirmed_closure_at:w.client_confirmed_closure_at,client:w.profiles??null,artisan:(_==null?void 0:_.profiles)??null,escrow:L??null,category:w.categories??null}}));o(b),y(!1)};c.useEffect(()=>{g()},[]);const E=async d=>{var v,b;if(!d.escrow||d.escrow.status==="released"){u("Escrow invalide ou dj libr");return}h(d.id);try{await j.from("escrows").update({status:"released",updated_at:new Date().toISOString()}).eq("id",d.escrow.id),await j.from("projects").update({status:"completed",updated_at:new Date().toISOString()}).eq("id",d.id);const w=d.escrow.artisan_payout||0;(v=d.artisan)!=null&&v.id&&w>0&&await Ki(d.id,d.artisan.id,w),await j.from("notifications").insert({user_id:(b=d.client)==null?void 0:b.id,type:"project_completed",title:"Projet cltur",message:`Le projet "${d.title}" a t cltur. Vous pouvez maintenant noter l'artisan.`,data:{project_id:d.id},is_read:!1}),i(`Projet "${d.title}" cltur. Paiement vers  l'artisan.`),await g()}catch(w){u((w==null?void 0:w.message)||"Erreur lors de la clture")}finally{h(null)}};return x?e.jsx(Yt,{}):e.jsxs("div",{className:"p-6 max-w-4xl",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-6",children:[e.jsx("div",{className:"w-12 h-12 bg-brand-100 rounded-xl flex items-center justify-center",children:e.jsx(Qe,{size:24,className:"text-brand-600"})}),e.jsxs("div",{children:[e.jsx("h1",{className:"text-xl font-black text-gray-900",children:"Cltures en attente"}),e.jsx("p",{className:"text-sm text-gray-500",children:"Projets dont le client a confirm la fin des travaux. Clturer et verser l'artisan."})]})]}),f.length===0?e.jsxs("div",{className:"bg-white rounded-2xl border border-gray-100 p-10 text-center",children:[e.jsx(St,{size:40,className:"text-gray-300 mx-auto mb-3"}),e.jsx("p",{className:"font-bold text-gray-700",children:"Aucune clture en attente"}),e.jsx("p",{className:"text-sm text-gray-500 mt-1",children:"Les demandes de clture confirmes par le client apparatront ici."})]}):e.jsx("div",{className:"space-y-4",children:f.map(d=>{var v,b,w;return e.jsxs("div",{className:"bg-white rounded-2xl border border-gray-100 p-4 sm:p-5 flex flex-col sm:flex-row sm:items-center gap-4",children:[e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsxs("div",{className:"flex items-center gap-2 flex-wrap",children:[e.jsx("span",{className:"font-mono text-xs text-gray-400",children:d.project_number}),d.category&&e.jsx("span",{className:"px-2 py-0.5 rounded-md bg-gray-100 text-gray-600 text-xs font-medium",children:d.category.name})]}),e.jsx("h2",{className:"font-bold text-gray-900 mt-1 truncate",children:d.title}),e.jsxs("div",{className:"flex flex-wrap gap-3 mt-2 text-sm text-gray-600",children:[e.jsxs("span",{className:"flex items-center gap-1",children:[e.jsx(ot,{size:14}),((v=d.client)==null?void 0:v.full_name)??""]}),e.jsxs("span",{className:"flex items-center gap-1",children:[e.jsx(et,{size:14}),"Artisan : ",((b=d.artisan)==null?void 0:b.full_name)??""]}),d.escrow&&e.jsxs("span",{className:"flex items-center gap-1 font-medium",children:[e.jsx(Ss,{size:14}),"Reliquat : ",(d.escrow.artisan_payout||0).toLocaleString("fr-FR")," FCFA"]})]})]}),e.jsx("div",{className:"flex-shrink-0",children:e.jsxs("button",{onClick:()=>E(d),disabled:N===d.id||((w=d.escrow)==null?void 0:w.status)==="released",className:"flex items-center justify-center gap-2 w-full sm:w-auto px-5 py-3 bg-brand-500 text-white font-bold rounded-xl hover:bg-brand-600 disabled:opacity-50 disabled:cursor-not-allowed transition-colors",children:[N===d.id?e.jsx(ma,{size:18,className:"animate-spin"}):e.jsx(Qe,{size:18}),"Clturer et payer l'artisan"]})})]},d.id)})})]})}function ay(){const{showSuccess:i,showError:u}=sa(),[f,o]=c.useState([]),[x,y]=c.useState(!0),[N,h]=c.useState("all"),[g,E]=c.useState(""),[d,v]=c.useState(null),[b,w]=c.useState(null),[_,L]=c.useState("");c.useEffect(()=>{M()},[N]);const M=async()=>{try{y(!0);let G=j.from("artisan_affiliations").select(`
          *,
          artisan:profiles!artisan_affiliations_artisan_id_fkey(
            full_name,
            avatar_url
          )
        `).order("created_at",{ascending:!1});N!=="all"&&(G=G.eq("status",N));const{data:Z,error:X}=await G;if(X)throw X;o(Z||[])}catch(G){console.error("Error loading affiliations:",G),u("Erreur lors du chargement des affiliations")}finally{y(!1)}},D=async G=>{var Z;try{v(G);const{error:X}=await j.from("artisan_affiliations").update({status:"verified",verified_at:new Date().toISOString(),verified_by:((Z=(await j.auth.getUser()).data.user)==null?void 0:Z.id)||null,rejection_reason:null}).eq("id",G);if(X)throw X;i("Affiliation vrifie avec succs"),M()}catch(X){console.error("Error verifying affiliation:",X),u(X.message||"Erreur lors de la vrification")}finally{v(null)}},U=async G=>{var Z;if(!_.trim()){u("Veuillez indiquer la raison du rejet");return}try{w(G);const{error:X}=await j.from("artisan_affiliations").update({status:"rejected",verified_at:new Date().toISOString(),verified_by:((Z=(await j.auth.getUser()).data.user)==null?void 0:Z.id)||null,rejection_reason:_}).eq("id",G);if(X)throw X;i("Affiliation rejete"),L(""),M()}catch(X){console.error("Error rejecting affiliation:",X),u(X.message||"Erreur lors du rejet")}finally{w(null)}},J=G=>{switch(G){case"chambre":return"Chambre de Mtier";case"incubateur":return"Incubateur";case"sae":return"SAE";case"autre":return"Autre organisme";default:return G}},F=f.filter(G=>{var X,R,ae,ge;if(!g)return!0;const Z=g.toLowerCase();return((R=(X=G.artisan)==null?void 0:X.full_name)==null?void 0:R.toLowerCase().includes(Z))||((ae=G.affiliation_name)==null?void 0:ae.toLowerCase().includes(Z))||((ge=G.affiliation_number)==null?void 0:ge.toLowerCase().includes(Z))});return x?e.jsx(Yt,{}):e.jsx("div",{className:"min-h-screen bg-gray-50 p-6",children:e.jsxs("div",{className:"max-w-6xl mx-auto",children:[e.jsxs("div",{className:"mb-8",children:[e.jsx("h1",{className:"text-3xl font-black text-gray-900 mb-2",children:"Vrifications d'affiliations"}),e.jsx("p",{className:"text-gray-600",children:"Vrifiez et validez les affiliations des artisans (chambres de mtier, incubateurs, SAE)"})]}),e.jsx("div",{className:"bg-white rounded-2xl p-6 mb-6 shadow-sm",children:e.jsxs("div",{className:"flex flex-col md:flex-row gap-4",children:[e.jsxs("div",{className:"flex-1 relative",children:[e.jsx(xa,{className:"absolute left-4 top-1/2 -translate-y-1/2 text-gray-400",size:20}),e.jsx("input",{type:"text",value:g,onChange:G=>E(G.target.value),placeholder:"Rechercher par nom d'artisan, organisme...",className:"w-full pl-12 pr-4 py-3 rounded-xl border border-gray-200 focus:border-brand-500 focus:outline-none"})]}),e.jsx("div",{className:"flex gap-2 flex-wrap",children:["all","pending","verified","rejected"].map(G=>e.jsx("button",{onClick:()=>h(G),className:`px-4 py-2 rounded-xl font-bold transition-colors ${N===G?"bg-brand-500 text-white":"bg-gray-100 text-gray-700 hover:bg-gray-200"}`,children:G==="all"?"Toutes":G==="pending"?"En attente":G==="verified"?"Vrifies":"Rejetes"},G))})]})}),e.jsx("div",{className:"space-y-4",children:F.length===0?e.jsxs("div",{className:"bg-white rounded-2xl p-12 text-center",children:[e.jsx(Qa,{size:48,className:"text-gray-300 mx-auto mb-4"}),e.jsx("p",{className:"text-gray-600 font-medium",children:"Aucune affiliation trouve"})]}):F.map(G=>{var Z,X;return e.jsxs("div",{className:"bg-white rounded-2xl p-6 shadow-sm border-2 border-gray-100",children:[e.jsxs("div",{className:"flex flex-col md:flex-row md:items-start gap-6",children:[e.jsxs("div",{className:"flex items-start gap-4 flex-1",children:[e.jsx("div",{className:"w-12 h-12 rounded-xl bg-gray-100 flex items-center justify-center overflow-hidden flex-shrink-0",children:(Z=G.artisan)!=null&&Z.avatar_url?e.jsx("img",{src:G.artisan.avatar_url,alt:"",className:"w-full h-full object-cover"}):e.jsx(ot,{size:24,className:"text-gray-400"})}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("h3",{className:"font-black text-gray-900 mb-1",children:((X=G.artisan)==null?void 0:X.full_name)||"Artisan"}),e.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[e.jsx(Qa,{size:16,className:"text-brand-500"}),e.jsx("span",{className:"text-sm font-bold text-gray-700",children:J(G.affiliation_type)})]}),G.affiliation_name&&e.jsx("p",{className:"text-sm text-gray-600 mb-1",children:G.affiliation_name}),G.affiliation_number&&e.jsxs("p",{className:"text-xs text-gray-500",children:["N ",G.affiliation_number]}),e.jsxs("p",{className:"text-xs text-gray-400 mt-2",children:["Soumis le ",new Date(G.created_at).toLocaleDateString("fr-FR",{day:"numeric",month:"long",year:"numeric"})]})]})]}),e.jsxs("div",{className:"flex flex-col gap-3 md:w-64",children:[G.certificate_url&&e.jsxs("a",{href:G.certificate_url,target:"_blank",rel:"noopener noreferrer",className:"flex items-center justify-center gap-2 px-4 py-2 bg-gray-100 text-gray-700 rounded-xl font-bold hover:bg-gray-200 transition-colors",children:[e.jsx(et,{size:18}),"Voir certificat"]}),e.jsxs("div",{className:"flex items-center justify-center",children:[G.status==="pending"&&e.jsxs("span",{className:"inline-flex items-center gap-1 px-3 py-1 rounded-full bg-yellow-100 text-yellow-700 text-xs font-bold",children:[e.jsx(St,{size:14}),"En attente"]}),G.status==="verified"&&e.jsxs("span",{className:"inline-flex items-center gap-1 px-3 py-1 rounded-full bg-green-100 text-green-700 text-xs font-bold",children:[e.jsx(aa,{size:14}),"Vrifie"]}),G.status==="rejected"&&e.jsxs("span",{className:"inline-flex items-center gap-1 px-3 py-1 rounded-full bg-red-100 text-red-700 text-xs font-bold",children:[e.jsx(Ze,{size:14}),"Rejete"]})]}),G.status==="pending"&&e.jsxs("div",{className:"flex gap-2",children:[e.jsxs("button",{onClick:()=>D(G.id),disabled:d===G.id,className:"flex-1 flex items-center justify-center gap-2 px-4 py-2 bg-green-500 text-white rounded-xl font-bold hover:bg-green-600 transition-colors disabled:opacity-50",children:[e.jsx(aa,{size:18}),"Vrifier"]}),e.jsxs("button",{onClick:()=>{w(G.id),L("")},className:"flex-1 flex items-center justify-center gap-2 px-4 py-2 bg-red-500 text-white rounded-xl font-bold hover:bg-red-600 transition-colors",children:[e.jsx(Ze,{size:18}),"Rejeter"]})]}),G.status==="rejected"&&G.rejection_reason&&e.jsxs("div",{className:"bg-red-50 border border-red-200 rounded-xl p-3",children:[e.jsx("p",{className:"text-xs font-bold text-red-700 mb-1",children:"Raison du rejet :"}),e.jsx("p",{className:"text-xs text-red-600",children:G.rejection_reason})]})]})]}),b===G.id&&e.jsx("div",{className:"mt-4 pt-4 border-t border-gray-200",children:e.jsxs("div",{className:"space-y-3",children:[e.jsxs("label",{className:"block text-sm font-bold text-gray-700",children:["Raison du rejet ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx("textarea",{value:_,onChange:R=>L(R.target.value),rows:3,className:"w-full rounded-xl border border-gray-200 px-4 py-2 focus:border-red-500 focus:outline-none",placeholder:"Expliquez pourquoi cette affiliation est rejete..."}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("button",{onClick:()=>{w(null),L("")},className:"flex-1 px-4 py-2 bg-gray-100 text-gray-700 rounded-xl font-bold hover:bg-gray-200 transition-colors",children:"Annuler"}),e.jsx("button",{onClick:()=>U(G.id),disabled:!_.trim()||b===G.id,className:"flex-1 px-4 py-2 bg-red-500 text-white rounded-xl font-bold hover:bg-red-600 transition-colors disabled:opacity-50",children:"Confirmer le rejet"})]})]})})]},G.id)})})]})})}function sy(){var w;const i=ht(),u=Nt(),{profile:f}=It(),{error:o}=sa(),[x,y]=c.useState([]),[N,h]=c.useState(!0),[g,E]=c.useState("all");c.useEffect(()=>{if(!u.user||!f||f.role!=="artisan"){i("/dashboard");return}d()},[u.user,f]);const d=async()=>{if(u.user){h(!0);try{const{data:_}=await j.from("quotes").select("id").eq("artisan_id",u.user.id);if(!_||_.length===0){y([]),h(!1);return}const L=_.map(U=>U.id),{data:M,error:D}=await j.from("quote_revisions").select(`
          *,
          quotes!quote_revisions_quote_id_fkey(id, amount, quote_number, status),
          projects!quote_revisions_project_id_fkey(id, title, project_number),
          profiles!quote_revisions_requested_by_fkey(id, full_name, avatar_url)
        `).in("quote_id",L).order("created_at",{ascending:!1});if(D)throw D;y(M||[])}catch(_){console.error("Error fetching revisions:",_),o(`Erreur: ${_.message||"Impossible de charger les rvisions"}`)}finally{h(!1)}}},v=g==="all"?x:x.filter(_=>_.status===g),b={pending:{label:"En attente",color:"bg-yellow-50 text-yellow-700 border-yellow-200",icon:St},accepted:{label:"Accepte",color:"bg-green-50 text-green-700 border-green-200",icon:Qe},rejected:{label:"Refuse",color:"bg-red-50 text-red-700 border-red-200",icon:el},modified:{label:"Devis modifi",color:"bg-blue-50 text-blue-700 border-blue-200",icon:et}};return N?e.jsx(Yt,{}):e.jsxs("div",{className:"min-h-screen bg-gradient-to-br from-gray-50 via-white to-gray-50",children:[e.jsx("header",{className:"bg-white sticky top-0 z-30 shadow-sm border-b border-gray-100",children:e.jsxs("div",{className:"max-w-lg mx-auto px-5 py-4 flex items-center gap-4",children:[e.jsx("button",{onClick:()=>i("/dashboard"),className:"w-10 h-10 flex items-center justify-center rounded-xl hover:bg-gray-100 transition-colors",children:e.jsx(Wt,{size:20,className:"text-gray-600"})}),e.jsxs("div",{className:"flex-1",children:[e.jsx("h1",{className:"text-xl font-black text-gray-900",children:"Rvisions de devis"}),e.jsx("p",{className:"text-xs text-gray-500",children:"Grez les demandes de rvision"})]}),e.jsx(Da,{})]})}),e.jsxs("main",{className:"max-w-lg mx-auto px-5 py-6",children:[e.jsx("div",{className:"flex gap-2 overflow-x-auto pb-2 mb-4",children:[{key:"all",label:"Toutes"},{key:"pending",label:"En attente"},{key:"accepted",label:"Acceptes"},{key:"rejected",label:"Refuses"},{key:"modified",label:"Modifies"}].map(_=>{const L=_.key==="all"?x.length:x.filter(M=>M.status===_.key).length;return e.jsxs("button",{onClick:()=>E(_.key),className:`px-4 py-2 text-xs font-bold rounded-xl whitespace-nowrap transition-all ${g===_.key?"bg-brand-500 text-white shadow-lg":"bg-gray-100 text-gray-600 hover:bg-gray-200"}`,children:[_.label,L>0&&e.jsx("span",{className:`ml-2 px-1.5 py-0.5 rounded-full ${g===_.key?"bg-white/20":"bg-white"}`,children:L})]},_.key)})}),v.length===0?e.jsxs("div",{className:"bg-white rounded-2xl p-12 text-center border border-gray-100",children:[e.jsx("div",{className:"w-16 h-16 bg-gray-100 rounded-2xl flex items-center justify-center mx-auto mb-4",children:e.jsx(zt,{size:28,className:"text-gray-300"})}),e.jsx("p",{className:"text-gray-500 font-medium",children:g==="all"?"Aucune rvision":`Aucune rvision ${(w=b[g])==null?void 0:w.label.toLowerCase()}`}),e.jsx("p",{className:"text-sm text-gray-400 mt-1",children:g==="all"?"Les demandes de rvision apparatront ici":"Changez de filtre pour voir d'autres rvisions"})]}):e.jsx("div",{className:"space-y-3",children:v.map(_=>{var F;const L=b[_.status]||b.pending,M=L.icon,D=_.quotes,U=_.projects,J=_.profiles;return e.jsx("div",{className:`bg-white rounded-2xl border-2 transition-all ${_.status==="pending"?"border-yellow-200 bg-yellow-50/30":"border-gray-100"}`,children:e.jsxs("div",{className:"p-4",children:[e.jsxs("div",{className:"flex items-start justify-between mb-3",children:[e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[e.jsx("h3",{className:"font-black text-gray-900",children:(U==null?void 0:U.title)||"Projet"}),(U==null?void 0:U.project_number)&&e.jsx("span",{className:"text-xs text-gray-400 font-mono",children:U.project_number})]}),e.jsxs("p",{className:"text-xs text-gray-500",children:["Devis: ",(D==null?void 0:D.quote_number)||_.quote_id.slice(0,8).toUpperCase()]}),J&&e.jsxs("div",{className:"flex items-center gap-2 mt-2",children:[e.jsx("div",{className:"w-6 h-6 rounded-full bg-gray-200 overflow-hidden",children:J.avatar_url?e.jsx("img",{src:J.avatar_url,alt:"",className:"w-full h-full object-cover"}):e.jsx("div",{className:"w-full h-full flex items-center justify-center",children:e.jsx("span",{className:"text-xs text-gray-400",children:(F=J.full_name)==null?void 0:F[0]})})}),e.jsx("span",{className:"text-xs font-bold text-gray-700",children:J.full_name})]})]}),e.jsxs("div",{className:"text-right",children:[e.jsxs("span",{className:`inline-flex items-center gap-1 px-2 py-1 rounded-lg text-xs font-bold border ${L.color}`,children:[e.jsx(M,{size:12}),L.label]}),e.jsx("p",{className:"text-xs text-gray-400 mt-1",children:new Date(_.requested_at).toLocaleDateString("fr-FR",{day:"numeric",month:"short",hour:"2-digit",minute:"2-digit"})})]})]}),_.suggested_price!=null&&Number(_.suggested_price)>0&&e.jsxs("div",{className:"bg-green-50 rounded-xl p-3 mb-3 border-2 border-green-200",children:[e.jsx("p",{className:"text-xs font-bold text-green-800 mb-1",children:"Prix propos par le client (sera appliqu au devis si vous acceptez)"}),e.jsxs("p",{className:"text-lg font-black text-green-900",children:[Number(_.suggested_price).toLocaleString("fr-FR")," FCFA"]}),(D==null?void 0:D.amount)!=null&&e.jsxs("p",{className:"text-xs text-green-700 mt-1",children:["Devis actuel : ",Number(D.amount).toLocaleString("fr-FR")," FCFA"]})]}),e.jsxs("div",{className:"bg-gray-50 rounded-xl p-3 mb-3",children:[e.jsx("p",{className:"text-xs font-bold text-gray-700 mb-1",children:"Commentaires du client :"}),e.jsx("p",{className:"text-sm text-gray-600 leading-relaxed",children:_.client_comments})]}),_.audio_url&&e.jsxs("div",{className:"bg-brand-50 rounded-xl p-3 mb-3 border border-brand-200 flex items-center gap-3",children:[e.jsx("button",{onClick:()=>new Audio(_.audio_url).play(),className:"w-10 h-10 bg-brand-500 text-white rounded-full flex items-center justify-center flex-shrink-0",children:e.jsx(Nl,{fill:"currentColor",size:14})}),e.jsxs("div",{className:"flex-1",children:[e.jsx("p",{className:"text-xs font-bold text-brand-800",children:"Message vocal"}),e.jsx("p",{className:"text-xs text-brand-600",children:"Cliquez pour couter"})]})]}),_.document_url&&e.jsx("div",{className:"bg-purple-50 rounded-xl p-3 mb-3 border border-purple-200",children:e.jsxs("a",{href:_.document_url,target:"_blank",rel:"noopener noreferrer",className:"flex items-center gap-3 text-purple-700 hover:text-purple-900",children:[e.jsx(et,{size:18}),e.jsxs("div",{className:"flex-1",children:[e.jsx("p",{className:"text-xs font-bold",children:"Document joint"}),e.jsx("p",{className:"text-xs",children:"Cliquez pour tlcharger"})]}),e.jsx(mn,{size:16})]})}),_.artisan_response&&e.jsx("div",{className:"bg-green-50 rounded-xl p-3 mb-3 border border-green-200",children:e.jsxs("div",{className:"flex items-start gap-2",children:[e.jsx(es,{size:16,className:"text-green-600 flex-shrink-0 mt-0.5"}),e.jsxs("div",{className:"flex-1",children:[e.jsx("p",{className:"text-xs font-bold text-green-800 mb-1",children:"Votre rponse :"}),e.jsx("p",{className:"text-sm text-green-900",children:_.artisan_response}),_.responded_at&&e.jsx("p",{className:"text-xs text-green-700 mt-1",children:new Date(_.responded_at).toLocaleDateString("fr-FR")})]})]})}),_.status==="pending"&&e.jsxs("button",{onClick:()=>setSelectedRevisionId(_.id),className:"w-full bg-brand-500 text-white font-bold py-3 rounded-xl hover:bg-brand-600 transition-colors flex items-center justify-center gap-2",children:[e.jsx(es,{size:16}),"Rpondre  la rvision"]}),_.status!=="pending"&&e.jsxs("button",{onClick:()=>i(`/projects/${_.project_id}`),className:"w-full bg-gray-100 text-gray-700 font-bold py-3 rounded-xl hover:bg-gray-200 transition-colors flex items-center justify-center gap-2",children:[e.jsx(et,{size:16}),"Voir le projet"]})]})},_.id)})})]})]})}function ly(){const{projectId:i}=Ya(),u=ht(),[f]=_l(),o=f.get("quoteId"),x=Nt(),{success:y,error:N}=sa(),[h,g]=c.useState(null),[E,d]=c.useState(null),[v,b]=c.useState(!0),[w,_]=c.useState(""),[L,M]=c.useState(""),[D,U]=c.useState(""),[J,F]=c.useState(!1);c.useEffect(()=>{if(!x.user||!i||!o){(!i||!o)&&(N("Lien invalide : projet ou devis manquant"),u("/dashboard")),b(!1);return}(async()=>{var X;b(!0);try{const{data:R,error:ae}=await j.from("projects").select("id, client_id, title").eq("id",i).single();if(ae||!R){N("Projet introuvable"),u("/dashboard");return}if(R.client_id!==((X=x.user)==null?void 0:X.id)){N("Vous n'tes pas le client de ce projet"),u(`/projects/${i}`);return}const{data:ge,error:k}=await j.from("quotes").select("id, amount, project_id").eq("id",o).single();if(k||!ge||ge.project_id!==i){N("Devis introuvable ou n'appartient pas  ce projet"),u(`/projects/${i}`);return}g(R),d(ge)}catch(R){N(R.message||"Erreur de chargement"),u("/dashboard")}finally{b(!1)}})()},[x.user,i,o]);const G=async Z=>{if(Z.preventDefault(),!(!x.user||!i||!o||!h||!E)){F(!0);try{const X=L.trim()?Math.max(0,Number(L)):null,R=D.trim()?Math.max(0,Number(D)):null,ae={quote_id:o,project_id:i,requested_by:x.user.id,client_comments:w.trim()||null,status:"pending"};X!=null&&!Number.isNaN(X)&&(ae.suggested_price=X),R!=null&&!Number.isNaN(R)&&(ae.additional_fees=R);const{data:ge,error:k}=await j.from("quote_revisions").insert(ae).select("id, quote_id, project_id, requested_by, status, created_at").single();if(k)throw console.error("[RequestRevisionPage] Insert quote_revisions:",k.code,k.message,k.details),k;const{data:q}=await j.from("quotes").select("artisan_id").eq("id",o).single(),{data:T}=await j.from("profiles").select("full_name").eq("id",x.user.id).single();if(q!=null&&q.artisan_id&&ge)try{const{notifyArtisanRevisionRequested:C}=await Ji(async()=>{const{notifyArtisanRevisionRequested:B}=await Promise.resolve().then(()=>bf);return{notifyArtisanRevisionRequested:B}},void 0,import.meta.url);await C(i,o,q.artisan_id,(T==null?void 0:T.full_name)||"Un client",ge.id)}catch(C){console.error("[RequestRevisionPage] Notification:",C)}y("Demande de rvision envoye avec succs"),u(`/projects/${i}`)}catch(X){console.error("[RequestRevisionPage] Error requesting revision:",X);const R=(X==null?void 0:X.message)||(X==null?void 0:X.error_description)||"Impossible de crer la demande de rvision";N(R)}finally{F(!1)}}};return v?e.jsx(Yt,{}):!h||!E?null:e.jsxs("div",{className:"min-h-screen bg-gradient-to-br from-gray-50 via-white to-gray-50",children:[e.jsx("header",{className:"bg-white sticky top-0 z-30 shadow-sm border-b border-gray-100",children:e.jsxs("div",{className:"max-w-lg mx-auto px-5 py-4 flex items-center gap-4",children:[e.jsx("button",{onClick:()=>u(`/projects/${i}`),className:"w-10 h-10 flex items-center justify-center rounded-xl hover:bg-gray-100 transition-colors",children:e.jsx(Wt,{size:20,className:"text-gray-600"})}),e.jsxs("div",{className:"flex-1",children:[e.jsx("h1",{className:"text-lg font-black text-gray-900",children:"Demander une rvision"}),e.jsx("p",{className:"text-xs text-gray-500",children:"Expliquez ce que vous souhaitez modifier"})]}),e.jsx(Da,{})]})}),e.jsx("main",{className:"max-w-lg mx-auto px-5 py-6",children:e.jsxs("form",{onSubmit:G,className:"space-y-4",children:[e.jsx("div",{className:"bg-blue-50 rounded-xl p-4 border border-blue-200",children:e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx(qa,{size:16,className:"text-blue-600 flex-shrink-0 mt-0.5"}),e.jsxs("div",{className:"flex-1",children:[e.jsx("p",{className:"text-xs font-bold text-blue-800 mb-1",children:"Devis actuel"}),e.jsxs("p",{className:"text-lg font-black text-blue-900",children:[(E.amount||0).toLocaleString("fr-FR")," FCFA"]}),e.jsx("p",{className:"text-xs text-blue-700 mt-2",children:"L'artisan recevra votre demande et pourra accepter, refuser ou modifier le devis."})]})]})}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-bold text-gray-700 mb-2",children:["Prix suggr ",e.jsx("span",{className:"text-gray-400 font-normal",children:"(optionnel)"})]}),e.jsxs("div",{className:"relative",children:[e.jsx("input",{type:"number",min:0,step:100,value:L,onChange:Z=>M(Z.target.value),placeholder:"Ex. 150000",className:"w-full px-4 py-3 pr-16 border border-gray-200 rounded-xl focus:ring-2 focus:ring-brand-500 focus:border-transparent text-sm",disabled:J}),e.jsx("span",{className:"absolute right-4 top-1/2 -translate-y-1/2 text-xs text-gray-500 font-medium",children:"FCFA"})]}),e.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Montant que vous proposez  l'artisan"})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-bold text-gray-700 mb-2",children:["Frais additionnels ",e.jsx("span",{className:"text-gray-400 font-normal",children:"(optionnel)"})]}),e.jsxs("div",{className:"relative",children:[e.jsx("input",{type:"number",min:0,step:100,value:D,onChange:Z=>U(Z.target.value),placeholder:"Ex. 5000",className:"w-full px-4 py-3 pr-16 border border-gray-200 rounded-xl focus:ring-2 focus:ring-brand-500 focus:border-transparent text-sm",disabled:J}),e.jsx("span",{className:"absolute right-4 top-1/2 -translate-y-1/2 text-xs text-gray-500 font-medium",children:"FCFA"})]}),e.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Frais ventuels (dplacement, matriel, etc.)"})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-bold text-gray-700 mb-2",children:["Commentaire ",e.jsx("span",{className:"text-gray-400 font-normal",children:"(optionnel)"})]}),e.jsx("textarea",{value:w,onChange:Z=>_(Z.target.value),placeholder:"Expliquez ce que vous souhaitez modifier (prix, matriaux, dlais...)",rows:4,className:"w-full px-4 py-3 border border-gray-200 rounded-xl focus:ring-2 focus:ring-brand-500 focus:border-transparent resize-none text-sm",disabled:J,maxLength:500}),e.jsxs("p",{className:"text-xs text-gray-500 mt-1",children:[w.length," / 500"]})]}),e.jsxs("div",{className:"flex gap-3 pt-2",children:[e.jsx("button",{type:"button",onClick:()=>u(`/projects/${i}`),disabled:J,className:"flex-1 px-4 py-3 bg-gray-100 text-gray-700 font-bold rounded-xl hover:bg-gray-200 transition-colors disabled:opacity-50",children:"Annuler"}),e.jsx("button",{type:"submit",disabled:J,className:"flex-1 px-4 py-3 bg-brand-500 text-white font-bold rounded-xl hover:bg-brand-600 transition-colors disabled:opacity-50 disabled:cursor-not-allowed flex items-center justify-center gap-2",children:J?e.jsx("span",{className:"inline-flex items-center justify-center w-5 h-5 border-2 border-white border-t-transparent rounded-full animate-spin","aria-hidden":!0}):e.jsxs("span",{className:"inline-flex items-center justify-center gap-2",children:[e.jsx(al,{size:16,"aria-hidden":!0}),e.jsx("span",{children:"Envoyer la demande"})]})})]})]})})]})}function ry(){const{revisionId:i}=Ya(),u=ht(),f=Nt(),{profile:o}=It(),{success:x,error:y}=sa(),{updateEscrowForNewAmount:N,initiateEscrow:h}=bn(),[g,E]=c.useState(null),[d,v]=c.useState(null),[b,w]=c.useState(null),[_,L]=c.useState(!0),[M,D]=c.useState(null),[U,J]=c.useState(""),[F,G]=c.useState(!1),[Z,X]=c.useState(!1);c.useEffect(()=>{if(!f.user||!o||o.role!=="artisan"||!i){i?!f.loading&&f.user&&o&&o.role!=="artisan"&&u("/dashboard"):(y("Rvision introuvable"),u("/revisions")),L(!1);return}(async()=>{var T;L(!0);try{const{data:C,error:B}=await j.from("quote_revisions").select(`
            *,
            quotes!quote_revisions_quote_id_fkey(id, amount, quote_number, status, artisan_id),
            projects!quote_revisions_project_id_fkey(id, title, project_number, client_id)
          `).eq("id",i).single();if(B||!C){y("Rvision introuvable"),u("/revisions");return}const z=C.quotes,S=C.projects;if(!z||!S){y("Donnes incompltes"),u("/revisions");return}if(z.artisan_id!==((T=f.user)==null?void 0:T.id)){y("Vous n'tes pas l'artisan concern par cette rvision"),u("/revisions");return}if(C.status!=="pending"){x("Cette rvision a dj t traite."),u("/revisions");return}E(C),v(z),w(S)}catch(C){y(C.message||"Erreur de chargement"),u("/revisions")}finally{L(!1)}})()},[f.user,f.loading,o,i]);const R=async(q,T)=>{if(!(!(b!=null&&b.client_id)||!g||!d)){try{const{notifyClientRevisionResponded:C}=await Ji(async()=>{const{notifyClientRevisionResponded:z}=await Promise.resolve().then(()=>bf);return{notifyClientRevisionResponded:z}},void 0,import.meta.url),{data:B}=await j.from("profiles").select("full_name").eq("id",d.artisan_id).single();await C(b.id,d.id,b.client_id,(B==null?void 0:B.full_name)||"L'artisan",q,g.id)}catch(C){console.error("[RevisionResponsePage] Notification:",C)}u(T??"/revisions")}},ae=async()=>{if(!(!g||!d)){G(!0);try{const{error:q}=await j.from("quote_revisions").update({status:"accepted",artisan_response:U.trim()||null,responded_at:new Date().toISOString()}).eq("id",g.id);if(q)throw q;const T=g.suggested_price!=null&&Number(g.suggested_price)>0?Number(g.suggested_price):null,C=g.additional_fees!=null&&Number(g.additional_fees)>0?Number(g.additional_fees):0,B=T!=null?T+C:null,z=B??Math.max(0,Number(d.amount??0)),S=B!=null?{amount:B,status:"accepted"}:{status:"accepted"},{error:V}=await j.from("quotes").update(S).eq("id",d.id);if(V){console.error("Erreur mise  jour devis aprs acceptation rvision:",V),y("Rvision enregistre mais erreur sur le devis."),G(!1);return}const{data:le}=await j.from("quotes").select("id").eq("project_id",b.id).neq("id",d.id).in("status",["pending","viewed"]);le!=null&&le.length&&await j.from("quotes").update({status:"rejected"}).in("id",le.map(Ne=>Ne.id));const{data:he}=await j.from("escrows").select("id, status").eq("project_id",b.id).maybeSingle();if(he&&(he.status==="pending"||he.status==="held"))try{await N(he.id,z)}catch(Ne){console.error("Erreur mise  jour escrow aprs rvision accepte:",Ne)}else if(!he&&z>0){const{data:Ne}=await j.from("artisans").select("is_verified").eq("id",d.artisan_id).maybeSingle();try{await h({project_id:b.id,total_amount:z,artisan_is_verified:!!(Ne!=null&&Ne.is_verified)})}catch(fe){console.error("Erreur cration escrow aprs rvision accepte:",fe)}}x(B!=null?"Rvision accepte. Le montant affich sur le projet est dsormais celui convenu.":"Rvision accepte. Accord conclu; vous pouvez procder au paiement."),await R("accepted",`/projects/${b.id}`)}catch(q){y(q.message||"Erreur")}finally{G(!1)}}},ge=async()=>{if(g){G(!0);try{const{error:q}=await j.from("quote_revisions").update({status:"rejected",artisan_response:U.trim()||null,responded_at:new Date().toISOString()}).eq("id",g.id);if(q)throw q;x("Rvision refuse. Le client sera notifi."),await R("rejected")}catch(q){y(q.message||"Erreur")}finally{G(!1)}}},k=async()=>{if(!(!g||!b||!d)){G(!0);try{const{data:q}=await j.from("quotes").select("id, amount").eq("project_id",b.id).eq("artisan_id",d.artisan_id).order("created_at",{ascending:!1}).limit(1),T=q==null?void 0:q[0];if(!(T!=null&&T.id)){y("Impossible de rcuprer le nouveau devis");return}const{error:C}=await j.from("quote_revisions").update({status:"modified",modified_quote_id:T.id,artisan_response:U.trim()||null,responded_at:new Date().toISOString()}).eq("id",g.id);if(C)throw C;const B=Number(T.amount)||0;if(B<=0){x("Nouveau devis cr. Le client sera notifi."),await R("modified");return}d.status==="accepted"&&await j.from("quotes").update({status:"viewed"}).eq("id",d.id),await j.from("quotes").update({status:"accepted"}).eq("id",T.id);const{data:S}=await j.from("escrows").select("id, status").eq("project_id",b.id).maybeSingle();if(S&&(S.status==="pending"||S.status==="held"))try{await N(S.id,B)}catch(V){console.error("Erreur mise  jour escrow aprs devis modifi:",V),y("Devis modifi mais erreur sur l'escrow. Contacter le support.")}else{const{data:V}=await j.from("artisans").select("is_verified").eq("id",d.artisan_id).maybeSingle();try{await h({project_id:b.id,total_amount:B,artisan_is_verified:!!(V!=null&&V.is_verified)}),await j.from("projects").update({status:"quote_accepted"}).eq("id",b.id)}catch(le){console.error("Erreur cration escrow aprs devis modifi:",le),y("Devis modifi mais erreur cration escrow. Le client devra accepter le devis sur le projet.")}}x("Nouveau devis cr. C'est ce devis qui fera l'objet du paiement."),await R("modified")}catch(q){y((q==null?void 0:q.message)||"Erreur")}finally{G(!1)}}};return _?e.jsx(Yt,{}):!g||!d||!b?null:Z?e.jsxs("div",{className:"min-h-screen bg-gradient-to-br from-gray-50 via-white to-gray-50",children:[e.jsx("header",{className:"bg-white sticky top-0 z-30 shadow-sm border-b border-gray-100",children:e.jsxs("div",{className:"max-w-lg mx-auto px-5 py-4 flex items-center gap-4",children:[e.jsx("button",{onClick:()=>X(!1),className:"w-10 h-10 flex items-center justify-center rounded-xl hover:bg-gray-100 transition-colors",children:e.jsx(Ze,{size:20,className:"text-gray-600"})}),e.jsxs("div",{className:"flex-1",children:[e.jsx("h1",{className:"text-lg font-black text-gray-900",children:"Modifier le devis"}),e.jsx("p",{className:"text-xs text-gray-500",children:"Crez un nouveau devis pour le client"})]}),e.jsx(Da,{})]})}),e.jsx("main",{className:"max-w-lg mx-auto px-5 py-6",children:e.jsx(yf,{projectId:b.id,artisanId:d.artisan_id,onSuccess:k,onCancel:()=>X(!1)})})]}):e.jsxs("div",{className:"min-h-screen bg-gradient-to-br from-gray-50 via-white to-gray-50",children:[e.jsx("header",{className:"bg-white sticky top-0 z-30 shadow-sm border-b border-gray-100",children:e.jsxs("div",{className:"max-w-lg mx-auto px-5 py-4 flex items-center gap-4",children:[e.jsx("button",{onClick:()=>u("/revisions"),className:"w-10 h-10 flex items-center justify-center rounded-xl hover:bg-gray-100 transition-colors",children:e.jsx(Wt,{size:20,className:"text-gray-600"})}),e.jsxs("div",{className:"flex-1",children:[e.jsx("h1",{className:"text-lg font-black text-gray-900",children:"Rpondre  la rvision"}),e.jsx("p",{className:"text-xs text-gray-500",children:"Choisissez votre action"})]}),e.jsx(Da,{})]})}),e.jsxs("main",{className:"max-w-lg mx-auto px-5 py-6 space-y-4",children:[e.jsxs("div",{className:"bg-blue-50 rounded-xl p-4 border border-blue-200",children:[e.jsx("p",{className:"text-xs font-bold text-blue-800 mb-2",children:"Demande du client :"}),e.jsx("p",{className:"text-sm text-blue-900",children:g.client_comments}),g.suggested_price!=null&&Number(g.suggested_price)>0&&e.jsxs("div",{className:"mt-3 p-3 bg-green-50 rounded-lg border-2 border-green-200",children:[e.jsx("p",{className:"text-xs font-bold text-green-800 mb-1",children:"Prix propos par le client (sera appliqu si vous acceptez)"}),e.jsxs("p",{className:"text-xl font-black text-green-900",children:[Number(g.suggested_price).toLocaleString("fr-FR")," FCFA"]}),e.jsxs("p",{className:"text-xs text-green-700 mt-1",children:["Devis actuel : ",(d.amount||0).toLocaleString("fr-FR")," FCFA"]})]}),(!g.suggested_price||Number(g.suggested_price)<=0)&&e.jsx("div",{className:"mt-3 pt-3 border-t border-blue-200",children:e.jsxs("p",{className:"text-xs text-blue-700",children:[e.jsx("span",{className:"font-bold",children:"Devis actuel :"})," ",(d.amount||0).toLocaleString("fr-FR")," FCFA"]})})]}),!M&&e.jsxs("div",{className:"space-y-2",children:[e.jsxs("button",{onClick:()=>D("accept"),className:"w-full bg-green-50 text-green-700 font-bold py-3 rounded-xl border-2 border-green-200 flex items-center justify-center gap-2 hover:bg-green-100 transition-colors",children:[e.jsx(Qe,{size:18}),"Accepter la rvision"]}),e.jsxs("button",{onClick:()=>D("reject"),className:"w-full bg-red-50 text-red-700 font-bold py-3 rounded-xl border-2 border-red-200 flex items-center justify-center gap-2 hover:bg-red-100 transition-colors",children:[e.jsx(el,{size:18}),"Refuser la rvision"]}),e.jsxs("button",{onClick:()=>D("modify"),className:"w-full bg-brand-50 text-brand-700 font-bold py-3 rounded-xl border-2 border-brand-200 flex items-center justify-center gap-2 hover:bg-brand-100 transition-colors",children:[e.jsx(et,{size:18}),"Modifier le devis"]})]}),M&&M!=="modify"&&e.jsxs("div",{className:"space-y-4",children:[M==="accept"&&g.suggested_price!=null&&Number(g.suggested_price)>0&&e.jsxs("p",{className:"text-sm text-green-700 bg-green-50 rounded-xl px-3 py-2 border border-green-200",children:["En confirmant, le montant du devis sera mis  jour  ",e.jsxs("strong",{children:[Number(g.suggested_price).toLocaleString("fr-FR")," FCFA"]})," pour ce projet."]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-bold text-gray-700 mb-2",children:[M==="accept"?"Votre rponse":"Raison du refus"," ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx("textarea",{value:U,onChange:q=>J(q.target.value),placeholder:M==="accept"?"Expliquez comment vous allez procder...":"Expliquez pourquoi vous refusez cette rvision...",rows:4,className:"w-full px-4 py-3 border border-gray-200 rounded-xl focus:ring-2 focus:ring-brand-500 focus:border-transparent resize-none text-sm",disabled:F,required:!0})]}),e.jsxs("div",{className:"flex gap-3",children:[e.jsx("button",{type:"button",onClick:()=>{D(null),J("")},disabled:F,className:"flex-1 px-4 py-3 bg-gray-100 text-gray-700 font-bold rounded-xl hover:bg-gray-200 transition-colors disabled:opacity-50",children:"Annuler"}),e.jsx("button",{onClick:M==="accept"?ae:ge,disabled:F||!U.trim(),className:`flex-1 px-4 py-3 font-bold rounded-xl transition-colors disabled:opacity-50 disabled:cursor-not-allowed flex items-center justify-center gap-2 ${M==="accept"?"bg-green-500 text-white hover:bg-green-600":"bg-red-500 text-white hover:bg-red-600"}`,children:e.jsx("span",{className:"inline-flex items-center justify-center gap-2",children:F?e.jsx("span",{className:"w-5 h-5 border-2 border-current border-t-transparent rounded-full animate-spin","aria-hidden":!0}):e.jsxs(e.Fragment,{children:[M==="accept"?e.jsx(Qe,{size:16}):e.jsx(el,{size:16}),"Confirmer"]})})})]})]}),M==="modify"&&e.jsx("div",{className:"space-y-4",children:e.jsxs("div",{className:"bg-brand-50 rounded-xl p-4 border border-brand-200",children:[e.jsx("p",{className:"text-sm text-brand-900 mb-3",children:"Vous allez crer un nouveau devis modifi. Le client pourra ensuite accepter ou refuser ce nouveau devis."}),e.jsxs("div",{className:"flex gap-3",children:[e.jsx("button",{type:"button",onClick:()=>{D(null),J("")},className:"flex-1 px-4 py-2 bg-gray-100 text-gray-700 font-bold rounded-xl hover:bg-gray-200 transition-colors text-sm",children:"Annuler"}),e.jsxs("button",{onClick:()=>X(!0),className:"flex-1 px-4 py-2 bg-brand-500 text-white font-bold rounded-xl hover:bg-brand-600 transition-colors text-sm flex items-center justify-center gap-2",children:[e.jsx(et,{size:16}),"Crer le nouveau devis"]})]})]})})]})]})}function ny(i){if(!i)return"";if(i.type==="image")return"Photo";if(i.type==="video")return"Vido";if(i.type==="audio")return"Message vocal";const u=(i.content||"").trim();return u.length>45?u.slice(0,45)+"":u}function cn(i){return(i||"").toLowerCase().normalize("NFD").replace(new RegExp("\\p{Diacritic}","gu"),"")}function iy(){const i=ht(),u=Nt(),{profile:f}=It(),{notifications:o}=yn(),[x,y]=c.useState([]),[N,h]=c.useState(!0),[g,E]=c.useState("");c.useEffect(()=>{if(!u.user||!f)return;(async()=>{h(!0);try{let b=[];if(f.role==="client"){const{data:D,error:U}=await j.from("projects").select("id, title, status, client_id, target_artisan_id, updated_at, categories(name)").eq("client_id",u.user.id).not("status","in",'("cancelled","expired")').order("updated_at",{ascending:!1});if(U)throw U;b=D||[]}else{const{data:D,error:U}=await j.from("quotes").select(`
              project_id,
              projects (id, title, status, client_id, target_artisan_id, updated_at, categories(name))
            `).eq("artisan_id",u.user.id).in("status",["pending","viewed","accepted"]);if(U)throw U;const J=new Map;D==null||D.forEach(F=>{const G=F.projects;G&&G.id&&!["cancelled","expired"].includes(G.status)&&J.set(G.id,G)}),b=Array.from(J.values())}if(b.length===0){y([]),h(!1);return}const w=b.map(D=>D.id),{data:_}=await j.from("messages").select("project_id, created_at, content, type").in("project_id",w).order("created_at",{ascending:!1}),L=new Map;_==null||_.forEach(D=>{L.has(D.project_id)||L.set(D.project_id,{created_at:D.created_at,content:D.content,type:D.type||"text"})});const M=await Promise.all(b.map(async D=>{let U=null;if(f.role==="client"){const{data:X}=await j.from("quotes").select("artisan_id").eq("project_id",D.id).eq("status","accepted").maybeSingle();if(U=(X==null?void 0:X.artisan_id)??null,!U){const{data:R}=await j.from("quotes").select("artisan_id").eq("project_id",D.id).in("status",["pending","viewed"]).order("created_at",{ascending:!1}).limit(1),ae=R==null?void 0:R[0];U=(ae==null?void 0:ae.artisan_id)??null}!U&&D.target_artisan_id&&(U=D.target_artisan_id)}else U=D.client_id;const J=L.get(D.id),F=(J==null?void 0:J.created_at)||D.updated_at,G=ny(J);let Z=null;if(U){const{data:X}=await j.from("profiles").select("id, full_name, avatar_url").eq("id",U).single();Z=X}return{project:D,participant:Z,lastMessageAt:F,lastMessagePreviewText:G}}));M.sort((D,U)=>new Date(U.lastMessageAt).getTime()-new Date(D.lastMessageAt).getTime()),y(M)}catch(b){console.error("Error fetching conversations:",b)}finally{h(!1)}})()},[u.user,f]);const d=c.useMemo(()=>{const v=cn(g).trim();return v?x.filter(b=>{var D,U,J,F;const w=cn(((D=b.participant)==null?void 0:D.full_name)||""),_=cn(((U=b.project)==null?void 0:U.title)||""),L=cn(b.lastMessagePreviewText||""),M=cn(((F=(J=b.project)==null?void 0:J.categories)==null?void 0:F.name)||"");return w.includes(v)||_.includes(v)||L.includes(v)||M.includes(v)}):x},[x,g]);return N?e.jsx(Yt,{}):e.jsxs("div",{className:"min-h-screen bg-gray-50",children:[e.jsx("header",{className:"bg-white/80 backdrop-blur-lg sticky top-0 z-30 shadow-sm border-b border-gray-100/50",children:e.jsx("div",{className:"max-w-lg mx-auto px-5 py-4",children:e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("button",{onClick:()=>i("/dashboard"),className:"w-10 h-10 rounded-xl bg-gray-100 flex items-center justify-center text-gray-600 hover:bg-gray-200 transition-colors",children:e.jsx(Wt,{size:20})}),e.jsx("h1",{className:"text-xl font-black text-gray-900",children:"Messages"})]})})}),e.jsxs("main",{className:"max-w-lg mx-auto px-5 py-6",children:[x.length>0&&e.jsx("div",{className:"mb-4",children:e.jsxs("div",{className:"relative",children:[e.jsx(xa,{className:"absolute left-4 top-1/2 -translate-y-1/2 w-5 h-5 text-gray-400"}),e.jsx("input",{type:"text",value:g,onChange:v=>E(v.target.value),placeholder:"Rechercher une discussion (nom, projet, message)",className:"w-full pl-12 pr-4 py-3 bg-white border border-gray-100 rounded-xl text-sm text-gray-900 placeholder:text-gray-400 focus:outline-none focus:ring-2 focus:ring-brand-200 focus:border-transparent","aria-label":"Rechercher dans les discussions"})]})}),x.length===0?e.jsxs("div",{className:"bg-white rounded-2xl p-12 text-center border border-gray-100",children:[e.jsx("div",{className:"w-16 h-16 bg-gray-100 rounded-2xl flex items-center justify-center mx-auto mb-4",children:e.jsx(fr,{size:28,className:"text-gray-300"})}),e.jsx("p",{className:"text-gray-500 font-medium",children:"Aucun projet en cours"}),e.jsx("p",{className:"text-sm text-gray-400 mt-1",children:"Les discussions de vos projets actifs apparatront ici"})]}):d.length===0?e.jsxs("div",{className:"bg-white rounded-2xl p-12 text-center border border-gray-100",children:[e.jsx(xa,{size:32,className:"mx-auto text-gray-200 mb-4"}),e.jsx("p",{className:"text-gray-500 font-medium",children:"Aucune discussion trouve"}),e.jsx("p",{className:"text-sm text-gray-400 mt-1",children:"Essayez avec un autre mot-cl (nom, titre du projet, message)"})]}):e.jsx("div",{className:"space-y-3",children:d.map((v,b)=>{var _,L;const w=o.some(M=>{var D;return!M.is_read&&M.type==="new_message"&&((D=M.data)==null?void 0:D.project_id)===v.project.id});return e.jsx("button",{onClick:()=>i(`/chat/${v.project.id}`),className:`w-full bg-white rounded-2xl p-4 border text-left shadow-[0_2px_8px_rgba(0,0,0,0.06)] hover:shadow-[0_4px_12px_rgba(0,0,0,0.08)] hover:border-brand-100 transition-all duration-200 active:scale-[0.99] animate-in fade-in slide-in-from-bottom-2 duration-300 ${w?"border-brand-200 bg-brand-50/40":"border-gray-100"}`,style:{animationDelay:`${b*40}ms`,animationFillMode:"both"},children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsxs("div",{className:"relative w-12 h-12 rounded-xl bg-brand-100 flex items-center justify-center flex-shrink-0",children:[(_=v.participant)!=null&&_.avatar_url?e.jsx("img",{src:v.participant.avatar_url,alt:v.participant.full_name||"User",className:"w-full h-full rounded-xl object-cover"}):e.jsx(fr,{size:20,className:"text-brand-600"}),w&&e.jsx("span",{className:"absolute -top-0.5 -right-0.5 w-3 h-3 bg-brand-500 rounded-full border-2 border-white"})]}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsxs("div",{className:"flex items-center justify-between mb-1",children:[e.jsx("p",{className:"font-bold truncate text-gray-900",children:((L=v.participant)==null?void 0:L.full_name)||"Utilisateur"}),e.jsxs("span",{className:"text-xs text-gray-400 flex items-center gap-1 flex-shrink-0 ml-2",children:[e.jsx(St,{size:12}),new Date(v.lastMessageAt).toLocaleDateString("fr-FR",{day:"numeric",month:"short"})]})]}),e.jsx("p",{className:"text-sm text-gray-600 truncate",children:v.lastMessagePreviewText||v.project.title||"Projet sans titre"}),v.project.categories&&e.jsx("span",{className:"inline-block mt-1 px-3 py-1 bg-brand-50 text-brand-700 text-xs font-bold rounded-full border border-brand-100",children:v.project.categories.name})]})]})},v.project.id)})})]})]})}const G0={new_project:{icon:e.jsx(Ht,{size:20}),color:"text-blue-600",bg:"bg-blue-100"},new_quote:{icon:e.jsx(et,{size:20}),color:"text-purple-600",bg:"bg-purple-100"},quote_accepted:{icon:e.jsx(aa,{size:20}),color:"text-green-600",bg:"bg-green-100"},quote_rejected:{icon:e.jsx(Ze,{size:20}),color:"text-red-600",bg:"bg-red-100"},project_completed:{icon:e.jsx(aa,{size:20}),color:"text-green-600",bg:"bg-green-100"},payment_received:{icon:e.jsx(Na,{size:20}),color:"text-green-600",bg:"bg-green-100"},verification_approved:{icon:e.jsx(Gt,{size:20}),color:"text-blue-600",bg:"bg-blue-100"},verification_rejected:{icon:e.jsx(Gt,{size:20}),color:"text-red-600",bg:"bg-red-100"},new_message:{icon:e.jsx(fr,{size:20}),color:"text-brand-600",bg:"bg-brand-100"},quote_revision_requested:{icon:e.jsx(zt,{size:20}),color:"text-yellow-600",bg:"bg-yellow-100"},quote_revision_responded:{icon:e.jsx(et,{size:20}),color:"text-blue-600",bg:"bg-blue-100"},system:{icon:e.jsx(ur,{size:20}),color:"text-gray-600",bg:"bg-gray-100"}};function oy(i){const u=new Date(i),o=new Date().getTime()-u.getTime(),x=Math.floor(o/(1e3*60)),y=Math.floor(o/(1e3*60*60)),N=Math.floor(o/(1e3*60*60*24));return x<1?" l'instant":x<60?`Il y a ${x} min`:y<24?`Il y a ${y}h`:N<7?`Il y a ${N}j`:u.toLocaleDateString("fr-FR",{day:"numeric",month:"short"})}function cy(i){const{type:u,data:f}=i;return u==="new_message"&&(f!=null&&f.project_id)?`/chat/${f.project_id}`:u==="new_quote"&&(f!=null&&f.project_id)?f!=null&&f.chat_enabled?`/chat/${f.project_id}`:`/projects/${f.project_id}#devis`:u==="quote_revision_requested"&&(f!=null&&f.project_id)&&(f!=null&&f.revision_id)?`/projects/${f.project_id}?revision=${f.revision_id}`:u==="quote_revision_requested"?"/revisions":u==="project_completed"&&(f!=null&&f.project_id)?`/projects/${f.project_id}#suivi`:f!=null&&f.project_id&&["new_project","quote_accepted","quote_rejected","quote_revision_responded","system","dispute_raised"].includes(u)?u==="system"&&(f==null?void 0:f.kind)==="quote_revision_requested"&&(f!=null&&f.revision_id)?`/projects/${f.project_id}?revision=${f.revision_id}`:`/projects/${f.project_id}#devis`:(["payment_received","verification_approved","verification_rejected"].includes(u),"/dashboard")}function dy(){const i=ht(),{notifications:u,unreadCount:f,markAsRead:o,markAllAsRead:x,deleteNotification:y,loading:N}=yn(),h=g=>{o(g.id),window.scrollTo({top:0,left:0,behavior:"instant"}),i(cy(g))};return N?e.jsx(Yt,{}):e.jsxs("div",{className:"min-h-screen bg-gray-50",children:[e.jsx("header",{className:"bg-white/80 backdrop-blur-lg sticky top-0 z-30 shadow-sm border-b border-gray-100/50",children:e.jsx("div",{className:"max-w-lg mx-auto px-5 py-4",children:e.jsxs("div",{className:"flex items-center justify-between gap-4",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("button",{onClick:()=>i("/dashboard"),className:"w-10 h-10 rounded-xl bg-gray-100 flex items-center justify-center text-gray-600 hover:bg-gray-200 transition-colors","aria-label":"Retour",children:e.jsx(Wt,{size:20})}),e.jsx("h1",{className:"text-xl font-black text-gray-900",children:"Notifications"})]}),f>0&&e.jsxs("button",{onClick:()=>x(),className:"text-sm text-brand-600 font-bold hover:underline flex items-center gap-1",children:[e.jsx(bd,{size:16}),"Tout lire"]})]})})}),e.jsx("main",{className:"max-w-lg mx-auto px-5 py-6",children:u.length===0?e.jsxs("div",{className:"bg-white rounded-2xl p-12 text-center border border-gray-100",children:[e.jsx(ur,{size:48,className:"mx-auto text-gray-200 mb-4"}),e.jsx("p",{className:"text-gray-500 font-medium",children:"Aucune notification"}),e.jsx("p",{className:"text-sm text-gray-400 mt-1",children:"Vos alertes apparatront ici"})]}):e.jsx("div",{className:"space-y-2",children:u.map(g=>{const E=G0[g.type]||G0.system;return e.jsx("div",{className:`bg-white rounded-2xl border overflow-hidden transition-colors ${g.is_read?"border-gray-100":"border-brand-200 bg-brand-50/30"}`,children:e.jsxs("div",{className:"flex items-start gap-3 p-4 cursor-pointer hover:bg-gray-50/50 transition-colors",onClick:()=>h(g),children:[e.jsx("div",{className:`w-12 h-12 rounded-xl flex items-center justify-center flex-shrink-0 ${E.bg} ${E.color}`,children:E.icon}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsxs("div",{className:"flex items-start justify-between gap-2",children:[e.jsx("p",{className:`font-bold text-gray-900 ${g.is_read?"text-gray-700":""}`,children:g.title}),!g.is_read&&e.jsx("span",{className:"w-2.5 h-2.5 bg-brand-500 rounded-full flex-shrink-0 mt-1.5"})]}),g.message&&e.jsx("p",{className:"text-sm text-gray-500 mt-0.5 truncate max-w-full",children:g.message}),e.jsx("p",{className:"text-xs text-gray-400 mt-2 font-medium",children:oy(g.created_at)})]}),e.jsx("button",{onClick:d=>{d.stopPropagation(),y(g.id)},className:"p-2 text-gray-300 hover:text-red-500 hover:bg-red-50 rounded-xl transition-colors","aria-label":"Supprimer",children:e.jsx(gr,{size:18})})]})},g.id)})})})]})}function uy(){const i=ht();return e.jsx("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center p-6",children:e.jsxs("div",{className:"text-center max-w-md",children:[e.jsx("div",{className:"w-16 h-16 bg-brand-100 rounded-2xl flex items-center justify-center mx-auto mb-4",children:e.jsx("span",{className:"text-3xl","aria-hidden":!0,children:""})}),e.jsx("h1",{className:"text-xl font-black text-gray-900 mb-2",children:"Tlchargement indisponible"}),e.jsx("p",{className:"text-gray-600 text-sm mb-6",children:"Le fichier de l'application Android n'est pas encore disponible  cette adresse. Revenez  l'accueil et utilisez le bouton  Tlcharger l'app Android  lorsque le lien sera configur."}),e.jsx("button",{onClick:()=>i("/"),className:"px-6 py-3 bg-brand-500 text-white rounded-xl font-bold hover:bg-brand-600 transition-colors",children:"Retour  l'accueil"})]})})}function my(){const i=ht();return $i.useEffect(()=>{console.warn("404 - Route non trouve:",window.location.pathname)},[]),e.jsx("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center p-6",children:e.jsxs("div",{className:"text-center max-w-md",children:[e.jsx("div",{className:"mb-6",children:e.jsx("div",{className:"w-24 h-24 bg-brand-100 rounded-full flex items-center justify-center mx-auto mb-4",children:e.jsx("span",{className:"text-4xl font-black text-brand-600",children:"404"})})}),e.jsx("h1",{className:"text-2xl font-black text-gray-900 mb-2",children:"Page non trouve"}),e.jsx("p",{className:"text-gray-600 mb-8",children:"La page que vous cherchez n'existe pas ou a t dplace."}),e.jsxs("div",{className:"flex flex-col sm:flex-row gap-3 justify-center",children:[e.jsx("button",{onClick:()=>i("/"),className:"px-6 py-3 bg-brand-500 text-white rounded-xl font-bold hover:bg-brand-600 transition-colors",children:"Retour  l'accueil"}),e.jsx("button",{onClick:()=>i(-1),className:"px-6 py-3 bg-gray-200 text-gray-700 rounded-xl font-bold hover:bg-gray-300 transition-colors",children:"Page prcdente"})]})]})})}function xy(){const{toasts:i,removeToast:u}=sa();return e.jsxs(sf,{children:[e.jsx(Dp,{}),e.jsx(Tp,{}),e.jsx(Mp,{}),e.jsxs(Rh,{children:[e.jsx(it,{path:"/",element:e.jsx(Gp,{})}),e.jsx(it,{path:"/about",element:e.jsx(Zb,{})}),e.jsx(it,{path:"/onboard",element:e.jsx(Qp,{})}),e.jsx(it,{path:"/artisans",element:e.jsx(Xp,{})}),e.jsx(it,{path:"/artisans/:id",element:e.jsx(Yb,{})}),e.jsx(it,{path:"/favorites",element:e.jsx(Xb,{})}),e.jsx(it,{path:"/category/:slug",element:e.jsx(Zp,{})}),e.jsx(it,{path:"/download/:filename",element:e.jsx(uy,{})}),e.jsx(it,{path:"/dashboard",element:e.jsx(Jt,{children:e.jsx(Ub,{})})}),e.jsx(it,{path:"/revisions",element:e.jsx(Jt,{children:e.jsx(sy,{})})}),e.jsx(it,{path:"/revisions/:revisionId/respond",element:e.jsx(Jt,{children:e.jsx(ry,{})})}),e.jsx(it,{path:"/create-project",element:e.jsx(Jt,{children:e.jsx(tb,{})})}),e.jsx(it,{path:"/projects/:id",element:e.jsx(Jt,{children:e.jsx(Nb,{})})}),e.jsx(it,{path:"/projects/:projectId/request-revision",element:e.jsx(Jt,{children:e.jsx(ly,{})})}),e.jsx(it,{path:"/projects/:id/payment",element:e.jsx(Jt,{children:e.jsx(_b,{})})}),e.jsx(it,{path:"/projects/:id/thank-you",element:e.jsx(Jt,{children:e.jsx(Sb,{})})}),e.jsx(it,{path:"/projects/:id/suivi",element:e.jsx(Jt,{children:e.jsx(zb,{})})}),e.jsx(it,{path:"/projects/:id/work",element:e.jsx(Jt,{children:e.jsx(kb,{})})}),e.jsx(it,{path:"/projects/:id/awaiting-payment",element:e.jsx(Jt,{children:e.jsx(Cb,{})})}),e.jsx(it,{path:"/projects/:id/completion",element:e.jsx(Jt,{children:e.jsx(Eb,{})})}),e.jsx(it,{path:"/chat/:projectId",element:e.jsx(Jt,{children:e.jsx(Rb,{})})}),e.jsx(it,{path:"/credits",element:e.jsx(Jt,{children:e.jsx(wb,{})})}),e.jsx(it,{path:"/verification",element:e.jsx(Jt,{children:e.jsx(Ob,{})})}),e.jsx(it,{path:"/edit-profile",element:e.jsx(Jt,{children:e.jsx(Gb,{})})}),e.jsx(it,{path:"/expenses",element:e.jsx(Jt,{children:e.jsx($b,{})})}),e.jsx(it,{path:"/invoices",element:e.jsx(Jt,{children:e.jsx(Qb,{})})}),e.jsx(it,{path:"/conversations",element:e.jsx(Jt,{children:e.jsx(iy,{})})}),e.jsx(it,{path:"/notifications",element:e.jsx(Jt,{children:e.jsx(dy,{})})}),e.jsx(it,{path:"/admin",element:e.jsx(Ks,{children:e.jsx(Pb,{})})}),e.jsx(it,{path:"/admin/users",element:e.jsx(Ks,{children:e.jsx(Kb,{})})}),e.jsx(it,{path:"/admin/projects",element:e.jsx(Ks,{children:e.jsx(Jb,{})})}),e.jsx(it,{path:"/admin/escrows",element:e.jsx(Ks,{children:e.jsx(Wb,{})})}),e.jsx(it,{path:"/admin/verifications",element:e.jsx(Ks,{children:e.jsx(Ib,{})})}),e.jsx(it,{path:"/admin/affiliations",element:e.jsx(Ks,{children:e.jsx(ay,{})})}),e.jsx(it,{path:"/admin/disputes",element:e.jsx(Ks,{children:e.jsx(ey,{})})}),e.jsx(it,{path:"/admin/closures",element:e.jsx(Ks,{children:e.jsx(ty,{})})}),e.jsx(it,{path:"*",element:e.jsx(my,{})})]}),e.jsx(Op,{}),e.jsx(qp,{toasts:i,onRemove:u})]})}function fy(){return e.jsx(Lp,{children:e.jsx(xy,{})})}"scrollRestoration"in window.history&&(window.history.scrollRestoration="manual");Gh.createRoot(document.getElementById("root")).render(e.jsx(Th,{children:e.jsx($h,{children:e.jsx(fy,{})})}));export{Ji as _};
