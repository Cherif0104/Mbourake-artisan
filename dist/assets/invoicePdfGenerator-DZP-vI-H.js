import{E as z}from"./jspdf.es.min-DSUTeXf_.js";import"./index-Ds4k8OKA.js";import"./react-vendor-xNK3thrU.js";import"./supabase-vendor-CSCOup90.js";function L(o){const t=new z,n=t.internal.pageSize.getWidth(),C=t.internal.pageSize.getHeight(),a=20;let e=a;const s=7,u=[59,130,246],g=[31,41,55],F=[107,114,128],f=[34,197,94];t.setFillColor(...u),t.rect(0,0,n,35,"F"),t.setTextColor(255,255,255),t.setFontSize(24),t.setFont("helvetica","bold"),t.text("FACTURE",a,20),t.setFontSize(11),t.setFont("helvetica","normal"),t.text(`N° ${o.invoice_number}`,n-a,20,{align:"right"});const p=new Date(o.issue_date).toLocaleDateString("fr-FR",{day:"2-digit",month:"long",year:"numeric"});if(t.setFontSize(9),t.text(`Date d'émission: ${p}`,n-a,28,{align:"right"}),o.due_date){const l=new Date(o.due_date).toLocaleDateString("fr-FR");t.text(`Échéance: ${l}`,n-a,34,{align:"right"})}e=45,t.setTextColor(...g),t.setFontSize(9),t.setFont("helvetica","bold"),t.text("ÉMETTEUR",a,e),t.setFont("helvetica","normal"),t.setFontSize(10),e+=s,o.artisan_name&&(t.text(o.artisan_name,a,e),e+=s),o.artisan_address&&(t.text(o.artisan_address,a,e),e+=s*1.5),o.artisan_phone&&(t.text(`Tél: ${o.artisan_phone}`,a,e),e+=s),o.artisan_email&&t.text(`Email: ${o.artisan_email}`,a,e);const x=n/2+10;e=45,t.setFont("helvetica","bold"),t.text("CLIENT",x,e),t.setFont("helvetica","normal"),e+=s,o.client_name&&(t.text(o.client_name,x,e),e+=s),o.client_address&&(t.text(o.client_address,x,e),e+=s*1.5),o.client_phone&&(t.text(`Tél: ${o.client_phone}`,x,e),e+=s),o.client_email&&t.text(`Email: ${o.client_email}`,x,e),e=95,t.setFillColor(239,246,255),t.setDrawColor(...u),t.rect(a-5,e-8,n-2*a+10,15,"FD"),t.setFontSize(11),t.setFont("helvetica","bold"),t.setTextColor(30,64,175),t.text(`Projet: ${o.project_title}`,a,e),o.project_number&&(t.setFontSize(9),t.setFont("helvetica","normal"),t.setTextColor(...F),t.text(`N° ${o.project_number}`,a,e+8)),e+=20,t.setTextColor(...g);const i=e,r=a,m=r+70,T=r+100,d=n-a;t.setFillColor(243,244,246),t.rect(r-5,i-8,n-2*a+10,8,"F"),t.setFontSize(9),t.setFont("helvetica","bold"),t.setTextColor(...F),t.text("DESCRIPTION",r,i-2),t.text("QTÉ",m,i-2,{align:"center"}),t.text("P.U.",T,i-2,{align:"right"}),t.text("MONTANT",d,i-2,{align:"right"}),e=i+5,t.setFont("helvetica","normal"),t.setFontSize(10),t.setTextColor(...g),(o.items&&o.items.length>0?o.items:[{description:o.project_title||"Prestation",quantity:1,unit_price:o.subtotal,amount:o.subtotal}]).forEach(l=>{const _=t.splitTextToSize(l.description||"Prestation",m-r-5),S=Math.max(_.length*s,8);t.text(_,r,e),l.quantity&&t.text(l.quantity.toString(),m,e,{align:"center"}),l.unit_price&&t.text(`${l.unit_price.toLocaleString("fr-FR")} FCFA`,T,e,{align:"right"}),t.text(`${l.amount.toLocaleString("fr-FR")} FCFA`,d,e,{align:"right"}),e+=S+3,t.setDrawColor(229,231,235),t.line(r,e-2,n-a,e-2),e+=2}),e+=5;const c=n-a-60;if(t.setFontSize(10),t.text("Sous-total",c,e,{align:"right"}),t.text(`${o.subtotal.toLocaleString("fr-FR")} FCFA`,n-a,e,{align:"right"}),e+=8,o.tax_amount&&o.tax_amount>0){const l=o.tax_percent?`TVA (${o.tax_percent}%)`:"TVA";t.text(l,c,e,{align:"right"}),t.text(`${o.tax_amount.toLocaleString("fr-FR")} FCFA`,n-a,e,{align:"right"}),e+=8}if(t.setFillColor(239,246,255),t.rect(c-10,e-8,70,12,"F"),t.setFontSize(12),t.setFont("helvetica","bold"),t.setTextColor(30,64,175),t.text("TOTAL",c,e,{align:"right"}),t.text(`${o.total_amount.toLocaleString("fr-FR")} FCFA`,n-a,e,{align:"right"}),e+=20,t.setTextColor(...g),o.notes){t.setFontSize(9),t.setFont("helvetica","normal"),t.setTextColor(...F);const l=t.splitTextToSize(`Note: ${o.notes}`,n-2*a);t.text(l,a,e),e+=l.length*s+10}t.setFontSize(10),t.setFont("helvetica","bold"),o.status==="paid"?(t.setTextColor(...f),t.text("✓ PAYÉE",a,e)):o.status==="overdue"?(t.setTextColor(239,68,68),t.text("EN RETARD",a,e)):(t.setTextColor(251,191,36),t.text("EN ATTENTE",a,e));const h=C-30;t.setDrawColor(229,231,235),t.line(a,h,n-a,h),t.setFontSize(9),t.setFont("helvetica","normal"),t.setTextColor(...F),t.text("Document généré par Mbourake - Plateforme de mise en relation artisans/clients",n/2,h+8,{align:"center"}),t.text("Facture conforme aux normes en vigueur au Sénégal",n/2,h+15,{align:"center"}),t.save(`Facture-${o.invoice_number}.pdf`)}export{L as downloadInvoicePDF};
